"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/next-sanity";
exports.ids = ["vendor-chunks/next-sanity"];
exports.modules = {

/***/ "(action-browser)/./node_modules/next-sanity/dist/visual-editing/server-actions.js":
/*!************************************************************************!*\
  !*** ./node_modules/next-sanity/dist/visual-editing/server-actions.js ***!
  \************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   revalidateRootLayout: () => (/* binding */ revalidateRootLayout)\n/* harmony export */ });\n/* harmony import */ var private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! private-next-rsc-server-reference */ \"(action-browser)/./node_modules/next/dist/build/webpack/loaders/next-flight-loader/server-reference.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! private-next-rsc-action-encryption */ \"(action-browser)/./node_modules/next/dist/server/app-render/encryption.js\");\n/* harmony import */ var next_cache_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/cache.js */ \"(action-browser)/./node_modules/next/cache.js\");\n/* harmony import */ var next_headers_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/headers.js */ \"(action-browser)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! private-next-rsc-action-validate */ \"(action-browser)/./node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-validate.js\");\n/* __next_internal_action_entry_do_not_use__ {\"7ffdcc8caedf9b731e41cc207adc540de4d11bc13d\":\"revalidateRootLayout\"} */ \n\n\n\nasync function revalidateRootLayout() {\n    if (!(await (0,next_headers_js__WEBPACK_IMPORTED_MODULE_3__.draftMode)()).isEnabled) {\n        console.warn(\"Skipped revalidatePath request because draft mode is not enabled\");\n        return;\n    }\n    await (0,next_cache_js__WEBPACK_IMPORTED_MODULE_2__.revalidatePath)(\"/\", \"layout\");\n}\n //# sourceMappingURL=server-actions.js.map\n\n(0,private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_4__.ensureServerEntryExports)([\n    revalidateRootLayout\n]);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(revalidateRootLayout, \"7ffdcc8caedf9b731e41cc207adc540de4d11bc13d\", null);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL25vZGVfbW9kdWxlcy9uZXh0LXNhbml0eS9kaXN0L3Zpc3VhbC1lZGl0aW5nL3NlcnZlci1hY3Rpb25zLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFJQSxlQUFzQix1QkFBc0M7SUFDMUQsSUFBSSxFQUFFLE1BQU0sMERBQVMsRUFBQyxFQUFHLFdBQVc7UUFFbEMsUUFBUSxLQUFLLGtFQUFrRTtRQUMvRTtJQUFBO0lBRUksbUVBQWMsQ0FBQyxLQUFLLFFBQVE7QUFDcEMiLCJzb3VyY2VzIjpbIi9ob21lL3NyYy92aXN1YWwtZWRpdGluZy9zZXJ2ZXItYWN0aW9ucy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHNlcnZlcidcbmltcG9ydCB7cmV2YWxpZGF0ZVBhdGh9IGZyb20gJ25leHQvY2FjaGUuanMnXG5pbXBvcnQge2RyYWZ0TW9kZX0gZnJvbSAnbmV4dC9oZWFkZXJzLmpzJ1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmV2YWxpZGF0ZVJvb3RMYXlvdXQoKTogUHJvbWlzZTx2b2lkPiB7XG4gIGlmICghKGF3YWl0IGRyYWZ0TW9kZSgpKS5pc0VuYWJsZWQpIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgIGNvbnNvbGUud2FybignU2tpcHBlZCByZXZhbGlkYXRlUGF0aCByZXF1ZXN0IGJlY2F1c2UgZHJhZnQgbW9kZSBpcyBub3QgZW5hYmxlZCcpXG4gICAgcmV0dXJuXG4gIH1cbiAgYXdhaXQgcmV2YWxpZGF0ZVBhdGgoJy8nLCAnbGF5b3V0Jylcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./node_modules/next-sanity/dist/visual-editing/server-actions.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/next-sanity/dist/visual-editing/client-component.js":
/*!**************************************************************************!*\
  !*** ./node_modules/next-sanity/dist/visual-editing/client-component.js ***!
  \**************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react_server_dom_webpack_server_edge__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react-server-dom-webpack/server.edge */ "(rsc)/./node_modules/next/dist/server/route-modules/app-page/vendored/rsc/react-server-dom-webpack-server-edge.js");

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,react_server_dom_webpack_server_edge__WEBPACK_IMPORTED_MODULE_0__.registerClientReference)(
function() { throw new Error("Attempted to call the default export of \"/home/runner/workspace/node_modules/next-sanity/dist/visual-editing/client-component.js\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component."); },
"/home/runner/workspace/node_modules/next-sanity/dist/visual-editing/client-component.js",
"default",
));


/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/dist/_chunks-es/VisualEditing.js":
/*!*******************************************************************!*\
  !*** ./node_modules/next-sanity/dist/_chunks-es/VisualEditing.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ VisualEditing)\n/* harmony export */ });\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n/* harmony import */ var _sanity_visual_editing_react__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sanity/visual-editing/react */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/react/index.js\");\n/* harmony import */ var next_navigation_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/navigation.js */ \"(ssr)/./node_modules/next/dist/api/navigation.js\");\n/* harmony import */ var next_sanity_visual_editing_server_actions__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next-sanity/visual-editing/server-actions */ \"(ssr)/./node_modules/next-sanity/dist/visual-editing/server-actions.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js\");\n\n\n\n\n\nfunction pathHasPrefix(path, prefix) {\n  if (typeof path != \"string\")\n    return !1;\n  const { pathname } = parsePath(path);\n  return pathname === prefix || pathname.startsWith(`${prefix}/`);\n}\nfunction parsePath(path) {\n  const hashIndex = path.indexOf(\"#\"), queryIndex = path.indexOf(\"?\"), hasQuery = queryIndex > -1 && (hashIndex < 0 || queryIndex < hashIndex);\n  return hasQuery || hashIndex > -1 ? {\n    pathname: path.substring(0, hasQuery ? queryIndex : hashIndex),\n    query: hasQuery ? path.substring(queryIndex, hashIndex > -1 ? hashIndex : void 0) : \"\",\n    hash: hashIndex > -1 ? path.slice(hashIndex) : \"\"\n  } : { pathname: path, query: \"\", hash: \"\" };\n}\nfunction addPathPrefix(path, prefix) {\n  if (!path.startsWith(\"/\") || !prefix)\n    return path;\n  if (path === \"/\" && prefix)\n    return prefix;\n  const { pathname, query, hash } = parsePath(path);\n  return `${prefix}${pathname}${query}${hash}`;\n}\nfunction removePathPrefix(path, prefix) {\n  if (!pathHasPrefix(path, prefix))\n    return path;\n  const withoutPrefix = path.slice(prefix.length);\n  return withoutPrefix.startsWith(\"/\") ? withoutPrefix : `/${withoutPrefix}`;\n}\nconst normalizePathTrailingSlash = (path, trailingSlash) => {\n  const { pathname, query, hash } = parsePath(path);\n  return trailingSlash ? pathname.endsWith(\"/\") ? `${pathname}${query}${hash}` : `${pathname}/${query}${hash}` : `${removeTrailingSlash(pathname)}${query}${hash}`;\n};\nfunction removeTrailingSlash(route) {\n  return route.replace(/\\/$/, \"\") || \"/\";\n}\nfunction VisualEditing(props) {\n  const { basePath = \"\", components, refresh, trailingSlash = !1, zIndex } = props, router = (0,next_navigation_js__WEBPACK_IMPORTED_MODULE_1__.useRouter)(), routerRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(router), [navigate, setNavigate] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)();\n  (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n    routerRef.current = router;\n  }, [router]);\n  const history = (0,react__WEBPACK_IMPORTED_MODULE_2__.useMemo)(\n    () => ({\n      subscribe: (_navigate) => (setNavigate(() => _navigate), () => setNavigate(void 0)),\n      update: (update) => {\n        switch (update.type) {\n          case \"push\":\n            return routerRef.current.push(removePathPrefix(update.url, basePath));\n          case \"pop\":\n            return routerRef.current.back();\n          case \"replace\":\n            return routerRef.current.replace(removePathPrefix(update.url, basePath));\n          default:\n            throw new Error(`Unknown update type: ${update.type}`);\n        }\n      }\n    }),\n    [basePath]\n  ), pathname = (0,next_navigation_js__WEBPACK_IMPORTED_MODULE_1__.usePathname)(), searchParams = (0,next_navigation_js__WEBPACK_IMPORTED_MODULE_1__.useSearchParams)();\n  (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(() => {\n    navigate && navigate({\n      type: \"push\",\n      url: normalizePathTrailingSlash(\n        addPathPrefix(`${pathname}${searchParams?.size ? `?${searchParams}` : \"\"}`, basePath),\n        trailingSlash\n      )\n    });\n  }, [basePath, navigate, pathname, searchParams, trailingSlash]);\n  const handleRefresh = (0,react__WEBPACK_IMPORTED_MODULE_2__.useCallback)(\n    (payload) => {\n      if (refresh) return refresh(payload);\n      const manualFastRefresh = () => (console.debug(\n        \"Live preview is setup, calling router.refresh() to refresh the server components without refetching cached data\"\n      ), routerRef.current.refresh(), Promise.resolve()), manualFallbackRefresh = () => (console.debug(\n        \"No loaders in live mode detected, or preview kit setup, revalidating root layout\"\n      ), (0,next_sanity_visual_editing_server_actions__WEBPACK_IMPORTED_MODULE_3__.revalidateRootLayout)()), mutationFastRefresh = () => (console.debug(\n        \"Live preview is setup, mutation is skipped assuming its handled by the live preview\"\n      ), !1), mutationFallbackRefresh = () => (console.debug(\n        \"No loaders in live mode detected, or preview kit setup, revalidating root layout\"\n      ), (0,next_sanity_visual_editing_server_actions__WEBPACK_IMPORTED_MODULE_3__.revalidateRootLayout)());\n      switch (payload.source) {\n        case \"manual\":\n          return payload.livePreviewEnabled ? manualFastRefresh() : manualFallbackRefresh();\n        case \"mutation\":\n          return payload.livePreviewEnabled ? mutationFastRefresh() : mutationFallbackRefresh();\n        default:\n          throw new Error(\"Unknown refresh source\", { cause: payload });\n      }\n    },\n    [refresh]\n  );\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\n    _sanity_visual_editing_react__WEBPACK_IMPORTED_MODULE_4__.VisualEditing,\n    {\n      components,\n      history,\n      portal: !0,\n      refresh: handleRefresh,\n      zIndex\n    }\n  );\n}\n\n//# sourceMappingURL=VisualEditing.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvZGlzdC9fY2h1bmtzLWVzL1Zpc3VhbEVkaXRpbmcuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQXdDO0FBQ3dDO0FBQ0g7QUFDSTtBQUNQO0FBQzFFO0FBQ0E7QUFDQTtBQUNBLFVBQVUsV0FBVztBQUNyQix1REFBdUQsT0FBTztBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksSUFBSTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsd0JBQXdCO0FBQ2xDLFlBQVksT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsS0FBSztBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkRBQTZELGNBQWM7QUFDM0U7QUFDQTtBQUNBLFVBQVUsd0JBQXdCO0FBQ2xDLHFEQUFxRCxTQUFTLEVBQUUsTUFBTSxFQUFFLEtBQUssT0FBTyxTQUFTLEdBQUcsTUFBTSxFQUFFLEtBQUssT0FBTyw4QkFBOEIsRUFBRSxNQUFNLEVBQUUsS0FBSztBQUNqSztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxpRUFBaUUsa0JBQWtCLDZEQUFTLGdCQUFnQiw2Q0FBTSxvQ0FBb0MsK0NBQVE7QUFDeEssRUFBRSxnREFBUztBQUNYO0FBQ0EsR0FBRztBQUNILGtCQUFrQiw4Q0FBTztBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9ELFlBQVk7QUFDaEU7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGdCQUFnQiwrREFBVyxtQkFBbUIsbUVBQWU7QUFDN0QsRUFBRSxnREFBUztBQUNYO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixTQUFTLEVBQUUseUJBQXlCLGFBQWEsT0FBTztBQUNqRjtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSCx3QkFBd0Isa0RBQVc7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUywrRkFBb0I7QUFDN0I7QUFDQTtBQUNBO0FBQ0EsU0FBUywrRkFBb0I7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNELGdCQUFnQjtBQUN0RTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EseUJBQXlCLHNEQUFHO0FBQzVCLElBQUksdUVBQWU7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0U7QUFDRiIsInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvZGlzdC9fY2h1bmtzLWVzL1Zpc3VhbEVkaXRpbmcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsganN4IH0gZnJvbSBcInJlYWN0L2pzeC1ydW50aW1lXCI7XG5pbXBvcnQgeyBWaXN1YWxFZGl0aW5nIGFzIFZpc3VhbEVkaXRpbmckMSB9IGZyb20gXCJAc2FuaXR5L3Zpc3VhbC1lZGl0aW5nL3JlYWN0XCI7XG5pbXBvcnQgeyB1c2VSb3V0ZXIsIHVzZVBhdGhuYW1lLCB1c2VTZWFyY2hQYXJhbXMgfSBmcm9tIFwibmV4dC9uYXZpZ2F0aW9uLmpzXCI7XG5pbXBvcnQgeyByZXZhbGlkYXRlUm9vdExheW91dCB9IGZyb20gXCJuZXh0LXNhbml0eS92aXN1YWwtZWRpdGluZy9zZXJ2ZXItYWN0aW9uc1wiO1xuaW1wb3J0IHsgdXNlUmVmLCB1c2VTdGF0ZSwgdXNlRWZmZWN0LCB1c2VNZW1vLCB1c2VDYWxsYmFjayB9IGZyb20gXCJyZWFjdFwiO1xuZnVuY3Rpb24gcGF0aEhhc1ByZWZpeChwYXRoLCBwcmVmaXgpIHtcbiAgaWYgKHR5cGVvZiBwYXRoICE9IFwic3RyaW5nXCIpXG4gICAgcmV0dXJuICExO1xuICBjb25zdCB7IHBhdGhuYW1lIH0gPSBwYXJzZVBhdGgocGF0aCk7XG4gIHJldHVybiBwYXRobmFtZSA9PT0gcHJlZml4IHx8IHBhdGhuYW1lLnN0YXJ0c1dpdGgoYCR7cHJlZml4fS9gKTtcbn1cbmZ1bmN0aW9uIHBhcnNlUGF0aChwYXRoKSB7XG4gIGNvbnN0IGhhc2hJbmRleCA9IHBhdGguaW5kZXhPZihcIiNcIiksIHF1ZXJ5SW5kZXggPSBwYXRoLmluZGV4T2YoXCI/XCIpLCBoYXNRdWVyeSA9IHF1ZXJ5SW5kZXggPiAtMSAmJiAoaGFzaEluZGV4IDwgMCB8fCBxdWVyeUluZGV4IDwgaGFzaEluZGV4KTtcbiAgcmV0dXJuIGhhc1F1ZXJ5IHx8IGhhc2hJbmRleCA+IC0xID8ge1xuICAgIHBhdGhuYW1lOiBwYXRoLnN1YnN0cmluZygwLCBoYXNRdWVyeSA/IHF1ZXJ5SW5kZXggOiBoYXNoSW5kZXgpLFxuICAgIHF1ZXJ5OiBoYXNRdWVyeSA/IHBhdGguc3Vic3RyaW5nKHF1ZXJ5SW5kZXgsIGhhc2hJbmRleCA+IC0xID8gaGFzaEluZGV4IDogdm9pZCAwKSA6IFwiXCIsXG4gICAgaGFzaDogaGFzaEluZGV4ID4gLTEgPyBwYXRoLnNsaWNlKGhhc2hJbmRleCkgOiBcIlwiXG4gIH0gOiB7IHBhdGhuYW1lOiBwYXRoLCBxdWVyeTogXCJcIiwgaGFzaDogXCJcIiB9O1xufVxuZnVuY3Rpb24gYWRkUGF0aFByZWZpeChwYXRoLCBwcmVmaXgpIHtcbiAgaWYgKCFwYXRoLnN0YXJ0c1dpdGgoXCIvXCIpIHx8ICFwcmVmaXgpXG4gICAgcmV0dXJuIHBhdGg7XG4gIGlmIChwYXRoID09PSBcIi9cIiAmJiBwcmVmaXgpXG4gICAgcmV0dXJuIHByZWZpeDtcbiAgY29uc3QgeyBwYXRobmFtZSwgcXVlcnksIGhhc2ggfSA9IHBhcnNlUGF0aChwYXRoKTtcbiAgcmV0dXJuIGAke3ByZWZpeH0ke3BhdGhuYW1lfSR7cXVlcnl9JHtoYXNofWA7XG59XG5mdW5jdGlvbiByZW1vdmVQYXRoUHJlZml4KHBhdGgsIHByZWZpeCkge1xuICBpZiAoIXBhdGhIYXNQcmVmaXgocGF0aCwgcHJlZml4KSlcbiAgICByZXR1cm4gcGF0aDtcbiAgY29uc3Qgd2l0aG91dFByZWZpeCA9IHBhdGguc2xpY2UocHJlZml4Lmxlbmd0aCk7XG4gIHJldHVybiB3aXRob3V0UHJlZml4LnN0YXJ0c1dpdGgoXCIvXCIpID8gd2l0aG91dFByZWZpeCA6IGAvJHt3aXRob3V0UHJlZml4fWA7XG59XG5jb25zdCBub3JtYWxpemVQYXRoVHJhaWxpbmdTbGFzaCA9IChwYXRoLCB0cmFpbGluZ1NsYXNoKSA9PiB7XG4gIGNvbnN0IHsgcGF0aG5hbWUsIHF1ZXJ5LCBoYXNoIH0gPSBwYXJzZVBhdGgocGF0aCk7XG4gIHJldHVybiB0cmFpbGluZ1NsYXNoID8gcGF0aG5hbWUuZW5kc1dpdGgoXCIvXCIpID8gYCR7cGF0aG5hbWV9JHtxdWVyeX0ke2hhc2h9YCA6IGAke3BhdGhuYW1lfS8ke3F1ZXJ5fSR7aGFzaH1gIDogYCR7cmVtb3ZlVHJhaWxpbmdTbGFzaChwYXRobmFtZSl9JHtxdWVyeX0ke2hhc2h9YDtcbn07XG5mdW5jdGlvbiByZW1vdmVUcmFpbGluZ1NsYXNoKHJvdXRlKSB7XG4gIHJldHVybiByb3V0ZS5yZXBsYWNlKC9cXC8kLywgXCJcIikgfHwgXCIvXCI7XG59XG5mdW5jdGlvbiBWaXN1YWxFZGl0aW5nKHByb3BzKSB7XG4gIGNvbnN0IHsgYmFzZVBhdGggPSBcIlwiLCBjb21wb25lbnRzLCByZWZyZXNoLCB0cmFpbGluZ1NsYXNoID0gITEsIHpJbmRleCB9ID0gcHJvcHMsIHJvdXRlciA9IHVzZVJvdXRlcigpLCByb3V0ZXJSZWYgPSB1c2VSZWYocm91dGVyKSwgW25hdmlnYXRlLCBzZXROYXZpZ2F0ZV0gPSB1c2VTdGF0ZSgpO1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHJvdXRlclJlZi5jdXJyZW50ID0gcm91dGVyO1xuICB9LCBbcm91dGVyXSk7XG4gIGNvbnN0IGhpc3RvcnkgPSB1c2VNZW1vKFxuICAgICgpID0+ICh7XG4gICAgICBzdWJzY3JpYmU6IChfbmF2aWdhdGUpID0+IChzZXROYXZpZ2F0ZSgoKSA9PiBfbmF2aWdhdGUpLCAoKSA9PiBzZXROYXZpZ2F0ZSh2b2lkIDApKSxcbiAgICAgIHVwZGF0ZTogKHVwZGF0ZSkgPT4ge1xuICAgICAgICBzd2l0Y2ggKHVwZGF0ZS50eXBlKSB7XG4gICAgICAgICAgY2FzZSBcInB1c2hcIjpcbiAgICAgICAgICAgIHJldHVybiByb3V0ZXJSZWYuY3VycmVudC5wdXNoKHJlbW92ZVBhdGhQcmVmaXgodXBkYXRlLnVybCwgYmFzZVBhdGgpKTtcbiAgICAgICAgICBjYXNlIFwicG9wXCI6XG4gICAgICAgICAgICByZXR1cm4gcm91dGVyUmVmLmN1cnJlbnQuYmFjaygpO1xuICAgICAgICAgIGNhc2UgXCJyZXBsYWNlXCI6XG4gICAgICAgICAgICByZXR1cm4gcm91dGVyUmVmLmN1cnJlbnQucmVwbGFjZShyZW1vdmVQYXRoUHJlZml4KHVwZGF0ZS51cmwsIGJhc2VQYXRoKSk7XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biB1cGRhdGUgdHlwZTogJHt1cGRhdGUudHlwZX1gKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pLFxuICAgIFtiYXNlUGF0aF1cbiAgKSwgcGF0aG5hbWUgPSB1c2VQYXRobmFtZSgpLCBzZWFyY2hQYXJhbXMgPSB1c2VTZWFyY2hQYXJhbXMoKTtcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBuYXZpZ2F0ZSAmJiBuYXZpZ2F0ZSh7XG4gICAgICB0eXBlOiBcInB1c2hcIixcbiAgICAgIHVybDogbm9ybWFsaXplUGF0aFRyYWlsaW5nU2xhc2goXG4gICAgICAgIGFkZFBhdGhQcmVmaXgoYCR7cGF0aG5hbWV9JHtzZWFyY2hQYXJhbXM/LnNpemUgPyBgPyR7c2VhcmNoUGFyYW1zfWAgOiBcIlwifWAsIGJhc2VQYXRoKSxcbiAgICAgICAgdHJhaWxpbmdTbGFzaFxuICAgICAgKVxuICAgIH0pO1xuICB9LCBbYmFzZVBhdGgsIG5hdmlnYXRlLCBwYXRobmFtZSwgc2VhcmNoUGFyYW1zLCB0cmFpbGluZ1NsYXNoXSk7XG4gIGNvbnN0IGhhbmRsZVJlZnJlc2ggPSB1c2VDYWxsYmFjayhcbiAgICAocGF5bG9hZCkgPT4ge1xuICAgICAgaWYgKHJlZnJlc2gpIHJldHVybiByZWZyZXNoKHBheWxvYWQpO1xuICAgICAgY29uc3QgbWFudWFsRmFzdFJlZnJlc2ggPSAoKSA9PiAoY29uc29sZS5kZWJ1ZyhcbiAgICAgICAgXCJMaXZlIHByZXZpZXcgaXMgc2V0dXAsIGNhbGxpbmcgcm91dGVyLnJlZnJlc2goKSB0byByZWZyZXNoIHRoZSBzZXJ2ZXIgY29tcG9uZW50cyB3aXRob3V0IHJlZmV0Y2hpbmcgY2FjaGVkIGRhdGFcIlxuICAgICAgKSwgcm91dGVyUmVmLmN1cnJlbnQucmVmcmVzaCgpLCBQcm9taXNlLnJlc29sdmUoKSksIG1hbnVhbEZhbGxiYWNrUmVmcmVzaCA9ICgpID0+IChjb25zb2xlLmRlYnVnKFxuICAgICAgICBcIk5vIGxvYWRlcnMgaW4gbGl2ZSBtb2RlIGRldGVjdGVkLCBvciBwcmV2aWV3IGtpdCBzZXR1cCwgcmV2YWxpZGF0aW5nIHJvb3QgbGF5b3V0XCJcbiAgICAgICksIHJldmFsaWRhdGVSb290TGF5b3V0KCkpLCBtdXRhdGlvbkZhc3RSZWZyZXNoID0gKCkgPT4gKGNvbnNvbGUuZGVidWcoXG4gICAgICAgIFwiTGl2ZSBwcmV2aWV3IGlzIHNldHVwLCBtdXRhdGlvbiBpcyBza2lwcGVkIGFzc3VtaW5nIGl0cyBoYW5kbGVkIGJ5IHRoZSBsaXZlIHByZXZpZXdcIlxuICAgICAgKSwgITEpLCBtdXRhdGlvbkZhbGxiYWNrUmVmcmVzaCA9ICgpID0+IChjb25zb2xlLmRlYnVnKFxuICAgICAgICBcIk5vIGxvYWRlcnMgaW4gbGl2ZSBtb2RlIGRldGVjdGVkLCBvciBwcmV2aWV3IGtpdCBzZXR1cCwgcmV2YWxpZGF0aW5nIHJvb3QgbGF5b3V0XCJcbiAgICAgICksIHJldmFsaWRhdGVSb290TGF5b3V0KCkpO1xuICAgICAgc3dpdGNoIChwYXlsb2FkLnNvdXJjZSkge1xuICAgICAgICBjYXNlIFwibWFudWFsXCI6XG4gICAgICAgICAgcmV0dXJuIHBheWxvYWQubGl2ZVByZXZpZXdFbmFibGVkID8gbWFudWFsRmFzdFJlZnJlc2goKSA6IG1hbnVhbEZhbGxiYWNrUmVmcmVzaCgpO1xuICAgICAgICBjYXNlIFwibXV0YXRpb25cIjpcbiAgICAgICAgICByZXR1cm4gcGF5bG9hZC5saXZlUHJldmlld0VuYWJsZWQgPyBtdXRhdGlvbkZhc3RSZWZyZXNoKCkgOiBtdXRhdGlvbkZhbGxiYWNrUmVmcmVzaCgpO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVua25vd24gcmVmcmVzaCBzb3VyY2VcIiwgeyBjYXVzZTogcGF5bG9hZCB9KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIFtyZWZyZXNoXVxuICApO1xuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeChcbiAgICBWaXN1YWxFZGl0aW5nJDEsXG4gICAge1xuICAgICAgY29tcG9uZW50cyxcbiAgICAgIGhpc3RvcnksXG4gICAgICBwb3J0YWw6ICEwLFxuICAgICAgcmVmcmVzaDogaGFuZGxlUmVmcmVzaCxcbiAgICAgIHpJbmRleFxuICAgIH1cbiAgKTtcbn1cbmV4cG9ydCB7XG4gIFZpc3VhbEVkaXRpbmcgYXMgZGVmYXVsdFxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVZpc3VhbEVkaXRpbmcuanMubWFwXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/dist/_chunks-es/VisualEditing.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/dist/visual-editing/client-component.js":
/*!**************************************************************************!*\
  !*** ./node_modules/next-sanity/dist/visual-editing/client-component.js ***!
  \**************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ VisualEditingLazyClientComponent)\n/* harmony export */ });\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js\");\n/* __next_internal_client_entry_do_not_use__ default auto */ \n\nconst VisualEditingClientComponent = /*#__PURE__*/ (0,react__WEBPACK_IMPORTED_MODULE_1__.lazy)(()=>Promise.all(/*! import() */[__webpack_require__.e(\"vendor-chunks/@sanity\"), __webpack_require__.e(\"vendor-chunks/rxjs\"), __webpack_require__.e(\"vendor-chunks/next-sanity\"), __webpack_require__.e(\"vendor-chunks/lodash-es\"), __webpack_require__.e(\"vendor-chunks/lodash\"), __webpack_require__.e(\"vendor-chunks/@juggle\"), __webpack_require__.e(\"vendor-chunks/stylis\"), __webpack_require__.e(\"vendor-chunks/@floating-ui\"), __webpack_require__.e(\"vendor-chunks/@emotion\"), __webpack_require__.e(\"vendor-chunks/styled-components\"), __webpack_require__.e(\"vendor-chunks/react-is\"), __webpack_require__.e(\"vendor-chunks/valibot\"), __webpack_require__.e(\"vendor-chunks/scroll-into-view-if-needed\"), __webpack_require__.e(\"vendor-chunks/mendoza\"), __webpack_require__.e(\"vendor-chunks/get-random-values-esm\"), __webpack_require__.e(\"vendor-chunks/compute-scroll-into-view\"), __webpack_require__.e(\"vendor-chunks/@vercel\"), __webpack_require__.e(\"vendor-chunks/shallowequal\"), __webpack_require__.e(\"vendor-chunks/react-compiler-runtime\")]).then(__webpack_require__.bind(__webpack_require__, /*! ../_chunks-es/VisualEditing.js */ \"(ssr)/./node_modules/next-sanity/dist/_chunks-es/VisualEditing.js\")));\nfunction VisualEditingLazyClientComponent(props) {\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react__WEBPACK_IMPORTED_MODULE_1__.Suspense, {\n        fallback: null,\n        children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(VisualEditingClientComponent, {\n            ...props\n        })\n    });\n}\n //# sourceMappingURL=client-component.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvZGlzdC92aXN1YWwtZWRpdGluZy9jbGllbnQtY29tcG9uZW50LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBWUEsTUFBTSw2Q0FBK0IsMkNBQUksQ0FBQyxJQUFNLG1xQ0FBeUI7QUFFbEUsU0FBUyxpQ0FBaUMsT0FBNEM7SUFFekYsOEVBQUMsMkNBQVEsRUFBUjtRQUFTLFVBQVU7UUFDbEIsaUZBQUMsOEJBQThCO1lBQUEsR0FBRztRQUFBLENBQU87SUFDM0M7QUFFSiIsInNvdXJjZXMiOlsiL2hvbWUvc3JjL3Zpc3VhbC1lZGl0aW5nL2NsaWVudC1jb21wb25lbnQvVmlzdWFsRWRpdGluZ0xhenkudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICpcbiAqIElmIHBhZ2VzIHJvdXRlciBzdXBwb3J0ZWQgYG5leHQvZHluYW1pY2AgaW1wb3J0cyAoaXQgd2FudHMgYG5leHQvZHluYW1pYy5qc2ApLFxuICogb3IgaWYgdHVyYm9wYWNrIGluIGFwcCByb3V0ZXIgYWxsb3dlZCBgbmV4dC9keW5hbWljLmpzYCAoaXQgZG9lc24ndCB5ZXQpXG4gKiB3ZSBjb3VsZCB1c2UgYGR5bmFtaWMoKCkgPT4gaW1wb3J0KCcuLi4pLCB7c3NyOiBmYWxzZX0pYCBoZXJlLlxuICogU2luY2Ugd2UgY2FuJ3QsIHdlIG5lZWQgdG8gdXNlIGEgbGF6eSBpbXBvcnQgYW5kIFN1c3BlbnNlIG91cnNlbGYuXG4gKi9cblxuaW1wb3J0IHtsYXp5LCBTdXNwZW5zZX0gZnJvbSAncmVhY3QnXG5cbmltcG9ydCB0eXBlIHtWaXN1YWxFZGl0aW5nUHJvcHN9IGZyb20gJy4vVmlzdWFsRWRpdGluZydcblxuY29uc3QgVmlzdWFsRWRpdGluZ0NsaWVudENvbXBvbmVudCA9IGxhenkoKCkgPT4gaW1wb3J0KCcuL1Zpc3VhbEVkaXRpbmcnKSlcblxuZXhwb3J0IGZ1bmN0aW9uIFZpc3VhbEVkaXRpbmdMYXp5Q2xpZW50Q29tcG9uZW50KHByb3BzOiBWaXN1YWxFZGl0aW5nUHJvcHMpOiBSZWFjdC5SZWFjdE5vZGUge1xuICByZXR1cm4gKFxuICAgIDxTdXNwZW5zZSBmYWxsYmFjaz17bnVsbH0+XG4gICAgICA8VmlzdWFsRWRpdGluZ0NsaWVudENvbXBvbmVudCB7Li4ucHJvcHN9IC8+XG4gICAgPC9TdXNwZW5zZT5cbiAgKVxufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/dist/visual-editing/client-component.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/dist/visual-editing/server-actions.js":
/*!************************************************************************!*\
  !*** ./node_modules/next-sanity/dist/visual-editing/server-actions.js ***!
  \************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   revalidateRootLayout: () => (/* binding */ revalidateRootLayout)
/* harmony export */ });
/* harmony import */ var private_next_rsc_action_client_wrapper__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! private-next-rsc-action-client-wrapper */ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-client-wrapper.js");
/* __next_internal_action_entry_do_not_use__ {"7ffdcc8caedf9b731e41cc207adc540de4d11bc13d":"revalidateRootLayout"} */ 
var revalidateRootLayout = /*#__PURE__*/ (0,private_next_rsc_action_client_wrapper__WEBPACK_IMPORTED_MODULE_0__.createServerReference)("7ffdcc8caedf9b731e41cc207adc540de4d11bc13d", private_next_rsc_action_client_wrapper__WEBPACK_IMPORTED_MODULE_0__.callServer, void 0, private_next_rsc_action_client_wrapper__WEBPACK_IMPORTED_MODULE_0__.findSourceMapURL, "revalidateRootLayout");
 //# sourceMappingURL=server-actions.js.map


/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/arrify.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/arrify.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   arrify: () => (/* binding */ arrify)\n/* harmony export */ });\nfunction arrify(val) {\n  return Array.isArray(val) ? val : [val];\n}\n\n//# sourceMappingURL=arrify.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy9hcnJpZnkuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUdFO0FBQ0YiLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3Jrc3BhY2Uvbm9kZV9tb2R1bGVzL25leHQtc2FuaXR5L25vZGVfbW9kdWxlcy9Ac2FuaXR5L211dGF0ZS9kaXN0L19jaHVua3MtZXMvYXJyaWZ5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIGFycmlmeSh2YWwpIHtcbiAgcmV0dXJuIEFycmF5LmlzQXJyYXkodmFsKSA/IHZhbCA6IFt2YWxdO1xufVxuZXhwb3J0IHtcbiAgYXJyaWZ5XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXJyaWZ5LmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/arrify.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/decode.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/decode.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decode: () => (/* binding */ decode),\n/* harmony export */   decodeAll: () => (/* binding */ decodeAll)\n/* harmony export */ });\n/* harmony import */ var _parse_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./parse.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/parse.js\");\n\nfunction isCreateIfNotExistsMutation(sanityMutation) {\n  return \"createIfNotExists\" in sanityMutation;\n}\nfunction isCreateOrReplaceMutation(sanityMutation) {\n  return \"createOrReplace\" in sanityMutation;\n}\nfunction isCreateMutation(sanityMutation) {\n  return \"create\" in sanityMutation;\n}\nfunction isDeleteMutation(sanityMutation) {\n  return \"delete\" in sanityMutation;\n}\nfunction isPatchMutation(sanityMutation) {\n  return \"patch\" in sanityMutation;\n}\nfunction isSetPatch(sanityPatch) {\n  return \"set\" in sanityPatch;\n}\nfunction isSetIfMissingPatch(sanityPatch) {\n  return \"setIfMissing\" in sanityPatch;\n}\nfunction isUnsetPatch(sanityPatch) {\n  return \"unset\" in sanityPatch;\n}\nfunction isIncPatch(sanityPatch) {\n  return \"inc\" in sanityPatch;\n}\nfunction isDecPatch(sanityPatch) {\n  return \"inc\" in sanityPatch;\n}\nfunction isInsertPatch(sanityPatch) {\n  return \"insert\" in sanityPatch;\n}\nfunction decodeAll(sanityMutations) {\n  return sanityMutations.map(decodeMutation);\n}\nfunction decode(encodedMutation) {\n  return decodeMutation(encodedMutation);\n}\nfunction decodeMutation(encodedMutation) {\n  if (isCreateIfNotExistsMutation(encodedMutation))\n    return {\n      type: \"createIfNotExists\",\n      document: encodedMutation.createIfNotExists\n    };\n  if (isCreateOrReplaceMutation(encodedMutation))\n    return {\n      type: \"createOrReplace\",\n      document: encodedMutation.createOrReplace\n    };\n  if (isCreateMutation(encodedMutation))\n    return { type: \"create\", document: encodedMutation.create };\n  if (isDeleteMutation(encodedMutation))\n    return { id: encodedMutation.delete.id, type: \"delete\" };\n  if (isPatchMutation(encodedMutation))\n    return {\n      type: \"patch\",\n      id: encodedMutation.patch.id,\n      patches: decodeNodePatches(encodedMutation.patch)\n    };\n  throw new Error(`Unknown mutation: ${JSON.stringify(encodedMutation)}`);\n}\nconst POSITION_KEYS = [\"before\", \"replace\", \"after\"];\nfunction getInsertPosition(insert) {\n  const positions = POSITION_KEYS.filter((k) => k in insert);\n  if (positions.length > 1)\n    throw new Error(\n      `Insert patch is ambiguous. Should only contain one of: ${POSITION_KEYS.join(\n        \", \"\n      )}, instead found ${positions.join(\", \")}`\n    );\n  return positions[0];\n}\nfunction decodeNodePatches(patch) {\n  return [\n    ...getSetPatches(patch),\n    ...getSetIfMissingPatches(patch),\n    ...getUnsetPatches(patch),\n    ...getIncPatches(patch),\n    ...getDecPatches(patch),\n    ...getInsertPatches(patch)\n  ];\n}\nfunction getSetPatches(patch) {\n  return isSetPatch(patch) ? Object.keys(patch.set).map((path) => ({\n    path: (0,_parse_js__WEBPACK_IMPORTED_MODULE_0__.parse)(path),\n    op: { type: \"set\", value: patch.set[path] }\n  })) : [];\n}\nfunction getSetIfMissingPatches(patch) {\n  return isSetIfMissingPatch(patch) ? Object.keys(patch.setIfMissing).map((path) => ({\n    path: (0,_parse_js__WEBPACK_IMPORTED_MODULE_0__.parse)(path),\n    op: { type: \"setIfMissing\", value: patch.setIfMissing[path] }\n  })) : [];\n}\nfunction getUnsetPatches(patch) {\n  return isUnsetPatch(patch) ? patch.unset.map((path) => ({\n    path: (0,_parse_js__WEBPACK_IMPORTED_MODULE_0__.parse)(path),\n    op: { type: \"unset\" }\n  })) : [];\n}\nfunction getIncPatches(patch) {\n  return isIncPatch(patch) ? Object.keys(patch.inc).map((path) => ({\n    path: (0,_parse_js__WEBPACK_IMPORTED_MODULE_0__.parse)(path),\n    op: { type: \"inc\", amount: patch.inc[path] }\n  })) : [];\n}\nfunction getDecPatches(patch) {\n  return isDecPatch(patch) ? Object.keys(patch.dec).map((path) => ({\n    path: (0,_parse_js__WEBPACK_IMPORTED_MODULE_0__.parse)(path),\n    op: { type: \"dec\", amount: patch.dec[path] }\n  })) : [];\n}\nfunction getInsertPatches(patch) {\n  if (!isInsertPatch(patch))\n    return [];\n  const position = getInsertPosition(patch.insert);\n  if (!position)\n    throw new Error(\"Insert patch missing position\");\n  const path = (0,_parse_js__WEBPACK_IMPORTED_MODULE_0__.parse)(patch.insert[position]), referenceItem = path.pop(), op = position === \"replace\" ? {\n    type: \"insert\",\n    position,\n    referenceItem,\n    items: patch.insert.items\n  } : {\n    type: \"insert\",\n    position,\n    referenceItem,\n    items: patch.insert.items\n  };\n  return [{ path, op }];\n}\n\n//# sourceMappingURL=decode.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy9kZWNvZGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQW1DO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsZ0NBQWdDO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdFQUFnRTtBQUNoRTtBQUNBLFFBQVEsa0JBQWtCLHFCQUFxQjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLGdEQUFLO0FBQ2YsVUFBVTtBQUNWLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxVQUFVLGdEQUFLO0FBQ2YsVUFBVTtBQUNWLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxVQUFVLGdEQUFLO0FBQ2YsVUFBVTtBQUNWLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxVQUFVLGdEQUFLO0FBQ2YsVUFBVTtBQUNWLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxVQUFVLGdEQUFLO0FBQ2YsVUFBVTtBQUNWLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsZ0RBQUs7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksVUFBVTtBQUN0QjtBQUlFO0FBQ0YiLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3Jrc3BhY2Uvbm9kZV9tb2R1bGVzL25leHQtc2FuaXR5L25vZGVfbW9kdWxlcy9Ac2FuaXR5L211dGF0ZS9kaXN0L19jaHVua3MtZXMvZGVjb2RlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBhcnNlIH0gZnJvbSBcIi4vcGFyc2UuanNcIjtcbmZ1bmN0aW9uIGlzQ3JlYXRlSWZOb3RFeGlzdHNNdXRhdGlvbihzYW5pdHlNdXRhdGlvbikge1xuICByZXR1cm4gXCJjcmVhdGVJZk5vdEV4aXN0c1wiIGluIHNhbml0eU11dGF0aW9uO1xufVxuZnVuY3Rpb24gaXNDcmVhdGVPclJlcGxhY2VNdXRhdGlvbihzYW5pdHlNdXRhdGlvbikge1xuICByZXR1cm4gXCJjcmVhdGVPclJlcGxhY2VcIiBpbiBzYW5pdHlNdXRhdGlvbjtcbn1cbmZ1bmN0aW9uIGlzQ3JlYXRlTXV0YXRpb24oc2FuaXR5TXV0YXRpb24pIHtcbiAgcmV0dXJuIFwiY3JlYXRlXCIgaW4gc2FuaXR5TXV0YXRpb247XG59XG5mdW5jdGlvbiBpc0RlbGV0ZU11dGF0aW9uKHNhbml0eU11dGF0aW9uKSB7XG4gIHJldHVybiBcImRlbGV0ZVwiIGluIHNhbml0eU11dGF0aW9uO1xufVxuZnVuY3Rpb24gaXNQYXRjaE11dGF0aW9uKHNhbml0eU11dGF0aW9uKSB7XG4gIHJldHVybiBcInBhdGNoXCIgaW4gc2FuaXR5TXV0YXRpb247XG59XG5mdW5jdGlvbiBpc1NldFBhdGNoKHNhbml0eVBhdGNoKSB7XG4gIHJldHVybiBcInNldFwiIGluIHNhbml0eVBhdGNoO1xufVxuZnVuY3Rpb24gaXNTZXRJZk1pc3NpbmdQYXRjaChzYW5pdHlQYXRjaCkge1xuICByZXR1cm4gXCJzZXRJZk1pc3NpbmdcIiBpbiBzYW5pdHlQYXRjaDtcbn1cbmZ1bmN0aW9uIGlzVW5zZXRQYXRjaChzYW5pdHlQYXRjaCkge1xuICByZXR1cm4gXCJ1bnNldFwiIGluIHNhbml0eVBhdGNoO1xufVxuZnVuY3Rpb24gaXNJbmNQYXRjaChzYW5pdHlQYXRjaCkge1xuICByZXR1cm4gXCJpbmNcIiBpbiBzYW5pdHlQYXRjaDtcbn1cbmZ1bmN0aW9uIGlzRGVjUGF0Y2goc2FuaXR5UGF0Y2gpIHtcbiAgcmV0dXJuIFwiaW5jXCIgaW4gc2FuaXR5UGF0Y2g7XG59XG5mdW5jdGlvbiBpc0luc2VydFBhdGNoKHNhbml0eVBhdGNoKSB7XG4gIHJldHVybiBcImluc2VydFwiIGluIHNhbml0eVBhdGNoO1xufVxuZnVuY3Rpb24gZGVjb2RlQWxsKHNhbml0eU11dGF0aW9ucykge1xuICByZXR1cm4gc2FuaXR5TXV0YXRpb25zLm1hcChkZWNvZGVNdXRhdGlvbik7XG59XG5mdW5jdGlvbiBkZWNvZGUoZW5jb2RlZE11dGF0aW9uKSB7XG4gIHJldHVybiBkZWNvZGVNdXRhdGlvbihlbmNvZGVkTXV0YXRpb24pO1xufVxuZnVuY3Rpb24gZGVjb2RlTXV0YXRpb24oZW5jb2RlZE11dGF0aW9uKSB7XG4gIGlmIChpc0NyZWF0ZUlmTm90RXhpc3RzTXV0YXRpb24oZW5jb2RlZE11dGF0aW9uKSlcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogXCJjcmVhdGVJZk5vdEV4aXN0c1wiLFxuICAgICAgZG9jdW1lbnQ6IGVuY29kZWRNdXRhdGlvbi5jcmVhdGVJZk5vdEV4aXN0c1xuICAgIH07XG4gIGlmIChpc0NyZWF0ZU9yUmVwbGFjZU11dGF0aW9uKGVuY29kZWRNdXRhdGlvbikpXG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IFwiY3JlYXRlT3JSZXBsYWNlXCIsXG4gICAgICBkb2N1bWVudDogZW5jb2RlZE11dGF0aW9uLmNyZWF0ZU9yUmVwbGFjZVxuICAgIH07XG4gIGlmIChpc0NyZWF0ZU11dGF0aW9uKGVuY29kZWRNdXRhdGlvbikpXG4gICAgcmV0dXJuIHsgdHlwZTogXCJjcmVhdGVcIiwgZG9jdW1lbnQ6IGVuY29kZWRNdXRhdGlvbi5jcmVhdGUgfTtcbiAgaWYgKGlzRGVsZXRlTXV0YXRpb24oZW5jb2RlZE11dGF0aW9uKSlcbiAgICByZXR1cm4geyBpZDogZW5jb2RlZE11dGF0aW9uLmRlbGV0ZS5pZCwgdHlwZTogXCJkZWxldGVcIiB9O1xuICBpZiAoaXNQYXRjaE11dGF0aW9uKGVuY29kZWRNdXRhdGlvbikpXG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IFwicGF0Y2hcIixcbiAgICAgIGlkOiBlbmNvZGVkTXV0YXRpb24ucGF0Y2guaWQsXG4gICAgICBwYXRjaGVzOiBkZWNvZGVOb2RlUGF0Y2hlcyhlbmNvZGVkTXV0YXRpb24ucGF0Y2gpXG4gICAgfTtcbiAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIG11dGF0aW9uOiAke0pTT04uc3RyaW5naWZ5KGVuY29kZWRNdXRhdGlvbil9YCk7XG59XG5jb25zdCBQT1NJVElPTl9LRVlTID0gW1wiYmVmb3JlXCIsIFwicmVwbGFjZVwiLCBcImFmdGVyXCJdO1xuZnVuY3Rpb24gZ2V0SW5zZXJ0UG9zaXRpb24oaW5zZXJ0KSB7XG4gIGNvbnN0IHBvc2l0aW9ucyA9IFBPU0lUSU9OX0tFWVMuZmlsdGVyKChrKSA9PiBrIGluIGluc2VydCk7XG4gIGlmIChwb3NpdGlvbnMubGVuZ3RoID4gMSlcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBgSW5zZXJ0IHBhdGNoIGlzIGFtYmlndW91cy4gU2hvdWxkIG9ubHkgY29udGFpbiBvbmUgb2Y6ICR7UE9TSVRJT05fS0VZUy5qb2luKFxuICAgICAgICBcIiwgXCJcbiAgICAgICl9LCBpbnN0ZWFkIGZvdW5kICR7cG9zaXRpb25zLmpvaW4oXCIsIFwiKX1gXG4gICAgKTtcbiAgcmV0dXJuIHBvc2l0aW9uc1swXTtcbn1cbmZ1bmN0aW9uIGRlY29kZU5vZGVQYXRjaGVzKHBhdGNoKSB7XG4gIHJldHVybiBbXG4gICAgLi4uZ2V0U2V0UGF0Y2hlcyhwYXRjaCksXG4gICAgLi4uZ2V0U2V0SWZNaXNzaW5nUGF0Y2hlcyhwYXRjaCksXG4gICAgLi4uZ2V0VW5zZXRQYXRjaGVzKHBhdGNoKSxcbiAgICAuLi5nZXRJbmNQYXRjaGVzKHBhdGNoKSxcbiAgICAuLi5nZXREZWNQYXRjaGVzKHBhdGNoKSxcbiAgICAuLi5nZXRJbnNlcnRQYXRjaGVzKHBhdGNoKVxuICBdO1xufVxuZnVuY3Rpb24gZ2V0U2V0UGF0Y2hlcyhwYXRjaCkge1xuICByZXR1cm4gaXNTZXRQYXRjaChwYXRjaCkgPyBPYmplY3Qua2V5cyhwYXRjaC5zZXQpLm1hcCgocGF0aCkgPT4gKHtcbiAgICBwYXRoOiBwYXJzZShwYXRoKSxcbiAgICBvcDogeyB0eXBlOiBcInNldFwiLCB2YWx1ZTogcGF0Y2guc2V0W3BhdGhdIH1cbiAgfSkpIDogW107XG59XG5mdW5jdGlvbiBnZXRTZXRJZk1pc3NpbmdQYXRjaGVzKHBhdGNoKSB7XG4gIHJldHVybiBpc1NldElmTWlzc2luZ1BhdGNoKHBhdGNoKSA/IE9iamVjdC5rZXlzKHBhdGNoLnNldElmTWlzc2luZykubWFwKChwYXRoKSA9PiAoe1xuICAgIHBhdGg6IHBhcnNlKHBhdGgpLFxuICAgIG9wOiB7IHR5cGU6IFwic2V0SWZNaXNzaW5nXCIsIHZhbHVlOiBwYXRjaC5zZXRJZk1pc3NpbmdbcGF0aF0gfVxuICB9KSkgOiBbXTtcbn1cbmZ1bmN0aW9uIGdldFVuc2V0UGF0Y2hlcyhwYXRjaCkge1xuICByZXR1cm4gaXNVbnNldFBhdGNoKHBhdGNoKSA/IHBhdGNoLnVuc2V0Lm1hcCgocGF0aCkgPT4gKHtcbiAgICBwYXRoOiBwYXJzZShwYXRoKSxcbiAgICBvcDogeyB0eXBlOiBcInVuc2V0XCIgfVxuICB9KSkgOiBbXTtcbn1cbmZ1bmN0aW9uIGdldEluY1BhdGNoZXMocGF0Y2gpIHtcbiAgcmV0dXJuIGlzSW5jUGF0Y2gocGF0Y2gpID8gT2JqZWN0LmtleXMocGF0Y2guaW5jKS5tYXAoKHBhdGgpID0+ICh7XG4gICAgcGF0aDogcGFyc2UocGF0aCksXG4gICAgb3A6IHsgdHlwZTogXCJpbmNcIiwgYW1vdW50OiBwYXRjaC5pbmNbcGF0aF0gfVxuICB9KSkgOiBbXTtcbn1cbmZ1bmN0aW9uIGdldERlY1BhdGNoZXMocGF0Y2gpIHtcbiAgcmV0dXJuIGlzRGVjUGF0Y2gocGF0Y2gpID8gT2JqZWN0LmtleXMocGF0Y2guZGVjKS5tYXAoKHBhdGgpID0+ICh7XG4gICAgcGF0aDogcGFyc2UocGF0aCksXG4gICAgb3A6IHsgdHlwZTogXCJkZWNcIiwgYW1vdW50OiBwYXRjaC5kZWNbcGF0aF0gfVxuICB9KSkgOiBbXTtcbn1cbmZ1bmN0aW9uIGdldEluc2VydFBhdGNoZXMocGF0Y2gpIHtcbiAgaWYgKCFpc0luc2VydFBhdGNoKHBhdGNoKSlcbiAgICByZXR1cm4gW107XG4gIGNvbnN0IHBvc2l0aW9uID0gZ2V0SW5zZXJ0UG9zaXRpb24ocGF0Y2guaW5zZXJ0KTtcbiAgaWYgKCFwb3NpdGlvbilcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnNlcnQgcGF0Y2ggbWlzc2luZyBwb3NpdGlvblwiKTtcbiAgY29uc3QgcGF0aCA9IHBhcnNlKHBhdGNoLmluc2VydFtwb3NpdGlvbl0pLCByZWZlcmVuY2VJdGVtID0gcGF0aC5wb3AoKSwgb3AgPSBwb3NpdGlvbiA9PT0gXCJyZXBsYWNlXCIgPyB7XG4gICAgdHlwZTogXCJpbnNlcnRcIixcbiAgICBwb3NpdGlvbixcbiAgICByZWZlcmVuY2VJdGVtLFxuICAgIGl0ZW1zOiBwYXRjaC5pbnNlcnQuaXRlbXNcbiAgfSA6IHtcbiAgICB0eXBlOiBcImluc2VydFwiLFxuICAgIHBvc2l0aW9uLFxuICAgIHJlZmVyZW5jZUl0ZW0sXG4gICAgaXRlbXM6IHBhdGNoLmluc2VydC5pdGVtc1xuICB9O1xuICByZXR1cm4gW3sgcGF0aCwgb3AgfV07XG59XG5leHBvcnQge1xuICBkZWNvZGUsXG4gIGRlY29kZUFsbFxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRlY29kZS5qcy5tYXBcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/decode.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/encode.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/encode.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   encode: () => (/* binding */ encode),\n/* harmony export */   encodeAll: () => (/* binding */ encodeAll),\n/* harmony export */   encodeMutation: () => (/* binding */ encodeMutation),\n/* harmony export */   encodeTransaction: () => (/* binding */ encodeTransaction)\n/* harmony export */ });\n/* harmony import */ var _stringify_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./stringify.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/stringify.js\");\n\nfunction encode(mutation) {\n  return encodeMutation(mutation);\n}\nfunction encodeAll(mutations) {\n  return mutations.flatMap(encode);\n}\nfunction encodeTransaction(transaction) {\n  return {\n    transactionId: transaction.id,\n    mutations: encodeAll(transaction.mutations)\n  };\n}\nfunction encodeMutation(mutation) {\n  if (mutation.type === \"create\" || mutation.type === \"createIfNotExists\" || mutation.type === \"createOrReplace\")\n    return { [mutation.type]: mutation.document };\n  if (mutation.type === \"delete\")\n    return {\n      delete: { id: mutation.id }\n    };\n  const ifRevisionID = mutation.options?.ifRevision;\n  return mutation.patches.map((patch) => ({\n    patch: {\n      id: mutation.id,\n      ...ifRevisionID && { ifRevisionID },\n      ...patchToSanity(patch)\n    }\n  }));\n}\nfunction patchToSanity(patch) {\n  const { path, op } = patch;\n  if (op.type === \"unset\")\n    return { unset: [(0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)(path)] };\n  if (op.type === \"insert\")\n    return {\n      insert: {\n        [op.position]: (0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)([...path, op.referenceItem]),\n        items: op.items\n      }\n    };\n  if (op.type === \"diffMatchPatch\")\n    return { diffMatchPatch: { [(0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)(path)]: op.value } };\n  if (op.type === \"inc\")\n    return { inc: { [(0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)(path)]: op.amount } };\n  if (op.type === \"dec\")\n    return { dec: { [(0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)(path)]: op.amount } };\n  if (op.type === \"set\" || op.type === \"setIfMissing\")\n    return { [op.type]: { [(0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)(path)]: op.value } };\n  if (op.type === \"truncate\") {\n    const range = [\n      op.startIndex,\n      typeof op.endIndex == \"number\" ? op.endIndex : \"\"\n    ].join(\":\");\n    return { unset: [`${(0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)(path)}[${range}]`] };\n  }\n  if (op.type === \"upsert\")\n    return {\n      unset: op.items.map(\n        (item) => (0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)([...path, { _key: item._key }])\n      ),\n      insert: {\n        [op.position]: (0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)([...path, op.referenceItem]),\n        items: op.items\n      }\n    };\n  if (op.type === \"assign\")\n    return {\n      set: Object.fromEntries(\n        Object.keys(op.value).map((key) => [\n          (0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)(path.concat(key)),\n          op.value[key]\n        ])\n      )\n    };\n  if (op.type === \"unassign\")\n    return {\n      unset: op.keys.map((key) => (0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)(path.concat(key)))\n    };\n  if (op.type === \"replace\")\n    return {\n      insert: {\n        replace: (0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)(path.concat(op.referenceItem)),\n        items: op.items\n      }\n    };\n  if (op.type === \"remove\")\n    return {\n      unset: [(0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.stringify)(path.concat(op.referenceItem))]\n    };\n  throw new Error(`Unknown operation type ${op.type}`);\n}\n\n//# sourceMappingURL=encode.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy9lbmNvZGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBMkM7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsY0FBYztBQUN6QztBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxVQUFVLFdBQVc7QUFDckI7QUFDQSxhQUFhLFFBQVEsd0RBQVM7QUFDOUI7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHdEQUFTO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxrQkFBa0IsQ0FBQyx3REFBUztBQUN6QztBQUNBLGFBQWEsT0FBTyxDQUFDLHdEQUFTO0FBQzlCO0FBQ0EsYUFBYSxPQUFPLENBQUMsd0RBQVM7QUFDOUI7QUFDQSxhQUFhLGFBQWEsQ0FBQyx3REFBUztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSxXQUFXLHdEQUFTLE9BQU8sR0FBRyxNQUFNO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLHdEQUFTLGFBQWEsaUJBQWlCO0FBQ3pEO0FBQ0E7QUFDQSx1QkFBdUIsd0RBQVM7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLHdEQUFTO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyx3REFBUztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQix3REFBUztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyx3REFBUztBQUN2QjtBQUNBLDRDQUE0QyxRQUFRO0FBQ3BEO0FBTUU7QUFDRiIsInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy9lbmNvZGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3RyaW5naWZ5IH0gZnJvbSBcIi4vc3RyaW5naWZ5LmpzXCI7XG5mdW5jdGlvbiBlbmNvZGUobXV0YXRpb24pIHtcbiAgcmV0dXJuIGVuY29kZU11dGF0aW9uKG11dGF0aW9uKTtcbn1cbmZ1bmN0aW9uIGVuY29kZUFsbChtdXRhdGlvbnMpIHtcbiAgcmV0dXJuIG11dGF0aW9ucy5mbGF0TWFwKGVuY29kZSk7XG59XG5mdW5jdGlvbiBlbmNvZGVUcmFuc2FjdGlvbih0cmFuc2FjdGlvbikge1xuICByZXR1cm4ge1xuICAgIHRyYW5zYWN0aW9uSWQ6IHRyYW5zYWN0aW9uLmlkLFxuICAgIG11dGF0aW9uczogZW5jb2RlQWxsKHRyYW5zYWN0aW9uLm11dGF0aW9ucylcbiAgfTtcbn1cbmZ1bmN0aW9uIGVuY29kZU11dGF0aW9uKG11dGF0aW9uKSB7XG4gIGlmIChtdXRhdGlvbi50eXBlID09PSBcImNyZWF0ZVwiIHx8IG11dGF0aW9uLnR5cGUgPT09IFwiY3JlYXRlSWZOb3RFeGlzdHNcIiB8fCBtdXRhdGlvbi50eXBlID09PSBcImNyZWF0ZU9yUmVwbGFjZVwiKVxuICAgIHJldHVybiB7IFttdXRhdGlvbi50eXBlXTogbXV0YXRpb24uZG9jdW1lbnQgfTtcbiAgaWYgKG11dGF0aW9uLnR5cGUgPT09IFwiZGVsZXRlXCIpXG4gICAgcmV0dXJuIHtcbiAgICAgIGRlbGV0ZTogeyBpZDogbXV0YXRpb24uaWQgfVxuICAgIH07XG4gIGNvbnN0IGlmUmV2aXNpb25JRCA9IG11dGF0aW9uLm9wdGlvbnM/LmlmUmV2aXNpb247XG4gIHJldHVybiBtdXRhdGlvbi5wYXRjaGVzLm1hcCgocGF0Y2gpID0+ICh7XG4gICAgcGF0Y2g6IHtcbiAgICAgIGlkOiBtdXRhdGlvbi5pZCxcbiAgICAgIC4uLmlmUmV2aXNpb25JRCAmJiB7IGlmUmV2aXNpb25JRCB9LFxuICAgICAgLi4ucGF0Y2hUb1Nhbml0eShwYXRjaClcbiAgICB9XG4gIH0pKTtcbn1cbmZ1bmN0aW9uIHBhdGNoVG9TYW5pdHkocGF0Y2gpIHtcbiAgY29uc3QgeyBwYXRoLCBvcCB9ID0gcGF0Y2g7XG4gIGlmIChvcC50eXBlID09PSBcInVuc2V0XCIpXG4gICAgcmV0dXJuIHsgdW5zZXQ6IFtzdHJpbmdpZnkocGF0aCldIH07XG4gIGlmIChvcC50eXBlID09PSBcImluc2VydFwiKVxuICAgIHJldHVybiB7XG4gICAgICBpbnNlcnQ6IHtcbiAgICAgICAgW29wLnBvc2l0aW9uXTogc3RyaW5naWZ5KFsuLi5wYXRoLCBvcC5yZWZlcmVuY2VJdGVtXSksXG4gICAgICAgIGl0ZW1zOiBvcC5pdGVtc1xuICAgICAgfVxuICAgIH07XG4gIGlmIChvcC50eXBlID09PSBcImRpZmZNYXRjaFBhdGNoXCIpXG4gICAgcmV0dXJuIHsgZGlmZk1hdGNoUGF0Y2g6IHsgW3N0cmluZ2lmeShwYXRoKV06IG9wLnZhbHVlIH0gfTtcbiAgaWYgKG9wLnR5cGUgPT09IFwiaW5jXCIpXG4gICAgcmV0dXJuIHsgaW5jOiB7IFtzdHJpbmdpZnkocGF0aCldOiBvcC5hbW91bnQgfSB9O1xuICBpZiAob3AudHlwZSA9PT0gXCJkZWNcIilcbiAgICByZXR1cm4geyBkZWM6IHsgW3N0cmluZ2lmeShwYXRoKV06IG9wLmFtb3VudCB9IH07XG4gIGlmIChvcC50eXBlID09PSBcInNldFwiIHx8IG9wLnR5cGUgPT09IFwic2V0SWZNaXNzaW5nXCIpXG4gICAgcmV0dXJuIHsgW29wLnR5cGVdOiB7IFtzdHJpbmdpZnkocGF0aCldOiBvcC52YWx1ZSB9IH07XG4gIGlmIChvcC50eXBlID09PSBcInRydW5jYXRlXCIpIHtcbiAgICBjb25zdCByYW5nZSA9IFtcbiAgICAgIG9wLnN0YXJ0SW5kZXgsXG4gICAgICB0eXBlb2Ygb3AuZW5kSW5kZXggPT0gXCJudW1iZXJcIiA/IG9wLmVuZEluZGV4IDogXCJcIlxuICAgIF0uam9pbihcIjpcIik7XG4gICAgcmV0dXJuIHsgdW5zZXQ6IFtgJHtzdHJpbmdpZnkocGF0aCl9WyR7cmFuZ2V9XWBdIH07XG4gIH1cbiAgaWYgKG9wLnR5cGUgPT09IFwidXBzZXJ0XCIpXG4gICAgcmV0dXJuIHtcbiAgICAgIHVuc2V0OiBvcC5pdGVtcy5tYXAoXG4gICAgICAgIChpdGVtKSA9PiBzdHJpbmdpZnkoWy4uLnBhdGgsIHsgX2tleTogaXRlbS5fa2V5IH1dKVxuICAgICAgKSxcbiAgICAgIGluc2VydDoge1xuICAgICAgICBbb3AucG9zaXRpb25dOiBzdHJpbmdpZnkoWy4uLnBhdGgsIG9wLnJlZmVyZW5jZUl0ZW1dKSxcbiAgICAgICAgaXRlbXM6IG9wLml0ZW1zXG4gICAgICB9XG4gICAgfTtcbiAgaWYgKG9wLnR5cGUgPT09IFwiYXNzaWduXCIpXG4gICAgcmV0dXJuIHtcbiAgICAgIHNldDogT2JqZWN0LmZyb21FbnRyaWVzKFxuICAgICAgICBPYmplY3Qua2V5cyhvcC52YWx1ZSkubWFwKChrZXkpID0+IFtcbiAgICAgICAgICBzdHJpbmdpZnkocGF0aC5jb25jYXQoa2V5KSksXG4gICAgICAgICAgb3AudmFsdWVba2V5XVxuICAgICAgICBdKVxuICAgICAgKVxuICAgIH07XG4gIGlmIChvcC50eXBlID09PSBcInVuYXNzaWduXCIpXG4gICAgcmV0dXJuIHtcbiAgICAgIHVuc2V0OiBvcC5rZXlzLm1hcCgoa2V5KSA9PiBzdHJpbmdpZnkocGF0aC5jb25jYXQoa2V5KSkpXG4gICAgfTtcbiAgaWYgKG9wLnR5cGUgPT09IFwicmVwbGFjZVwiKVxuICAgIHJldHVybiB7XG4gICAgICBpbnNlcnQ6IHtcbiAgICAgICAgcmVwbGFjZTogc3RyaW5naWZ5KHBhdGguY29uY2F0KG9wLnJlZmVyZW5jZUl0ZW0pKSxcbiAgICAgICAgaXRlbXM6IG9wLml0ZW1zXG4gICAgICB9XG4gICAgfTtcbiAgaWYgKG9wLnR5cGUgPT09IFwicmVtb3ZlXCIpXG4gICAgcmV0dXJuIHtcbiAgICAgIHVuc2V0OiBbc3RyaW5naWZ5KHBhdGguY29uY2F0KG9wLnJlZmVyZW5jZUl0ZW0pKV1cbiAgICB9O1xuICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gb3BlcmF0aW9uIHR5cGUgJHtvcC50eXBlfWApO1xufVxuZXhwb3J0IHtcbiAgZW5jb2RlLFxuICBlbmNvZGVBbGwsXG4gIGVuY29kZU11dGF0aW9uLFxuICBlbmNvZGVUcmFuc2FjdGlvblxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWVuY29kZS5qcy5tYXBcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/encode.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/getAtPath.js":
/*!*******************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/getAtPath.js ***!
  \*******************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getAtPath: () => (/* binding */ getAtPath)\n/* harmony export */ });\n/* harmony import */ var _stringify_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./stringify.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/stringify.js\");\n\nfunction getAtPath(path, value) {\n  if (path.length === 0)\n    return value;\n  let current = value;\n  for (const head of path) {\n    if ((0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.isArrayElement)(head)) {\n      if (!Array.isArray(current))\n        return;\n      if ((0,_stringify_js__WEBPACK_IMPORTED_MODULE_0__.isKeyedElement)(head)) {\n        current = current.find((item) => item._key === head._key);\n        continue;\n      }\n      current = current[head];\n      continue;\n    }\n    current = current[head];\n  }\n  return current;\n}\n\n//# sourceMappingURL=getAtPath.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy9nZXRBdFBhdGguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBZ0U7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsNkRBQWM7QUFDdEI7QUFDQTtBQUNBLFVBQVUsNkRBQWM7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHRTtBQUNGIiwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL25vZGVfbW9kdWxlcy9uZXh0LXNhbml0eS9ub2RlX21vZHVsZXMvQHNhbml0eS9tdXRhdGUvZGlzdC9fY2h1bmtzLWVzL2dldEF0UGF0aC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc0FycmF5RWxlbWVudCwgaXNLZXllZEVsZW1lbnQgfSBmcm9tIFwiLi9zdHJpbmdpZnkuanNcIjtcbmZ1bmN0aW9uIGdldEF0UGF0aChwYXRoLCB2YWx1ZSkge1xuICBpZiAocGF0aC5sZW5ndGggPT09IDApXG4gICAgcmV0dXJuIHZhbHVlO1xuICBsZXQgY3VycmVudCA9IHZhbHVlO1xuICBmb3IgKGNvbnN0IGhlYWQgb2YgcGF0aCkge1xuICAgIGlmIChpc0FycmF5RWxlbWVudChoZWFkKSkge1xuICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGN1cnJlbnQpKVxuICAgICAgICByZXR1cm47XG4gICAgICBpZiAoaXNLZXllZEVsZW1lbnQoaGVhZCkpIHtcbiAgICAgICAgY3VycmVudCA9IGN1cnJlbnQuZmluZCgoaXRlbSkgPT4gaXRlbS5fa2V5ID09PSBoZWFkLl9rZXkpO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGN1cnJlbnQgPSBjdXJyZW50W2hlYWRdO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGN1cnJlbnQgPSBjdXJyZW50W2hlYWRdO1xuICB9XG4gIHJldHVybiBjdXJyZW50O1xufVxuZXhwb3J0IHtcbiAgZ2V0QXRQYXRoXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z2V0QXRQYXRoLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/getAtPath.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/isObject.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/isObject.js ***!
  \******************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isObject: () => (/* binding */ isObject)\n/* harmony export */ });\nfunction isObject(val) {\n  return val !== null && typeof val == \"object\" && !Array.isArray(val);\n}\n\n//# sourceMappingURL=isObject.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy9pc09iamVjdC5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBR0U7QUFDRiIsInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy9pc09iamVjdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBpc09iamVjdCh2YWwpIHtcbiAgcmV0dXJuIHZhbCAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsID09IFwib2JqZWN0XCIgJiYgIUFycmF5LmlzQXJyYXkodmFsKTtcbn1cbmV4cG9ydCB7XG4gIGlzT2JqZWN0XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aXNPYmplY3QuanMubWFwXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/isObject.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/parse.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/parse.js ***!
  \***************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   parse: () => (/* binding */ parse)\n/* harmony export */ });\nfunction parse(path) {\n  return path.split(/[[.\\]]/g).filter(Boolean).map((seg) => seg.includes(\"==\") ? parseSegment(seg) : coerce(seg));\n}\nconst IS_NUMERIC = /^-?\\d+$/;\nfunction unquote(str) {\n  return str.replace(/^['\"]/, \"\").replace(/['\"]$/, \"\");\n}\nfunction parseSegment(segment) {\n  const [key, value] = segment.split(\"==\");\n  if (key !== \"_key\")\n    throw new Error(\n      `Currently only \"_key\" is supported as path segment. Found ${key}`\n    );\n  if (typeof value > \"u\")\n    throw new Error('Invalid path segment, expected `key==\"value\"`');\n  return { _key: unquote(value) };\n}\nfunction coerce(segment) {\n  return IS_NUMERIC.test(segment) ? Number(segment) : segment;\n}\n\n//# sourceMappingURL=parse.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy9wYXJzZS5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1FQUFtRSxJQUFJO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUdFO0FBQ0YiLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3Jrc3BhY2Uvbm9kZV9tb2R1bGVzL25leHQtc2FuaXR5L25vZGVfbW9kdWxlcy9Ac2FuaXR5L211dGF0ZS9kaXN0L19jaHVua3MtZXMvcGFyc2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gcGFyc2UocGF0aCkge1xuICByZXR1cm4gcGF0aC5zcGxpdCgvW1suXFxdXS9nKS5maWx0ZXIoQm9vbGVhbikubWFwKChzZWcpID0+IHNlZy5pbmNsdWRlcyhcIj09XCIpID8gcGFyc2VTZWdtZW50KHNlZykgOiBjb2VyY2Uoc2VnKSk7XG59XG5jb25zdCBJU19OVU1FUklDID0gL14tP1xcZCskLztcbmZ1bmN0aW9uIHVucXVvdGUoc3RyKSB7XG4gIHJldHVybiBzdHIucmVwbGFjZSgvXlsnXCJdLywgXCJcIikucmVwbGFjZSgvWydcIl0kLywgXCJcIik7XG59XG5mdW5jdGlvbiBwYXJzZVNlZ21lbnQoc2VnbWVudCkge1xuICBjb25zdCBba2V5LCB2YWx1ZV0gPSBzZWdtZW50LnNwbGl0KFwiPT1cIik7XG4gIGlmIChrZXkgIT09IFwiX2tleVwiKVxuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBDdXJyZW50bHkgb25seSBcIl9rZXlcIiBpcyBzdXBwb3J0ZWQgYXMgcGF0aCBzZWdtZW50LiBGb3VuZCAke2tleX1gXG4gICAgKTtcbiAgaWYgKHR5cGVvZiB2YWx1ZSA+IFwidVwiKVxuICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBwYXRoIHNlZ21lbnQsIGV4cGVjdGVkIGBrZXk9PVwidmFsdWVcImAnKTtcbiAgcmV0dXJuIHsgX2tleTogdW5xdW90ZSh2YWx1ZSkgfTtcbn1cbmZ1bmN0aW9uIGNvZXJjZShzZWdtZW50KSB7XG4gIHJldHVybiBJU19OVU1FUklDLnRlc3Qoc2VnbWVudCkgPyBOdW1iZXIoc2VnbWVudCkgOiBzZWdtZW50O1xufVxuZXhwb3J0IHtcbiAgcGFyc2Vcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYXJzZS5qcy5tYXBcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/parse.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/stringify.js":
/*!*******************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/stringify.js ***!
  \*******************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isArrayElement: () => (/* binding */ isArrayElement),\n/* harmony export */   isElementEqual: () => (/* binding */ isElementEqual),\n/* harmony export */   isEqual: () => (/* binding */ isEqual),\n/* harmony export */   isIndexElement: () => (/* binding */ isIndexElement),\n/* harmony export */   isKeyElement: () => (/* binding */ isKeyElement),\n/* harmony export */   isKeyedElement: () => (/* binding */ isKeyedElement),\n/* harmony export */   isPropertyElement: () => (/* binding */ isPropertyElement),\n/* harmony export */   startsWith: () => (/* binding */ startsWith),\n/* harmony export */   stringify: () => (/* binding */ stringify)\n/* harmony export */ });\nfunction safeGetElementAt(array, index) {\n  if (index < 0 || index >= array.length)\n    throw new Error(\"Index out of bounds\");\n  return array[index];\n}\nfunction startsWith(parentPath, path) {\n  return parentPath.length <= path.length && parentPath.every(\n    (segment, i) => isElementEqual(segment, safeGetElementAt(path, i))\n  );\n}\nfunction isEqual(path, otherPath) {\n  return path.length === otherPath.length && path.every(\n    (segment, i) => isElementEqual(segment, safeGetElementAt(path, i))\n  );\n}\nfunction isElementEqual(segmentA, segmentB) {\n  return isKeyElement(segmentA) && isKeyElement(segmentB) ? segmentA._key === segmentB._key : isIndexElement(segmentA) ? Number(segmentA) === Number(segmentB) : segmentA === segmentB;\n}\nfunction isKeyElement(segment) {\n  return typeof segment?._key == \"string\";\n}\nfunction isIndexElement(segment) {\n  return typeof segment == \"number\";\n}\nfunction isKeyedElement(element) {\n  return typeof element == \"object\" && \"_key\" in element && typeof element._key == \"string\";\n}\nfunction isArrayElement(element) {\n  return typeof element == \"number\" || isKeyedElement(element);\n}\nfunction isPropertyElement(element) {\n  return typeof element == \"string\";\n}\nconst IS_DOTTABLE = /^[a-z_$]+/;\nfunction stringifySegment(segment, hasLeading) {\n  return Array.isArray(segment) ? `[${segment[0]}:${segment[1] || \"\"}]` : typeof segment == \"number\" ? `[${segment}]` : isKeyedElement(segment) ? `[_key==${JSON.stringify(segment._key)}]` : typeof segment == \"string\" && IS_DOTTABLE.test(segment) ? hasLeading ? segment : `.${segment}` : `['${segment}']`;\n}\nfunction stringify(pathArray) {\n  return pathArray.map((segment, i) => stringifySegment(segment, i === 0)).join(\"\");\n}\n\n//# sourceMappingURL=stringify.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy9zdHJpbmdpZnkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxXQUFXLEdBQUcsaUJBQWlCLHNDQUFzQyxRQUFRLHlDQUF5Qyw2QkFBNkIsMEZBQTBGLFFBQVEsU0FBUyxRQUFRO0FBQzVTO0FBQ0E7QUFDQTtBQUNBO0FBV0U7QUFDRiIsInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy9zdHJpbmdpZnkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gc2FmZUdldEVsZW1lbnRBdChhcnJheSwgaW5kZXgpIHtcbiAgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSBhcnJheS5sZW5ndGgpXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiSW5kZXggb3V0IG9mIGJvdW5kc1wiKTtcbiAgcmV0dXJuIGFycmF5W2luZGV4XTtcbn1cbmZ1bmN0aW9uIHN0YXJ0c1dpdGgocGFyZW50UGF0aCwgcGF0aCkge1xuICByZXR1cm4gcGFyZW50UGF0aC5sZW5ndGggPD0gcGF0aC5sZW5ndGggJiYgcGFyZW50UGF0aC5ldmVyeShcbiAgICAoc2VnbWVudCwgaSkgPT4gaXNFbGVtZW50RXF1YWwoc2VnbWVudCwgc2FmZUdldEVsZW1lbnRBdChwYXRoLCBpKSlcbiAgKTtcbn1cbmZ1bmN0aW9uIGlzRXF1YWwocGF0aCwgb3RoZXJQYXRoKSB7XG4gIHJldHVybiBwYXRoLmxlbmd0aCA9PT0gb3RoZXJQYXRoLmxlbmd0aCAmJiBwYXRoLmV2ZXJ5KFxuICAgIChzZWdtZW50LCBpKSA9PiBpc0VsZW1lbnRFcXVhbChzZWdtZW50LCBzYWZlR2V0RWxlbWVudEF0KHBhdGgsIGkpKVxuICApO1xufVxuZnVuY3Rpb24gaXNFbGVtZW50RXF1YWwoc2VnbWVudEEsIHNlZ21lbnRCKSB7XG4gIHJldHVybiBpc0tleUVsZW1lbnQoc2VnbWVudEEpICYmIGlzS2V5RWxlbWVudChzZWdtZW50QikgPyBzZWdtZW50QS5fa2V5ID09PSBzZWdtZW50Qi5fa2V5IDogaXNJbmRleEVsZW1lbnQoc2VnbWVudEEpID8gTnVtYmVyKHNlZ21lbnRBKSA9PT0gTnVtYmVyKHNlZ21lbnRCKSA6IHNlZ21lbnRBID09PSBzZWdtZW50Qjtcbn1cbmZ1bmN0aW9uIGlzS2V5RWxlbWVudChzZWdtZW50KSB7XG4gIHJldHVybiB0eXBlb2Ygc2VnbWVudD8uX2tleSA9PSBcInN0cmluZ1wiO1xufVxuZnVuY3Rpb24gaXNJbmRleEVsZW1lbnQoc2VnbWVudCkge1xuICByZXR1cm4gdHlwZW9mIHNlZ21lbnQgPT0gXCJudW1iZXJcIjtcbn1cbmZ1bmN0aW9uIGlzS2V5ZWRFbGVtZW50KGVsZW1lbnQpIHtcbiAgcmV0dXJuIHR5cGVvZiBlbGVtZW50ID09IFwib2JqZWN0XCIgJiYgXCJfa2V5XCIgaW4gZWxlbWVudCAmJiB0eXBlb2YgZWxlbWVudC5fa2V5ID09IFwic3RyaW5nXCI7XG59XG5mdW5jdGlvbiBpc0FycmF5RWxlbWVudChlbGVtZW50KSB7XG4gIHJldHVybiB0eXBlb2YgZWxlbWVudCA9PSBcIm51bWJlclwiIHx8IGlzS2V5ZWRFbGVtZW50KGVsZW1lbnQpO1xufVxuZnVuY3Rpb24gaXNQcm9wZXJ0eUVsZW1lbnQoZWxlbWVudCkge1xuICByZXR1cm4gdHlwZW9mIGVsZW1lbnQgPT0gXCJzdHJpbmdcIjtcbn1cbmNvbnN0IElTX0RPVFRBQkxFID0gL15bYS16XyRdKy87XG5mdW5jdGlvbiBzdHJpbmdpZnlTZWdtZW50KHNlZ21lbnQsIGhhc0xlYWRpbmcpIHtcbiAgcmV0dXJuIEFycmF5LmlzQXJyYXkoc2VnbWVudCkgPyBgWyR7c2VnbWVudFswXX06JHtzZWdtZW50WzFdIHx8IFwiXCJ9XWAgOiB0eXBlb2Ygc2VnbWVudCA9PSBcIm51bWJlclwiID8gYFske3NlZ21lbnR9XWAgOiBpc0tleWVkRWxlbWVudChzZWdtZW50KSA/IGBbX2tleT09JHtKU09OLnN0cmluZ2lmeShzZWdtZW50Ll9rZXkpfV1gIDogdHlwZW9mIHNlZ21lbnQgPT0gXCJzdHJpbmdcIiAmJiBJU19ET1RUQUJMRS50ZXN0KHNlZ21lbnQpID8gaGFzTGVhZGluZyA/IHNlZ21lbnQgOiBgLiR7c2VnbWVudH1gIDogYFsnJHtzZWdtZW50fSddYDtcbn1cbmZ1bmN0aW9uIHN0cmluZ2lmeShwYXRoQXJyYXkpIHtcbiAgcmV0dXJuIHBhdGhBcnJheS5tYXAoKHNlZ21lbnQsIGkpID0+IHN0cmluZ2lmeVNlZ21lbnQoc2VnbWVudCwgaSA9PT0gMCkpLmpvaW4oXCJcIik7XG59XG5leHBvcnQge1xuICBpc0FycmF5RWxlbWVudCxcbiAgaXNFbGVtZW50RXF1YWwsXG4gIGlzRXF1YWwsXG4gIGlzSW5kZXhFbGVtZW50LFxuICBpc0tleUVsZW1lbnQsXG4gIGlzS2V5ZWRFbGVtZW50LFxuICBpc1Byb3BlcnR5RWxlbWVudCxcbiAgc3RhcnRzV2l0aCxcbiAgc3RyaW5naWZ5XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3RyaW5naWZ5LmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/stringify.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/toTransactions.js":
/*!************************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/toTransactions.js ***!
  \************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   applyMutations: () => (/* binding */ applyMutations),\n/* harmony export */   commit: () => (/* binding */ commit),\n/* harmony export */   getMutationDocumentId: () => (/* binding */ getMutationDocumentId),\n/* harmony export */   rebase: () => (/* binding */ rebase),\n/* harmony export */   squashDMPStrings: () => (/* binding */ squashDMPStrings),\n/* harmony export */   squashMutationGroups: () => (/* binding */ squashMutationGroups),\n/* harmony export */   toTransactions: () => (/* binding */ toTransactions)\n/* harmony export */ });\n/* harmony import */ var lodash_es__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! lodash-es */ \"(ssr)/./node_modules/lodash-es/groupBy.js\");\n/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/utils.js\");\n/* harmony import */ var _getAtPath_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./getAtPath.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/getAtPath.js\");\n/* harmony import */ var _sanity_diff_match_patch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sanity/diff-match-patch */ \"(ssr)/./node_modules/@sanity/diff-match-patch/dist/index.js\");\n/* harmony import */ var _stringify_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./stringify.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/stringify.js\");\n\n\n\n\n\nfunction getMutationDocumentId(mutation) {\n  if (mutation.type === \"patch\")\n    return mutation.id;\n  if (mutation.type === \"create\")\n    return mutation.document._id;\n  if (mutation.type === \"delete\")\n    return mutation.id;\n  if (mutation.type === \"createIfNotExists\" || mutation.type === \"createOrReplace\")\n    return mutation.document._id;\n  throw new Error(\"Invalid mutation type\");\n}\nfunction applyAll(current, mutation) {\n  return mutation.reduce((doc, m) => {\n    const res = applyDocumentMutation(doc, m);\n    if (res.status === \"error\")\n      throw new Error(res.message);\n    return res.status === \"noop\" ? doc : res.after;\n  }, current);\n}\nfunction applyDocumentMutation(document, mutation) {\n  if (mutation.type === \"create\")\n    return create(document, mutation);\n  if (mutation.type === \"createIfNotExists\")\n    return createIfNotExists(document, mutation);\n  if (mutation.type === \"delete\")\n    return del(document, mutation);\n  if (mutation.type === \"createOrReplace\")\n    return createOrReplace(document, mutation);\n  if (mutation.type === \"patch\")\n    return patch(document, mutation);\n  throw new Error(`Invalid mutation type: ${mutation.type}`);\n}\nfunction create(document, mutation) {\n  if (document)\n    return { status: \"error\", message: \"Document already exist\" };\n  const result = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.assignId)(mutation.document, _utils_js__WEBPACK_IMPORTED_MODULE_0__.nanoid);\n  return { status: \"created\", id: result._id, after: result };\n}\nfunction createIfNotExists(document, mutation) {\n  return (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.hasId)(mutation.document) ? document ? { status: \"noop\" } : { status: \"created\", id: mutation.document._id, after: mutation.document } : {\n    status: \"error\",\n    message: \"Cannot createIfNotExists on document without _id\"\n  };\n}\nfunction createOrReplace(document, mutation) {\n  return (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.hasId)(mutation.document) ? document ? {\n    status: \"updated\",\n    id: mutation.document._id,\n    before: document,\n    after: mutation.document\n  } : { status: \"created\", id: mutation.document._id, after: mutation.document } : {\n    status: \"error\",\n    message: \"Cannot createIfNotExists on document without _id\"\n  };\n}\nfunction del(document, mutation) {\n  return document ? mutation.id !== document._id ? { status: \"error\", message: \"Delete mutation targeted wrong document\" } : {\n    status: \"deleted\",\n    id: mutation.id,\n    before: document,\n    after: void 0\n  } : { status: \"noop\" };\n}\nfunction patch(document, mutation) {\n  if (!document)\n    return {\n      status: \"error\",\n      message: \"Cannot apply patch on nonexistent document\"\n    };\n  const next = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.applyPatchMutation)(mutation, document);\n  return document === next ? { status: \"noop\" } : { status: \"updated\", id: mutation.id, before: document, after: next };\n}\nfunction applyMutations(mutations, dataset) {\n  const updatedDocs = /* @__PURE__ */ Object.create(null);\n  for (const mutation of mutations) {\n    const documentId = getMutationDocumentId(mutation);\n    if (!documentId)\n      throw new Error(\"Unable to get document id from mutation\");\n    const before = updatedDocs[documentId]?.after || dataset.get(documentId), res = applyDocumentMutation(before, mutation);\n    if (res.status === \"error\")\n      throw new Error(res.message);\n    res.status !== \"noop\" && (res.status === \"updated\" || res.status === \"created\" || res.status === \"deleted\") && (documentId in updatedDocs || (updatedDocs[documentId] = { before, after: void 0, muts: [] }), updatedDocs[documentId].after = res.after);\n  }\n  return Object.entries(updatedDocs).map(\n    // eslint-disable-next-line no-shadow\n    ([id, { before, after, muts }]) => ({\n      id,\n      status: after ? before ? \"updated\" : \"created\" : \"deleted\",\n      mutations: muts,\n      before,\n      after\n    })\n  );\n}\nfunction commit(results, dataset) {\n  results.forEach((result) => {\n    (result.status === \"created\" || result.status === \"updated\") && dataset.set(result.id, result.after), result.status === \"deleted\" && dataset.delete(result.id);\n  });\n}\nfunction takeUntilRight(arr, predicate, opts) {\n  const result = [];\n  for (const item of arr.slice().reverse()) {\n    if (predicate(item))\n      return result;\n    result.push(item);\n  }\n  return result.reverse();\n}\nfunction isEqualPath(p1, p2) {\n  return (0,_stringify_js__WEBPACK_IMPORTED_MODULE_1__.stringify)(p1) === (0,_stringify_js__WEBPACK_IMPORTED_MODULE_1__.stringify)(p2);\n}\nfunction supersedes(later, earlier) {\n  return (earlier.type === \"set\" || earlier.type === \"unset\") && (later.type === \"set\" || later.type === \"unset\");\n}\nfunction squashNodePatches(patches) {\n  return compactSetIfMissingPatches(\n    compactSetPatches(compactUnsetPatches(patches))\n  );\n}\nfunction compactUnsetPatches(patches) {\n  return patches.reduce(\n    (earlierPatches, laterPatch) => {\n      if (laterPatch.op.type !== \"unset\")\n        return earlierPatches.push(laterPatch), earlierPatches;\n      const unaffected = earlierPatches.filter(\n        (earlierPatch) => !(0,_stringify_js__WEBPACK_IMPORTED_MODULE_1__.startsWith)(laterPatch.path, earlierPatch.path)\n      );\n      return unaffected.push(laterPatch), unaffected;\n    },\n    []\n  );\n}\nfunction compactSetPatches(patches) {\n  return patches.reduceRight(\n    (laterPatches, earlierPatch) => (laterPatches.find(\n      (later) => supersedes(later.op, earlierPatch.op) && isEqualPath(later.path, earlierPatch.path)\n    ) || laterPatches.unshift(earlierPatch), laterPatches),\n    []\n  );\n}\nfunction compactSetIfMissingPatches(patches) {\n  return patches.reduce(\n    (previousPatches, laterPatch) => laterPatch.op.type !== \"setIfMissing\" ? (previousPatches.push(laterPatch), previousPatches) : (takeUntilRight(\n      previousPatches,\n      (patch2) => patch2.op.type === \"unset\"\n    ).find(\n      (precedingPatch) => precedingPatch.op.type === \"setIfMissing\" && isEqualPath(precedingPatch.path, laterPatch.path)\n    ) || previousPatches.push(laterPatch), previousPatches),\n    []\n  );\n}\nfunction compactDMPSetPatches(base, patches) {\n  let edge = base;\n  return patches.reduce(\n    (earlierPatches, laterPatch) => {\n      const before = edge;\n      if (edge = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.applyNodePatch)(laterPatch, edge), laterPatch.op.type === \"set\" && typeof laterPatch.op.value == \"string\") {\n        const current = (0,_getAtPath_js__WEBPACK_IMPORTED_MODULE_2__.getAtPath)(laterPatch.path, before);\n        if (typeof current == \"string\") {\n          const replaced = {\n            ...laterPatch,\n            op: {\n              type: \"diffMatchPatch\",\n              value: (0,_sanity_diff_match_patch__WEBPACK_IMPORTED_MODULE_3__.stringifyPatches)(\n                (0,_sanity_diff_match_patch__WEBPACK_IMPORTED_MODULE_3__.makePatches)(current, laterPatch.op.value)\n              )\n            }\n          };\n          return earlierPatches.flatMap((ep) => isEqualPath(ep.path, laterPatch.path) && ep.op.type === \"diffMatchPatch\" ? [] : ep).concat(replaced);\n        }\n      }\n      return earlierPatches.push(laterPatch), earlierPatches;\n    },\n    []\n  );\n}\nfunction squashDMPStrings(remote, mutationGroups) {\n  return mutationGroups.map((mutationGroup) => ({\n    ...mutationGroup,\n    mutations: dmpIfyMutations(remote, mutationGroup.mutations)\n  }));\n}\nfunction dmpIfyMutations(store, mutations) {\n  return mutations.map((mutation, i) => mutation.type === \"patch\" ? dmpifyPatchMutation(store.get(mutation.id), mutation) : mutation);\n}\nfunction dmpifyPatchMutation(base, mutation) {\n  return base ? {\n    ...mutation,\n    patches: compactDMPSetPatches(base, mutation.patches)\n  } : mutation;\n}\nfunction mergeMutationGroups(mutationGroups) {\n  return chunkWhile(mutationGroups, (group) => !group.transaction).flatMap(\n    (chunk) => ({\n      ...chunk[0],\n      mutations: chunk.flatMap((c) => c.mutations)\n    })\n  );\n}\nfunction chunkWhile(arr, predicate) {\n  const res = [];\n  let currentChunk = [];\n  return arr.forEach((item) => {\n    predicate(item) ? currentChunk.push(item) : (currentChunk.length > 0 && res.push(currentChunk), currentChunk = [], res.push([item]));\n  }), currentChunk.length > 0 && res.push(currentChunk), res;\n}\nfunction squashMutationGroups(staged) {\n  return mergeMutationGroups(staged).map((transaction) => ({\n    ...transaction,\n    mutations: squashMutations(transaction.mutations)\n  })).map((transaction) => ({\n    ...transaction,\n    mutations: transaction.mutations.map((mutation) => mutation.type !== \"patch\" ? mutation : {\n      ...mutation,\n      patches: squashNodePatches(mutation.patches)\n    })\n  }));\n}\nfunction squashMutations(mutations) {\n  const byDocument = (0,lodash_es__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(mutations, getMutationDocumentId);\n  return Object.values(byDocument).flatMap((documentMutations) => squashCreateIfNotExists(squashDelete(documentMutations)).flat().reduce((acc, docMutation) => {\n    const prev = acc[acc.length - 1];\n    return (!prev || prev.type === \"patch\") && docMutation.type === \"patch\" ? acc.slice(0, -1).concat({\n      ...docMutation,\n      patches: (prev?.patches || []).concat(docMutation.patches)\n    }) : acc.concat(docMutation);\n  }, []));\n}\nfunction squashCreateIfNotExists(mutations) {\n  return mutations.length === 0 ? mutations : mutations.reduce((previousMuts, laterMut) => laterMut.type !== \"createIfNotExists\" ? (previousMuts.push(laterMut), previousMuts) : (takeUntilRight(previousMuts, (m) => m.type === \"delete\").find(\n    (precedingPatch) => precedingPatch.type === \"createIfNotExists\"\n  ) || previousMuts.push(laterMut), previousMuts), []);\n}\nfunction squashDelete(mutations) {\n  return mutations.length === 0 ? mutations : mutations.reduce((previousMuts, laterMut) => laterMut.type === \"delete\" ? [laterMut] : (previousMuts.push(laterMut), previousMuts), []);\n}\nfunction rebase(documentId, oldBase, newBase, stagedMutations) {\n  let edge = oldBase;\n  const dmpified = stagedMutations.map((transaction) => {\n    const mutations = transaction.mutations.flatMap((mut) => {\n      if (getMutationDocumentId(mut) !== documentId)\n        return [];\n      const before = edge;\n      return edge = applyAll(edge, [mut]), !before || mut.type !== \"patch\" ? mut : {\n        type: \"dmpified\",\n        mutation: {\n          ...mut,\n          // Todo: make compactDMPSetPatches return pairs of patches that was dmpified with their\n          //  original as dmpPatches and original is not 1:1 (e..g some of the original may not be dmpified)\n          dmpPatches: compactDMPSetPatches(before, mut.patches),\n          original: mut.patches\n        }\n      };\n    });\n    return { ...transaction, mutations };\n  });\n  let newBaseWithDMPForOldBaseApplied = newBase;\n  return dmpified.map((transaction) => {\n    const applied = [];\n    return transaction.mutations.forEach((mut) => {\n      if (mut.type === \"dmpified\")\n        try {\n          newBaseWithDMPForOldBaseApplied = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.applyPatches)(\n            mut.mutation.dmpPatches,\n            newBaseWithDMPForOldBaseApplied\n          ), applied.push(mut);\n        } catch {\n          console.warn(\"Failed to apply dmp patch, falling back to original\");\n          try {\n            newBaseWithDMPForOldBaseApplied = (0,_utils_js__WEBPACK_IMPORTED_MODULE_0__.applyPatches)(\n              mut.mutation.original,\n              newBaseWithDMPForOldBaseApplied\n            ), applied.push(mut);\n          } catch (second) {\n            throw new Error(\n              `Failed to apply patch for document \"${documentId}\": ${second.message}`\n            );\n          }\n        }\n      else\n        newBaseWithDMPForOldBaseApplied = applyAll(\n          newBaseWithDMPForOldBaseApplied,\n          [mut]\n        );\n    });\n  }), [stagedMutations.map((transaction) => ({\n    ...transaction,\n    mutations: transaction.mutations.map((mut) => mut.type !== \"patch\" || getMutationDocumentId(mut) !== documentId ? mut : {\n      ...mut,\n      patches: mut.patches.map((patch2) => patch2.op.type !== \"set\" ? patch2 : {\n        ...patch2,\n        op: {\n          ...patch2.op,\n          value: (0,_getAtPath_js__WEBPACK_IMPORTED_MODULE_2__.getAtPath)(patch2.path, newBaseWithDMPForOldBaseApplied)\n        }\n      })\n    })\n  })), newBaseWithDMPForOldBaseApplied];\n}\nfunction toTransactions(groups) {\n  return groups.map((group) => group.transaction && group.id !== void 0 ? { id: group.id, mutations: group.mutations } : { mutations: group.mutations });\n}\n\n//# sourceMappingURL=toTransactions.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy90b1RyYW5zYWN0aW9ucy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBb0M7QUFDbUU7QUFDNUQ7QUFDOEI7QUFDbEI7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsY0FBYztBQUMxRDtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsaUJBQWlCLG1EQUFRLG9CQUFvQiw2Q0FBTTtBQUNuRCxXQUFXO0FBQ1g7QUFDQTtBQUNBLFNBQVMsZ0RBQUssbUNBQW1DLGlCQUFpQixJQUFJLHlFQUF5RTtBQUMvSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxnREFBSztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxJQUFJLHlFQUF5RTtBQUNqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscURBQXFELHNFQUFzRTtBQUMzSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksSUFBSTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSw2REFBa0I7QUFDakMsK0JBQStCLGlCQUFpQixJQUFJO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEtBQThLLGlDQUFpQztBQUMvTTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHFCQUFxQjtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsd0RBQVMsU0FBUyx3REFBUztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIseURBQVU7QUFDckM7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIseURBQWM7QUFDL0Isd0JBQXdCLHdEQUFTO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIsMEVBQWdCO0FBQ3JDLGdCQUFnQixxRUFBVztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0EscUJBQXFCLHFEQUFPO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsYUFBYTtBQUNiLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsdURBQVk7QUFDeEQ7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQSw4Q0FBOEMsdURBQVk7QUFDMUQ7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0EscURBQXFELFdBQVcsS0FBSyxlQUFlO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLHdEQUFTO0FBQzFCO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBLDRFQUE0RSwyQ0FBMkMsSUFBSSw0QkFBNEI7QUFDdko7QUFTRTtBQUNGIiwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL25vZGVfbW9kdWxlcy9uZXh0LXNhbml0eS9ub2RlX21vZHVsZXMvQHNhbml0eS9tdXRhdGUvZGlzdC9fY2h1bmtzLWVzL3RvVHJhbnNhY3Rpb25zLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdyb3VwQnkgfSBmcm9tIFwibG9kYXNoLWVzXCI7XG5pbXBvcnQgeyBhc3NpZ25JZCwgbmFub2lkLCBoYXNJZCwgYXBwbHlQYXRjaE11dGF0aW9uLCBhcHBseU5vZGVQYXRjaCwgYXBwbHlQYXRjaGVzIH0gZnJvbSBcIi4vdXRpbHMuanNcIjtcbmltcG9ydCB7IGdldEF0UGF0aCB9IGZyb20gXCIuL2dldEF0UGF0aC5qc1wiO1xuaW1wb3J0IHsgc3RyaW5naWZ5UGF0Y2hlcywgbWFrZVBhdGNoZXMgfSBmcm9tIFwiQHNhbml0eS9kaWZmLW1hdGNoLXBhdGNoXCI7XG5pbXBvcnQgeyBzdGFydHNXaXRoLCBzdHJpbmdpZnkgfSBmcm9tIFwiLi9zdHJpbmdpZnkuanNcIjtcbmZ1bmN0aW9uIGdldE11dGF0aW9uRG9jdW1lbnRJZChtdXRhdGlvbikge1xuICBpZiAobXV0YXRpb24udHlwZSA9PT0gXCJwYXRjaFwiKVxuICAgIHJldHVybiBtdXRhdGlvbi5pZDtcbiAgaWYgKG11dGF0aW9uLnR5cGUgPT09IFwiY3JlYXRlXCIpXG4gICAgcmV0dXJuIG11dGF0aW9uLmRvY3VtZW50Ll9pZDtcbiAgaWYgKG11dGF0aW9uLnR5cGUgPT09IFwiZGVsZXRlXCIpXG4gICAgcmV0dXJuIG11dGF0aW9uLmlkO1xuICBpZiAobXV0YXRpb24udHlwZSA9PT0gXCJjcmVhdGVJZk5vdEV4aXN0c1wiIHx8IG11dGF0aW9uLnR5cGUgPT09IFwiY3JlYXRlT3JSZXBsYWNlXCIpXG4gICAgcmV0dXJuIG11dGF0aW9uLmRvY3VtZW50Ll9pZDtcbiAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBtdXRhdGlvbiB0eXBlXCIpO1xufVxuZnVuY3Rpb24gYXBwbHlBbGwoY3VycmVudCwgbXV0YXRpb24pIHtcbiAgcmV0dXJuIG11dGF0aW9uLnJlZHVjZSgoZG9jLCBtKSA9PiB7XG4gICAgY29uc3QgcmVzID0gYXBwbHlEb2N1bWVudE11dGF0aW9uKGRvYywgbSk7XG4gICAgaWYgKHJlcy5zdGF0dXMgPT09IFwiZXJyb3JcIilcbiAgICAgIHRocm93IG5ldyBFcnJvcihyZXMubWVzc2FnZSk7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMgPT09IFwibm9vcFwiID8gZG9jIDogcmVzLmFmdGVyO1xuICB9LCBjdXJyZW50KTtcbn1cbmZ1bmN0aW9uIGFwcGx5RG9jdW1lbnRNdXRhdGlvbihkb2N1bWVudCwgbXV0YXRpb24pIHtcbiAgaWYgKG11dGF0aW9uLnR5cGUgPT09IFwiY3JlYXRlXCIpXG4gICAgcmV0dXJuIGNyZWF0ZShkb2N1bWVudCwgbXV0YXRpb24pO1xuICBpZiAobXV0YXRpb24udHlwZSA9PT0gXCJjcmVhdGVJZk5vdEV4aXN0c1wiKVxuICAgIHJldHVybiBjcmVhdGVJZk5vdEV4aXN0cyhkb2N1bWVudCwgbXV0YXRpb24pO1xuICBpZiAobXV0YXRpb24udHlwZSA9PT0gXCJkZWxldGVcIilcbiAgICByZXR1cm4gZGVsKGRvY3VtZW50LCBtdXRhdGlvbik7XG4gIGlmIChtdXRhdGlvbi50eXBlID09PSBcImNyZWF0ZU9yUmVwbGFjZVwiKVxuICAgIHJldHVybiBjcmVhdGVPclJlcGxhY2UoZG9jdW1lbnQsIG11dGF0aW9uKTtcbiAgaWYgKG11dGF0aW9uLnR5cGUgPT09IFwicGF0Y2hcIilcbiAgICByZXR1cm4gcGF0Y2goZG9jdW1lbnQsIG11dGF0aW9uKTtcbiAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIG11dGF0aW9uIHR5cGU6ICR7bXV0YXRpb24udHlwZX1gKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZShkb2N1bWVudCwgbXV0YXRpb24pIHtcbiAgaWYgKGRvY3VtZW50KVxuICAgIHJldHVybiB7IHN0YXR1czogXCJlcnJvclwiLCBtZXNzYWdlOiBcIkRvY3VtZW50IGFscmVhZHkgZXhpc3RcIiB9O1xuICBjb25zdCByZXN1bHQgPSBhc3NpZ25JZChtdXRhdGlvbi5kb2N1bWVudCwgbmFub2lkKTtcbiAgcmV0dXJuIHsgc3RhdHVzOiBcImNyZWF0ZWRcIiwgaWQ6IHJlc3VsdC5faWQsIGFmdGVyOiByZXN1bHQgfTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUlmTm90RXhpc3RzKGRvY3VtZW50LCBtdXRhdGlvbikge1xuICByZXR1cm4gaGFzSWQobXV0YXRpb24uZG9jdW1lbnQpID8gZG9jdW1lbnQgPyB7IHN0YXR1czogXCJub29wXCIgfSA6IHsgc3RhdHVzOiBcImNyZWF0ZWRcIiwgaWQ6IG11dGF0aW9uLmRvY3VtZW50Ll9pZCwgYWZ0ZXI6IG11dGF0aW9uLmRvY3VtZW50IH0gOiB7XG4gICAgc3RhdHVzOiBcImVycm9yXCIsXG4gICAgbWVzc2FnZTogXCJDYW5ub3QgY3JlYXRlSWZOb3RFeGlzdHMgb24gZG9jdW1lbnQgd2l0aG91dCBfaWRcIlxuICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlT3JSZXBsYWNlKGRvY3VtZW50LCBtdXRhdGlvbikge1xuICByZXR1cm4gaGFzSWQobXV0YXRpb24uZG9jdW1lbnQpID8gZG9jdW1lbnQgPyB7XG4gICAgc3RhdHVzOiBcInVwZGF0ZWRcIixcbiAgICBpZDogbXV0YXRpb24uZG9jdW1lbnQuX2lkLFxuICAgIGJlZm9yZTogZG9jdW1lbnQsXG4gICAgYWZ0ZXI6IG11dGF0aW9uLmRvY3VtZW50XG4gIH0gOiB7IHN0YXR1czogXCJjcmVhdGVkXCIsIGlkOiBtdXRhdGlvbi5kb2N1bWVudC5faWQsIGFmdGVyOiBtdXRhdGlvbi5kb2N1bWVudCB9IDoge1xuICAgIHN0YXR1czogXCJlcnJvclwiLFxuICAgIG1lc3NhZ2U6IFwiQ2Fubm90IGNyZWF0ZUlmTm90RXhpc3RzIG9uIGRvY3VtZW50IHdpdGhvdXQgX2lkXCJcbiAgfTtcbn1cbmZ1bmN0aW9uIGRlbChkb2N1bWVudCwgbXV0YXRpb24pIHtcbiAgcmV0dXJuIGRvY3VtZW50ID8gbXV0YXRpb24uaWQgIT09IGRvY3VtZW50Ll9pZCA/IHsgc3RhdHVzOiBcImVycm9yXCIsIG1lc3NhZ2U6IFwiRGVsZXRlIG11dGF0aW9uIHRhcmdldGVkIHdyb25nIGRvY3VtZW50XCIgfSA6IHtcbiAgICBzdGF0dXM6IFwiZGVsZXRlZFwiLFxuICAgIGlkOiBtdXRhdGlvbi5pZCxcbiAgICBiZWZvcmU6IGRvY3VtZW50LFxuICAgIGFmdGVyOiB2b2lkIDBcbiAgfSA6IHsgc3RhdHVzOiBcIm5vb3BcIiB9O1xufVxuZnVuY3Rpb24gcGF0Y2goZG9jdW1lbnQsIG11dGF0aW9uKSB7XG4gIGlmICghZG9jdW1lbnQpXG4gICAgcmV0dXJuIHtcbiAgICAgIHN0YXR1czogXCJlcnJvclwiLFxuICAgICAgbWVzc2FnZTogXCJDYW5ub3QgYXBwbHkgcGF0Y2ggb24gbm9uZXhpc3RlbnQgZG9jdW1lbnRcIlxuICAgIH07XG4gIGNvbnN0IG5leHQgPSBhcHBseVBhdGNoTXV0YXRpb24obXV0YXRpb24sIGRvY3VtZW50KTtcbiAgcmV0dXJuIGRvY3VtZW50ID09PSBuZXh0ID8geyBzdGF0dXM6IFwibm9vcFwiIH0gOiB7IHN0YXR1czogXCJ1cGRhdGVkXCIsIGlkOiBtdXRhdGlvbi5pZCwgYmVmb3JlOiBkb2N1bWVudCwgYWZ0ZXI6IG5leHQgfTtcbn1cbmZ1bmN0aW9uIGFwcGx5TXV0YXRpb25zKG11dGF0aW9ucywgZGF0YXNldCkge1xuICBjb25zdCB1cGRhdGVkRG9jcyA9IC8qIEBfX1BVUkVfXyAqLyBPYmplY3QuY3JlYXRlKG51bGwpO1xuICBmb3IgKGNvbnN0IG11dGF0aW9uIG9mIG11dGF0aW9ucykge1xuICAgIGNvbnN0IGRvY3VtZW50SWQgPSBnZXRNdXRhdGlvbkRvY3VtZW50SWQobXV0YXRpb24pO1xuICAgIGlmICghZG9jdW1lbnRJZClcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuYWJsZSB0byBnZXQgZG9jdW1lbnQgaWQgZnJvbSBtdXRhdGlvblwiKTtcbiAgICBjb25zdCBiZWZvcmUgPSB1cGRhdGVkRG9jc1tkb2N1bWVudElkXT8uYWZ0ZXIgfHwgZGF0YXNldC5nZXQoZG9jdW1lbnRJZCksIHJlcyA9IGFwcGx5RG9jdW1lbnRNdXRhdGlvbihiZWZvcmUsIG11dGF0aW9uKTtcbiAgICBpZiAocmVzLnN0YXR1cyA9PT0gXCJlcnJvclwiKVxuICAgICAgdGhyb3cgbmV3IEVycm9yKHJlcy5tZXNzYWdlKTtcbiAgICByZXMuc3RhdHVzICE9PSBcIm5vb3BcIiAmJiAocmVzLnN0YXR1cyA9PT0gXCJ1cGRhdGVkXCIgfHwgcmVzLnN0YXR1cyA9PT0gXCJjcmVhdGVkXCIgfHwgcmVzLnN0YXR1cyA9PT0gXCJkZWxldGVkXCIpICYmIChkb2N1bWVudElkIGluIHVwZGF0ZWREb2NzIHx8ICh1cGRhdGVkRG9jc1tkb2N1bWVudElkXSA9IHsgYmVmb3JlLCBhZnRlcjogdm9pZCAwLCBtdXRzOiBbXSB9KSwgdXBkYXRlZERvY3NbZG9jdW1lbnRJZF0uYWZ0ZXIgPSByZXMuYWZ0ZXIpO1xuICB9XG4gIHJldHVybiBPYmplY3QuZW50cmllcyh1cGRhdGVkRG9jcykubWFwKFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1zaGFkb3dcbiAgICAoW2lkLCB7IGJlZm9yZSwgYWZ0ZXIsIG11dHMgfV0pID0+ICh7XG4gICAgICBpZCxcbiAgICAgIHN0YXR1czogYWZ0ZXIgPyBiZWZvcmUgPyBcInVwZGF0ZWRcIiA6IFwiY3JlYXRlZFwiIDogXCJkZWxldGVkXCIsXG4gICAgICBtdXRhdGlvbnM6IG11dHMsXG4gICAgICBiZWZvcmUsXG4gICAgICBhZnRlclxuICAgIH0pXG4gICk7XG59XG5mdW5jdGlvbiBjb21taXQocmVzdWx0cywgZGF0YXNldCkge1xuICByZXN1bHRzLmZvckVhY2goKHJlc3VsdCkgPT4ge1xuICAgIChyZXN1bHQuc3RhdHVzID09PSBcImNyZWF0ZWRcIiB8fCByZXN1bHQuc3RhdHVzID09PSBcInVwZGF0ZWRcIikgJiYgZGF0YXNldC5zZXQocmVzdWx0LmlkLCByZXN1bHQuYWZ0ZXIpLCByZXN1bHQuc3RhdHVzID09PSBcImRlbGV0ZWRcIiAmJiBkYXRhc2V0LmRlbGV0ZShyZXN1bHQuaWQpO1xuICB9KTtcbn1cbmZ1bmN0aW9uIHRha2VVbnRpbFJpZ2h0KGFyciwgcHJlZGljYXRlLCBvcHRzKSB7XG4gIGNvbnN0IHJlc3VsdCA9IFtdO1xuICBmb3IgKGNvbnN0IGl0ZW0gb2YgYXJyLnNsaWNlKCkucmV2ZXJzZSgpKSB7XG4gICAgaWYgKHByZWRpY2F0ZShpdGVtKSlcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgcmVzdWx0LnB1c2goaXRlbSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdC5yZXZlcnNlKCk7XG59XG5mdW5jdGlvbiBpc0VxdWFsUGF0aChwMSwgcDIpIHtcbiAgcmV0dXJuIHN0cmluZ2lmeShwMSkgPT09IHN0cmluZ2lmeShwMik7XG59XG5mdW5jdGlvbiBzdXBlcnNlZGVzKGxhdGVyLCBlYXJsaWVyKSB7XG4gIHJldHVybiAoZWFybGllci50eXBlID09PSBcInNldFwiIHx8IGVhcmxpZXIudHlwZSA9PT0gXCJ1bnNldFwiKSAmJiAobGF0ZXIudHlwZSA9PT0gXCJzZXRcIiB8fCBsYXRlci50eXBlID09PSBcInVuc2V0XCIpO1xufVxuZnVuY3Rpb24gc3F1YXNoTm9kZVBhdGNoZXMocGF0Y2hlcykge1xuICByZXR1cm4gY29tcGFjdFNldElmTWlzc2luZ1BhdGNoZXMoXG4gICAgY29tcGFjdFNldFBhdGNoZXMoY29tcGFjdFVuc2V0UGF0Y2hlcyhwYXRjaGVzKSlcbiAgKTtcbn1cbmZ1bmN0aW9uIGNvbXBhY3RVbnNldFBhdGNoZXMocGF0Y2hlcykge1xuICByZXR1cm4gcGF0Y2hlcy5yZWR1Y2UoXG4gICAgKGVhcmxpZXJQYXRjaGVzLCBsYXRlclBhdGNoKSA9PiB7XG4gICAgICBpZiAobGF0ZXJQYXRjaC5vcC50eXBlICE9PSBcInVuc2V0XCIpXG4gICAgICAgIHJldHVybiBlYXJsaWVyUGF0Y2hlcy5wdXNoKGxhdGVyUGF0Y2gpLCBlYXJsaWVyUGF0Y2hlcztcbiAgICAgIGNvbnN0IHVuYWZmZWN0ZWQgPSBlYXJsaWVyUGF0Y2hlcy5maWx0ZXIoXG4gICAgICAgIChlYXJsaWVyUGF0Y2gpID0+ICFzdGFydHNXaXRoKGxhdGVyUGF0Y2gucGF0aCwgZWFybGllclBhdGNoLnBhdGgpXG4gICAgICApO1xuICAgICAgcmV0dXJuIHVuYWZmZWN0ZWQucHVzaChsYXRlclBhdGNoKSwgdW5hZmZlY3RlZDtcbiAgICB9LFxuICAgIFtdXG4gICk7XG59XG5mdW5jdGlvbiBjb21wYWN0U2V0UGF0Y2hlcyhwYXRjaGVzKSB7XG4gIHJldHVybiBwYXRjaGVzLnJlZHVjZVJpZ2h0KFxuICAgIChsYXRlclBhdGNoZXMsIGVhcmxpZXJQYXRjaCkgPT4gKGxhdGVyUGF0Y2hlcy5maW5kKFxuICAgICAgKGxhdGVyKSA9PiBzdXBlcnNlZGVzKGxhdGVyLm9wLCBlYXJsaWVyUGF0Y2gub3ApICYmIGlzRXF1YWxQYXRoKGxhdGVyLnBhdGgsIGVhcmxpZXJQYXRjaC5wYXRoKVxuICAgICkgfHwgbGF0ZXJQYXRjaGVzLnVuc2hpZnQoZWFybGllclBhdGNoKSwgbGF0ZXJQYXRjaGVzKSxcbiAgICBbXVxuICApO1xufVxuZnVuY3Rpb24gY29tcGFjdFNldElmTWlzc2luZ1BhdGNoZXMocGF0Y2hlcykge1xuICByZXR1cm4gcGF0Y2hlcy5yZWR1Y2UoXG4gICAgKHByZXZpb3VzUGF0Y2hlcywgbGF0ZXJQYXRjaCkgPT4gbGF0ZXJQYXRjaC5vcC50eXBlICE9PSBcInNldElmTWlzc2luZ1wiID8gKHByZXZpb3VzUGF0Y2hlcy5wdXNoKGxhdGVyUGF0Y2gpLCBwcmV2aW91c1BhdGNoZXMpIDogKHRha2VVbnRpbFJpZ2h0KFxuICAgICAgcHJldmlvdXNQYXRjaGVzLFxuICAgICAgKHBhdGNoMikgPT4gcGF0Y2gyLm9wLnR5cGUgPT09IFwidW5zZXRcIlxuICAgICkuZmluZChcbiAgICAgIChwcmVjZWRpbmdQYXRjaCkgPT4gcHJlY2VkaW5nUGF0Y2gub3AudHlwZSA9PT0gXCJzZXRJZk1pc3NpbmdcIiAmJiBpc0VxdWFsUGF0aChwcmVjZWRpbmdQYXRjaC5wYXRoLCBsYXRlclBhdGNoLnBhdGgpXG4gICAgKSB8fCBwcmV2aW91c1BhdGNoZXMucHVzaChsYXRlclBhdGNoKSwgcHJldmlvdXNQYXRjaGVzKSxcbiAgICBbXVxuICApO1xufVxuZnVuY3Rpb24gY29tcGFjdERNUFNldFBhdGNoZXMoYmFzZSwgcGF0Y2hlcykge1xuICBsZXQgZWRnZSA9IGJhc2U7XG4gIHJldHVybiBwYXRjaGVzLnJlZHVjZShcbiAgICAoZWFybGllclBhdGNoZXMsIGxhdGVyUGF0Y2gpID0+IHtcbiAgICAgIGNvbnN0IGJlZm9yZSA9IGVkZ2U7XG4gICAgICBpZiAoZWRnZSA9IGFwcGx5Tm9kZVBhdGNoKGxhdGVyUGF0Y2gsIGVkZ2UpLCBsYXRlclBhdGNoLm9wLnR5cGUgPT09IFwic2V0XCIgJiYgdHlwZW9mIGxhdGVyUGF0Y2gub3AudmFsdWUgPT0gXCJzdHJpbmdcIikge1xuICAgICAgICBjb25zdCBjdXJyZW50ID0gZ2V0QXRQYXRoKGxhdGVyUGF0Y2gucGF0aCwgYmVmb3JlKTtcbiAgICAgICAgaWYgKHR5cGVvZiBjdXJyZW50ID09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICBjb25zdCByZXBsYWNlZCA9IHtcbiAgICAgICAgICAgIC4uLmxhdGVyUGF0Y2gsXG4gICAgICAgICAgICBvcDoge1xuICAgICAgICAgICAgICB0eXBlOiBcImRpZmZNYXRjaFBhdGNoXCIsXG4gICAgICAgICAgICAgIHZhbHVlOiBzdHJpbmdpZnlQYXRjaGVzKFxuICAgICAgICAgICAgICAgIG1ha2VQYXRjaGVzKGN1cnJlbnQsIGxhdGVyUGF0Y2gub3AudmFsdWUpXG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuICAgICAgICAgIHJldHVybiBlYXJsaWVyUGF0Y2hlcy5mbGF0TWFwKChlcCkgPT4gaXNFcXVhbFBhdGgoZXAucGF0aCwgbGF0ZXJQYXRjaC5wYXRoKSAmJiBlcC5vcC50eXBlID09PSBcImRpZmZNYXRjaFBhdGNoXCIgPyBbXSA6IGVwKS5jb25jYXQocmVwbGFjZWQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZWFybGllclBhdGNoZXMucHVzaChsYXRlclBhdGNoKSwgZWFybGllclBhdGNoZXM7XG4gICAgfSxcbiAgICBbXVxuICApO1xufVxuZnVuY3Rpb24gc3F1YXNoRE1QU3RyaW5ncyhyZW1vdGUsIG11dGF0aW9uR3JvdXBzKSB7XG4gIHJldHVybiBtdXRhdGlvbkdyb3Vwcy5tYXAoKG11dGF0aW9uR3JvdXApID0+ICh7XG4gICAgLi4ubXV0YXRpb25Hcm91cCxcbiAgICBtdXRhdGlvbnM6IGRtcElmeU11dGF0aW9ucyhyZW1vdGUsIG11dGF0aW9uR3JvdXAubXV0YXRpb25zKVxuICB9KSk7XG59XG5mdW5jdGlvbiBkbXBJZnlNdXRhdGlvbnMoc3RvcmUsIG11dGF0aW9ucykge1xuICByZXR1cm4gbXV0YXRpb25zLm1hcCgobXV0YXRpb24sIGkpID0+IG11dGF0aW9uLnR5cGUgPT09IFwicGF0Y2hcIiA/IGRtcGlmeVBhdGNoTXV0YXRpb24oc3RvcmUuZ2V0KG11dGF0aW9uLmlkKSwgbXV0YXRpb24pIDogbXV0YXRpb24pO1xufVxuZnVuY3Rpb24gZG1waWZ5UGF0Y2hNdXRhdGlvbihiYXNlLCBtdXRhdGlvbikge1xuICByZXR1cm4gYmFzZSA/IHtcbiAgICAuLi5tdXRhdGlvbixcbiAgICBwYXRjaGVzOiBjb21wYWN0RE1QU2V0UGF0Y2hlcyhiYXNlLCBtdXRhdGlvbi5wYXRjaGVzKVxuICB9IDogbXV0YXRpb247XG59XG5mdW5jdGlvbiBtZXJnZU11dGF0aW9uR3JvdXBzKG11dGF0aW9uR3JvdXBzKSB7XG4gIHJldHVybiBjaHVua1doaWxlKG11dGF0aW9uR3JvdXBzLCAoZ3JvdXApID0+ICFncm91cC50cmFuc2FjdGlvbikuZmxhdE1hcChcbiAgICAoY2h1bmspID0+ICh7XG4gICAgICAuLi5jaHVua1swXSxcbiAgICAgIG11dGF0aW9uczogY2h1bmsuZmxhdE1hcCgoYykgPT4gYy5tdXRhdGlvbnMpXG4gICAgfSlcbiAgKTtcbn1cbmZ1bmN0aW9uIGNodW5rV2hpbGUoYXJyLCBwcmVkaWNhdGUpIHtcbiAgY29uc3QgcmVzID0gW107XG4gIGxldCBjdXJyZW50Q2h1bmsgPSBbXTtcbiAgcmV0dXJuIGFyci5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgcHJlZGljYXRlKGl0ZW0pID8gY3VycmVudENodW5rLnB1c2goaXRlbSkgOiAoY3VycmVudENodW5rLmxlbmd0aCA+IDAgJiYgcmVzLnB1c2goY3VycmVudENodW5rKSwgY3VycmVudENodW5rID0gW10sIHJlcy5wdXNoKFtpdGVtXSkpO1xuICB9KSwgY3VycmVudENodW5rLmxlbmd0aCA+IDAgJiYgcmVzLnB1c2goY3VycmVudENodW5rKSwgcmVzO1xufVxuZnVuY3Rpb24gc3F1YXNoTXV0YXRpb25Hcm91cHMoc3RhZ2VkKSB7XG4gIHJldHVybiBtZXJnZU11dGF0aW9uR3JvdXBzKHN0YWdlZCkubWFwKCh0cmFuc2FjdGlvbikgPT4gKHtcbiAgICAuLi50cmFuc2FjdGlvbixcbiAgICBtdXRhdGlvbnM6IHNxdWFzaE11dGF0aW9ucyh0cmFuc2FjdGlvbi5tdXRhdGlvbnMpXG4gIH0pKS5tYXAoKHRyYW5zYWN0aW9uKSA9PiAoe1xuICAgIC4uLnRyYW5zYWN0aW9uLFxuICAgIG11dGF0aW9uczogdHJhbnNhY3Rpb24ubXV0YXRpb25zLm1hcCgobXV0YXRpb24pID0+IG11dGF0aW9uLnR5cGUgIT09IFwicGF0Y2hcIiA/IG11dGF0aW9uIDoge1xuICAgICAgLi4ubXV0YXRpb24sXG4gICAgICBwYXRjaGVzOiBzcXVhc2hOb2RlUGF0Y2hlcyhtdXRhdGlvbi5wYXRjaGVzKVxuICAgIH0pXG4gIH0pKTtcbn1cbmZ1bmN0aW9uIHNxdWFzaE11dGF0aW9ucyhtdXRhdGlvbnMpIHtcbiAgY29uc3QgYnlEb2N1bWVudCA9IGdyb3VwQnkobXV0YXRpb25zLCBnZXRNdXRhdGlvbkRvY3VtZW50SWQpO1xuICByZXR1cm4gT2JqZWN0LnZhbHVlcyhieURvY3VtZW50KS5mbGF0TWFwKChkb2N1bWVudE11dGF0aW9ucykgPT4gc3F1YXNoQ3JlYXRlSWZOb3RFeGlzdHMoc3F1YXNoRGVsZXRlKGRvY3VtZW50TXV0YXRpb25zKSkuZmxhdCgpLnJlZHVjZSgoYWNjLCBkb2NNdXRhdGlvbikgPT4ge1xuICAgIGNvbnN0IHByZXYgPSBhY2NbYWNjLmxlbmd0aCAtIDFdO1xuICAgIHJldHVybiAoIXByZXYgfHwgcHJldi50eXBlID09PSBcInBhdGNoXCIpICYmIGRvY011dGF0aW9uLnR5cGUgPT09IFwicGF0Y2hcIiA/IGFjYy5zbGljZSgwLCAtMSkuY29uY2F0KHtcbiAgICAgIC4uLmRvY011dGF0aW9uLFxuICAgICAgcGF0Y2hlczogKHByZXY/LnBhdGNoZXMgfHwgW10pLmNvbmNhdChkb2NNdXRhdGlvbi5wYXRjaGVzKVxuICAgIH0pIDogYWNjLmNvbmNhdChkb2NNdXRhdGlvbik7XG4gIH0sIFtdKSk7XG59XG5mdW5jdGlvbiBzcXVhc2hDcmVhdGVJZk5vdEV4aXN0cyhtdXRhdGlvbnMpIHtcbiAgcmV0dXJuIG11dGF0aW9ucy5sZW5ndGggPT09IDAgPyBtdXRhdGlvbnMgOiBtdXRhdGlvbnMucmVkdWNlKChwcmV2aW91c011dHMsIGxhdGVyTXV0KSA9PiBsYXRlck11dC50eXBlICE9PSBcImNyZWF0ZUlmTm90RXhpc3RzXCIgPyAocHJldmlvdXNNdXRzLnB1c2gobGF0ZXJNdXQpLCBwcmV2aW91c011dHMpIDogKHRha2VVbnRpbFJpZ2h0KHByZXZpb3VzTXV0cywgKG0pID0+IG0udHlwZSA9PT0gXCJkZWxldGVcIikuZmluZChcbiAgICAocHJlY2VkaW5nUGF0Y2gpID0+IHByZWNlZGluZ1BhdGNoLnR5cGUgPT09IFwiY3JlYXRlSWZOb3RFeGlzdHNcIlxuICApIHx8IHByZXZpb3VzTXV0cy5wdXNoKGxhdGVyTXV0KSwgcHJldmlvdXNNdXRzKSwgW10pO1xufVxuZnVuY3Rpb24gc3F1YXNoRGVsZXRlKG11dGF0aW9ucykge1xuICByZXR1cm4gbXV0YXRpb25zLmxlbmd0aCA9PT0gMCA/IG11dGF0aW9ucyA6IG11dGF0aW9ucy5yZWR1Y2UoKHByZXZpb3VzTXV0cywgbGF0ZXJNdXQpID0+IGxhdGVyTXV0LnR5cGUgPT09IFwiZGVsZXRlXCIgPyBbbGF0ZXJNdXRdIDogKHByZXZpb3VzTXV0cy5wdXNoKGxhdGVyTXV0KSwgcHJldmlvdXNNdXRzKSwgW10pO1xufVxuZnVuY3Rpb24gcmViYXNlKGRvY3VtZW50SWQsIG9sZEJhc2UsIG5ld0Jhc2UsIHN0YWdlZE11dGF0aW9ucykge1xuICBsZXQgZWRnZSA9IG9sZEJhc2U7XG4gIGNvbnN0IGRtcGlmaWVkID0gc3RhZ2VkTXV0YXRpb25zLm1hcCgodHJhbnNhY3Rpb24pID0+IHtcbiAgICBjb25zdCBtdXRhdGlvbnMgPSB0cmFuc2FjdGlvbi5tdXRhdGlvbnMuZmxhdE1hcCgobXV0KSA9PiB7XG4gICAgICBpZiAoZ2V0TXV0YXRpb25Eb2N1bWVudElkKG11dCkgIT09IGRvY3VtZW50SWQpXG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIGNvbnN0IGJlZm9yZSA9IGVkZ2U7XG4gICAgICByZXR1cm4gZWRnZSA9IGFwcGx5QWxsKGVkZ2UsIFttdXRdKSwgIWJlZm9yZSB8fCBtdXQudHlwZSAhPT0gXCJwYXRjaFwiID8gbXV0IDoge1xuICAgICAgICB0eXBlOiBcImRtcGlmaWVkXCIsXG4gICAgICAgIG11dGF0aW9uOiB7XG4gICAgICAgICAgLi4ubXV0LFxuICAgICAgICAgIC8vIFRvZG86IG1ha2UgY29tcGFjdERNUFNldFBhdGNoZXMgcmV0dXJuIHBhaXJzIG9mIHBhdGNoZXMgdGhhdCB3YXMgZG1waWZpZWQgd2l0aCB0aGVpclxuICAgICAgICAgIC8vICBvcmlnaW5hbCBhcyBkbXBQYXRjaGVzIGFuZCBvcmlnaW5hbCBpcyBub3QgMToxIChlLi5nIHNvbWUgb2YgdGhlIG9yaWdpbmFsIG1heSBub3QgYmUgZG1waWZpZWQpXG4gICAgICAgICAgZG1wUGF0Y2hlczogY29tcGFjdERNUFNldFBhdGNoZXMoYmVmb3JlLCBtdXQucGF0Y2hlcyksXG4gICAgICAgICAgb3JpZ2luYWw6IG11dC5wYXRjaGVzXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSk7XG4gICAgcmV0dXJuIHsgLi4udHJhbnNhY3Rpb24sIG11dGF0aW9ucyB9O1xuICB9KTtcbiAgbGV0IG5ld0Jhc2VXaXRoRE1QRm9yT2xkQmFzZUFwcGxpZWQgPSBuZXdCYXNlO1xuICByZXR1cm4gZG1waWZpZWQubWFwKCh0cmFuc2FjdGlvbikgPT4ge1xuICAgIGNvbnN0IGFwcGxpZWQgPSBbXTtcbiAgICByZXR1cm4gdHJhbnNhY3Rpb24ubXV0YXRpb25zLmZvckVhY2goKG11dCkgPT4ge1xuICAgICAgaWYgKG11dC50eXBlID09PSBcImRtcGlmaWVkXCIpXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgbmV3QmFzZVdpdGhETVBGb3JPbGRCYXNlQXBwbGllZCA9IGFwcGx5UGF0Y2hlcyhcbiAgICAgICAgICAgIG11dC5tdXRhdGlvbi5kbXBQYXRjaGVzLFxuICAgICAgICAgICAgbmV3QmFzZVdpdGhETVBGb3JPbGRCYXNlQXBwbGllZFxuICAgICAgICAgICksIGFwcGxpZWQucHVzaChtdXQpO1xuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oXCJGYWlsZWQgdG8gYXBwbHkgZG1wIHBhdGNoLCBmYWxsaW5nIGJhY2sgdG8gb3JpZ2luYWxcIik7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIG5ld0Jhc2VXaXRoRE1QRm9yT2xkQmFzZUFwcGxpZWQgPSBhcHBseVBhdGNoZXMoXG4gICAgICAgICAgICAgIG11dC5tdXRhdGlvbi5vcmlnaW5hbCxcbiAgICAgICAgICAgICAgbmV3QmFzZVdpdGhETVBGb3JPbGRCYXNlQXBwbGllZFxuICAgICAgICAgICAgKSwgYXBwbGllZC5wdXNoKG11dCk7XG4gICAgICAgICAgfSBjYXRjaCAoc2Vjb25kKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICAgIGBGYWlsZWQgdG8gYXBwbHkgcGF0Y2ggZm9yIGRvY3VtZW50IFwiJHtkb2N1bWVudElkfVwiOiAke3NlY29uZC5tZXNzYWdlfWBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBlbHNlXG4gICAgICAgIG5ld0Jhc2VXaXRoRE1QRm9yT2xkQmFzZUFwcGxpZWQgPSBhcHBseUFsbChcbiAgICAgICAgICBuZXdCYXNlV2l0aERNUEZvck9sZEJhc2VBcHBsaWVkLFxuICAgICAgICAgIFttdXRdXG4gICAgICAgICk7XG4gICAgfSk7XG4gIH0pLCBbc3RhZ2VkTXV0YXRpb25zLm1hcCgodHJhbnNhY3Rpb24pID0+ICh7XG4gICAgLi4udHJhbnNhY3Rpb24sXG4gICAgbXV0YXRpb25zOiB0cmFuc2FjdGlvbi5tdXRhdGlvbnMubWFwKChtdXQpID0+IG11dC50eXBlICE9PSBcInBhdGNoXCIgfHwgZ2V0TXV0YXRpb25Eb2N1bWVudElkKG11dCkgIT09IGRvY3VtZW50SWQgPyBtdXQgOiB7XG4gICAgICAuLi5tdXQsXG4gICAgICBwYXRjaGVzOiBtdXQucGF0Y2hlcy5tYXAoKHBhdGNoMikgPT4gcGF0Y2gyLm9wLnR5cGUgIT09IFwic2V0XCIgPyBwYXRjaDIgOiB7XG4gICAgICAgIC4uLnBhdGNoMixcbiAgICAgICAgb3A6IHtcbiAgICAgICAgICAuLi5wYXRjaDIub3AsXG4gICAgICAgICAgdmFsdWU6IGdldEF0UGF0aChwYXRjaDIucGF0aCwgbmV3QmFzZVdpdGhETVBGb3JPbGRCYXNlQXBwbGllZClcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9KVxuICB9KSksIG5ld0Jhc2VXaXRoRE1QRm9yT2xkQmFzZUFwcGxpZWRdO1xufVxuZnVuY3Rpb24gdG9UcmFuc2FjdGlvbnMoZ3JvdXBzKSB7XG4gIHJldHVybiBncm91cHMubWFwKChncm91cCkgPT4gZ3JvdXAudHJhbnNhY3Rpb24gJiYgZ3JvdXAuaWQgIT09IHZvaWQgMCA/IHsgaWQ6IGdyb3VwLmlkLCBtdXRhdGlvbnM6IGdyb3VwLm11dGF0aW9ucyB9IDogeyBtdXRhdGlvbnM6IGdyb3VwLm11dGF0aW9ucyB9KTtcbn1cbmV4cG9ydCB7XG4gIGFwcGx5TXV0YXRpb25zLFxuICBjb21taXQsXG4gIGdldE11dGF0aW9uRG9jdW1lbnRJZCxcbiAgcmViYXNlLFxuICBzcXVhc2hETVBTdHJpbmdzLFxuICBzcXVhc2hNdXRhdGlvbkdyb3VwcyxcbiAgdG9UcmFuc2FjdGlvbnNcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD10b1RyYW5zYWN0aW9ucy5qcy5tYXBcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/toTransactions.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/utils.js":
/*!***************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/utils.js ***!
  \***************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   applyNodePatch: () => (/* binding */ applyNodePatch),\n/* harmony export */   applyOp: () => (/* binding */ applyOp),\n/* harmony export */   applyPatchMutation: () => (/* binding */ applyPatchMutation),\n/* harmony export */   applyPatches: () => (/* binding */ applyPatches),\n/* harmony export */   assignId: () => (/* binding */ assignId),\n/* harmony export */   hasId: () => (/* binding */ hasId),\n/* harmony export */   nanoid: () => (/* binding */ nanoid),\n/* harmony export */   splice: () => (/* binding */ splice)\n/* harmony export */ });\n/* harmony import */ var _stringify_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./stringify.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/stringify.js\");\n/* harmony import */ var _isObject_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./isObject.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/isObject.js\");\n/* harmony import */ var _sanity_diff_match_patch__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sanity/diff-match-patch */ \"(ssr)/./node_modules/@sanity/diff-match-patch/dist/index.js\");\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! node:crypto */ \"node:crypto\");\n\n\n\n\nfunction keyOf(value) {\n  return value !== null && typeof value == \"object\" && typeof value._key == \"string\" && value._key || null;\n}\nfunction findTargetIndex(array, pathSegment) {\n  if (typeof pathSegment == \"number\")\n    return normalizeIndex(array.length, pathSegment);\n  if ((0,_stringify_js__WEBPACK_IMPORTED_MODULE_1__.isKeyedElement)(pathSegment)) {\n    const idx = array.findIndex((value) => keyOf(value) === pathSegment._key);\n    return idx === -1 ? null : idx;\n  }\n  throw new Error(\n    `Expected path segment to be addressing a single array item either by numeric index or by '_key'. Instead saw ${JSON.stringify(\n      pathSegment\n    )}`\n  );\n}\nfunction getTargetIdx(position, index) {\n  return position === \"before\" ? index : index + 1;\n}\nfunction normalizeIndex(length, index) {\n  if (length === 0 && (index === -1 || index === 0))\n    return 0;\n  const normalized = index < 0 ? length + index : index;\n  return normalized >= length || normalized < 0 ? null : normalized;\n}\nfunction splice(arr, start, deleteCount, items) {\n  const copy = arr.slice();\n  return copy.splice(start, deleteCount, ...items || []), copy;\n}\nfunction insert(op, currentValue) {\n  if (!Array.isArray(currentValue))\n    throw new TypeError('Cannot apply \"insert()\" on non-array value');\n  const index = findTargetIndex(currentValue, op.referenceItem);\n  if (index === null)\n    throw new Error(`Found no matching array element to insert ${op.position}`);\n  return currentValue.length === 0 ? op.items : splice(currentValue, getTargetIdx(op.position, index), 0, op.items);\n}\nfunction upsert(op, currentValue) {\n  if (!Array.isArray(currentValue))\n    throw new TypeError('Cannot apply \"upsert()\" on non-array value');\n  if (op.items.length === 0)\n    return currentValue;\n  const replaceItemsMap = [], insertItems = [];\n  if (op.items.forEach((itemToBeUpserted, i) => {\n    const existingIndex = currentValue.findIndex(\n      (existingItem) => existingItem?._key === itemToBeUpserted._key\n    );\n    existingIndex >= 0 ? replaceItemsMap[existingIndex] = i : insertItems.push(itemToBeUpserted);\n  }), replaceItemsMap.length === 0 && insertItems.length == 0)\n    return currentValue;\n  const next = [...currentValue];\n  for (const i of replaceItemsMap)\n    next[i] = op.items[replaceItemsMap[i]];\n  return insert(\n    {\n      type: \"insert\",\n      items: insertItems,\n      referenceItem: op.referenceItem,\n      position: op.position\n    },\n    next\n  );\n}\nfunction replace(op, currentValue) {\n  if (!Array.isArray(currentValue))\n    throw new TypeError('Cannot apply \"replace()\" on non-array value');\n  const index = findTargetIndex(currentValue, op.referenceItem);\n  if (index === null)\n    throw new Error(\"Found no matching array element to replace\");\n  return splice(currentValue, index, op.items.length, op.items);\n}\nfunction remove(op, currentValue) {\n  if (!Array.isArray(currentValue))\n    throw new TypeError('Cannot apply \"remove()\" on non-array value');\n  const index = findTargetIndex(currentValue, op.referenceItem);\n  if (index === null)\n    throw new Error(\"Found no matching array element to replace\");\n  return splice(currentValue, index, 1, []);\n}\nfunction truncate(op, currentValue) {\n  if (!Array.isArray(currentValue))\n    throw new TypeError('Cannot apply \"truncate()\" on non-array value');\n  return typeof op.endIndex == \"number\" ? currentValue.slice(0, op.startIndex).concat(currentValue.slice(op.endIndex)) : currentValue.slice(0, op.startIndex);\n}\nfunction set(op, currentValue) {\n  return op.value;\n}\nfunction setIfMissing(op, currentValue) {\n  return currentValue ?? op.value;\n}\nfunction unset(op) {\n}\nfunction inc(op, currentValue) {\n  if (typeof currentValue != \"number\")\n    throw new TypeError('Cannot apply \"inc()\" on non-numeric value');\n  return currentValue + op.amount;\n}\nfunction dec(op, currentValue) {\n  if (typeof currentValue != \"number\")\n    throw new TypeError('Cannot apply \"dec()\" on non-numeric value');\n  return currentValue - op.amount;\n}\nconst hasOwn = Object.prototype.hasOwnProperty.call.bind(\n  Object.prototype.hasOwnProperty\n);\nfunction isEmpty(v) {\n  for (const key in v)\n    if (hasOwn(v, key))\n      return !1;\n  return !0;\n}\nfunction omit(val, props) {\n  const copy = { ...val };\n  for (const prop of props)\n    delete copy[prop];\n  return copy;\n}\nfunction unassign(op, currentValue) {\n  if (!(0,_isObject_js__WEBPACK_IMPORTED_MODULE_2__.isObject)(currentValue))\n    throw new TypeError('Cannot apply \"unassign()\" on non-object value');\n  return op.keys.length === 0 ? currentValue : omit(currentValue, op.keys);\n}\nfunction assign(op, currentValue) {\n  if (!(0,_isObject_js__WEBPACK_IMPORTED_MODULE_2__.isObject)(currentValue))\n    throw new TypeError('Cannot apply \"assign()\" on non-object value');\n  return isEmpty(op.value) ? currentValue : { ...currentValue, ...op.value };\n}\nfunction diffMatchPatch(op, currentValue) {\n  if (typeof currentValue != \"string\")\n    throw new TypeError('Cannot apply \"diffMatchPatch()\" on non-string value');\n  return (0,_sanity_diff_match_patch__WEBPACK_IMPORTED_MODULE_3__.applyPatches)((0,_sanity_diff_match_patch__WEBPACK_IMPORTED_MODULE_3__.parsePatch)(op.value), currentValue)[0];\n}\nvar operations = /* @__PURE__ */ Object.freeze({\n  __proto__: null,\n  assign,\n  dec,\n  diffMatchPatch,\n  inc,\n  insert,\n  remove,\n  replace,\n  set,\n  setIfMissing,\n  truncate,\n  unassign,\n  unset,\n  upsert\n});\nfunction applyOp(op, currentValue) {\n  if (!(op.type in operations))\n    throw new Error(`Invalid operation type: \"${op.type}\"`);\n  return operations[op.type](op, currentValue);\n}\nfunction applyPatches(patches, document) {\n  return patches.reduce(\n    (prev, patch) => applyNodePatch(patch, prev),\n    document\n  );\n}\nfunction applyNodePatch(patch, document) {\n  return applyAtPath(patch.path, patch.op, document);\n}\nfunction applyAtPath(path, op, value) {\n  if (!isNonEmptyArray(path))\n    return applyOp(op, value);\n  const [head, ...tail] = path;\n  if ((0,_stringify_js__WEBPACK_IMPORTED_MODULE_1__.isArrayElement)(head) && Array.isArray(value))\n    return applyInArray(head, tail, op, value);\n  if ((0,_stringify_js__WEBPACK_IMPORTED_MODULE_1__.isPropertyElement)(head) && (0,_isObject_js__WEBPACK_IMPORTED_MODULE_2__.isObject)(value))\n    return applyInObject(head, tail, op, value);\n  throw new Error(\n    `Cannot apply operation of type \"${op.type}\" to path ${(0,_stringify_js__WEBPACK_IMPORTED_MODULE_1__.stringify)(\n      path\n    )} on ${typeof value} value`\n  );\n}\nfunction applyInObject(head, tail, op, object) {\n  const current = object[head];\n  if (current === void 0 && tail.length > 0)\n    return object;\n  const patchedValue = applyAtPath(tail, op, current);\n  return patchedValue === current ? object : { ...object, [head]: patchedValue };\n}\nfunction applyInArray(head, tail, op, value) {\n  const index = findTargetIndex(value, head);\n  if (index === null || index === -1)\n    return value;\n  const current = value[index], patchedItem = applyAtPath(tail, op, current);\n  return patchedItem === current ? value : splice(value, index, 1, [patchedItem]);\n}\nfunction isNonEmptyArray(a) {\n  return a.length > 0;\n}\nfunction applyPatchMutation(mutation, document) {\n  if (mutation.options?.ifRevision && document._rev !== mutation.options.ifRevision)\n    throw new Error(\"Revision mismatch\");\n  if (mutation.id !== document._id)\n    throw new Error(\n      `Document id mismatch. Refusing to apply mutation for document with id=\"${mutation.id}\" on the given document with id=\"${document._id}\"`\n    );\n  return applyPatches(mutation.patches, document);\n}\nconst urlAlphabet = \"useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict\", POOL_SIZE_MULTIPLIER = 128;\nlet pool, poolOffset;\nfunction fillPool(bytes) {\n  !pool || pool.length < bytes ? (pool = Buffer.allocUnsafe(bytes * POOL_SIZE_MULTIPLIER), node_crypto__WEBPACK_IMPORTED_MODULE_0__.webcrypto.getRandomValues(pool), poolOffset = 0) : poolOffset + bytes > pool.length && (node_crypto__WEBPACK_IMPORTED_MODULE_0__.webcrypto.getRandomValues(pool), poolOffset = 0), poolOffset += bytes;\n}\nfunction nanoid(size = 21) {\n  fillPool(size -= 0);\n  let id = \"\";\n  for (let i = poolOffset - size; i < poolOffset; i++)\n    id += urlAlphabet[pool[i] & 63];\n  return id;\n}\nfunction hasId(doc) {\n  return \"_id\" in doc;\n}\nfunction assignId(doc, generateId) {\n  return hasId(doc) ? doc : { ...doc, _id: generateId() };\n}\n\n//# sourceMappingURL=utils.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy91dGlscy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBOEY7QUFDckQ7QUFDNkM7QUFDOUM7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSw2REFBYztBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9IQUFvSDtBQUNwSDtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLFlBQVk7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU8sc0RBQVE7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU8sc0RBQVE7QUFDZjtBQUNBLDhDQUE4QztBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsc0VBQWMsQ0FBQyxvRUFBVTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsZ0RBQWdELFFBQVE7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSw2REFBYztBQUNwQjtBQUNBLE1BQU0sZ0VBQWlCLFVBQVUsc0RBQVE7QUFDekM7QUFDQTtBQUNBLHVDQUF1QyxRQUFRLFlBQVksd0RBQVM7QUFDcEU7QUFDQSxPQUFPLEtBQUssY0FBYztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQztBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdGQUFnRixZQUFZLG1DQUFtQyxhQUFhO0FBQzVJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJGQUEyRixrREFBUywrRUFBK0Usa0RBQVM7QUFDNUw7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsZ0JBQWdCO0FBQ2xEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCO0FBQzlCO0FBVUU7QUFDRiIsInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX2NodW5rcy1lcy91dGlscy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc0tleWVkRWxlbWVudCwgaXNBcnJheUVsZW1lbnQsIGlzUHJvcGVydHlFbGVtZW50LCBzdHJpbmdpZnkgfSBmcm9tIFwiLi9zdHJpbmdpZnkuanNcIjtcbmltcG9ydCB7IGlzT2JqZWN0IH0gZnJvbSBcIi4vaXNPYmplY3QuanNcIjtcbmltcG9ydCB7IGFwcGx5UGF0Y2hlcyBhcyBhcHBseVBhdGNoZXMkMSwgcGFyc2VQYXRjaCB9IGZyb20gXCJAc2FuaXR5L2RpZmYtbWF0Y2gtcGF0Y2hcIjtcbmltcG9ydCB7IHdlYmNyeXB0byB9IGZyb20gXCJub2RlOmNyeXB0b1wiO1xuZnVuY3Rpb24ga2V5T2YodmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlICE9PSBudWxsICYmIHR5cGVvZiB2YWx1ZSA9PSBcIm9iamVjdFwiICYmIHR5cGVvZiB2YWx1ZS5fa2V5ID09IFwic3RyaW5nXCIgJiYgdmFsdWUuX2tleSB8fCBudWxsO1xufVxuZnVuY3Rpb24gZmluZFRhcmdldEluZGV4KGFycmF5LCBwYXRoU2VnbWVudCkge1xuICBpZiAodHlwZW9mIHBhdGhTZWdtZW50ID09IFwibnVtYmVyXCIpXG4gICAgcmV0dXJuIG5vcm1hbGl6ZUluZGV4KGFycmF5Lmxlbmd0aCwgcGF0aFNlZ21lbnQpO1xuICBpZiAoaXNLZXllZEVsZW1lbnQocGF0aFNlZ21lbnQpKSB7XG4gICAgY29uc3QgaWR4ID0gYXJyYXkuZmluZEluZGV4KCh2YWx1ZSkgPT4ga2V5T2YodmFsdWUpID09PSBwYXRoU2VnbWVudC5fa2V5KTtcbiAgICByZXR1cm4gaWR4ID09PSAtMSA/IG51bGwgOiBpZHg7XG4gIH1cbiAgdGhyb3cgbmV3IEVycm9yKFxuICAgIGBFeHBlY3RlZCBwYXRoIHNlZ21lbnQgdG8gYmUgYWRkcmVzc2luZyBhIHNpbmdsZSBhcnJheSBpdGVtIGVpdGhlciBieSBudW1lcmljIGluZGV4IG9yIGJ5ICdfa2V5Jy4gSW5zdGVhZCBzYXcgJHtKU09OLnN0cmluZ2lmeShcbiAgICAgIHBhdGhTZWdtZW50XG4gICAgKX1gXG4gICk7XG59XG5mdW5jdGlvbiBnZXRUYXJnZXRJZHgocG9zaXRpb24sIGluZGV4KSB7XG4gIHJldHVybiBwb3NpdGlvbiA9PT0gXCJiZWZvcmVcIiA/IGluZGV4IDogaW5kZXggKyAxO1xufVxuZnVuY3Rpb24gbm9ybWFsaXplSW5kZXgobGVuZ3RoLCBpbmRleCkge1xuICBpZiAobGVuZ3RoID09PSAwICYmIChpbmRleCA9PT0gLTEgfHwgaW5kZXggPT09IDApKVxuICAgIHJldHVybiAwO1xuICBjb25zdCBub3JtYWxpemVkID0gaW5kZXggPCAwID8gbGVuZ3RoICsgaW5kZXggOiBpbmRleDtcbiAgcmV0dXJuIG5vcm1hbGl6ZWQgPj0gbGVuZ3RoIHx8IG5vcm1hbGl6ZWQgPCAwID8gbnVsbCA6IG5vcm1hbGl6ZWQ7XG59XG5mdW5jdGlvbiBzcGxpY2UoYXJyLCBzdGFydCwgZGVsZXRlQ291bnQsIGl0ZW1zKSB7XG4gIGNvbnN0IGNvcHkgPSBhcnIuc2xpY2UoKTtcbiAgcmV0dXJuIGNvcHkuc3BsaWNlKHN0YXJ0LCBkZWxldGVDb3VudCwgLi4uaXRlbXMgfHwgW10pLCBjb3B5O1xufVxuZnVuY3Rpb24gaW5zZXJ0KG9wLCBjdXJyZW50VmFsdWUpIHtcbiAgaWYgKCFBcnJheS5pc0FycmF5KGN1cnJlbnRWYWx1ZSkpXG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGFwcGx5IFwiaW5zZXJ0KClcIiBvbiBub24tYXJyYXkgdmFsdWUnKTtcbiAgY29uc3QgaW5kZXggPSBmaW5kVGFyZ2V0SW5kZXgoY3VycmVudFZhbHVlLCBvcC5yZWZlcmVuY2VJdGVtKTtcbiAgaWYgKGluZGV4ID09PSBudWxsKVxuICAgIHRocm93IG5ldyBFcnJvcihgRm91bmQgbm8gbWF0Y2hpbmcgYXJyYXkgZWxlbWVudCB0byBpbnNlcnQgJHtvcC5wb3NpdGlvbn1gKTtcbiAgcmV0dXJuIGN1cnJlbnRWYWx1ZS5sZW5ndGggPT09IDAgPyBvcC5pdGVtcyA6IHNwbGljZShjdXJyZW50VmFsdWUsIGdldFRhcmdldElkeChvcC5wb3NpdGlvbiwgaW5kZXgpLCAwLCBvcC5pdGVtcyk7XG59XG5mdW5jdGlvbiB1cHNlcnQob3AsIGN1cnJlbnRWYWx1ZSkge1xuICBpZiAoIUFycmF5LmlzQXJyYXkoY3VycmVudFZhbHVlKSlcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgYXBwbHkgXCJ1cHNlcnQoKVwiIG9uIG5vbi1hcnJheSB2YWx1ZScpO1xuICBpZiAob3AuaXRlbXMubGVuZ3RoID09PSAwKVxuICAgIHJldHVybiBjdXJyZW50VmFsdWU7XG4gIGNvbnN0IHJlcGxhY2VJdGVtc01hcCA9IFtdLCBpbnNlcnRJdGVtcyA9IFtdO1xuICBpZiAob3AuaXRlbXMuZm9yRWFjaCgoaXRlbVRvQmVVcHNlcnRlZCwgaSkgPT4ge1xuICAgIGNvbnN0IGV4aXN0aW5nSW5kZXggPSBjdXJyZW50VmFsdWUuZmluZEluZGV4KFxuICAgICAgKGV4aXN0aW5nSXRlbSkgPT4gZXhpc3RpbmdJdGVtPy5fa2V5ID09PSBpdGVtVG9CZVVwc2VydGVkLl9rZXlcbiAgICApO1xuICAgIGV4aXN0aW5nSW5kZXggPj0gMCA/IHJlcGxhY2VJdGVtc01hcFtleGlzdGluZ0luZGV4XSA9IGkgOiBpbnNlcnRJdGVtcy5wdXNoKGl0ZW1Ub0JlVXBzZXJ0ZWQpO1xuICB9KSwgcmVwbGFjZUl0ZW1zTWFwLmxlbmd0aCA9PT0gMCAmJiBpbnNlcnRJdGVtcy5sZW5ndGggPT0gMClcbiAgICByZXR1cm4gY3VycmVudFZhbHVlO1xuICBjb25zdCBuZXh0ID0gWy4uLmN1cnJlbnRWYWx1ZV07XG4gIGZvciAoY29uc3QgaSBvZiByZXBsYWNlSXRlbXNNYXApXG4gICAgbmV4dFtpXSA9IG9wLml0ZW1zW3JlcGxhY2VJdGVtc01hcFtpXV07XG4gIHJldHVybiBpbnNlcnQoXG4gICAge1xuICAgICAgdHlwZTogXCJpbnNlcnRcIixcbiAgICAgIGl0ZW1zOiBpbnNlcnRJdGVtcyxcbiAgICAgIHJlZmVyZW5jZUl0ZW06IG9wLnJlZmVyZW5jZUl0ZW0sXG4gICAgICBwb3NpdGlvbjogb3AucG9zaXRpb25cbiAgICB9LFxuICAgIG5leHRcbiAgKTtcbn1cbmZ1bmN0aW9uIHJlcGxhY2Uob3AsIGN1cnJlbnRWYWx1ZSkge1xuICBpZiAoIUFycmF5LmlzQXJyYXkoY3VycmVudFZhbHVlKSlcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgYXBwbHkgXCJyZXBsYWNlKClcIiBvbiBub24tYXJyYXkgdmFsdWUnKTtcbiAgY29uc3QgaW5kZXggPSBmaW5kVGFyZ2V0SW5kZXgoY3VycmVudFZhbHVlLCBvcC5yZWZlcmVuY2VJdGVtKTtcbiAgaWYgKGluZGV4ID09PSBudWxsKVxuICAgIHRocm93IG5ldyBFcnJvcihcIkZvdW5kIG5vIG1hdGNoaW5nIGFycmF5IGVsZW1lbnQgdG8gcmVwbGFjZVwiKTtcbiAgcmV0dXJuIHNwbGljZShjdXJyZW50VmFsdWUsIGluZGV4LCBvcC5pdGVtcy5sZW5ndGgsIG9wLml0ZW1zKTtcbn1cbmZ1bmN0aW9uIHJlbW92ZShvcCwgY3VycmVudFZhbHVlKSB7XG4gIGlmICghQXJyYXkuaXNBcnJheShjdXJyZW50VmFsdWUpKVxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBhcHBseSBcInJlbW92ZSgpXCIgb24gbm9uLWFycmF5IHZhbHVlJyk7XG4gIGNvbnN0IGluZGV4ID0gZmluZFRhcmdldEluZGV4KGN1cnJlbnRWYWx1ZSwgb3AucmVmZXJlbmNlSXRlbSk7XG4gIGlmIChpbmRleCA9PT0gbnVsbClcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJGb3VuZCBubyBtYXRjaGluZyBhcnJheSBlbGVtZW50IHRvIHJlcGxhY2VcIik7XG4gIHJldHVybiBzcGxpY2UoY3VycmVudFZhbHVlLCBpbmRleCwgMSwgW10pO1xufVxuZnVuY3Rpb24gdHJ1bmNhdGUob3AsIGN1cnJlbnRWYWx1ZSkge1xuICBpZiAoIUFycmF5LmlzQXJyYXkoY3VycmVudFZhbHVlKSlcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgYXBwbHkgXCJ0cnVuY2F0ZSgpXCIgb24gbm9uLWFycmF5IHZhbHVlJyk7XG4gIHJldHVybiB0eXBlb2Ygb3AuZW5kSW5kZXggPT0gXCJudW1iZXJcIiA/IGN1cnJlbnRWYWx1ZS5zbGljZSgwLCBvcC5zdGFydEluZGV4KS5jb25jYXQoY3VycmVudFZhbHVlLnNsaWNlKG9wLmVuZEluZGV4KSkgOiBjdXJyZW50VmFsdWUuc2xpY2UoMCwgb3Auc3RhcnRJbmRleCk7XG59XG5mdW5jdGlvbiBzZXQob3AsIGN1cnJlbnRWYWx1ZSkge1xuICByZXR1cm4gb3AudmFsdWU7XG59XG5mdW5jdGlvbiBzZXRJZk1pc3Npbmcob3AsIGN1cnJlbnRWYWx1ZSkge1xuICByZXR1cm4gY3VycmVudFZhbHVlID8/IG9wLnZhbHVlO1xufVxuZnVuY3Rpb24gdW5zZXQob3ApIHtcbn1cbmZ1bmN0aW9uIGluYyhvcCwgY3VycmVudFZhbHVlKSB7XG4gIGlmICh0eXBlb2YgY3VycmVudFZhbHVlICE9IFwibnVtYmVyXCIpXG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGFwcGx5IFwiaW5jKClcIiBvbiBub24tbnVtZXJpYyB2YWx1ZScpO1xuICByZXR1cm4gY3VycmVudFZhbHVlICsgb3AuYW1vdW50O1xufVxuZnVuY3Rpb24gZGVjKG9wLCBjdXJyZW50VmFsdWUpIHtcbiAgaWYgKHR5cGVvZiBjdXJyZW50VmFsdWUgIT0gXCJudW1iZXJcIilcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgYXBwbHkgXCJkZWMoKVwiIG9uIG5vbi1udW1lcmljIHZhbHVlJyk7XG4gIHJldHVybiBjdXJyZW50VmFsdWUgLSBvcC5hbW91bnQ7XG59XG5jb25zdCBoYXNPd24gPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwuYmluZChcbiAgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eVxuKTtcbmZ1bmN0aW9uIGlzRW1wdHkodikge1xuICBmb3IgKGNvbnN0IGtleSBpbiB2KVxuICAgIGlmIChoYXNPd24odiwga2V5KSlcbiAgICAgIHJldHVybiAhMTtcbiAgcmV0dXJuICEwO1xufVxuZnVuY3Rpb24gb21pdCh2YWwsIHByb3BzKSB7XG4gIGNvbnN0IGNvcHkgPSB7IC4uLnZhbCB9O1xuICBmb3IgKGNvbnN0IHByb3Agb2YgcHJvcHMpXG4gICAgZGVsZXRlIGNvcHlbcHJvcF07XG4gIHJldHVybiBjb3B5O1xufVxuZnVuY3Rpb24gdW5hc3NpZ24ob3AsIGN1cnJlbnRWYWx1ZSkge1xuICBpZiAoIWlzT2JqZWN0KGN1cnJlbnRWYWx1ZSkpXG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGFwcGx5IFwidW5hc3NpZ24oKVwiIG9uIG5vbi1vYmplY3QgdmFsdWUnKTtcbiAgcmV0dXJuIG9wLmtleXMubGVuZ3RoID09PSAwID8gY3VycmVudFZhbHVlIDogb21pdChjdXJyZW50VmFsdWUsIG9wLmtleXMpO1xufVxuZnVuY3Rpb24gYXNzaWduKG9wLCBjdXJyZW50VmFsdWUpIHtcbiAgaWYgKCFpc09iamVjdChjdXJyZW50VmFsdWUpKVxuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBhcHBseSBcImFzc2lnbigpXCIgb24gbm9uLW9iamVjdCB2YWx1ZScpO1xuICByZXR1cm4gaXNFbXB0eShvcC52YWx1ZSkgPyBjdXJyZW50VmFsdWUgOiB7IC4uLmN1cnJlbnRWYWx1ZSwgLi4ub3AudmFsdWUgfTtcbn1cbmZ1bmN0aW9uIGRpZmZNYXRjaFBhdGNoKG9wLCBjdXJyZW50VmFsdWUpIHtcbiAgaWYgKHR5cGVvZiBjdXJyZW50VmFsdWUgIT0gXCJzdHJpbmdcIilcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgYXBwbHkgXCJkaWZmTWF0Y2hQYXRjaCgpXCIgb24gbm9uLXN0cmluZyB2YWx1ZScpO1xuICByZXR1cm4gYXBwbHlQYXRjaGVzJDEocGFyc2VQYXRjaChvcC52YWx1ZSksIGN1cnJlbnRWYWx1ZSlbMF07XG59XG52YXIgb3BlcmF0aW9ucyA9IC8qIEBfX1BVUkVfXyAqLyBPYmplY3QuZnJlZXplKHtcbiAgX19wcm90b19fOiBudWxsLFxuICBhc3NpZ24sXG4gIGRlYyxcbiAgZGlmZk1hdGNoUGF0Y2gsXG4gIGluYyxcbiAgaW5zZXJ0LFxuICByZW1vdmUsXG4gIHJlcGxhY2UsXG4gIHNldCxcbiAgc2V0SWZNaXNzaW5nLFxuICB0cnVuY2F0ZSxcbiAgdW5hc3NpZ24sXG4gIHVuc2V0LFxuICB1cHNlcnRcbn0pO1xuZnVuY3Rpb24gYXBwbHlPcChvcCwgY3VycmVudFZhbHVlKSB7XG4gIGlmICghKG9wLnR5cGUgaW4gb3BlcmF0aW9ucykpXG4gICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIG9wZXJhdGlvbiB0eXBlOiBcIiR7b3AudHlwZX1cImApO1xuICByZXR1cm4gb3BlcmF0aW9uc1tvcC50eXBlXShvcCwgY3VycmVudFZhbHVlKTtcbn1cbmZ1bmN0aW9uIGFwcGx5UGF0Y2hlcyhwYXRjaGVzLCBkb2N1bWVudCkge1xuICByZXR1cm4gcGF0Y2hlcy5yZWR1Y2UoXG4gICAgKHByZXYsIHBhdGNoKSA9PiBhcHBseU5vZGVQYXRjaChwYXRjaCwgcHJldiksXG4gICAgZG9jdW1lbnRcbiAgKTtcbn1cbmZ1bmN0aW9uIGFwcGx5Tm9kZVBhdGNoKHBhdGNoLCBkb2N1bWVudCkge1xuICByZXR1cm4gYXBwbHlBdFBhdGgocGF0Y2gucGF0aCwgcGF0Y2gub3AsIGRvY3VtZW50KTtcbn1cbmZ1bmN0aW9uIGFwcGx5QXRQYXRoKHBhdGgsIG9wLCB2YWx1ZSkge1xuICBpZiAoIWlzTm9uRW1wdHlBcnJheShwYXRoKSlcbiAgICByZXR1cm4gYXBwbHlPcChvcCwgdmFsdWUpO1xuICBjb25zdCBbaGVhZCwgLi4udGFpbF0gPSBwYXRoO1xuICBpZiAoaXNBcnJheUVsZW1lbnQoaGVhZCkgJiYgQXJyYXkuaXNBcnJheSh2YWx1ZSkpXG4gICAgcmV0dXJuIGFwcGx5SW5BcnJheShoZWFkLCB0YWlsLCBvcCwgdmFsdWUpO1xuICBpZiAoaXNQcm9wZXJ0eUVsZW1lbnQoaGVhZCkgJiYgaXNPYmplY3QodmFsdWUpKVxuICAgIHJldHVybiBhcHBseUluT2JqZWN0KGhlYWQsIHRhaWwsIG9wLCB2YWx1ZSk7XG4gIHRocm93IG5ldyBFcnJvcihcbiAgICBgQ2Fubm90IGFwcGx5IG9wZXJhdGlvbiBvZiB0eXBlIFwiJHtvcC50eXBlfVwiIHRvIHBhdGggJHtzdHJpbmdpZnkoXG4gICAgICBwYXRoXG4gICAgKX0gb24gJHt0eXBlb2YgdmFsdWV9IHZhbHVlYFxuICApO1xufVxuZnVuY3Rpb24gYXBwbHlJbk9iamVjdChoZWFkLCB0YWlsLCBvcCwgb2JqZWN0KSB7XG4gIGNvbnN0IGN1cnJlbnQgPSBvYmplY3RbaGVhZF07XG4gIGlmIChjdXJyZW50ID09PSB2b2lkIDAgJiYgdGFpbC5sZW5ndGggPiAwKVxuICAgIHJldHVybiBvYmplY3Q7XG4gIGNvbnN0IHBhdGNoZWRWYWx1ZSA9IGFwcGx5QXRQYXRoKHRhaWwsIG9wLCBjdXJyZW50KTtcbiAgcmV0dXJuIHBhdGNoZWRWYWx1ZSA9PT0gY3VycmVudCA/IG9iamVjdCA6IHsgLi4ub2JqZWN0LCBbaGVhZF06IHBhdGNoZWRWYWx1ZSB9O1xufVxuZnVuY3Rpb24gYXBwbHlJbkFycmF5KGhlYWQsIHRhaWwsIG9wLCB2YWx1ZSkge1xuICBjb25zdCBpbmRleCA9IGZpbmRUYXJnZXRJbmRleCh2YWx1ZSwgaGVhZCk7XG4gIGlmIChpbmRleCA9PT0gbnVsbCB8fCBpbmRleCA9PT0gLTEpXG4gICAgcmV0dXJuIHZhbHVlO1xuICBjb25zdCBjdXJyZW50ID0gdmFsdWVbaW5kZXhdLCBwYXRjaGVkSXRlbSA9IGFwcGx5QXRQYXRoKHRhaWwsIG9wLCBjdXJyZW50KTtcbiAgcmV0dXJuIHBhdGNoZWRJdGVtID09PSBjdXJyZW50ID8gdmFsdWUgOiBzcGxpY2UodmFsdWUsIGluZGV4LCAxLCBbcGF0Y2hlZEl0ZW1dKTtcbn1cbmZ1bmN0aW9uIGlzTm9uRW1wdHlBcnJheShhKSB7XG4gIHJldHVybiBhLmxlbmd0aCA+IDA7XG59XG5mdW5jdGlvbiBhcHBseVBhdGNoTXV0YXRpb24obXV0YXRpb24sIGRvY3VtZW50KSB7XG4gIGlmIChtdXRhdGlvbi5vcHRpb25zPy5pZlJldmlzaW9uICYmIGRvY3VtZW50Ll9yZXYgIT09IG11dGF0aW9uLm9wdGlvbnMuaWZSZXZpc2lvbilcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJSZXZpc2lvbiBtaXNtYXRjaFwiKTtcbiAgaWYgKG11dGF0aW9uLmlkICE9PSBkb2N1bWVudC5faWQpXG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgYERvY3VtZW50IGlkIG1pc21hdGNoLiBSZWZ1c2luZyB0byBhcHBseSBtdXRhdGlvbiBmb3IgZG9jdW1lbnQgd2l0aCBpZD1cIiR7bXV0YXRpb24uaWR9XCIgb24gdGhlIGdpdmVuIGRvY3VtZW50IHdpdGggaWQ9XCIke2RvY3VtZW50Ll9pZH1cImBcbiAgICApO1xuICByZXR1cm4gYXBwbHlQYXRjaGVzKG11dGF0aW9uLnBhdGNoZXMsIGRvY3VtZW50KTtcbn1cbmNvbnN0IHVybEFscGhhYmV0ID0gXCJ1c2VhbmRvbS0yNlQxOTgzNDBQWDc1cHhKQUNLVkVSWU1JTkRCVVNIV09MRl9HUVpiZmdoamtscXZ3eXpyaWN0XCIsIFBPT0xfU0laRV9NVUxUSVBMSUVSID0gMTI4O1xubGV0IHBvb2wsIHBvb2xPZmZzZXQ7XG5mdW5jdGlvbiBmaWxsUG9vbChieXRlcykge1xuICAhcG9vbCB8fCBwb29sLmxlbmd0aCA8IGJ5dGVzID8gKHBvb2wgPSBCdWZmZXIuYWxsb2NVbnNhZmUoYnl0ZXMgKiBQT09MX1NJWkVfTVVMVElQTElFUiksIHdlYmNyeXB0by5nZXRSYW5kb21WYWx1ZXMocG9vbCksIHBvb2xPZmZzZXQgPSAwKSA6IHBvb2xPZmZzZXQgKyBieXRlcyA+IHBvb2wubGVuZ3RoICYmICh3ZWJjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKHBvb2wpLCBwb29sT2Zmc2V0ID0gMCksIHBvb2xPZmZzZXQgKz0gYnl0ZXM7XG59XG5mdW5jdGlvbiBuYW5vaWQoc2l6ZSA9IDIxKSB7XG4gIGZpbGxQb29sKHNpemUgLT0gMCk7XG4gIGxldCBpZCA9IFwiXCI7XG4gIGZvciAobGV0IGkgPSBwb29sT2Zmc2V0IC0gc2l6ZTsgaSA8IHBvb2xPZmZzZXQ7IGkrKylcbiAgICBpZCArPSB1cmxBbHBoYWJldFtwb29sW2ldICYgNjNdO1xuICByZXR1cm4gaWQ7XG59XG5mdW5jdGlvbiBoYXNJZChkb2MpIHtcbiAgcmV0dXJuIFwiX2lkXCIgaW4gZG9jO1xufVxuZnVuY3Rpb24gYXNzaWduSWQoZG9jLCBnZW5lcmF0ZUlkKSB7XG4gIHJldHVybiBoYXNJZChkb2MpID8gZG9jIDogeyAuLi5kb2MsIF9pZDogZ2VuZXJhdGVJZCgpIH07XG59XG5leHBvcnQge1xuICBhcHBseU5vZGVQYXRjaCxcbiAgYXBwbHlPcCxcbiAgYXBwbHlQYXRjaE11dGF0aW9uLFxuICBhcHBseVBhdGNoZXMsXG4gIGFzc2lnbklkLFxuICBoYXNJZCxcbiAgbmFub2lkLFxuICBzcGxpY2Vcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD11dGlscy5qcy5tYXBcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/utils.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_unstable_machine.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_unstable_machine.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   applyMutations: () => (/* reexport safe */ _chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_7__.applyMutations),\n/* harmony export */   commit: () => (/* reexport safe */ _chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_7__.commit),\n/* harmony export */   createSharedListener: () => (/* binding */ createSharedListener),\n/* harmony export */   documentMutatorMachine: () => (/* binding */ documentMutatorMachine),\n/* harmony export */   rebase: () => (/* reexport safe */ _chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_7__.rebase),\n/* harmony export */   squashDMPStrings: () => (/* reexport safe */ _chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_7__.squashDMPStrings),\n/* harmony export */   squashMutationGroups: () => (/* reexport safe */ _chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_7__.squashMutationGroups),\n/* harmony export */   toTransactions: () => (/* reexport safe */ _chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_7__.toTransactions)\n/* harmony export */ });\n/* harmony import */ var _chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./_chunks-es/toTransactions.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/toTransactions.js\");\n/* harmony import */ var mendoza__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! mendoza */ \"(ssr)/./node_modules/mendoza/dist/index.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/rxjs/dist/esm5/internal/operators/share.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/rxjs/dist/esm5/internal/operators/filter.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/rxjs/dist/esm5/internal/observable/merge.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/rxjs/dist/esm5/internal/operators/shareReplay.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/rxjs/dist/esm5/internal/observable/defer.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/rxjs/dist/esm5/internal/operators/observeOn.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/rxjs/dist/esm5/internal/scheduler/asap.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/dist/xstate.development.esm.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/dist/log-0acd9069.development.esm.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/dist/raise-1db27a82.development.esm.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/actors/dist/xstate-actors.development.esm.js\");\n/* harmony import */ var _chunks_es_encode_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./_chunks-es/encode.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/encode.js\");\n\n\n\n\n\nfunction createSharedListener(client) {\n  const allEvents$ = client.listen(\n    '*[!(_id in path(\"_.**\"))]',\n    {},\n    {\n      events: [\"welcome\", \"mutation\", \"reconnect\"],\n      includeResult: !1,\n      includePreviousRevision: !1,\n      visibility: \"transaction\",\n      effectFormat: \"mendoza\",\n      includeMutations: !1\n    }\n  ).pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_0__.share)({ resetOnRefCountZero: !0 })), reconnect = allEvents$.pipe(\n    (0,rxjs__WEBPACK_IMPORTED_MODULE_1__.filter)((event) => event.type === \"reconnect\")\n  ), welcome = allEvents$.pipe(\n    (0,rxjs__WEBPACK_IMPORTED_MODULE_1__.filter)((event) => event.type === \"welcome\")\n  ), mutations = allEvents$.pipe(\n    (0,rxjs__WEBPACK_IMPORTED_MODULE_1__.filter)((event) => event.type === \"mutation\")\n  ), replayWelcome = (0,rxjs__WEBPACK_IMPORTED_MODULE_2__.merge)(welcome, reconnect).pipe(\n    (0,rxjs__WEBPACK_IMPORTED_MODULE_3__.shareReplay)({ bufferSize: 1, refCount: !0 })\n  ).pipe(\n    (0,rxjs__WEBPACK_IMPORTED_MODULE_1__.filter)((latestConnectionEvent) => latestConnectionEvent.type === \"welcome\")\n  );\n  return (0,rxjs__WEBPACK_IMPORTED_MODULE_2__.merge)(replayWelcome, mutations, reconnect);\n}\nconst documentMutatorMachine = (0,xstate__WEBPACK_IMPORTED_MODULE_4__.setup)({\n  types: {},\n  actions: {\n    \"assign error to context\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({ error: ({ event }) => event }),\n    \"clear error from context\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({ error: void 0 }),\n    \"connect to server-sent events\": (0,xstate__WEBPACK_IMPORTED_MODULE_6__.O)({ type: \"connect\" }),\n    \"listen to server-sent events\": (0,xstate__WEBPACK_IMPORTED_MODULE_6__.P)(\"server-sent events\", {\n      id: \"listener\",\n      input: ({ context }) => ({\n        listener: context.sharedListener || createSharedListener(context.client),\n        id: context.id\n      })\n    }),\n    \"stop listening to server-sent events\": (0,xstate__WEBPACK_IMPORTED_MODULE_6__.R)(\"listener\"),\n    \"buffer remote mutation events\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({\n      mutationEvents: ({ event, context }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"mutation\"), [...context.mutationEvents, event])\n    }),\n    \"restore stashed changes\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({\n      stagedChanges: ({ event, context }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"xstate.done.actor.submitTransactions\"), context.stashedChanges),\n      stashedChanges: []\n    }),\n    \"rebase fetched remote snapshot\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.b)(({ enqueue }) => {\n      enqueue.assign(({ event, context }) => {\n        (0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"xstate.done.actor.getDocument\");\n        const previousRemote = context.remote;\n        let nextRemote = event.output, seenCurrentRev = !1;\n        for (const patch of context.mutationEvents)\n          !patch.effects?.apply || !patch.previousRev && patch.transition !== \"appear\" || (!seenCurrentRev && patch.previousRev === nextRemote?._rev && (seenCurrentRev = !0), seenCurrentRev && (nextRemote = applyMendozaPatch(\n            nextRemote,\n            patch.effects.apply,\n            patch.resultRev\n          )));\n        context.cache && // If the shared cache don't have the document already we can just set it\n        (!context.cache.has(context.id) || // But when it's in the cache, make sure it's necessary to update it\n        context.cache.get(context.id)._rev !== nextRemote?._rev) && context.cache.set(context.id, nextRemote);\n        const [stagedChanges, local] = (0,_chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_7__.rebase)(\n          context.id,\n          // It's annoying to convert between null and undefined, reach consensus\n          previousRemote === null ? void 0 : previousRemote,\n          nextRemote === null ? void 0 : nextRemote,\n          context.stagedChanges\n        );\n        return {\n          remote: nextRemote,\n          local,\n          stagedChanges,\n          // Since the snapshot handler applies all the patches they are no longer needed, allow GC\n          mutationEvents: []\n        };\n      }), enqueue.sendParent(\n        ({ context }) => ({\n          type: \"rebased.remote\",\n          id: context.id,\n          document: context.remote\n        })\n      );\n    }),\n    \"apply mendoza patch\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)(({ event, context }) => {\n      (0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"mutation\");\n      const previousRemote = context.remote;\n      if (event.transactionId === previousRemote?._rev)\n        return {};\n      const nextRemote = applyMendozaPatch(\n        previousRemote,\n        event.effects.apply,\n        event.resultRev\n      );\n      context.cache && // If the shared cache don't have the document already we can just set it\n      (!context.cache.has(context.id) || // But when it's in the cache, make sure it's necessary to update it\n      context.cache.get(context.id)._rev !== nextRemote?._rev) && context.cache.set(context.id, nextRemote);\n      const [stagedChanges, local] = (0,_chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_7__.rebase)(\n        context.id,\n        // It's annoying to convert between null and undefined, reach consensus\n        previousRemote === null ? void 0 : previousRemote,\n        nextRemote === null ? void 0 : nextRemote,\n        context.stagedChanges\n      );\n      return {\n        remote: nextRemote,\n        local,\n        stagedChanges\n      };\n    }),\n    \"increment fetch attempts\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({\n      fetchRemoteSnapshotAttempts: ({ context }) => context.fetchRemoteSnapshotAttempts + 1\n    }),\n    \"reset fetch attempts\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({\n      fetchRemoteSnapshotAttempts: 0\n    }),\n    \"increment submit attempts\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({\n      submitTransactionsAttempts: ({ context }) => context.submitTransactionsAttempts + 1\n    }),\n    \"reset submit attempts\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({\n      submitTransactionsAttempts: 0\n    }),\n    \"stage mutation\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({\n      stagedChanges: ({ event, context }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"mutate\"), [\n        ...context.stagedChanges,\n        { transaction: !1, mutations: event.mutations }\n      ])\n    }),\n    \"stash mutation\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.a)({\n      stashedChanges: ({ event, context }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"mutate\"), [\n        ...context.stashedChanges,\n        { transaction: !1, mutations: event.mutations }\n      ])\n    }),\n    \"rebase local snapshot\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.b)(({ enqueue }) => {\n      enqueue.assign({\n        local: ({ event, context }) => {\n          (0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"mutate\");\n          const localDataset = /* @__PURE__ */ new Map();\n          context.local && localDataset.set(context.id, context.local);\n          const results = (0,_chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_7__.applyMutations)(event.mutations, localDataset);\n          return (0,_chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_7__.commit)(results, localDataset), localDataset.get(context.id);\n        }\n      }), enqueue.sendParent(\n        ({ context }) => ({\n          type: \"rebased.local\",\n          id: context.id,\n          document: context.local\n        })\n      );\n    }),\n    \"send pristine event to parent\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.s)(\n      ({ context }) => ({\n        type: \"pristine\",\n        id: context.id\n      })\n    ),\n    \"send sync event to parent\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.s)(\n      ({ context }) => ({\n        type: \"sync\",\n        id: context.id,\n        document: context.remote\n      })\n    ),\n    \"send mutation event to parent\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.s)(({ context, event }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"mutation\"), {\n      type: \"mutation\",\n      id: context.id,\n      previousRev: event.previousRev,\n      resultRev: event.resultRev,\n      effects: event.effects\n    }))\n  },\n  actors: {\n    \"server-sent events\": (0,xstate__WEBPACK_IMPORTED_MODULE_8__.fromEventObservable)(\n      ({\n        input\n      }) => {\n        const { listener, id } = input;\n        return (0,rxjs__WEBPACK_IMPORTED_MODULE_9__.defer)(() => listener).pipe(\n          (0,rxjs__WEBPACK_IMPORTED_MODULE_1__.filter)(\n            (event) => event.type === \"welcome\" || event.type === \"reconnect\" || event.type === \"mutation\" && event.documentId === id\n          ),\n          // This is necessary to avoid sync emitted events from `shareReplay` from happening before the actor is ready to receive them\n          (0,rxjs__WEBPACK_IMPORTED_MODULE_10__.observeOn)(rxjs__WEBPACK_IMPORTED_MODULE_11__.asapScheduler)\n        );\n      }\n    ),\n    \"fetch remote snapshot\": (0,xstate__WEBPACK_IMPORTED_MODULE_8__.fromPromise)(\n      async ({\n        input,\n        signal\n      }) => {\n        const { client, id } = input;\n        return await client.getDocument(id, {\n          signal\n        }).catch((e) => {\n          if (!(e instanceof Error && e.name === \"AbortError\"))\n            throw e;\n        });\n      }\n    ),\n    \"submit mutations as transactions\": (0,xstate__WEBPACK_IMPORTED_MODULE_8__.fromPromise)(\n      async ({\n        input,\n        signal\n      }) => {\n        const { client, transactions } = input;\n        for (const transaction of transactions) {\n          if (signal.aborted) return;\n          await client.dataRequest(\"mutate\", (0,_chunks_es_encode_js__WEBPACK_IMPORTED_MODULE_12__.encodeTransaction)(transaction), {\n            visibility: \"async\",\n            returnDocuments: !1,\n            signal\n          }).catch((e) => {\n            if (!(e instanceof Error && e.name === \"AbortError\"))\n              throw e;\n          });\n        }\n      }\n    )\n  },\n  delays: {\n    // Exponential backoff delay function\n    fetchRemoteSnapshotTimeout: ({ context }) => Math.pow(2, context.fetchRemoteSnapshotAttempts) * 1e3,\n    submitTransactionsTimeout: ({ context }) => Math.pow(2, context.submitTransactionsAttempts) * 1e3\n  }\n}).createMachine({\n  /** @xstate-layout N4IgpgJg5mDOIC5QQPYGMCuBbMA7ALgLRYb4CG+KATgMQnn5gDaADALqKgAOKsAlvj4pcnEAA9EADhYAWAHQA2GSwUBmAKwBOaQEZJkhQBoQAT0Q6ATAF8rx1JhwFipCtTkQ+sNMNxg0jCBpvXF9-Vg4kEB5+QWFRCQQLFhY5PQB2dRU1SQsdGSVjMwRlHTkWNM00nR1VKryKmzt0bDwielcqOWDQwVwoGgB3MAAbbxxw0WiBIRFIhPUKuQ1NVU0tTU0WFdVCxAt1dTlNhX2WdRltGUk061sQexandspO7r9e-qo-H3eJyKnYrNQPNJJollpVutNttdghVCo5MoTgoMpo8jIkqpGvdmo42i4Xl0fv4+H0aGAqFRqH9uLxpnE5ogFrCLFd5CtNBYFJkdOpuaosXcHnjnAw3G9-AAxMh8YYYL5BYn4GlROmA+KIFEs1R6ORpZYWHIXGR6bHC1qijpyL4Sj6DEZjZjsSZqmYaxK1ORcvlc-ZqSoyNKwnRpGTyK4WDK5BQ6BQ5BRm3EW55uG1K0n9ClUqgqgFuxketJe7nIv2rUNB0x7LmSL2qGMsSySevcmSJhzJgnipWQOgEma510M4HmcqHZYyWqaOMqTQyWGh0osVSGiwC5uGyftx74sWvHuBNMhX7O-5DoHiPae72lvnlwPBydFlRVS7qPIl7cilP74-+SByMMKBkB4ZKoL4cikgAbigADWYByDA+AACJJgQg4xPmI7FHkZQrKGsjqKcCiaMG9YpJOxySBiCiyPoX6dnuRJ-gEgHAaBmaUm4XDDBQABm1BYIhYAoWhyqnrSmHDpeCAKCicjUbU6g6nkFichYsJrLWVxaPsk7KdICZCmJlqEraAFASBvbPAOEmqlJF4JJURbVDcy4Yvk1GVkUsabApMjKZGqjNg2kgMU8Xa-j0FnsQBXBUJ4vRgH2DBOhEkn0o5TLKV6y6WDG6lhkYVYIDoKzyBkeR8pUDZqOFu5WuZEBsVZzUeFQ+AmDQsAYAARlgAgYZl7o6I2tYLJINSSO+3JaMGlQpGkhFhryo2jW2xkdhFTFNS1EAAT1-UCHa4EIdBcEIYdA34AAKlQZC4LAZAksIsBDeqBbrdpym8iuByxlcLK5BYqQLBUZyTcFvL1aZ3YsTFrVyFdx0ZuSXGdDx-GCUjfXXXdD1PS9j3vVhMnrWCFRxtNaRLdcfIsiwuS5fkgZaOUlhpDDP7MdFzWWftzXI-gdrPGlLoOSNyiHFstRySisjcgzahyFoUYBbRsac5tO6w1F7wIwLONHfg0qyvKyVfPgVAmCT0kJGt41pJD02xgcpElUkcZ6rI+q5JcckbU0W0NWZB57QduMCKbcoKmIsCpXIZB8YwVAABRC-jj3PYCsA3XwOAoKQACUNDmttjVh-zEfG9H5u21lpVjSrTtTTNbsstUYJJAFWgA37XORTz+t8+xtcKpb1v1+6KJFopGQqRi6nBlstYcqNK5riusYDztlejzKMfJXHCdJynqd8SJaAABYAEpgFgKCMAAyrgZBcLAV+P3nBfF6XJnc7tfmY8xZnglgWGe-klILzUhYDSJVRpnCONNOcWxWRKBRDYO4uAUD7XgJEMuIdqDi2GgWQgOhgxMyRKyFc8IuQkXUDvK0HgvAHmIR9bCD4SoeSWCoLkoZpxrmXIw0OLEMxsNJgkSc418KhnrHyG4oZYTcPhMifhJx4SCiDjrABSpgHiLtogAUhwW77DRIGXkk55wexKCrJQsg1jBTnPsYRqZviiL6PohuORgyhhBhGKMsZYzxhcXrf8EBPHulUJOPCtRlABWIu7IoORVBIIhMpNYGJyghKHmEvaYjQEkOwhkxQrJtBES0JDOBPlkgKD1JYZSjZORyTXNkwBsVwkFPYTJVYS58JxPKbOYM0gUj7FjGcEMOpciaJxMHXWOTWJV2avFRKpIwARILJRGJBF4mZBIkDE0KtIxLSSDkDYGhWl70Ru1Tq6zsLURBkoLyWRmz8PmlUZmcY1zXDKdMghcy2mIyFh8W5ZN4RFmOFyKaZwiLeT2GVJcy5pBrguCiMK2tvyDwBYbIWejOkSMQBkeQORJq0RNCUDIDNondxuGpPQmRqIXPhiPECuKMpdMkbILZ-SEnLxyjqOJMZsj1jRTYIAA */\n  id: \"document-mutator\",\n  context: ({ input }) => ({\n    client: input.client.withConfig({ allowReconfigure: !1 }),\n    sharedListener: input.sharedListener,\n    id: input.id,\n    remote: void 0,\n    local: void 0,\n    mutationEvents: [],\n    stagedChanges: [],\n    stashedChanges: [],\n    error: void 0,\n    fetchRemoteSnapshotAttempts: 0,\n    submitTransactionsAttempts: 0,\n    cache: input.cache\n  }),\n  // Auto start the connection by default\n  entry: [\"connect to server-sent events\"],\n  on: {\n    mutate: {\n      actions: [\"rebase local snapshot\", \"stage mutation\"]\n    }\n  },\n  initial: \"disconnected\",\n  states: {\n    disconnected: {\n      on: {\n        connect: {\n          target: \"connecting\",\n          actions: [\"listen to server-sent events\"]\n        }\n      }\n    },\n    connecting: {\n      on: {\n        welcome: \"connected\",\n        reconnect: \"reconnecting\",\n        error: \"connectFailure\"\n      },\n      tags: [\"busy\"]\n    },\n    connectFailure: {\n      on: {\n        connect: {\n          target: \"connecting\",\n          actions: [\"listen to server-sent events\"]\n        }\n      },\n      entry: [\n        \"stop listening to server-sent events\",\n        \"assign error to context\"\n      ],\n      exit: [\"clear error from context\"],\n      tags: [\"error\"]\n    },\n    reconnecting: {\n      on: {\n        welcome: {\n          target: \"connected\"\n        },\n        error: {\n          target: \"connectFailure\"\n        }\n      },\n      tags: [\"busy\", \"error\"]\n    },\n    connected: {\n      on: {\n        mutation: {\n          actions: [\"buffer remote mutation events\"]\n        },\n        reconnect: \"reconnecting\"\n      },\n      entry: [\"clear error from context\"],\n      initial: \"loading\",\n      states: {\n        loading: {\n          invoke: {\n            src: \"fetch remote snapshot\",\n            id: \"getDocument\",\n            input: ({ context }) => ({\n              client: context.client,\n              id: context.id\n            }),\n            onError: {\n              target: \"loadFailure\"\n            },\n            onDone: {\n              target: \"loaded\",\n              actions: [\n                \"rebase fetched remote snapshot\",\n                \"reset fetch attempts\"\n              ]\n            }\n          },\n          tags: [\"busy\"]\n        },\n        loaded: {\n          entry: [\"send sync event to parent\"],\n          on: {\n            mutation: {\n              actions: [\"apply mendoza patch\", \"send mutation event to parent\"]\n            }\n          },\n          initial: \"pristine\",\n          states: {\n            pristine: {\n              on: {\n                mutate: {\n                  actions: [\"rebase local snapshot\", \"stage mutation\"],\n                  target: \"dirty\"\n                }\n              },\n              tags: [\"ready\"]\n            },\n            dirty: {\n              on: {\n                submit: \"submitting\"\n              },\n              tags: [\"ready\"]\n            },\n            submitting: {\n              on: {\n                mutate: {\n                  actions: [\"rebase local snapshot\", \"stash mutation\"]\n                }\n              },\n              invoke: {\n                src: \"submit mutations as transactions\",\n                id: \"submitTransactions\",\n                input: ({ context }) => {\n                  const remoteDataset = /* @__PURE__ */ new Map();\n                  return remoteDataset.set(context.id, context.remote), {\n                    client: context.client,\n                    transactions: (0,_chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_7__.toTransactions)(\n                      // Squashing DMP strings is the last thing we do before submitting\n                      (0,_chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_7__.squashDMPStrings)(\n                        remoteDataset,\n                        (0,_chunks_es_toTransactions_js__WEBPACK_IMPORTED_MODULE_7__.squashMutationGroups)(context.stagedChanges)\n                      )\n                    )\n                  };\n                },\n                onError: {\n                  target: \"submitFailure\"\n                },\n                onDone: {\n                  target: \"pristine\",\n                  actions: [\n                    \"restore stashed changes\",\n                    \"reset submit attempts\",\n                    \"send pristine event to parent\"\n                  ]\n                }\n              },\n              /**\n               * 'busy' means we should show a spinner, 'ready' means we can still accept mutations, they'll be applied optimistically right away, and queued for submissions after the current submission settles\n               */\n              tags: [\"busy\", \"ready\"]\n            },\n            submitFailure: {\n              exit: [\"clear error from context\"],\n              after: {\n                submitTransactionsTimeout: {\n                  actions: [\"increment submit attempts\"],\n                  target: \"submitting\"\n                }\n              },\n              on: {\n                retry: \"submitting\"\n              },\n              /**\n               * How can it be both `ready` and `error`? `ready` means it can receive mutations, optimistically apply them, and queue them for submission. `error` means it failed to submit previously applied mutations.\n               * It's completely fine to keep queueing up more mutations and applying them optimistically, while showing UI that notifies that mutations didn't submit, and show a count down until the next automatic retry.\n               */\n              tags: [\"error\", \"ready\"]\n            }\n          }\n        },\n        loadFailure: {\n          exit: [\"clear error from context\"],\n          after: {\n            fetchRemoteSnapshotTimeout: {\n              actions: [\"increment fetch attempts\"],\n              target: \"loading\"\n            }\n          },\n          on: {\n            retry: \"loading\"\n          },\n          tags: [\"error\"]\n        }\n      }\n    }\n  }\n});\nfunction applyMendozaPatch(document, patch, nextRevision) {\n  const next = (0,mendoza__WEBPACK_IMPORTED_MODULE_13__.applyPatch)(omitRev(document), patch);\n  return next ? Object.assign(next, { _rev: nextRevision }) : null;\n}\nfunction omitRev(document) {\n  if (!document)\n    return null;\n  const { _rev, ...doc } = document;\n  return doc;\n}\n\n//# sourceMappingURL=_unstable_machine.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvX3Vuc3RhYmxlX21hY2hpbmUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUF3STtBQUNuRztBQUNxRDtBQUNzRDtBQUNyRjtBQUMzRDtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsMkNBQUssR0FBRyx5QkFBeUI7QUFDMUMsSUFBSSw0Q0FBTTtBQUNWO0FBQ0EsSUFBSSw0Q0FBTTtBQUNWO0FBQ0EsSUFBSSw0Q0FBTTtBQUNWLHFCQUFxQiwyQ0FBSztBQUMxQixJQUFJLGlEQUFXLEdBQUcsNkJBQTZCO0FBQy9DO0FBQ0EsSUFBSSw0Q0FBTTtBQUNWO0FBQ0EsU0FBUywyQ0FBSztBQUNkO0FBQ0EsK0JBQStCLDZDQUFLO0FBQ3BDLFdBQVc7QUFDWDtBQUNBLCtCQUErQix5Q0FBTSxHQUFHLFVBQVUsT0FBTyxZQUFZO0FBQ3JFLGdDQUFnQyx5Q0FBTSxHQUFHLGVBQWU7QUFDeEQscUNBQXFDLHlDQUFLLEdBQUcsaUJBQWlCO0FBQzlELG9DQUFvQyx5Q0FBVTtBQUM5QztBQUNBLGdCQUFnQixTQUFTO0FBQ3pCO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMLDRDQUE0Qyx5Q0FBUztBQUNyRCxxQ0FBcUMseUNBQU07QUFDM0MseUJBQXlCLGdCQUFnQixNQUFNLG1EQUFXO0FBQzFELEtBQUs7QUFDTCwrQkFBK0IseUNBQU07QUFDckMsd0JBQXdCLGdCQUFnQixNQUFNLG1EQUFXO0FBQ3pEO0FBQ0EsS0FBSztBQUNMLHNDQUFzQyx5Q0FBYyxJQUFJLFNBQVM7QUFDakUsd0JBQXdCLGdCQUFnQjtBQUN4QyxRQUFRLG1EQUFXO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUMsb0VBQU07QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsV0FBVyxTQUFTO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTCwyQkFBMkIseUNBQU0sSUFBSSxnQkFBZ0I7QUFDckQsTUFBTSxtREFBVztBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLG9FQUFNO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsZ0NBQWdDLHlDQUFNO0FBQ3RDLHNDQUFzQyxTQUFTO0FBQy9DLEtBQUs7QUFDTCw0QkFBNEIseUNBQU07QUFDbEM7QUFDQSxLQUFLO0FBQ0wsaUNBQWlDLHlDQUFNO0FBQ3ZDLHFDQUFxQyxTQUFTO0FBQzlDLEtBQUs7QUFDTCw2QkFBNkIseUNBQU07QUFDbkM7QUFDQSxLQUFLO0FBQ0wsc0JBQXNCLHlDQUFNO0FBQzVCLHdCQUF3QixnQkFBZ0IsTUFBTSxtREFBVztBQUN6RDtBQUNBLFVBQVU7QUFDVjtBQUNBLEtBQUs7QUFDTCxzQkFBc0IseUNBQU07QUFDNUIseUJBQXlCLGdCQUFnQixNQUFNLG1EQUFXO0FBQzFEO0FBQ0EsVUFBVTtBQUNWO0FBQ0EsS0FBSztBQUNMLDZCQUE2Qix5Q0FBYyxJQUFJLFNBQVM7QUFDeEQ7QUFDQSxrQkFBa0IsZ0JBQWdCO0FBQ2xDLFVBQVUsbURBQVc7QUFDckI7QUFDQTtBQUNBLDBCQUEwQiw0RUFBYztBQUN4QyxpQkFBaUIsb0VBQU07QUFDdkI7QUFDQSxPQUFPO0FBQ1AsV0FBVyxTQUFTO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTCxxQ0FBcUMseUNBQVU7QUFDL0MsU0FBUyxTQUFTO0FBQ2xCO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxpQ0FBaUMseUNBQVU7QUFDM0MsU0FBUyxTQUFTO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLHFDQUFxQyx5Q0FBVSxJQUFJLGdCQUFnQixNQUFNLG1EQUFXO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0EsMEJBQTBCLDJEQUFtQjtBQUM3QztBQUNBO0FBQ0EsT0FBTztBQUNQLGdCQUFnQixlQUFlO0FBQy9CLGVBQWUsMkNBQUs7QUFDcEIsVUFBVSw0Q0FBTTtBQUNoQjtBQUNBO0FBQ0E7QUFDQSxVQUFVLGdEQUFTLENBQUMsZ0RBQWE7QUFDakM7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLG1EQUFXO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxnQkFBZ0IsYUFBYTtBQUM3QjtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLHdDQUF3QyxtREFBVztBQUNuRDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsZ0JBQWdCLHVCQUF1QjtBQUN2QztBQUNBO0FBQ0EsNkNBQTZDLHdFQUFpQjtBQUM5RDtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLG1DQUFtQyxTQUFTO0FBQzVDLGtDQUFrQyxTQUFTO0FBQzNDO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxjQUFjLE9BQU87QUFDckIsc0NBQXNDLHNCQUFzQjtBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixTQUFTO0FBQy9CO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsU0FBUztBQUNuQztBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsNEVBQWM7QUFDaEQ7QUFDQSxzQkFBc0IsOEVBQWdCO0FBQ3RDO0FBQ0Esd0JBQXdCLGtGQUFvQjtBQUM1QztBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQSxlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsZUFBZSxvREFBVTtBQUN6QixzQ0FBc0Msb0JBQW9CO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxlQUFlO0FBQ3pCO0FBQ0E7QUFVRTtBQUNGIiwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL25vZGVfbW9kdWxlcy9uZXh0LXNhbml0eS9ub2RlX21vZHVsZXMvQHNhbml0eS9tdXRhdGUvZGlzdC9fdW5zdGFibGVfbWFjaGluZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByZWJhc2UsIGFwcGx5TXV0YXRpb25zLCBjb21taXQsIHRvVHJhbnNhY3Rpb25zLCBzcXVhc2hETVBTdHJpbmdzLCBzcXVhc2hNdXRhdGlvbkdyb3VwcyB9IGZyb20gXCIuL19jaHVua3MtZXMvdG9UcmFuc2FjdGlvbnMuanNcIjtcbmltcG9ydCB7IGFwcGx5UGF0Y2ggfSBmcm9tIFwibWVuZG96YVwiO1xuaW1wb3J0IHsgc2hhcmUsIGZpbHRlciwgbWVyZ2UsIHNoYXJlUmVwbGF5LCBkZWZlciwgb2JzZXJ2ZU9uLCBhc2FwU2NoZWR1bGVyIH0gZnJvbSBcInJ4anNcIjtcbmltcG9ydCB7IHNldHVwLCBhc3NpZ24sIHJhaXNlLCBzcGF3bkNoaWxkLCBzdG9wQ2hpbGQsIGFzc2VydEV2ZW50LCBlbnF1ZXVlQWN0aW9ucywgc2VuZFBhcmVudCwgZnJvbUV2ZW50T2JzZXJ2YWJsZSwgZnJvbVByb21pc2UgfSBmcm9tIFwieHN0YXRlXCI7XG5pbXBvcnQgeyBlbmNvZGVUcmFuc2FjdGlvbiB9IGZyb20gXCIuL19jaHVua3MtZXMvZW5jb2RlLmpzXCI7XG5mdW5jdGlvbiBjcmVhdGVTaGFyZWRMaXN0ZW5lcihjbGllbnQpIHtcbiAgY29uc3QgYWxsRXZlbnRzJCA9IGNsaWVudC5saXN0ZW4oXG4gICAgJypbIShfaWQgaW4gcGF0aChcIl8uKipcIikpXScsXG4gICAge30sXG4gICAge1xuICAgICAgZXZlbnRzOiBbXCJ3ZWxjb21lXCIsIFwibXV0YXRpb25cIiwgXCJyZWNvbm5lY3RcIl0sXG4gICAgICBpbmNsdWRlUmVzdWx0OiAhMSxcbiAgICAgIGluY2x1ZGVQcmV2aW91c1JldmlzaW9uOiAhMSxcbiAgICAgIHZpc2liaWxpdHk6IFwidHJhbnNhY3Rpb25cIixcbiAgICAgIGVmZmVjdEZvcm1hdDogXCJtZW5kb3phXCIsXG4gICAgICBpbmNsdWRlTXV0YXRpb25zOiAhMVxuICAgIH1cbiAgKS5waXBlKHNoYXJlKHsgcmVzZXRPblJlZkNvdW50WmVybzogITAgfSkpLCByZWNvbm5lY3QgPSBhbGxFdmVudHMkLnBpcGUoXG4gICAgZmlsdGVyKChldmVudCkgPT4gZXZlbnQudHlwZSA9PT0gXCJyZWNvbm5lY3RcIilcbiAgKSwgd2VsY29tZSA9IGFsbEV2ZW50cyQucGlwZShcbiAgICBmaWx0ZXIoKGV2ZW50KSA9PiBldmVudC50eXBlID09PSBcIndlbGNvbWVcIilcbiAgKSwgbXV0YXRpb25zID0gYWxsRXZlbnRzJC5waXBlKFxuICAgIGZpbHRlcigoZXZlbnQpID0+IGV2ZW50LnR5cGUgPT09IFwibXV0YXRpb25cIilcbiAgKSwgcmVwbGF5V2VsY29tZSA9IG1lcmdlKHdlbGNvbWUsIHJlY29ubmVjdCkucGlwZShcbiAgICBzaGFyZVJlcGxheSh7IGJ1ZmZlclNpemU6IDEsIHJlZkNvdW50OiAhMCB9KVxuICApLnBpcGUoXG4gICAgZmlsdGVyKChsYXRlc3RDb25uZWN0aW9uRXZlbnQpID0+IGxhdGVzdENvbm5lY3Rpb25FdmVudC50eXBlID09PSBcIndlbGNvbWVcIilcbiAgKTtcbiAgcmV0dXJuIG1lcmdlKHJlcGxheVdlbGNvbWUsIG11dGF0aW9ucywgcmVjb25uZWN0KTtcbn1cbmNvbnN0IGRvY3VtZW50TXV0YXRvck1hY2hpbmUgPSBzZXR1cCh7XG4gIHR5cGVzOiB7fSxcbiAgYWN0aW9uczoge1xuICAgIFwiYXNzaWduIGVycm9yIHRvIGNvbnRleHRcIjogYXNzaWduKHsgZXJyb3I6ICh7IGV2ZW50IH0pID0+IGV2ZW50IH0pLFxuICAgIFwiY2xlYXIgZXJyb3IgZnJvbSBjb250ZXh0XCI6IGFzc2lnbih7IGVycm9yOiB2b2lkIDAgfSksXG4gICAgXCJjb25uZWN0IHRvIHNlcnZlci1zZW50IGV2ZW50c1wiOiByYWlzZSh7IHR5cGU6IFwiY29ubmVjdFwiIH0pLFxuICAgIFwibGlzdGVuIHRvIHNlcnZlci1zZW50IGV2ZW50c1wiOiBzcGF3bkNoaWxkKFwic2VydmVyLXNlbnQgZXZlbnRzXCIsIHtcbiAgICAgIGlkOiBcImxpc3RlbmVyXCIsXG4gICAgICBpbnB1dDogKHsgY29udGV4dCB9KSA9PiAoe1xuICAgICAgICBsaXN0ZW5lcjogY29udGV4dC5zaGFyZWRMaXN0ZW5lciB8fCBjcmVhdGVTaGFyZWRMaXN0ZW5lcihjb250ZXh0LmNsaWVudCksXG4gICAgICAgIGlkOiBjb250ZXh0LmlkXG4gICAgICB9KVxuICAgIH0pLFxuICAgIFwic3RvcCBsaXN0ZW5pbmcgdG8gc2VydmVyLXNlbnQgZXZlbnRzXCI6IHN0b3BDaGlsZChcImxpc3RlbmVyXCIpLFxuICAgIFwiYnVmZmVyIHJlbW90ZSBtdXRhdGlvbiBldmVudHNcIjogYXNzaWduKHtcbiAgICAgIG11dGF0aW9uRXZlbnRzOiAoeyBldmVudCwgY29udGV4dCB9KSA9PiAoYXNzZXJ0RXZlbnQoZXZlbnQsIFwibXV0YXRpb25cIiksIFsuLi5jb250ZXh0Lm11dGF0aW9uRXZlbnRzLCBldmVudF0pXG4gICAgfSksXG4gICAgXCJyZXN0b3JlIHN0YXNoZWQgY2hhbmdlc1wiOiBhc3NpZ24oe1xuICAgICAgc3RhZ2VkQ2hhbmdlczogKHsgZXZlbnQsIGNvbnRleHQgfSkgPT4gKGFzc2VydEV2ZW50KGV2ZW50LCBcInhzdGF0ZS5kb25lLmFjdG9yLnN1Ym1pdFRyYW5zYWN0aW9uc1wiKSwgY29udGV4dC5zdGFzaGVkQ2hhbmdlcyksXG4gICAgICBzdGFzaGVkQ2hhbmdlczogW11cbiAgICB9KSxcbiAgICBcInJlYmFzZSBmZXRjaGVkIHJlbW90ZSBzbmFwc2hvdFwiOiBlbnF1ZXVlQWN0aW9ucygoeyBlbnF1ZXVlIH0pID0+IHtcbiAgICAgIGVucXVldWUuYXNzaWduKCh7IGV2ZW50LCBjb250ZXh0IH0pID0+IHtcbiAgICAgICAgYXNzZXJ0RXZlbnQoZXZlbnQsIFwieHN0YXRlLmRvbmUuYWN0b3IuZ2V0RG9jdW1lbnRcIik7XG4gICAgICAgIGNvbnN0IHByZXZpb3VzUmVtb3RlID0gY29udGV4dC5yZW1vdGU7XG4gICAgICAgIGxldCBuZXh0UmVtb3RlID0gZXZlbnQub3V0cHV0LCBzZWVuQ3VycmVudFJldiA9ICExO1xuICAgICAgICBmb3IgKGNvbnN0IHBhdGNoIG9mIGNvbnRleHQubXV0YXRpb25FdmVudHMpXG4gICAgICAgICAgIXBhdGNoLmVmZmVjdHM/LmFwcGx5IHx8ICFwYXRjaC5wcmV2aW91c1JldiAmJiBwYXRjaC50cmFuc2l0aW9uICE9PSBcImFwcGVhclwiIHx8ICghc2VlbkN1cnJlbnRSZXYgJiYgcGF0Y2gucHJldmlvdXNSZXYgPT09IG5leHRSZW1vdGU/Ll9yZXYgJiYgKHNlZW5DdXJyZW50UmV2ID0gITApLCBzZWVuQ3VycmVudFJldiAmJiAobmV4dFJlbW90ZSA9IGFwcGx5TWVuZG96YVBhdGNoKFxuICAgICAgICAgICAgbmV4dFJlbW90ZSxcbiAgICAgICAgICAgIHBhdGNoLmVmZmVjdHMuYXBwbHksXG4gICAgICAgICAgICBwYXRjaC5yZXN1bHRSZXZcbiAgICAgICAgICApKSk7XG4gICAgICAgIGNvbnRleHQuY2FjaGUgJiYgLy8gSWYgdGhlIHNoYXJlZCBjYWNoZSBkb24ndCBoYXZlIHRoZSBkb2N1bWVudCBhbHJlYWR5IHdlIGNhbiBqdXN0IHNldCBpdFxuICAgICAgICAoIWNvbnRleHQuY2FjaGUuaGFzKGNvbnRleHQuaWQpIHx8IC8vIEJ1dCB3aGVuIGl0J3MgaW4gdGhlIGNhY2hlLCBtYWtlIHN1cmUgaXQncyBuZWNlc3NhcnkgdG8gdXBkYXRlIGl0XG4gICAgICAgIGNvbnRleHQuY2FjaGUuZ2V0KGNvbnRleHQuaWQpLl9yZXYgIT09IG5leHRSZW1vdGU/Ll9yZXYpICYmIGNvbnRleHQuY2FjaGUuc2V0KGNvbnRleHQuaWQsIG5leHRSZW1vdGUpO1xuICAgICAgICBjb25zdCBbc3RhZ2VkQ2hhbmdlcywgbG9jYWxdID0gcmViYXNlKFxuICAgICAgICAgIGNvbnRleHQuaWQsXG4gICAgICAgICAgLy8gSXQncyBhbm5veWluZyB0byBjb252ZXJ0IGJldHdlZW4gbnVsbCBhbmQgdW5kZWZpbmVkLCByZWFjaCBjb25zZW5zdXNcbiAgICAgICAgICBwcmV2aW91c1JlbW90ZSA9PT0gbnVsbCA/IHZvaWQgMCA6IHByZXZpb3VzUmVtb3RlLFxuICAgICAgICAgIG5leHRSZW1vdGUgPT09IG51bGwgPyB2b2lkIDAgOiBuZXh0UmVtb3RlLFxuICAgICAgICAgIGNvbnRleHQuc3RhZ2VkQ2hhbmdlc1xuICAgICAgICApO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJlbW90ZTogbmV4dFJlbW90ZSxcbiAgICAgICAgICBsb2NhbCxcbiAgICAgICAgICBzdGFnZWRDaGFuZ2VzLFxuICAgICAgICAgIC8vIFNpbmNlIHRoZSBzbmFwc2hvdCBoYW5kbGVyIGFwcGxpZXMgYWxsIHRoZSBwYXRjaGVzIHRoZXkgYXJlIG5vIGxvbmdlciBuZWVkZWQsIGFsbG93IEdDXG4gICAgICAgICAgbXV0YXRpb25FdmVudHM6IFtdXG4gICAgICAgIH07XG4gICAgICB9KSwgZW5xdWV1ZS5zZW5kUGFyZW50KFxuICAgICAgICAoeyBjb250ZXh0IH0pID0+ICh7XG4gICAgICAgICAgdHlwZTogXCJyZWJhc2VkLnJlbW90ZVwiLFxuICAgICAgICAgIGlkOiBjb250ZXh0LmlkLFxuICAgICAgICAgIGRvY3VtZW50OiBjb250ZXh0LnJlbW90ZVxuICAgICAgICB9KVxuICAgICAgKTtcbiAgICB9KSxcbiAgICBcImFwcGx5IG1lbmRvemEgcGF0Y2hcIjogYXNzaWduKCh7IGV2ZW50LCBjb250ZXh0IH0pID0+IHtcbiAgICAgIGFzc2VydEV2ZW50KGV2ZW50LCBcIm11dGF0aW9uXCIpO1xuICAgICAgY29uc3QgcHJldmlvdXNSZW1vdGUgPSBjb250ZXh0LnJlbW90ZTtcbiAgICAgIGlmIChldmVudC50cmFuc2FjdGlvbklkID09PSBwcmV2aW91c1JlbW90ZT8uX3JldilcbiAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgY29uc3QgbmV4dFJlbW90ZSA9IGFwcGx5TWVuZG96YVBhdGNoKFxuICAgICAgICBwcmV2aW91c1JlbW90ZSxcbiAgICAgICAgZXZlbnQuZWZmZWN0cy5hcHBseSxcbiAgICAgICAgZXZlbnQucmVzdWx0UmV2XG4gICAgICApO1xuICAgICAgY29udGV4dC5jYWNoZSAmJiAvLyBJZiB0aGUgc2hhcmVkIGNhY2hlIGRvbid0IGhhdmUgdGhlIGRvY3VtZW50IGFscmVhZHkgd2UgY2FuIGp1c3Qgc2V0IGl0XG4gICAgICAoIWNvbnRleHQuY2FjaGUuaGFzKGNvbnRleHQuaWQpIHx8IC8vIEJ1dCB3aGVuIGl0J3MgaW4gdGhlIGNhY2hlLCBtYWtlIHN1cmUgaXQncyBuZWNlc3NhcnkgdG8gdXBkYXRlIGl0XG4gICAgICBjb250ZXh0LmNhY2hlLmdldChjb250ZXh0LmlkKS5fcmV2ICE9PSBuZXh0UmVtb3RlPy5fcmV2KSAmJiBjb250ZXh0LmNhY2hlLnNldChjb250ZXh0LmlkLCBuZXh0UmVtb3RlKTtcbiAgICAgIGNvbnN0IFtzdGFnZWRDaGFuZ2VzLCBsb2NhbF0gPSByZWJhc2UoXG4gICAgICAgIGNvbnRleHQuaWQsXG4gICAgICAgIC8vIEl0J3MgYW5ub3lpbmcgdG8gY29udmVydCBiZXR3ZWVuIG51bGwgYW5kIHVuZGVmaW5lZCwgcmVhY2ggY29uc2Vuc3VzXG4gICAgICAgIHByZXZpb3VzUmVtb3RlID09PSBudWxsID8gdm9pZCAwIDogcHJldmlvdXNSZW1vdGUsXG4gICAgICAgIG5leHRSZW1vdGUgPT09IG51bGwgPyB2b2lkIDAgOiBuZXh0UmVtb3RlLFxuICAgICAgICBjb250ZXh0LnN0YWdlZENoYW5nZXNcbiAgICAgICk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByZW1vdGU6IG5leHRSZW1vdGUsXG4gICAgICAgIGxvY2FsLFxuICAgICAgICBzdGFnZWRDaGFuZ2VzXG4gICAgICB9O1xuICAgIH0pLFxuICAgIFwiaW5jcmVtZW50IGZldGNoIGF0dGVtcHRzXCI6IGFzc2lnbih7XG4gICAgICBmZXRjaFJlbW90ZVNuYXBzaG90QXR0ZW1wdHM6ICh7IGNvbnRleHQgfSkgPT4gY29udGV4dC5mZXRjaFJlbW90ZVNuYXBzaG90QXR0ZW1wdHMgKyAxXG4gICAgfSksXG4gICAgXCJyZXNldCBmZXRjaCBhdHRlbXB0c1wiOiBhc3NpZ24oe1xuICAgICAgZmV0Y2hSZW1vdGVTbmFwc2hvdEF0dGVtcHRzOiAwXG4gICAgfSksXG4gICAgXCJpbmNyZW1lbnQgc3VibWl0IGF0dGVtcHRzXCI6IGFzc2lnbih7XG4gICAgICBzdWJtaXRUcmFuc2FjdGlvbnNBdHRlbXB0czogKHsgY29udGV4dCB9KSA9PiBjb250ZXh0LnN1Ym1pdFRyYW5zYWN0aW9uc0F0dGVtcHRzICsgMVxuICAgIH0pLFxuICAgIFwicmVzZXQgc3VibWl0IGF0dGVtcHRzXCI6IGFzc2lnbih7XG4gICAgICBzdWJtaXRUcmFuc2FjdGlvbnNBdHRlbXB0czogMFxuICAgIH0pLFxuICAgIFwic3RhZ2UgbXV0YXRpb25cIjogYXNzaWduKHtcbiAgICAgIHN0YWdlZENoYW5nZXM6ICh7IGV2ZW50LCBjb250ZXh0IH0pID0+IChhc3NlcnRFdmVudChldmVudCwgXCJtdXRhdGVcIiksIFtcbiAgICAgICAgLi4uY29udGV4dC5zdGFnZWRDaGFuZ2VzLFxuICAgICAgICB7IHRyYW5zYWN0aW9uOiAhMSwgbXV0YXRpb25zOiBldmVudC5tdXRhdGlvbnMgfVxuICAgICAgXSlcbiAgICB9KSxcbiAgICBcInN0YXNoIG11dGF0aW9uXCI6IGFzc2lnbih7XG4gICAgICBzdGFzaGVkQ2hhbmdlczogKHsgZXZlbnQsIGNvbnRleHQgfSkgPT4gKGFzc2VydEV2ZW50KGV2ZW50LCBcIm11dGF0ZVwiKSwgW1xuICAgICAgICAuLi5jb250ZXh0LnN0YXNoZWRDaGFuZ2VzLFxuICAgICAgICB7IHRyYW5zYWN0aW9uOiAhMSwgbXV0YXRpb25zOiBldmVudC5tdXRhdGlvbnMgfVxuICAgICAgXSlcbiAgICB9KSxcbiAgICBcInJlYmFzZSBsb2NhbCBzbmFwc2hvdFwiOiBlbnF1ZXVlQWN0aW9ucygoeyBlbnF1ZXVlIH0pID0+IHtcbiAgICAgIGVucXVldWUuYXNzaWduKHtcbiAgICAgICAgbG9jYWw6ICh7IGV2ZW50LCBjb250ZXh0IH0pID0+IHtcbiAgICAgICAgICBhc3NlcnRFdmVudChldmVudCwgXCJtdXRhdGVcIik7XG4gICAgICAgICAgY29uc3QgbG9jYWxEYXRhc2V0ID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgICAgICAgICBjb250ZXh0LmxvY2FsICYmIGxvY2FsRGF0YXNldC5zZXQoY29udGV4dC5pZCwgY29udGV4dC5sb2NhbCk7XG4gICAgICAgICAgY29uc3QgcmVzdWx0cyA9IGFwcGx5TXV0YXRpb25zKGV2ZW50Lm11dGF0aW9ucywgbG9jYWxEYXRhc2V0KTtcbiAgICAgICAgICByZXR1cm4gY29tbWl0KHJlc3VsdHMsIGxvY2FsRGF0YXNldCksIGxvY2FsRGF0YXNldC5nZXQoY29udGV4dC5pZCk7XG4gICAgICAgIH1cbiAgICAgIH0pLCBlbnF1ZXVlLnNlbmRQYXJlbnQoXG4gICAgICAgICh7IGNvbnRleHQgfSkgPT4gKHtcbiAgICAgICAgICB0eXBlOiBcInJlYmFzZWQubG9jYWxcIixcbiAgICAgICAgICBpZDogY29udGV4dC5pZCxcbiAgICAgICAgICBkb2N1bWVudDogY29udGV4dC5sb2NhbFxuICAgICAgICB9KVxuICAgICAgKTtcbiAgICB9KSxcbiAgICBcInNlbmQgcHJpc3RpbmUgZXZlbnQgdG8gcGFyZW50XCI6IHNlbmRQYXJlbnQoXG4gICAgICAoeyBjb250ZXh0IH0pID0+ICh7XG4gICAgICAgIHR5cGU6IFwicHJpc3RpbmVcIixcbiAgICAgICAgaWQ6IGNvbnRleHQuaWRcbiAgICAgIH0pXG4gICAgKSxcbiAgICBcInNlbmQgc3luYyBldmVudCB0byBwYXJlbnRcIjogc2VuZFBhcmVudChcbiAgICAgICh7IGNvbnRleHQgfSkgPT4gKHtcbiAgICAgICAgdHlwZTogXCJzeW5jXCIsXG4gICAgICAgIGlkOiBjb250ZXh0LmlkLFxuICAgICAgICBkb2N1bWVudDogY29udGV4dC5yZW1vdGVcbiAgICAgIH0pXG4gICAgKSxcbiAgICBcInNlbmQgbXV0YXRpb24gZXZlbnQgdG8gcGFyZW50XCI6IHNlbmRQYXJlbnQoKHsgY29udGV4dCwgZXZlbnQgfSkgPT4gKGFzc2VydEV2ZW50KGV2ZW50LCBcIm11dGF0aW9uXCIpLCB7XG4gICAgICB0eXBlOiBcIm11dGF0aW9uXCIsXG4gICAgICBpZDogY29udGV4dC5pZCxcbiAgICAgIHByZXZpb3VzUmV2OiBldmVudC5wcmV2aW91c1JldixcbiAgICAgIHJlc3VsdFJldjogZXZlbnQucmVzdWx0UmV2LFxuICAgICAgZWZmZWN0czogZXZlbnQuZWZmZWN0c1xuICAgIH0pKVxuICB9LFxuICBhY3RvcnM6IHtcbiAgICBcInNlcnZlci1zZW50IGV2ZW50c1wiOiBmcm9tRXZlbnRPYnNlcnZhYmxlKFxuICAgICAgKHtcbiAgICAgICAgaW5wdXRcbiAgICAgIH0pID0+IHtcbiAgICAgICAgY29uc3QgeyBsaXN0ZW5lciwgaWQgfSA9IGlucHV0O1xuICAgICAgICByZXR1cm4gZGVmZXIoKCkgPT4gbGlzdGVuZXIpLnBpcGUoXG4gICAgICAgICAgZmlsdGVyKFxuICAgICAgICAgICAgKGV2ZW50KSA9PiBldmVudC50eXBlID09PSBcIndlbGNvbWVcIiB8fCBldmVudC50eXBlID09PSBcInJlY29ubmVjdFwiIHx8IGV2ZW50LnR5cGUgPT09IFwibXV0YXRpb25cIiAmJiBldmVudC5kb2N1bWVudElkID09PSBpZFxuICAgICAgICAgICksXG4gICAgICAgICAgLy8gVGhpcyBpcyBuZWNlc3NhcnkgdG8gYXZvaWQgc3luYyBlbWl0dGVkIGV2ZW50cyBmcm9tIGBzaGFyZVJlcGxheWAgZnJvbSBoYXBwZW5pbmcgYmVmb3JlIHRoZSBhY3RvciBpcyByZWFkeSB0byByZWNlaXZlIHRoZW1cbiAgICAgICAgICBvYnNlcnZlT24oYXNhcFNjaGVkdWxlcilcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICApLFxuICAgIFwiZmV0Y2ggcmVtb3RlIHNuYXBzaG90XCI6IGZyb21Qcm9taXNlKFxuICAgICAgYXN5bmMgKHtcbiAgICAgICAgaW5wdXQsXG4gICAgICAgIHNpZ25hbFxuICAgICAgfSkgPT4ge1xuICAgICAgICBjb25zdCB7IGNsaWVudCwgaWQgfSA9IGlucHV0O1xuICAgICAgICByZXR1cm4gYXdhaXQgY2xpZW50LmdldERvY3VtZW50KGlkLCB7XG4gICAgICAgICAgc2lnbmFsXG4gICAgICAgIH0pLmNhdGNoKChlKSA9PiB7XG4gICAgICAgICAgaWYgKCEoZSBpbnN0YW5jZW9mIEVycm9yICYmIGUubmFtZSA9PT0gXCJBYm9ydEVycm9yXCIpKVxuICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgKSxcbiAgICBcInN1Ym1pdCBtdXRhdGlvbnMgYXMgdHJhbnNhY3Rpb25zXCI6IGZyb21Qcm9taXNlKFxuICAgICAgYXN5bmMgKHtcbiAgICAgICAgaW5wdXQsXG4gICAgICAgIHNpZ25hbFxuICAgICAgfSkgPT4ge1xuICAgICAgICBjb25zdCB7IGNsaWVudCwgdHJhbnNhY3Rpb25zIH0gPSBpbnB1dDtcbiAgICAgICAgZm9yIChjb25zdCB0cmFuc2FjdGlvbiBvZiB0cmFuc2FjdGlvbnMpIHtcbiAgICAgICAgICBpZiAoc2lnbmFsLmFib3J0ZWQpIHJldHVybjtcbiAgICAgICAgICBhd2FpdCBjbGllbnQuZGF0YVJlcXVlc3QoXCJtdXRhdGVcIiwgZW5jb2RlVHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pLCB7XG4gICAgICAgICAgICB2aXNpYmlsaXR5OiBcImFzeW5jXCIsXG4gICAgICAgICAgICByZXR1cm5Eb2N1bWVudHM6ICExLFxuICAgICAgICAgICAgc2lnbmFsXG4gICAgICAgICAgfSkuY2F0Y2goKGUpID0+IHtcbiAgICAgICAgICAgIGlmICghKGUgaW5zdGFuY2VvZiBFcnJvciAmJiBlLm5hbWUgPT09IFwiQWJvcnRFcnJvclwiKSlcbiAgICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIClcbiAgfSxcbiAgZGVsYXlzOiB7XG4gICAgLy8gRXhwb25lbnRpYWwgYmFja29mZiBkZWxheSBmdW5jdGlvblxuICAgIGZldGNoUmVtb3RlU25hcHNob3RUaW1lb3V0OiAoeyBjb250ZXh0IH0pID0+IE1hdGgucG93KDIsIGNvbnRleHQuZmV0Y2hSZW1vdGVTbmFwc2hvdEF0dGVtcHRzKSAqIDFlMyxcbiAgICBzdWJtaXRUcmFuc2FjdGlvbnNUaW1lb3V0OiAoeyBjb250ZXh0IH0pID0+IE1hdGgucG93KDIsIGNvbnRleHQuc3VibWl0VHJhbnNhY3Rpb25zQXR0ZW1wdHMpICogMWUzXG4gIH1cbn0pLmNyZWF0ZU1hY2hpbmUoe1xuICAvKiogQHhzdGF0ZS1sYXlvdXQgTjRJZ3BnSmc1bURPSUM1UVFQWUdNQ3VCYk1BN0FMZ0xSWWI0Q0crS0FUZ01Rbm41Z0RhQURBTHFLZ0FPS3NBbHZqNHBjbkVBQTlFQURoWUFXQUhRQTJHU3dVQm1BS3dCT2FRRVpKa2hRQm9RQVQwUTZBVEFGOHJ4MUpod0ZpcEN0VGtRK3NOTU54ZzBqQ0JwdlhGOS1WZzRrRUI1K1FXRlJDUVFMRmhZNVBRQjJkUlUxU1FzZEdTVmpNd1JsSFRrV05NMDBuUjFWS3J5S216dDBiRHdpZWxjcU9XRFF3VndvR2dCM01BQWJieHh3MFdpQklSRkloUFVLdVExTlZVMHRUVTBXRmRWQ3hBdDFkVGxOaFgyV2RSbHRHVWswNjFzUWV4YW5kc3BPN3I5ZS1xby1IM2VKeUtuWXJOUVBOSkpvbGxwVnV0TnR0ZGdoVkNvNU1vVGdvTXBvOGpJa3FwR3ZkbW80Mmk0WGwwZnY0K0gwYUdBcUZScUg5dUx4cG5FNW9nRnJDTEZkNUN0TkJZRkprZE9wdWFvc1hjSG5qbkF3M0c5LUFBeE1oOFlZWUw1QlluNEdsUk9tQStLSUZFczFSNk9ScFpZV0hJWEdSNmJIQzFxaWpweUw0U2o2REVaalpqc1NacW1ZYXhLMU9SY3ZsYy1acVNveU5Ld25ScEdUeUs0V0RLNUJRNkJRNUJSbTNFVzU1dUcxSzBuOUNsVXFncWdGdXhrZXRKZTduSXYyclVOQjB4N0xtU0wycUdNc1N5U2V2Y21TSmh6SmduaXBXUU9nRW1hNTEwTTRIbWNxSFpZeVdxYU9NcVRReVdHaDBvc1ZTR2l3QzV1R3lmdHg3NHNXdkh1Qk5NaFg3Ty01RG9IaVBhZTcybHZubHdQQnlkRmxSVlM3cVBJbDdjaWxQNzQtK1NCeU1NS0JrQjRaS29MNGNpa2dBYmlnQURXWUJ5REErQUFDSkpnUWc0eFBtSTdGSGtaUXJLR3NqcUtjQ2lhTUc5WXBKT3h5U0JpQ2l5UG9YNmRudVJKLWdFZ0hBYUJtYVVtNFhEREJRQUJtMUJZSWhZQW9XaHlxbnJTbUhEcGVDQUtDaWNqVWJVNmc2bmtGaWNoWXNKckxXVnhhUHNrN0tkSUNaQ21KbHFFcmFBRkFTQnZiUEFPRW1xbEpGNEpKVVJiVkRjeTRZdmsxR1ZrVXNhYkFwTWpLWkdxak5nMmtnTVU4WGEtajBGbnNRQlhCVUo0dlJnSDJEQk9oRWtuMG81VExLVjZ5NldERzZsaGtZVllJRG9LenlCa2VSOHBVRFpxT0Z1NVd1WkVCc1ZaelVlRlErQW1EUXNBWUFBUmxnQWdZWmw3bzZJMnRZTEpJTlNTTyszSmFNR2xRcEdraEZocnlvMmpXMnhrZGhGVEZOUzFFQUFUMS1VQ0hhNEVJZEJjRUlZZEEzNEFBS2xRWkM0TEFaQWtzSXNCRGVxQmJyZHB5bThpdUJ5eGxjTEs1QllxUUxCVVp5VGNGdkwxYVozWXNURnJWeUZkeDBadVNYR2REeC1HQ1VqZlhYWGREMVBTOWozdlZoTW5yV0NGUnh0TmFSTGRjZklzaXd1UzVma2daYU9VbGhwRERQN01kRnpXV2Z0elhJLWdkclBHbExvT1NOeWlIRnN0UnlTaXNqY2d6YWh5Rm9VWUJiUnNhYzV0TzZ3MUY3d0l3TE9OSGZnMHF5dkt5VmZQZ1ZBbUNUMGtKR3Q0MXBKRDAyeGdjcEVsVWtjWjZySStxNUpjY2tiVTBXME5XWkI1N1FkdU1DS2Jjb0ttSXNDcFhJWkI4WXdWQUFCUkMtamozUFlDc0EzWHdPQW9LUUFDVU5EbXR0alZoLXpFZkc5SDV1MjFscFZqU3JUdFRUTmJzc3RVWUpKQUZXZ0EzN1hPUlR6K3Q4K3h0Y0twYjF2MSs2S0pGb3BHUXFSaTZuQmxzdFljcU5LNXJpdXNZRHp0bGVqektNZkpYSENkSnlucWQ4U0phQUFCWUFFcGdGZ0tDTUFBeXJnWkJjTEFWK1AzbkJmRjZYSm5jN3RmbVk4eFpuZ2xnV0dlLWtsSUx6VWhZRFNKVlJwbkNPTk5PY1d4V1JLQlJEWU80dUFVRDdYZ0pFTXVJZHFEaTJHZ1dRZ09oZ3hNeVJLeUZjOEl1UWtYVUR2SzBIZ3ZBSG1JUjliQ0Q0U29lU1dDb0xrb1pweHJtWEl3ME9MRU14c05KZ2tTYzQxOEtobnJIeUc0b1pZVGNQaE1pZmhKeDRTQ2lEanJBQlNwZ0hpTHRvZ0FVaHdXNzdEUklHWGtrNTV3ZXhLQ3JKUXNnMWpCVG5Qc1lScVp2aWlMNlBvaHVPUmd5aGhCaEdLTXNaWXp4aGNYcmY4RUJQSHVsVUpPUEN0UmxBQldJdTdJb09SVkJJSWhNcE5ZR0p5Z2hLSG1FdmFZalFFa093aGt4UXJKdEJFUzBKRE9CUGxrZ0tEMUpZWlNqWk9SeVRYTmt3QnNWd2tGUFlUSlZZUzU4SnhQS2JPWU0wZ1VqN0ZqR2NFTU9wY2lhSnhNSFhXT1RXSlYyYXZGUktwSXdBUklMSlJHSkJGNG1aQklrREUwS3RJeExTU0RrRFlHaFdsNzBSdTFUcTZ6c0xVUkJrb0x5V1JtejhQbWxVWm1jWTF6WERLZE1naGN5Mm1JeUZoOFc1Wk40UkZtT0Z5S2Fad2lMZVQyR1ZKY3k1cEJyZ3VDaU1LMnR2eUR3QlliSVdlak9rU01RQmtlUU9SSnEwUk5DVURJRE5vbmR4dUdwUFFtUnFJWFBoaVBFQ3VLTXBkTWtiSUxaLVNFbkx4eWpxT0pNWnNqMWpSVFlJQUEgKi9cbiAgaWQ6IFwiZG9jdW1lbnQtbXV0YXRvclwiLFxuICBjb250ZXh0OiAoeyBpbnB1dCB9KSA9PiAoe1xuICAgIGNsaWVudDogaW5wdXQuY2xpZW50LndpdGhDb25maWcoeyBhbGxvd1JlY29uZmlndXJlOiAhMSB9KSxcbiAgICBzaGFyZWRMaXN0ZW5lcjogaW5wdXQuc2hhcmVkTGlzdGVuZXIsXG4gICAgaWQ6IGlucHV0LmlkLFxuICAgIHJlbW90ZTogdm9pZCAwLFxuICAgIGxvY2FsOiB2b2lkIDAsXG4gICAgbXV0YXRpb25FdmVudHM6IFtdLFxuICAgIHN0YWdlZENoYW5nZXM6IFtdLFxuICAgIHN0YXNoZWRDaGFuZ2VzOiBbXSxcbiAgICBlcnJvcjogdm9pZCAwLFxuICAgIGZldGNoUmVtb3RlU25hcHNob3RBdHRlbXB0czogMCxcbiAgICBzdWJtaXRUcmFuc2FjdGlvbnNBdHRlbXB0czogMCxcbiAgICBjYWNoZTogaW5wdXQuY2FjaGVcbiAgfSksXG4gIC8vIEF1dG8gc3RhcnQgdGhlIGNvbm5lY3Rpb24gYnkgZGVmYXVsdFxuICBlbnRyeTogW1wiY29ubmVjdCB0byBzZXJ2ZXItc2VudCBldmVudHNcIl0sXG4gIG9uOiB7XG4gICAgbXV0YXRlOiB7XG4gICAgICBhY3Rpb25zOiBbXCJyZWJhc2UgbG9jYWwgc25hcHNob3RcIiwgXCJzdGFnZSBtdXRhdGlvblwiXVxuICAgIH1cbiAgfSxcbiAgaW5pdGlhbDogXCJkaXNjb25uZWN0ZWRcIixcbiAgc3RhdGVzOiB7XG4gICAgZGlzY29ubmVjdGVkOiB7XG4gICAgICBvbjoge1xuICAgICAgICBjb25uZWN0OiB7XG4gICAgICAgICAgdGFyZ2V0OiBcImNvbm5lY3RpbmdcIixcbiAgICAgICAgICBhY3Rpb25zOiBbXCJsaXN0ZW4gdG8gc2VydmVyLXNlbnQgZXZlbnRzXCJdXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIGNvbm5lY3Rpbmc6IHtcbiAgICAgIG9uOiB7XG4gICAgICAgIHdlbGNvbWU6IFwiY29ubmVjdGVkXCIsXG4gICAgICAgIHJlY29ubmVjdDogXCJyZWNvbm5lY3RpbmdcIixcbiAgICAgICAgZXJyb3I6IFwiY29ubmVjdEZhaWx1cmVcIlxuICAgICAgfSxcbiAgICAgIHRhZ3M6IFtcImJ1c3lcIl1cbiAgICB9LFxuICAgIGNvbm5lY3RGYWlsdXJlOiB7XG4gICAgICBvbjoge1xuICAgICAgICBjb25uZWN0OiB7XG4gICAgICAgICAgdGFyZ2V0OiBcImNvbm5lY3RpbmdcIixcbiAgICAgICAgICBhY3Rpb25zOiBbXCJsaXN0ZW4gdG8gc2VydmVyLXNlbnQgZXZlbnRzXCJdXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBlbnRyeTogW1xuICAgICAgICBcInN0b3AgbGlzdGVuaW5nIHRvIHNlcnZlci1zZW50IGV2ZW50c1wiLFxuICAgICAgICBcImFzc2lnbiBlcnJvciB0byBjb250ZXh0XCJcbiAgICAgIF0sXG4gICAgICBleGl0OiBbXCJjbGVhciBlcnJvciBmcm9tIGNvbnRleHRcIl0sXG4gICAgICB0YWdzOiBbXCJlcnJvclwiXVxuICAgIH0sXG4gICAgcmVjb25uZWN0aW5nOiB7XG4gICAgICBvbjoge1xuICAgICAgICB3ZWxjb21lOiB7XG4gICAgICAgICAgdGFyZ2V0OiBcImNvbm5lY3RlZFwiXG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiB7XG4gICAgICAgICAgdGFyZ2V0OiBcImNvbm5lY3RGYWlsdXJlXCJcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHRhZ3M6IFtcImJ1c3lcIiwgXCJlcnJvclwiXVxuICAgIH0sXG4gICAgY29ubmVjdGVkOiB7XG4gICAgICBvbjoge1xuICAgICAgICBtdXRhdGlvbjoge1xuICAgICAgICAgIGFjdGlvbnM6IFtcImJ1ZmZlciByZW1vdGUgbXV0YXRpb24gZXZlbnRzXCJdXG4gICAgICAgIH0sXG4gICAgICAgIHJlY29ubmVjdDogXCJyZWNvbm5lY3RpbmdcIlxuICAgICAgfSxcbiAgICAgIGVudHJ5OiBbXCJjbGVhciBlcnJvciBmcm9tIGNvbnRleHRcIl0sXG4gICAgICBpbml0aWFsOiBcImxvYWRpbmdcIixcbiAgICAgIHN0YXRlczoge1xuICAgICAgICBsb2FkaW5nOiB7XG4gICAgICAgICAgaW52b2tlOiB7XG4gICAgICAgICAgICBzcmM6IFwiZmV0Y2ggcmVtb3RlIHNuYXBzaG90XCIsXG4gICAgICAgICAgICBpZDogXCJnZXREb2N1bWVudFwiLFxuICAgICAgICAgICAgaW5wdXQ6ICh7IGNvbnRleHQgfSkgPT4gKHtcbiAgICAgICAgICAgICAgY2xpZW50OiBjb250ZXh0LmNsaWVudCxcbiAgICAgICAgICAgICAgaWQ6IGNvbnRleHQuaWRcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgb25FcnJvcjoge1xuICAgICAgICAgICAgICB0YXJnZXQ6IFwibG9hZEZhaWx1cmVcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG9uRG9uZToge1xuICAgICAgICAgICAgICB0YXJnZXQ6IFwibG9hZGVkXCIsXG4gICAgICAgICAgICAgIGFjdGlvbnM6IFtcbiAgICAgICAgICAgICAgICBcInJlYmFzZSBmZXRjaGVkIHJlbW90ZSBzbmFwc2hvdFwiLFxuICAgICAgICAgICAgICAgIFwicmVzZXQgZmV0Y2ggYXR0ZW1wdHNcIlxuICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICB0YWdzOiBbXCJidXN5XCJdXG4gICAgICAgIH0sXG4gICAgICAgIGxvYWRlZDoge1xuICAgICAgICAgIGVudHJ5OiBbXCJzZW5kIHN5bmMgZXZlbnQgdG8gcGFyZW50XCJdLFxuICAgICAgICAgIG9uOiB7XG4gICAgICAgICAgICBtdXRhdGlvbjoge1xuICAgICAgICAgICAgICBhY3Rpb25zOiBbXCJhcHBseSBtZW5kb3phIHBhdGNoXCIsIFwic2VuZCBtdXRhdGlvbiBldmVudCB0byBwYXJlbnRcIl1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGluaXRpYWw6IFwicHJpc3RpbmVcIixcbiAgICAgICAgICBzdGF0ZXM6IHtcbiAgICAgICAgICAgIHByaXN0aW5lOiB7XG4gICAgICAgICAgICAgIG9uOiB7XG4gICAgICAgICAgICAgICAgbXV0YXRlOiB7XG4gICAgICAgICAgICAgICAgICBhY3Rpb25zOiBbXCJyZWJhc2UgbG9jYWwgc25hcHNob3RcIiwgXCJzdGFnZSBtdXRhdGlvblwiXSxcbiAgICAgICAgICAgICAgICAgIHRhcmdldDogXCJkaXJ0eVwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB0YWdzOiBbXCJyZWFkeVwiXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRpcnR5OiB7XG4gICAgICAgICAgICAgIG9uOiB7XG4gICAgICAgICAgICAgICAgc3VibWl0OiBcInN1Ym1pdHRpbmdcIlxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB0YWdzOiBbXCJyZWFkeVwiXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN1Ym1pdHRpbmc6IHtcbiAgICAgICAgICAgICAgb246IHtcbiAgICAgICAgICAgICAgICBtdXRhdGU6IHtcbiAgICAgICAgICAgICAgICAgIGFjdGlvbnM6IFtcInJlYmFzZSBsb2NhbCBzbmFwc2hvdFwiLCBcInN0YXNoIG11dGF0aW9uXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBpbnZva2U6IHtcbiAgICAgICAgICAgICAgICBzcmM6IFwic3VibWl0IG11dGF0aW9ucyBhcyB0cmFuc2FjdGlvbnNcIixcbiAgICAgICAgICAgICAgICBpZDogXCJzdWJtaXRUcmFuc2FjdGlvbnNcIixcbiAgICAgICAgICAgICAgICBpbnB1dDogKHsgY29udGV4dCB9KSA9PiB7XG4gICAgICAgICAgICAgICAgICBjb25zdCByZW1vdGVEYXRhc2V0ID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgICAgICAgICAgICAgICAgIHJldHVybiByZW1vdGVEYXRhc2V0LnNldChjb250ZXh0LmlkLCBjb250ZXh0LnJlbW90ZSksIHtcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50OiBjb250ZXh0LmNsaWVudCxcbiAgICAgICAgICAgICAgICAgICAgdHJhbnNhY3Rpb25zOiB0b1RyYW5zYWN0aW9ucyhcbiAgICAgICAgICAgICAgICAgICAgICAvLyBTcXVhc2hpbmcgRE1QIHN0cmluZ3MgaXMgdGhlIGxhc3QgdGhpbmcgd2UgZG8gYmVmb3JlIHN1Ym1pdHRpbmdcbiAgICAgICAgICAgICAgICAgICAgICBzcXVhc2hETVBTdHJpbmdzKFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlRGF0YXNldCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNxdWFzaE11dGF0aW9uR3JvdXBzKGNvbnRleHQuc3RhZ2VkQ2hhbmdlcylcbiAgICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvbkVycm9yOiB7XG4gICAgICAgICAgICAgICAgICB0YXJnZXQ6IFwic3VibWl0RmFpbHVyZVwiXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBvbkRvbmU6IHtcbiAgICAgICAgICAgICAgICAgIHRhcmdldDogXCJwcmlzdGluZVwiLFxuICAgICAgICAgICAgICAgICAgYWN0aW9uczogW1xuICAgICAgICAgICAgICAgICAgICBcInJlc3RvcmUgc3Rhc2hlZCBjaGFuZ2VzXCIsXG4gICAgICAgICAgICAgICAgICAgIFwicmVzZXQgc3VibWl0IGF0dGVtcHRzXCIsXG4gICAgICAgICAgICAgICAgICAgIFwic2VuZCBwcmlzdGluZSBldmVudCB0byBwYXJlbnRcIlxuICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAqICdidXN5JyBtZWFucyB3ZSBzaG91bGQgc2hvdyBhIHNwaW5uZXIsICdyZWFkeScgbWVhbnMgd2UgY2FuIHN0aWxsIGFjY2VwdCBtdXRhdGlvbnMsIHRoZXknbGwgYmUgYXBwbGllZCBvcHRpbWlzdGljYWxseSByaWdodCBhd2F5LCBhbmQgcXVldWVkIGZvciBzdWJtaXNzaW9ucyBhZnRlciB0aGUgY3VycmVudCBzdWJtaXNzaW9uIHNldHRsZXNcbiAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgIHRhZ3M6IFtcImJ1c3lcIiwgXCJyZWFkeVwiXVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN1Ym1pdEZhaWx1cmU6IHtcbiAgICAgICAgICAgICAgZXhpdDogW1wiY2xlYXIgZXJyb3IgZnJvbSBjb250ZXh0XCJdLFxuICAgICAgICAgICAgICBhZnRlcjoge1xuICAgICAgICAgICAgICAgIHN1Ym1pdFRyYW5zYWN0aW9uc1RpbWVvdXQ6IHtcbiAgICAgICAgICAgICAgICAgIGFjdGlvbnM6IFtcImluY3JlbWVudCBzdWJtaXQgYXR0ZW1wdHNcIl0sXG4gICAgICAgICAgICAgICAgICB0YXJnZXQ6IFwic3VibWl0dGluZ1wiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBvbjoge1xuICAgICAgICAgICAgICAgIHJldHJ5OiBcInN1Ym1pdHRpbmdcIlxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICogSG93IGNhbiBpdCBiZSBib3RoIGByZWFkeWAgYW5kIGBlcnJvcmA/IGByZWFkeWAgbWVhbnMgaXQgY2FuIHJlY2VpdmUgbXV0YXRpb25zLCBvcHRpbWlzdGljYWxseSBhcHBseSB0aGVtLCBhbmQgcXVldWUgdGhlbSBmb3Igc3VibWlzc2lvbi4gYGVycm9yYCBtZWFucyBpdCBmYWlsZWQgdG8gc3VibWl0IHByZXZpb3VzbHkgYXBwbGllZCBtdXRhdGlvbnMuXG4gICAgICAgICAgICAgICAqIEl0J3MgY29tcGxldGVseSBmaW5lIHRvIGtlZXAgcXVldWVpbmcgdXAgbW9yZSBtdXRhdGlvbnMgYW5kIGFwcGx5aW5nIHRoZW0gb3B0aW1pc3RpY2FsbHksIHdoaWxlIHNob3dpbmcgVUkgdGhhdCBub3RpZmllcyB0aGF0IG11dGF0aW9ucyBkaWRuJ3Qgc3VibWl0LCBhbmQgc2hvdyBhIGNvdW50IGRvd24gdW50aWwgdGhlIG5leHQgYXV0b21hdGljIHJldHJ5LlxuICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgdGFnczogW1wiZXJyb3JcIiwgXCJyZWFkeVwiXVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgbG9hZEZhaWx1cmU6IHtcbiAgICAgICAgICBleGl0OiBbXCJjbGVhciBlcnJvciBmcm9tIGNvbnRleHRcIl0sXG4gICAgICAgICAgYWZ0ZXI6IHtcbiAgICAgICAgICAgIGZldGNoUmVtb3RlU25hcHNob3RUaW1lb3V0OiB7XG4gICAgICAgICAgICAgIGFjdGlvbnM6IFtcImluY3JlbWVudCBmZXRjaCBhdHRlbXB0c1wiXSxcbiAgICAgICAgICAgICAgdGFyZ2V0OiBcImxvYWRpbmdcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgb246IHtcbiAgICAgICAgICAgIHJldHJ5OiBcImxvYWRpbmdcIlxuICAgICAgICAgIH0sXG4gICAgICAgICAgdGFnczogW1wiZXJyb3JcIl1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufSk7XG5mdW5jdGlvbiBhcHBseU1lbmRvemFQYXRjaChkb2N1bWVudCwgcGF0Y2gsIG5leHRSZXZpc2lvbikge1xuICBjb25zdCBuZXh0ID0gYXBwbHlQYXRjaChvbWl0UmV2KGRvY3VtZW50KSwgcGF0Y2gpO1xuICByZXR1cm4gbmV4dCA/IE9iamVjdC5hc3NpZ24obmV4dCwgeyBfcmV2OiBuZXh0UmV2aXNpb24gfSkgOiBudWxsO1xufVxuZnVuY3Rpb24gb21pdFJldihkb2N1bWVudCkge1xuICBpZiAoIWRvY3VtZW50KVxuICAgIHJldHVybiBudWxsO1xuICBjb25zdCB7IF9yZXYsIC4uLmRvYyB9ID0gZG9jdW1lbnQ7XG4gIHJldHVybiBkb2M7XG59XG5leHBvcnQge1xuICBhcHBseU11dGF0aW9ucyxcbiAgY29tbWl0LFxuICBjcmVhdGVTaGFyZWRMaXN0ZW5lcixcbiAgZG9jdW1lbnRNdXRhdG9yTWFjaGluZSxcbiAgcmViYXNlLFxuICBzcXVhc2hETVBTdHJpbmdzLFxuICBzcXVhc2hNdXRhdGlvbkdyb3VwcyxcbiAgdG9UcmFuc2FjdGlvbnNcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1fdW5zdGFibGVfbWFjaGluZS5qcy5tYXBcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_unstable_machine.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/index.js":
/*!****************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/mutate/dist/index.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CompactEncoder: () => (/* binding */ index$1),\n/* harmony export */   CompactFormatter: () => (/* binding */ compact),\n/* harmony export */   SanityEncoder: () => (/* binding */ index),\n/* harmony export */   append: () => (/* binding */ append),\n/* harmony export */   assign: () => (/* binding */ assign),\n/* harmony export */   at: () => (/* binding */ at),\n/* harmony export */   autoKeys: () => (/* binding */ autoKeys),\n/* harmony export */   create: () => (/* binding */ create),\n/* harmony export */   createIfNotExists: () => (/* binding */ createIfNotExists),\n/* harmony export */   createOrReplace: () => (/* binding */ createOrReplace),\n/* harmony export */   dec: () => (/* binding */ dec),\n/* harmony export */   del: () => (/* binding */ del),\n/* harmony export */   delete_: () => (/* binding */ delete_),\n/* harmony export */   destroy: () => (/* binding */ destroy),\n/* harmony export */   diffMatchPatch: () => (/* binding */ diffMatchPatch),\n/* harmony export */   inc: () => (/* binding */ inc),\n/* harmony export */   insert: () => (/* binding */ insert),\n/* harmony export */   insertAfter: () => (/* binding */ insertAfter),\n/* harmony export */   insertBefore: () => (/* binding */ insertBefore),\n/* harmony export */   patch: () => (/* binding */ patch),\n/* harmony export */   prepend: () => (/* binding */ prepend),\n/* harmony export */   remove: () => (/* binding */ remove),\n/* harmony export */   replace: () => (/* binding */ replace),\n/* harmony export */   set: () => (/* binding */ set),\n/* harmony export */   setIfMissing: () => (/* binding */ setIfMissing),\n/* harmony export */   truncate: () => (/* binding */ truncate),\n/* harmony export */   unassign: () => (/* binding */ unassign),\n/* harmony export */   unset: () => (/* binding */ unset),\n/* harmony export */   upsert: () => (/* binding */ upsert)\n/* harmony export */ });\n/* harmony import */ var _chunks_es_parse_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./_chunks-es/parse.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/parse.js\");\n/* harmony import */ var _chunks_es_stringify_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./_chunks-es/stringify.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/stringify.js\");\n/* harmony import */ var _chunks_es_decode_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./_chunks-es/decode.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/decode.js\");\n/* harmony import */ var _chunks_es_encode_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./_chunks-es/encode.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/encode.js\");\n/* harmony import */ var _chunks_es_isObject_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./_chunks-es/isObject.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/isObject.js\");\n/* harmony import */ var _chunks_es_arrify_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./_chunks-es/arrify.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_chunks-es/arrify.js\");\n\n\n\n\n\n\nfunction decode(mutations) {\n  return mutations.map(decodeMutation);\n}\nfunction decodeMutation(mutation) {\n  const [type] = mutation;\n  if (type === \"delete\") {\n    const [, id] = mutation;\n    return { id, type };\n  } else if (type === \"create\") {\n    const [, document] = mutation;\n    return { type, document };\n  } else if (type === \"createIfNotExists\") {\n    const [, document] = mutation;\n    return { type, document };\n  } else if (type === \"createOrReplace\") {\n    const [, document] = mutation;\n    return { type, document };\n  } else if (type === \"patch\")\n    return decodePatchMutation(mutation);\n  throw new Error(`Unrecognized mutation: ${JSON.stringify(mutation)}`);\n}\nfunction decodePatchMutation(mutation) {\n  const [, type, id, serializedPath, , revisionId] = mutation, path = (0,_chunks_es_parse_js__WEBPACK_IMPORTED_MODULE_0__.parse)(serializedPath);\n  if (type === \"dec\" || type === \"inc\") {\n    const [, , , , [amount]] = mutation;\n    return {\n      type: \"patch\",\n      id,\n      patches: [{ path, op: { type: \"inc\", amount } }],\n      ...createOpts(revisionId)\n    };\n  }\n  if (type === \"unset\")\n    return {\n      type: \"patch\",\n      id,\n      patches: [{ path, op: { type: \"unset\" } }],\n      ...createOpts(revisionId)\n    };\n  if (type === \"insert\") {\n    const [, , , , [position, ref, items]] = mutation;\n    return {\n      type: \"patch\",\n      id,\n      patches: [\n        {\n          path,\n          op: {\n            type: \"insert\",\n            position,\n            items,\n            referenceItem: typeof ref == \"string\" ? { _key: ref } : ref\n          }\n        }\n      ],\n      ...createOpts(revisionId)\n    };\n  }\n  if (type === \"set\") {\n    const [, , , , [value]] = mutation;\n    return {\n      type: \"patch\",\n      id,\n      patches: [{ path, op: { type: \"set\", value } }],\n      ...createOpts(revisionId)\n    };\n  }\n  if (type === \"setIfMissing\") {\n    const [, , , , [value]] = mutation;\n    return {\n      type: \"patch\",\n      id,\n      patches: [{ path, op: { type: \"setIfMissing\", value } }],\n      ...createOpts(revisionId)\n    };\n  }\n  if (type === \"diffMatchPatch\") {\n    const [, , , , [value]] = mutation;\n    return {\n      type: \"patch\",\n      id,\n      patches: [{ path, op: { type: \"diffMatchPatch\", value } }],\n      ...createOpts(revisionId)\n    };\n  }\n  if (type === \"truncate\") {\n    const [, , , , [startIndex, endIndex]] = mutation;\n    return {\n      type: \"patch\",\n      id,\n      patches: [{ path, op: { type: \"truncate\", startIndex, endIndex } }],\n      ...createOpts(revisionId)\n    };\n  }\n  if (type === \"assign\") {\n    const [, , , , [value]] = mutation;\n    return {\n      type: \"patch\",\n      id,\n      patches: [{ path, op: { type: \"assign\", value } }],\n      ...createOpts(revisionId)\n    };\n  }\n  if (type === \"replace\") {\n    const [, , , , [ref, items]] = mutation;\n    return {\n      type: \"patch\",\n      id,\n      patches: [\n        { path, op: { type: \"replace\", items, referenceItem: decodeItemRef(ref) } }\n      ],\n      ...createOpts(revisionId)\n    };\n  }\n  if (type === \"upsert\") {\n    const [, , , , [position, referenceItem, items]] = mutation;\n    return {\n      type: \"patch\",\n      id,\n      patches: [\n        {\n          path,\n          op: {\n            type: \"upsert\",\n            items,\n            referenceItem: decodeItemRef(referenceItem),\n            position\n          }\n        }\n      ],\n      ...createOpts(revisionId)\n    };\n  }\n  throw new Error(`Invalid mutation type: ${type}`);\n}\nfunction decodeItemRef(ref) {\n  return typeof ref == \"string\" ? { _key: ref } : ref;\n}\nfunction createOpts(revisionId) {\n  return revisionId ? { options: { ifRevision: revisionId } } : null;\n}\nfunction encode(mutations) {\n  return mutations.flatMap((m) => encodeMutation$1(m));\n}\nfunction encodeItemRef$1(ref) {\n  return typeof ref == \"number\" ? ref : ref._key;\n}\nfunction encodeMutation$1(mutation) {\n  if (mutation.type === \"create\" || mutation.type === \"createIfNotExists\" || mutation.type === \"createOrReplace\")\n    return [[mutation.type, mutation.document]];\n  if (mutation.type === \"delete\")\n    return [[\"delete\", mutation.id]];\n  if (mutation.type === \"patch\")\n    return mutation.patches.map(\n      (patch2) => maybeAddRevision(\n        mutation.options?.ifRevision,\n        encodePatchMutation(mutation.id, patch2)\n      )\n    );\n  throw new Error(`Invalid mutation type: ${mutation.type}`);\n}\nfunction encodePatchMutation(id, patch2) {\n  const { op } = patch2, path = (0,_chunks_es_stringify_js__WEBPACK_IMPORTED_MODULE_1__.stringify)(patch2.path);\n  if (op.type === \"unset\")\n    return [\"patch\", \"unset\", id, path, []];\n  if (op.type === \"diffMatchPatch\")\n    return [\"patch\", \"diffMatchPatch\", id, path, [op.value]];\n  if (op.type === \"inc\" || op.type === \"dec\")\n    return [\"patch\", op.type, id, path, [op.amount]];\n  if (op.type === \"set\")\n    return [\"patch\", op.type, id, path, [op.value]];\n  if (op.type === \"setIfMissing\")\n    return [\"patch\", op.type, id, path, [op.value]];\n  if (op.type === \"insert\")\n    return [\n      \"patch\",\n      \"insert\",\n      id,\n      path,\n      [op.position, encodeItemRef$1(op.referenceItem), op.items]\n    ];\n  if (op.type === \"upsert\")\n    return [\n      \"patch\",\n      \"upsert\",\n      id,\n      path,\n      [op.position, encodeItemRef$1(op.referenceItem), op.items]\n    ];\n  if (op.type === \"assign\")\n    return [\"patch\", \"assign\", id, path, [op.value]];\n  if (op.type === \"unassign\")\n    return [\"patch\", \"assign\", id, path, [op.keys]];\n  if (op.type === \"replace\")\n    return [\n      \"patch\",\n      \"replace\",\n      id,\n      path,\n      [encodeItemRef$1(op.referenceItem), op.items]\n    ];\n  if (op.type === \"truncate\")\n    return [\"patch\", \"truncate\", id, path, [op.startIndex, op.endIndex]];\n  if (op.type === \"remove\")\n    return [\"patch\", \"remove\", id, path, [encodeItemRef$1(op.referenceItem)]];\n  throw new Error(`Invalid operation type: ${op.type}`);\n}\nfunction maybeAddRevision(revision, mut) {\n  const [mutType, patchType, id, path, args] = mut;\n  return revision ? [mutType, patchType, id, path, args, revision] : mut;\n}\nvar index$1 = /* @__PURE__ */ Object.freeze({\n  __proto__: null,\n  decode,\n  encode\n}), index = /* @__PURE__ */ Object.freeze({\n  __proto__: null,\n  decode: _chunks_es_decode_js__WEBPACK_IMPORTED_MODULE_2__.decode,\n  decodeAll: _chunks_es_decode_js__WEBPACK_IMPORTED_MODULE_2__.decodeAll,\n  encode: _chunks_es_encode_js__WEBPACK_IMPORTED_MODULE_3__.encode,\n  encodeAll: _chunks_es_encode_js__WEBPACK_IMPORTED_MODULE_3__.encodeAll,\n  encodeMutation: _chunks_es_encode_js__WEBPACK_IMPORTED_MODULE_3__.encodeMutation,\n  encodeTransaction: _chunks_es_encode_js__WEBPACK_IMPORTED_MODULE_3__.encodeTransaction\n});\nfunction format(mutations) {\n  return mutations.flatMap((m) => encodeMutation(m)).join(`\n`);\n}\nfunction encodeItemRef(ref) {\n  return typeof ref == \"number\" ? ref : ref._key;\n}\nfunction encodeMutation(mutation) {\n  if (mutation.type === \"create\" || mutation.type === \"createIfNotExists\" || mutation.type === \"createOrReplace\")\n    return [mutation.type, \": \", JSON.stringify(mutation.document)].join(\"\");\n  if (mutation.type === \"delete\")\n    return [\"delete \", mutation.id].join(\": \");\n  if (mutation.type === \"patch\") {\n    const ifRevision = mutation.options?.ifRevision;\n    return [\n      \"patch\",\n      \" \",\n      `id=${mutation.id}`,\n      ifRevision ? ` (if revision==${ifRevision})` : \"\",\n      `:\n`,\n      mutation.patches.map((nodePatch) => `  ${formatPatchMutation(nodePatch)}`).join(`\n`)\n    ].join(\"\");\n  }\n  throw new Error(`Invalid mutation type: ${mutation.type}`);\n}\nfunction formatPatchMutation(patch2) {\n  const { op } = patch2, path = (0,_chunks_es_stringify_js__WEBPACK_IMPORTED_MODULE_1__.stringify)(patch2.path);\n  if (op.type === \"unset\")\n    return [path, \"unset()\"].join(\": \");\n  if (op.type === \"diffMatchPatch\")\n    return [path, `diffMatchPatch(${op.value})`].join(\": \");\n  if (op.type === \"inc\" || op.type === \"dec\")\n    return [path, `${op.type}(${op.amount})`].join(\": \");\n  if (op.type === \"set\" || op.type === \"setIfMissing\")\n    return [path, `${op.type}(${JSON.stringify(op.value)})`].join(\": \");\n  if (op.type === \"assign\")\n    return [path, `${op.type}(${JSON.stringify(op.value)})`].join(\": \");\n  if (op.type === \"unassign\")\n    return [path, `${op.type}(${JSON.stringify(op.keys)})`].join(\": \");\n  if (op.type === \"insert\" || op.type === \"upsert\")\n    return [\n      path,\n      `${op.type}(${op.position}, ${encodeItemRef(\n        op.referenceItem\n      )}, ${JSON.stringify(op.items)})`\n    ].join(\": \");\n  if (op.type === \"replace\")\n    return [\n      path,\n      `replace(${encodeItemRef(op.referenceItem)}, ${JSON.stringify(\n        op.items\n      )})`\n    ].join(\": \");\n  if (op.type === \"truncate\")\n    return [path, `truncate(${op.startIndex}, ${op.endIndex}`].join(\": \");\n  if (op.type === \"remove\")\n    return [path, `remove(${encodeItemRef(op.referenceItem)})`].join(\": \");\n  throw new Error(`Invalid operation type: ${op.type}`);\n}\nvar compact = /* @__PURE__ */ Object.freeze({\n  __proto__: null,\n  format\n});\nconst set = (value) => ({ type: \"set\", value }), assign = (value) => ({\n  type: \"assign\",\n  value\n}), unassign = (keys) => ({\n  type: \"unassign\",\n  keys\n}), setIfMissing = (value) => ({\n  type: \"setIfMissing\",\n  value\n}), unset = () => ({ type: \"unset\" }), inc = (amount = 1) => ({\n  type: \"inc\",\n  amount\n}), dec = (amount = 1) => ({\n  type: \"dec\",\n  amount\n}), diffMatchPatch = (value) => ({\n  type: \"diffMatchPatch\",\n  value\n});\nfunction insert(items, position, indexOrReferenceItem) {\n  return {\n    type: \"insert\",\n    referenceItem: indexOrReferenceItem,\n    position,\n    items: (0,_chunks_es_arrify_js__WEBPACK_IMPORTED_MODULE_4__.arrify)(items)\n  };\n}\nfunction append(items) {\n  return insert(items, \"after\", -1);\n}\nfunction prepend(items) {\n  return insert(items, \"before\", 0);\n}\nfunction insertBefore(items, indexOrReferenceItem) {\n  return insert(items, \"before\", indexOrReferenceItem);\n}\nconst insertAfter = (items, indexOrReferenceItem) => insert(items, \"after\", indexOrReferenceItem);\nfunction truncate(startIndex, endIndex) {\n  return {\n    type: \"truncate\",\n    startIndex,\n    endIndex\n  };\n}\nfunction replace(items, referenceItem) {\n  return {\n    type: \"replace\",\n    referenceItem,\n    items: (0,_chunks_es_arrify_js__WEBPACK_IMPORTED_MODULE_4__.arrify)(items)\n  };\n}\nfunction remove(referenceItem) {\n  return {\n    type: \"remove\",\n    referenceItem\n  };\n}\nfunction upsert(items, position, referenceItem) {\n  return {\n    type: \"upsert\",\n    items: (0,_chunks_es_arrify_js__WEBPACK_IMPORTED_MODULE_4__.arrify)(items),\n    referenceItem,\n    position\n  };\n}\nfunction autoKeys(generateKey) {\n  const ensureKeys = createEnsureKeys(generateKey), insert$1 = (position, referenceItem, items) => insert(ensureKeys(items), position, referenceItem), upsert$1 = (items, position, referenceItem) => upsert(ensureKeys(items), position, referenceItem), replace$1 = (items, position, referenceItem) => replace(ensureKeys(items), referenceItem), insertBefore2 = (ref, items) => insert$1(\"before\", ref, items);\n  return { insert: insert$1, upsert: upsert$1, replace: replace$1, insertBefore: insertBefore2, prepend: (items) => insertBefore2(0, items), insertAfter: (ref, items) => insert$1(\"after\", ref, items), append: (items) => insert$1(\"after\", -1, items) };\n}\nfunction hasKey(item) {\n  return \"_key\" in item;\n}\nfunction createEnsureKeys(generateKey) {\n  return (array) => {\n    let didModify = !1;\n    const withKeys = array.map((item) => needsKey(item) ? (didModify = !0, { ...item, _key: generateKey(item) }) : item);\n    return didModify ? withKeys : array;\n  };\n}\nfunction needsKey(arrayItem) {\n  return (0,_chunks_es_isObject_js__WEBPACK_IMPORTED_MODULE_5__.isObject)(arrayItem) && !hasKey(arrayItem);\n}\nfunction create(document) {\n  return { type: \"create\", document };\n}\nfunction patch(id, patches, options) {\n  return {\n    type: \"patch\",\n    id,\n    patches: (0,_chunks_es_arrify_js__WEBPACK_IMPORTED_MODULE_4__.arrify)(patches),\n    ...options ? { options } : {}\n  };\n}\nfunction at(path, operation) {\n  return {\n    path: typeof path == \"string\" ? (0,_chunks_es_parse_js__WEBPACK_IMPORTED_MODULE_0__.parse)(path) : path,\n    op: operation\n  };\n}\nfunction createIfNotExists(document) {\n  return { type: \"createIfNotExists\", document };\n}\nfunction createOrReplace(document) {\n  return { type: \"createOrReplace\", document };\n}\nfunction delete_(id) {\n  return { type: \"delete\", id };\n}\nconst del = delete_, destroy = delete_;\n\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvbXV0YXRlL2Rpc3QvaW5kZXguanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBOEM7QUFDUTtBQUNpQjtBQUN1RDtBQUMxRTtBQUNKO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLElBQUk7QUFDSjtBQUNBLGFBQWE7QUFDYixJQUFJO0FBQ0o7QUFDQSxhQUFhO0FBQ2IsSUFBSTtBQUNKO0FBQ0EsYUFBYTtBQUNiLElBQUk7QUFDSjtBQUNBLDRDQUE0Qyx5QkFBeUI7QUFDckU7QUFDQTtBQUNBLHNFQUFzRSwwREFBSztBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLFlBQVksdUJBQXVCO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLFlBQVksaUJBQWlCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0QsWUFBWTtBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLFlBQVksc0JBQXNCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsWUFBWSwrQkFBK0I7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixZQUFZLGlDQUFpQztBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLFlBQVksMENBQTBDO0FBQ3hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsWUFBWSx5QkFB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsNERBQU07QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkVBQTZFLGtDQUFrQztBQUMvRztBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsZ0VBQVE7QUFDakI7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSw0REFBTTtBQUNuQixtQkFBbUIsVUFBVTtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQywwREFBSztBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQStCRTtBQUNGIiwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL25vZGVfbW9kdWxlcy9uZXh0LXNhbml0eS9ub2RlX21vZHVsZXMvQHNhbml0eS9tdXRhdGUvZGlzdC9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwYXJzZSB9IGZyb20gXCIuL19jaHVua3MtZXMvcGFyc2UuanNcIjtcbmltcG9ydCB7IHN0cmluZ2lmeSB9IGZyb20gXCIuL19jaHVua3MtZXMvc3RyaW5naWZ5LmpzXCI7XG5pbXBvcnQgeyBkZWNvZGUgYXMgZGVjb2RlJDEsIGRlY29kZUFsbCB9IGZyb20gXCIuL19jaHVua3MtZXMvZGVjb2RlLmpzXCI7XG5pbXBvcnQgeyBlbmNvZGUgYXMgZW5jb2RlJDEsIGVuY29kZUFsbCwgZW5jb2RlTXV0YXRpb24gYXMgZW5jb2RlTXV0YXRpb24kMiwgZW5jb2RlVHJhbnNhY3Rpb24gfSBmcm9tIFwiLi9fY2h1bmtzLWVzL2VuY29kZS5qc1wiO1xuaW1wb3J0IHsgaXNPYmplY3QgfSBmcm9tIFwiLi9fY2h1bmtzLWVzL2lzT2JqZWN0LmpzXCI7XG5pbXBvcnQgeyBhcnJpZnkgfSBmcm9tIFwiLi9fY2h1bmtzLWVzL2FycmlmeS5qc1wiO1xuZnVuY3Rpb24gZGVjb2RlKG11dGF0aW9ucykge1xuICByZXR1cm4gbXV0YXRpb25zLm1hcChkZWNvZGVNdXRhdGlvbik7XG59XG5mdW5jdGlvbiBkZWNvZGVNdXRhdGlvbihtdXRhdGlvbikge1xuICBjb25zdCBbdHlwZV0gPSBtdXRhdGlvbjtcbiAgaWYgKHR5cGUgPT09IFwiZGVsZXRlXCIpIHtcbiAgICBjb25zdCBbLCBpZF0gPSBtdXRhdGlvbjtcbiAgICByZXR1cm4geyBpZCwgdHlwZSB9O1xuICB9IGVsc2UgaWYgKHR5cGUgPT09IFwiY3JlYXRlXCIpIHtcbiAgICBjb25zdCBbLCBkb2N1bWVudF0gPSBtdXRhdGlvbjtcbiAgICByZXR1cm4geyB0eXBlLCBkb2N1bWVudCB9O1xuICB9IGVsc2UgaWYgKHR5cGUgPT09IFwiY3JlYXRlSWZOb3RFeGlzdHNcIikge1xuICAgIGNvbnN0IFssIGRvY3VtZW50XSA9IG11dGF0aW9uO1xuICAgIHJldHVybiB7IHR5cGUsIGRvY3VtZW50IH07XG4gIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJjcmVhdGVPclJlcGxhY2VcIikge1xuICAgIGNvbnN0IFssIGRvY3VtZW50XSA9IG11dGF0aW9uO1xuICAgIHJldHVybiB7IHR5cGUsIGRvY3VtZW50IH07XG4gIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJwYXRjaFwiKVxuICAgIHJldHVybiBkZWNvZGVQYXRjaE11dGF0aW9uKG11dGF0aW9uKTtcbiAgdGhyb3cgbmV3IEVycm9yKGBVbnJlY29nbml6ZWQgbXV0YXRpb246ICR7SlNPTi5zdHJpbmdpZnkobXV0YXRpb24pfWApO1xufVxuZnVuY3Rpb24gZGVjb2RlUGF0Y2hNdXRhdGlvbihtdXRhdGlvbikge1xuICBjb25zdCBbLCB0eXBlLCBpZCwgc2VyaWFsaXplZFBhdGgsICwgcmV2aXNpb25JZF0gPSBtdXRhdGlvbiwgcGF0aCA9IHBhcnNlKHNlcmlhbGl6ZWRQYXRoKTtcbiAgaWYgKHR5cGUgPT09IFwiZGVjXCIgfHwgdHlwZSA9PT0gXCJpbmNcIikge1xuICAgIGNvbnN0IFssICwgLCAsIFthbW91bnRdXSA9IG11dGF0aW9uO1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBcInBhdGNoXCIsXG4gICAgICBpZCxcbiAgICAgIHBhdGNoZXM6IFt7IHBhdGgsIG9wOiB7IHR5cGU6IFwiaW5jXCIsIGFtb3VudCB9IH1dLFxuICAgICAgLi4uY3JlYXRlT3B0cyhyZXZpc2lvbklkKVxuICAgIH07XG4gIH1cbiAgaWYgKHR5cGUgPT09IFwidW5zZXRcIilcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogXCJwYXRjaFwiLFxuICAgICAgaWQsXG4gICAgICBwYXRjaGVzOiBbeyBwYXRoLCBvcDogeyB0eXBlOiBcInVuc2V0XCIgfSB9XSxcbiAgICAgIC4uLmNyZWF0ZU9wdHMocmV2aXNpb25JZClcbiAgICB9O1xuICBpZiAodHlwZSA9PT0gXCJpbnNlcnRcIikge1xuICAgIGNvbnN0IFssICwgLCAsIFtwb3NpdGlvbiwgcmVmLCBpdGVtc11dID0gbXV0YXRpb247XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IFwicGF0Y2hcIixcbiAgICAgIGlkLFxuICAgICAgcGF0Y2hlczogW1xuICAgICAgICB7XG4gICAgICAgICAgcGF0aCxcbiAgICAgICAgICBvcDoge1xuICAgICAgICAgICAgdHlwZTogXCJpbnNlcnRcIixcbiAgICAgICAgICAgIHBvc2l0aW9uLFxuICAgICAgICAgICAgaXRlbXMsXG4gICAgICAgICAgICByZWZlcmVuY2VJdGVtOiB0eXBlb2YgcmVmID09IFwic3RyaW5nXCIgPyB7IF9rZXk6IHJlZiB9IDogcmVmXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBdLFxuICAgICAgLi4uY3JlYXRlT3B0cyhyZXZpc2lvbklkKVxuICAgIH07XG4gIH1cbiAgaWYgKHR5cGUgPT09IFwic2V0XCIpIHtcbiAgICBjb25zdCBbLCAsICwgLCBbdmFsdWVdXSA9IG11dGF0aW9uO1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBcInBhdGNoXCIsXG4gICAgICBpZCxcbiAgICAgIHBhdGNoZXM6IFt7IHBhdGgsIG9wOiB7IHR5cGU6IFwic2V0XCIsIHZhbHVlIH0gfV0sXG4gICAgICAuLi5jcmVhdGVPcHRzKHJldmlzaW9uSWQpXG4gICAgfTtcbiAgfVxuICBpZiAodHlwZSA9PT0gXCJzZXRJZk1pc3NpbmdcIikge1xuICAgIGNvbnN0IFssICwgLCAsIFt2YWx1ZV1dID0gbXV0YXRpb247XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IFwicGF0Y2hcIixcbiAgICAgIGlkLFxuICAgICAgcGF0Y2hlczogW3sgcGF0aCwgb3A6IHsgdHlwZTogXCJzZXRJZk1pc3NpbmdcIiwgdmFsdWUgfSB9XSxcbiAgICAgIC4uLmNyZWF0ZU9wdHMocmV2aXNpb25JZClcbiAgICB9O1xuICB9XG4gIGlmICh0eXBlID09PSBcImRpZmZNYXRjaFBhdGNoXCIpIHtcbiAgICBjb25zdCBbLCAsICwgLCBbdmFsdWVdXSA9IG11dGF0aW9uO1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBcInBhdGNoXCIsXG4gICAgICBpZCxcbiAgICAgIHBhdGNoZXM6IFt7IHBhdGgsIG9wOiB7IHR5cGU6IFwiZGlmZk1hdGNoUGF0Y2hcIiwgdmFsdWUgfSB9XSxcbiAgICAgIC4uLmNyZWF0ZU9wdHMocmV2aXNpb25JZClcbiAgICB9O1xuICB9XG4gIGlmICh0eXBlID09PSBcInRydW5jYXRlXCIpIHtcbiAgICBjb25zdCBbLCAsICwgLCBbc3RhcnRJbmRleCwgZW5kSW5kZXhdXSA9IG11dGF0aW9uO1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBcInBhdGNoXCIsXG4gICAgICBpZCxcbiAgICAgIHBhdGNoZXM6IFt7IHBhdGgsIG9wOiB7IHR5cGU6IFwidHJ1bmNhdGVcIiwgc3RhcnRJbmRleCwgZW5kSW5kZXggfSB9XSxcbiAgICAgIC4uLmNyZWF0ZU9wdHMocmV2aXNpb25JZClcbiAgICB9O1xuICB9XG4gIGlmICh0eXBlID09PSBcImFzc2lnblwiKSB7XG4gICAgY29uc3QgWywgLCAsICwgW3ZhbHVlXV0gPSBtdXRhdGlvbjtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogXCJwYXRjaFwiLFxuICAgICAgaWQsXG4gICAgICBwYXRjaGVzOiBbeyBwYXRoLCBvcDogeyB0eXBlOiBcImFzc2lnblwiLCB2YWx1ZSB9IH1dLFxuICAgICAgLi4uY3JlYXRlT3B0cyhyZXZpc2lvbklkKVxuICAgIH07XG4gIH1cbiAgaWYgKHR5cGUgPT09IFwicmVwbGFjZVwiKSB7XG4gICAgY29uc3QgWywgLCAsICwgW3JlZiwgaXRlbXNdXSA9IG11dGF0aW9uO1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBcInBhdGNoXCIsXG4gICAgICBpZCxcbiAgICAgIHBhdGNoZXM6IFtcbiAgICAgICAgeyBwYXRoLCBvcDogeyB0eXBlOiBcInJlcGxhY2VcIiwgaXRlbXMsIHJlZmVyZW5jZUl0ZW06IGRlY29kZUl0ZW1SZWYocmVmKSB9IH1cbiAgICAgIF0sXG4gICAgICAuLi5jcmVhdGVPcHRzKHJldmlzaW9uSWQpXG4gICAgfTtcbiAgfVxuICBpZiAodHlwZSA9PT0gXCJ1cHNlcnRcIikge1xuICAgIGNvbnN0IFssICwgLCAsIFtwb3NpdGlvbiwgcmVmZXJlbmNlSXRlbSwgaXRlbXNdXSA9IG11dGF0aW9uO1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBcInBhdGNoXCIsXG4gICAgICBpZCxcbiAgICAgIHBhdGNoZXM6IFtcbiAgICAgICAge1xuICAgICAgICAgIHBhdGgsXG4gICAgICAgICAgb3A6IHtcbiAgICAgICAgICAgIHR5cGU6IFwidXBzZXJ0XCIsXG4gICAgICAgICAgICBpdGVtcyxcbiAgICAgICAgICAgIHJlZmVyZW5jZUl0ZW06IGRlY29kZUl0ZW1SZWYocmVmZXJlbmNlSXRlbSksXG4gICAgICAgICAgICBwb3NpdGlvblxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgXSxcbiAgICAgIC4uLmNyZWF0ZU9wdHMocmV2aXNpb25JZClcbiAgICB9O1xuICB9XG4gIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBtdXRhdGlvbiB0eXBlOiAke3R5cGV9YCk7XG59XG5mdW5jdGlvbiBkZWNvZGVJdGVtUmVmKHJlZikge1xuICByZXR1cm4gdHlwZW9mIHJlZiA9PSBcInN0cmluZ1wiID8geyBfa2V5OiByZWYgfSA6IHJlZjtcbn1cbmZ1bmN0aW9uIGNyZWF0ZU9wdHMocmV2aXNpb25JZCkge1xuICByZXR1cm4gcmV2aXNpb25JZCA/IHsgb3B0aW9uczogeyBpZlJldmlzaW9uOiByZXZpc2lvbklkIH0gfSA6IG51bGw7XG59XG5mdW5jdGlvbiBlbmNvZGUobXV0YXRpb25zKSB7XG4gIHJldHVybiBtdXRhdGlvbnMuZmxhdE1hcCgobSkgPT4gZW5jb2RlTXV0YXRpb24kMShtKSk7XG59XG5mdW5jdGlvbiBlbmNvZGVJdGVtUmVmJDEocmVmKSB7XG4gIHJldHVybiB0eXBlb2YgcmVmID09IFwibnVtYmVyXCIgPyByZWYgOiByZWYuX2tleTtcbn1cbmZ1bmN0aW9uIGVuY29kZU11dGF0aW9uJDEobXV0YXRpb24pIHtcbiAgaWYgKG11dGF0aW9uLnR5cGUgPT09IFwiY3JlYXRlXCIgfHwgbXV0YXRpb24udHlwZSA9PT0gXCJjcmVhdGVJZk5vdEV4aXN0c1wiIHx8IG11dGF0aW9uLnR5cGUgPT09IFwiY3JlYXRlT3JSZXBsYWNlXCIpXG4gICAgcmV0dXJuIFtbbXV0YXRpb24udHlwZSwgbXV0YXRpb24uZG9jdW1lbnRdXTtcbiAgaWYgKG11dGF0aW9uLnR5cGUgPT09IFwiZGVsZXRlXCIpXG4gICAgcmV0dXJuIFtbXCJkZWxldGVcIiwgbXV0YXRpb24uaWRdXTtcbiAgaWYgKG11dGF0aW9uLnR5cGUgPT09IFwicGF0Y2hcIilcbiAgICByZXR1cm4gbXV0YXRpb24ucGF0Y2hlcy5tYXAoXG4gICAgICAocGF0Y2gyKSA9PiBtYXliZUFkZFJldmlzaW9uKFxuICAgICAgICBtdXRhdGlvbi5vcHRpb25zPy5pZlJldmlzaW9uLFxuICAgICAgICBlbmNvZGVQYXRjaE11dGF0aW9uKG11dGF0aW9uLmlkLCBwYXRjaDIpXG4gICAgICApXG4gICAgKTtcbiAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIG11dGF0aW9uIHR5cGU6ICR7bXV0YXRpb24udHlwZX1gKTtcbn1cbmZ1bmN0aW9uIGVuY29kZVBhdGNoTXV0YXRpb24oaWQsIHBhdGNoMikge1xuICBjb25zdCB7IG9wIH0gPSBwYXRjaDIsIHBhdGggPSBzdHJpbmdpZnkocGF0Y2gyLnBhdGgpO1xuICBpZiAob3AudHlwZSA9PT0gXCJ1bnNldFwiKVxuICAgIHJldHVybiBbXCJwYXRjaFwiLCBcInVuc2V0XCIsIGlkLCBwYXRoLCBbXV07XG4gIGlmIChvcC50eXBlID09PSBcImRpZmZNYXRjaFBhdGNoXCIpXG4gICAgcmV0dXJuIFtcInBhdGNoXCIsIFwiZGlmZk1hdGNoUGF0Y2hcIiwgaWQsIHBhdGgsIFtvcC52YWx1ZV1dO1xuICBpZiAob3AudHlwZSA9PT0gXCJpbmNcIiB8fCBvcC50eXBlID09PSBcImRlY1wiKVxuICAgIHJldHVybiBbXCJwYXRjaFwiLCBvcC50eXBlLCBpZCwgcGF0aCwgW29wLmFtb3VudF1dO1xuICBpZiAob3AudHlwZSA9PT0gXCJzZXRcIilcbiAgICByZXR1cm4gW1wicGF0Y2hcIiwgb3AudHlwZSwgaWQsIHBhdGgsIFtvcC52YWx1ZV1dO1xuICBpZiAob3AudHlwZSA9PT0gXCJzZXRJZk1pc3NpbmdcIilcbiAgICByZXR1cm4gW1wicGF0Y2hcIiwgb3AudHlwZSwgaWQsIHBhdGgsIFtvcC52YWx1ZV1dO1xuICBpZiAob3AudHlwZSA9PT0gXCJpbnNlcnRcIilcbiAgICByZXR1cm4gW1xuICAgICAgXCJwYXRjaFwiLFxuICAgICAgXCJpbnNlcnRcIixcbiAgICAgIGlkLFxuICAgICAgcGF0aCxcbiAgICAgIFtvcC5wb3NpdGlvbiwgZW5jb2RlSXRlbVJlZiQxKG9wLnJlZmVyZW5jZUl0ZW0pLCBvcC5pdGVtc11cbiAgICBdO1xuICBpZiAob3AudHlwZSA9PT0gXCJ1cHNlcnRcIilcbiAgICByZXR1cm4gW1xuICAgICAgXCJwYXRjaFwiLFxuICAgICAgXCJ1cHNlcnRcIixcbiAgICAgIGlkLFxuICAgICAgcGF0aCxcbiAgICAgIFtvcC5wb3NpdGlvbiwgZW5jb2RlSXRlbVJlZiQxKG9wLnJlZmVyZW5jZUl0ZW0pLCBvcC5pdGVtc11cbiAgICBdO1xuICBpZiAob3AudHlwZSA9PT0gXCJhc3NpZ25cIilcbiAgICByZXR1cm4gW1wicGF0Y2hcIiwgXCJhc3NpZ25cIiwgaWQsIHBhdGgsIFtvcC52YWx1ZV1dO1xuICBpZiAob3AudHlwZSA9PT0gXCJ1bmFzc2lnblwiKVxuICAgIHJldHVybiBbXCJwYXRjaFwiLCBcImFzc2lnblwiLCBpZCwgcGF0aCwgW29wLmtleXNdXTtcbiAgaWYgKG9wLnR5cGUgPT09IFwicmVwbGFjZVwiKVxuICAgIHJldHVybiBbXG4gICAgICBcInBhdGNoXCIsXG4gICAgICBcInJlcGxhY2VcIixcbiAgICAgIGlkLFxuICAgICAgcGF0aCxcbiAgICAgIFtlbmNvZGVJdGVtUmVmJDEob3AucmVmZXJlbmNlSXRlbSksIG9wLml0ZW1zXVxuICAgIF07XG4gIGlmIChvcC50eXBlID09PSBcInRydW5jYXRlXCIpXG4gICAgcmV0dXJuIFtcInBhdGNoXCIsIFwidHJ1bmNhdGVcIiwgaWQsIHBhdGgsIFtvcC5zdGFydEluZGV4LCBvcC5lbmRJbmRleF1dO1xuICBpZiAob3AudHlwZSA9PT0gXCJyZW1vdmVcIilcbiAgICByZXR1cm4gW1wicGF0Y2hcIiwgXCJyZW1vdmVcIiwgaWQsIHBhdGgsIFtlbmNvZGVJdGVtUmVmJDEob3AucmVmZXJlbmNlSXRlbSldXTtcbiAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIG9wZXJhdGlvbiB0eXBlOiAke29wLnR5cGV9YCk7XG59XG5mdW5jdGlvbiBtYXliZUFkZFJldmlzaW9uKHJldmlzaW9uLCBtdXQpIHtcbiAgY29uc3QgW211dFR5cGUsIHBhdGNoVHlwZSwgaWQsIHBhdGgsIGFyZ3NdID0gbXV0O1xuICByZXR1cm4gcmV2aXNpb24gPyBbbXV0VHlwZSwgcGF0Y2hUeXBlLCBpZCwgcGF0aCwgYXJncywgcmV2aXNpb25dIDogbXV0O1xufVxudmFyIGluZGV4JDEgPSAvKiBAX19QVVJFX18gKi8gT2JqZWN0LmZyZWV6ZSh7XG4gIF9fcHJvdG9fXzogbnVsbCxcbiAgZGVjb2RlLFxuICBlbmNvZGVcbn0pLCBpbmRleCA9IC8qIEBfX1BVUkVfXyAqLyBPYmplY3QuZnJlZXplKHtcbiAgX19wcm90b19fOiBudWxsLFxuICBkZWNvZGU6IGRlY29kZSQxLFxuICBkZWNvZGVBbGwsXG4gIGVuY29kZTogZW5jb2RlJDEsXG4gIGVuY29kZUFsbCxcbiAgZW5jb2RlTXV0YXRpb246IGVuY29kZU11dGF0aW9uJDIsXG4gIGVuY29kZVRyYW5zYWN0aW9uXG59KTtcbmZ1bmN0aW9uIGZvcm1hdChtdXRhdGlvbnMpIHtcbiAgcmV0dXJuIG11dGF0aW9ucy5mbGF0TWFwKChtKSA9PiBlbmNvZGVNdXRhdGlvbihtKSkuam9pbihgXG5gKTtcbn1cbmZ1bmN0aW9uIGVuY29kZUl0ZW1SZWYocmVmKSB7XG4gIHJldHVybiB0eXBlb2YgcmVmID09IFwibnVtYmVyXCIgPyByZWYgOiByZWYuX2tleTtcbn1cbmZ1bmN0aW9uIGVuY29kZU11dGF0aW9uKG11dGF0aW9uKSB7XG4gIGlmIChtdXRhdGlvbi50eXBlID09PSBcImNyZWF0ZVwiIHx8IG11dGF0aW9uLnR5cGUgPT09IFwiY3JlYXRlSWZOb3RFeGlzdHNcIiB8fCBtdXRhdGlvbi50eXBlID09PSBcImNyZWF0ZU9yUmVwbGFjZVwiKVxuICAgIHJldHVybiBbbXV0YXRpb24udHlwZSwgXCI6IFwiLCBKU09OLnN0cmluZ2lmeShtdXRhdGlvbi5kb2N1bWVudCldLmpvaW4oXCJcIik7XG4gIGlmIChtdXRhdGlvbi50eXBlID09PSBcImRlbGV0ZVwiKVxuICAgIHJldHVybiBbXCJkZWxldGUgXCIsIG11dGF0aW9uLmlkXS5qb2luKFwiOiBcIik7XG4gIGlmIChtdXRhdGlvbi50eXBlID09PSBcInBhdGNoXCIpIHtcbiAgICBjb25zdCBpZlJldmlzaW9uID0gbXV0YXRpb24ub3B0aW9ucz8uaWZSZXZpc2lvbjtcbiAgICByZXR1cm4gW1xuICAgICAgXCJwYXRjaFwiLFxuICAgICAgXCIgXCIsXG4gICAgICBgaWQ9JHttdXRhdGlvbi5pZH1gLFxuICAgICAgaWZSZXZpc2lvbiA/IGAgKGlmIHJldmlzaW9uPT0ke2lmUmV2aXNpb259KWAgOiBcIlwiLFxuICAgICAgYDpcbmAsXG4gICAgICBtdXRhdGlvbi5wYXRjaGVzLm1hcCgobm9kZVBhdGNoKSA9PiBgICAke2Zvcm1hdFBhdGNoTXV0YXRpb24obm9kZVBhdGNoKX1gKS5qb2luKGBcbmApXG4gICAgXS5qb2luKFwiXCIpO1xuICB9XG4gIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBtdXRhdGlvbiB0eXBlOiAke211dGF0aW9uLnR5cGV9YCk7XG59XG5mdW5jdGlvbiBmb3JtYXRQYXRjaE11dGF0aW9uKHBhdGNoMikge1xuICBjb25zdCB7IG9wIH0gPSBwYXRjaDIsIHBhdGggPSBzdHJpbmdpZnkocGF0Y2gyLnBhdGgpO1xuICBpZiAob3AudHlwZSA9PT0gXCJ1bnNldFwiKVxuICAgIHJldHVybiBbcGF0aCwgXCJ1bnNldCgpXCJdLmpvaW4oXCI6IFwiKTtcbiAgaWYgKG9wLnR5cGUgPT09IFwiZGlmZk1hdGNoUGF0Y2hcIilcbiAgICByZXR1cm4gW3BhdGgsIGBkaWZmTWF0Y2hQYXRjaCgke29wLnZhbHVlfSlgXS5qb2luKFwiOiBcIik7XG4gIGlmIChvcC50eXBlID09PSBcImluY1wiIHx8IG9wLnR5cGUgPT09IFwiZGVjXCIpXG4gICAgcmV0dXJuIFtwYXRoLCBgJHtvcC50eXBlfSgke29wLmFtb3VudH0pYF0uam9pbihcIjogXCIpO1xuICBpZiAob3AudHlwZSA9PT0gXCJzZXRcIiB8fCBvcC50eXBlID09PSBcInNldElmTWlzc2luZ1wiKVxuICAgIHJldHVybiBbcGF0aCwgYCR7b3AudHlwZX0oJHtKU09OLnN0cmluZ2lmeShvcC52YWx1ZSl9KWBdLmpvaW4oXCI6IFwiKTtcbiAgaWYgKG9wLnR5cGUgPT09IFwiYXNzaWduXCIpXG4gICAgcmV0dXJuIFtwYXRoLCBgJHtvcC50eXBlfSgke0pTT04uc3RyaW5naWZ5KG9wLnZhbHVlKX0pYF0uam9pbihcIjogXCIpO1xuICBpZiAob3AudHlwZSA9PT0gXCJ1bmFzc2lnblwiKVxuICAgIHJldHVybiBbcGF0aCwgYCR7b3AudHlwZX0oJHtKU09OLnN0cmluZ2lmeShvcC5rZXlzKX0pYF0uam9pbihcIjogXCIpO1xuICBpZiAob3AudHlwZSA9PT0gXCJpbnNlcnRcIiB8fCBvcC50eXBlID09PSBcInVwc2VydFwiKVxuICAgIHJldHVybiBbXG4gICAgICBwYXRoLFxuICAgICAgYCR7b3AudHlwZX0oJHtvcC5wb3NpdGlvbn0sICR7ZW5jb2RlSXRlbVJlZihcbiAgICAgICAgb3AucmVmZXJlbmNlSXRlbVxuICAgICAgKX0sICR7SlNPTi5zdHJpbmdpZnkob3AuaXRlbXMpfSlgXG4gICAgXS5qb2luKFwiOiBcIik7XG4gIGlmIChvcC50eXBlID09PSBcInJlcGxhY2VcIilcbiAgICByZXR1cm4gW1xuICAgICAgcGF0aCxcbiAgICAgIGByZXBsYWNlKCR7ZW5jb2RlSXRlbVJlZihvcC5yZWZlcmVuY2VJdGVtKX0sICR7SlNPTi5zdHJpbmdpZnkoXG4gICAgICAgIG9wLml0ZW1zXG4gICAgICApfSlgXG4gICAgXS5qb2luKFwiOiBcIik7XG4gIGlmIChvcC50eXBlID09PSBcInRydW5jYXRlXCIpXG4gICAgcmV0dXJuIFtwYXRoLCBgdHJ1bmNhdGUoJHtvcC5zdGFydEluZGV4fSwgJHtvcC5lbmRJbmRleH1gXS5qb2luKFwiOiBcIik7XG4gIGlmIChvcC50eXBlID09PSBcInJlbW92ZVwiKVxuICAgIHJldHVybiBbcGF0aCwgYHJlbW92ZSgke2VuY29kZUl0ZW1SZWYob3AucmVmZXJlbmNlSXRlbSl9KWBdLmpvaW4oXCI6IFwiKTtcbiAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIG9wZXJhdGlvbiB0eXBlOiAke29wLnR5cGV9YCk7XG59XG52YXIgY29tcGFjdCA9IC8qIEBfX1BVUkVfXyAqLyBPYmplY3QuZnJlZXplKHtcbiAgX19wcm90b19fOiBudWxsLFxuICBmb3JtYXRcbn0pO1xuY29uc3Qgc2V0ID0gKHZhbHVlKSA9PiAoeyB0eXBlOiBcInNldFwiLCB2YWx1ZSB9KSwgYXNzaWduID0gKHZhbHVlKSA9PiAoe1xuICB0eXBlOiBcImFzc2lnblwiLFxuICB2YWx1ZVxufSksIHVuYXNzaWduID0gKGtleXMpID0+ICh7XG4gIHR5cGU6IFwidW5hc3NpZ25cIixcbiAga2V5c1xufSksIHNldElmTWlzc2luZyA9ICh2YWx1ZSkgPT4gKHtcbiAgdHlwZTogXCJzZXRJZk1pc3NpbmdcIixcbiAgdmFsdWVcbn0pLCB1bnNldCA9ICgpID0+ICh7IHR5cGU6IFwidW5zZXRcIiB9KSwgaW5jID0gKGFtb3VudCA9IDEpID0+ICh7XG4gIHR5cGU6IFwiaW5jXCIsXG4gIGFtb3VudFxufSksIGRlYyA9IChhbW91bnQgPSAxKSA9PiAoe1xuICB0eXBlOiBcImRlY1wiLFxuICBhbW91bnRcbn0pLCBkaWZmTWF0Y2hQYXRjaCA9ICh2YWx1ZSkgPT4gKHtcbiAgdHlwZTogXCJkaWZmTWF0Y2hQYXRjaFwiLFxuICB2YWx1ZVxufSk7XG5mdW5jdGlvbiBpbnNlcnQoaXRlbXMsIHBvc2l0aW9uLCBpbmRleE9yUmVmZXJlbmNlSXRlbSkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IFwiaW5zZXJ0XCIsXG4gICAgcmVmZXJlbmNlSXRlbTogaW5kZXhPclJlZmVyZW5jZUl0ZW0sXG4gICAgcG9zaXRpb24sXG4gICAgaXRlbXM6IGFycmlmeShpdGVtcylcbiAgfTtcbn1cbmZ1bmN0aW9uIGFwcGVuZChpdGVtcykge1xuICByZXR1cm4gaW5zZXJ0KGl0ZW1zLCBcImFmdGVyXCIsIC0xKTtcbn1cbmZ1bmN0aW9uIHByZXBlbmQoaXRlbXMpIHtcbiAgcmV0dXJuIGluc2VydChpdGVtcywgXCJiZWZvcmVcIiwgMCk7XG59XG5mdW5jdGlvbiBpbnNlcnRCZWZvcmUoaXRlbXMsIGluZGV4T3JSZWZlcmVuY2VJdGVtKSB7XG4gIHJldHVybiBpbnNlcnQoaXRlbXMsIFwiYmVmb3JlXCIsIGluZGV4T3JSZWZlcmVuY2VJdGVtKTtcbn1cbmNvbnN0IGluc2VydEFmdGVyID0gKGl0ZW1zLCBpbmRleE9yUmVmZXJlbmNlSXRlbSkgPT4gaW5zZXJ0KGl0ZW1zLCBcImFmdGVyXCIsIGluZGV4T3JSZWZlcmVuY2VJdGVtKTtcbmZ1bmN0aW9uIHRydW5jYXRlKHN0YXJ0SW5kZXgsIGVuZEluZGV4KSB7XG4gIHJldHVybiB7XG4gICAgdHlwZTogXCJ0cnVuY2F0ZVwiLFxuICAgIHN0YXJ0SW5kZXgsXG4gICAgZW5kSW5kZXhcbiAgfTtcbn1cbmZ1bmN0aW9uIHJlcGxhY2UoaXRlbXMsIHJlZmVyZW5jZUl0ZW0pIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiBcInJlcGxhY2VcIixcbiAgICByZWZlcmVuY2VJdGVtLFxuICAgIGl0ZW1zOiBhcnJpZnkoaXRlbXMpXG4gIH07XG59XG5mdW5jdGlvbiByZW1vdmUocmVmZXJlbmNlSXRlbSkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IFwicmVtb3ZlXCIsXG4gICAgcmVmZXJlbmNlSXRlbVxuICB9O1xufVxuZnVuY3Rpb24gdXBzZXJ0KGl0ZW1zLCBwb3NpdGlvbiwgcmVmZXJlbmNlSXRlbSkge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IFwidXBzZXJ0XCIsXG4gICAgaXRlbXM6IGFycmlmeShpdGVtcyksXG4gICAgcmVmZXJlbmNlSXRlbSxcbiAgICBwb3NpdGlvblxuICB9O1xufVxuZnVuY3Rpb24gYXV0b0tleXMoZ2VuZXJhdGVLZXkpIHtcbiAgY29uc3QgZW5zdXJlS2V5cyA9IGNyZWF0ZUVuc3VyZUtleXMoZ2VuZXJhdGVLZXkpLCBpbnNlcnQkMSA9IChwb3NpdGlvbiwgcmVmZXJlbmNlSXRlbSwgaXRlbXMpID0+IGluc2VydChlbnN1cmVLZXlzKGl0ZW1zKSwgcG9zaXRpb24sIHJlZmVyZW5jZUl0ZW0pLCB1cHNlcnQkMSA9IChpdGVtcywgcG9zaXRpb24sIHJlZmVyZW5jZUl0ZW0pID0+IHVwc2VydChlbnN1cmVLZXlzKGl0ZW1zKSwgcG9zaXRpb24sIHJlZmVyZW5jZUl0ZW0pLCByZXBsYWNlJDEgPSAoaXRlbXMsIHBvc2l0aW9uLCByZWZlcmVuY2VJdGVtKSA9PiByZXBsYWNlKGVuc3VyZUtleXMoaXRlbXMpLCByZWZlcmVuY2VJdGVtKSwgaW5zZXJ0QmVmb3JlMiA9IChyZWYsIGl0ZW1zKSA9PiBpbnNlcnQkMShcImJlZm9yZVwiLCByZWYsIGl0ZW1zKTtcbiAgcmV0dXJuIHsgaW5zZXJ0OiBpbnNlcnQkMSwgdXBzZXJ0OiB1cHNlcnQkMSwgcmVwbGFjZTogcmVwbGFjZSQxLCBpbnNlcnRCZWZvcmU6IGluc2VydEJlZm9yZTIsIHByZXBlbmQ6IChpdGVtcykgPT4gaW5zZXJ0QmVmb3JlMigwLCBpdGVtcyksIGluc2VydEFmdGVyOiAocmVmLCBpdGVtcykgPT4gaW5zZXJ0JDEoXCJhZnRlclwiLCByZWYsIGl0ZW1zKSwgYXBwZW5kOiAoaXRlbXMpID0+IGluc2VydCQxKFwiYWZ0ZXJcIiwgLTEsIGl0ZW1zKSB9O1xufVxuZnVuY3Rpb24gaGFzS2V5KGl0ZW0pIHtcbiAgcmV0dXJuIFwiX2tleVwiIGluIGl0ZW07XG59XG5mdW5jdGlvbiBjcmVhdGVFbnN1cmVLZXlzKGdlbmVyYXRlS2V5KSB7XG4gIHJldHVybiAoYXJyYXkpID0+IHtcbiAgICBsZXQgZGlkTW9kaWZ5ID0gITE7XG4gICAgY29uc3Qgd2l0aEtleXMgPSBhcnJheS5tYXAoKGl0ZW0pID0+IG5lZWRzS2V5KGl0ZW0pID8gKGRpZE1vZGlmeSA9ICEwLCB7IC4uLml0ZW0sIF9rZXk6IGdlbmVyYXRlS2V5KGl0ZW0pIH0pIDogaXRlbSk7XG4gICAgcmV0dXJuIGRpZE1vZGlmeSA/IHdpdGhLZXlzIDogYXJyYXk7XG4gIH07XG59XG5mdW5jdGlvbiBuZWVkc0tleShhcnJheUl0ZW0pIHtcbiAgcmV0dXJuIGlzT2JqZWN0KGFycmF5SXRlbSkgJiYgIWhhc0tleShhcnJheUl0ZW0pO1xufVxuZnVuY3Rpb24gY3JlYXRlKGRvY3VtZW50KSB7XG4gIHJldHVybiB7IHR5cGU6IFwiY3JlYXRlXCIsIGRvY3VtZW50IH07XG59XG5mdW5jdGlvbiBwYXRjaChpZCwgcGF0Y2hlcywgb3B0aW9ucykge1xuICByZXR1cm4ge1xuICAgIHR5cGU6IFwicGF0Y2hcIixcbiAgICBpZCxcbiAgICBwYXRjaGVzOiBhcnJpZnkocGF0Y2hlcyksXG4gICAgLi4ub3B0aW9ucyA/IHsgb3B0aW9ucyB9IDoge31cbiAgfTtcbn1cbmZ1bmN0aW9uIGF0KHBhdGgsIG9wZXJhdGlvbikge1xuICByZXR1cm4ge1xuICAgIHBhdGg6IHR5cGVvZiBwYXRoID09IFwic3RyaW5nXCIgPyBwYXJzZShwYXRoKSA6IHBhdGgsXG4gICAgb3A6IG9wZXJhdGlvblxuICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlSWZOb3RFeGlzdHMoZG9jdW1lbnQpIHtcbiAgcmV0dXJuIHsgdHlwZTogXCJjcmVhdGVJZk5vdEV4aXN0c1wiLCBkb2N1bWVudCB9O1xufVxuZnVuY3Rpb24gY3JlYXRlT3JSZXBsYWNlKGRvY3VtZW50KSB7XG4gIHJldHVybiB7IHR5cGU6IFwiY3JlYXRlT3JSZXBsYWNlXCIsIGRvY3VtZW50IH07XG59XG5mdW5jdGlvbiBkZWxldGVfKGlkKSB7XG4gIHJldHVybiB7IHR5cGU6IFwiZGVsZXRlXCIsIGlkIH07XG59XG5jb25zdCBkZWwgPSBkZWxldGVfLCBkZXN0cm95ID0gZGVsZXRlXztcbmV4cG9ydCB7XG4gIGluZGV4JDEgYXMgQ29tcGFjdEVuY29kZXIsXG4gIGNvbXBhY3QgYXMgQ29tcGFjdEZvcm1hdHRlcixcbiAgaW5kZXggYXMgU2FuaXR5RW5jb2RlcixcbiAgYXBwZW5kLFxuICBhc3NpZ24sXG4gIGF0LFxuICBhdXRvS2V5cyxcbiAgY3JlYXRlLFxuICBjcmVhdGVJZk5vdEV4aXN0cyxcbiAgY3JlYXRlT3JSZXBsYWNlLFxuICBkZWMsXG4gIGRlbCxcbiAgZGVsZXRlXyxcbiAgZGVzdHJveSxcbiAgZGlmZk1hdGNoUGF0Y2gsXG4gIGluYyxcbiAgaW5zZXJ0LFxuICBpbnNlcnRBZnRlcixcbiAgaW5zZXJ0QmVmb3JlLFxuICBwYXRjaCxcbiAgcHJlcGVuZCxcbiAgcmVtb3ZlLFxuICByZXBsYWNlLFxuICBzZXQsXG4gIHNldElmTWlzc2luZyxcbiAgdHJ1bmNhdGUsXG4gIHVuYXNzaWduLFxuICB1bnNldCxcbiAgdXBzZXJ0XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/PointerEvents.js":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/PointerEvents.js ***!
  \*******************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   InsertMenu: () => (/* binding */ InsertMenu),\n/* harmony export */   InsertMenuPopover: () => (/* binding */ InsertMenuPopover),\n/* harmony export */   PointerEvents: () => (/* binding */ PointerEvents),\n/* harmony export */   PopoverPortal: () => (/* binding */ PopoverPortal),\n/* harmony export */   TelemetryContext: () => (/* binding */ TelemetryContext),\n/* harmony export */   events: () => (/* binding */ events),\n/* harmony export */   getNodeIcon: () => (/* binding */ getNodeIcon),\n/* harmony export */   useTelemetry: () => (/* binding */ useTelemetry)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n/* harmony import */ var react_compiler_runtime__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-compiler-runtime */ \"(ssr)/./node_modules/react-compiler-runtime/dist/index.js\");\n/* harmony import */ var _sanity_insert_menu__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sanity/insert-menu */ \"(ssr)/./node_modules/@sanity/insert-menu/dist/index.js\");\n/* harmony import */ var _sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sanity/ui/_visual-editing */ \"(ssr)/./node_modules/@sanity/ui/dist/_chunks-es/_visual-editing.mjs\");\n/* harmony import */ var styled_components__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! styled-components */ \"(ssr)/./node_modules/styled-components/dist/styled-components.esm.js\");\n/* harmony import */ var _sanity_icons__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sanity/icons */ \"(ssr)/./node_modules/@sanity/icons/dist/index.js\");\n\n\n\n\n\n\n\nfunction getNodeIcon(option) {\n  if (!option) return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.CubeIcon, {});\n  if (option.type === \"string\")\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.StringIcon, {});\n  if (option.type === \"number\")\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.NumberIcon, {});\n  const {\n    value: node\n  } = option;\n  if (\"icon\" in option && option.icon)\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { dangerouslySetInnerHTML: {\n      __html: option.icon\n    } });\n  const {\n    type\n  } = node;\n  if (type === \"string\")\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.StringIcon, {});\n  if (type === \"boolean\")\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.CheckmarkCircleIcon, {});\n  if (type === \"number\")\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.NumberIcon, {});\n  if (type === \"array\" || type === \"union\")\n    return (Array.isArray(node.of) ? node.of : [node.of]).some((n) => \"name\" in n && n.name === \"block\") ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.BlockContentIcon, {}) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.ThListIcon, {});\n  if (type === \"object\") {\n    if (option.name === \"image\")\n      return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.ImageIcon, {});\n    if (option.name === \"block\")\n      return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.StringIcon, {});\n  }\n  return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_3__.CubeIcon, {});\n}\nconst PortalContainer = styled_components__WEBPACK_IMPORTED_MODULE_4__.styled.div`\n  height: 100%;\n  inset: 0;\n  overflow-y: scroll;\n  overscroll-behavior: contain;\n  pointer-events: all;\n  position: fixed;\n  width: 100%;\n  -ms-overflow-style: none;\n  scrollbar-width: none;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  &:before {\n    content: '';\n    display: block;\n    height: calc(100% + 1px);\n    position: absolute;\n    top: 0;\n    width: 100%;\n    z-index: -1;\n  }\n`, PortalBackground = styled_components__WEBPACK_IMPORTED_MODULE_4__.styled.div`\n  background: transparent;\n  height: 100%;\n  inset: 0;\n  position: absolute;\n  width: 100%;\n`, PopoverPortal = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_2__.c)(6), {\n    children,\n    onDismiss,\n    setBoundaryElement\n  } = props, handleClick = _temp$1;\n  let t0;\n  $[0] !== onDismiss ? (t0 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(PortalBackground, { onClickCapture: onDismiss }), $[0] = onDismiss, $[1] = t0) : t0 = $[1];\n  let t1;\n  return $[2] !== children || $[3] !== setBoundaryElement || $[4] !== t0 ? (t1 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_5__.Portal, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(PortalContainer, { \"data-sanity-overlay-element\": !0, ref: setBoundaryElement, onClick: handleClick, children: [\n    t0,\n    children\n  ] }) }), $[2] = children, $[3] = setBoundaryElement, $[4] = t0, $[5] = t1) : t1 = $[5], t1;\n};\nfunction _temp$1(event) {\n  event.stopPropagation();\n}\nfunction defineEvent(options) {\n  return {\n    type: \"log\",\n    name: options.name,\n    version: options.version,\n    description: options.description,\n    maxSampleRate: options.maxSampleRate,\n    schema: void 0\n  };\n}\nconst events = {\n  \"Visual Editing Drag Sequence Completed\": defineEvent({\n    name: \"Visual Editing Drag Sequence Completed\",\n    description: \"An array is successfully reordered using drag and drop.\",\n    version: 1\n  }),\n  \"Visual Editing Drag Minimap Enabled\": defineEvent({\n    name: \"Visual Editing Drag Minimap Enabled\",\n    description: \"The zoomed-out minimap view is enabled during a drag sequence.\",\n    version: 1\n  }),\n  \"Visual Editing Context Menu Item Removed\": defineEvent({\n    name: \"Visual Editing Context Menu Item Removed\",\n    description: \"An item is removed using the Context Menu.\",\n    version: 1\n  }),\n  \"Visual Editing Context Menu Item Duplicated\": defineEvent({\n    name: \"Visual Editing Context Menu Item Duplicated\",\n    description: \"An item is duplicated using the Context Menu.\",\n    version: 1\n  }),\n  \"Visual Editing Context Menu Item Moved\": defineEvent({\n    name: \"Visual Editing Context Menu Item Moved\",\n    description: \"An item is moved using the Context Menu.\",\n    version: 1\n  }),\n  \"Visual Editing Context Menu Item Inserted\": defineEvent({\n    name: \"Visual Editing Context Menu Item Inserted\",\n    description: \"An item is inserted using the Context Menu.\",\n    version: 1\n  }),\n  \"Visual Editing Insert Menu Item Inserted\": defineEvent({\n    name: \"Visual Editing Insert Menu Item Inserted\",\n    description: \"An item is inserted using the Insert Menu.\",\n    version: 1\n  }),\n  \"Visual Editing Overlay Clicked\": defineEvent({\n    name: \"Visual Editing Overlay Clicked\",\n    description: \"An Overlay is clicked.\",\n    version: 1\n  })\n}, TelemetryContext = (0,react__WEBPACK_IMPORTED_MODULE_0__.createContext)(void 0);\nfunction useTelemetry() {\n  const context = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(TelemetryContext);\n  if (!context)\n    throw new Error(\"Telemetry context is missing\");\n  return context;\n}\nconst labels = {\n  \"insert-menu.filter.all-items\": \"All\",\n  \"insert-menu.search.no-results\": \"No results\",\n  \"insert-menu.search.placeholder\": \"Filter types\\u2026\",\n  \"insert-menu.toggle-grid-view.tooltip\": \"Toggle grid view\",\n  \"insert-menu.toggle-list-view.tooltip\": \"Toggle list view\"\n}, InsertMenu = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_2__.c)(11), {\n    node,\n    onSelect\n  } = props;\n  let t0;\n  $[0] !== node.options?.insertMenu ? (t0 = node.options?.insertMenu || {}, $[0] = node.options?.insertMenu, $[1] = t0) : t0 = $[1];\n  const insertMenuOptions = t0;\n  let t1;\n  $[2] !== insertMenuOptions.views ? (t1 = insertMenuOptions.views?.map(_temp), $[2] = insertMenuOptions.views, $[3] = t1) : t1 = $[3];\n  const views = t1;\n  let t2;\n  $[4] !== node.of ? (t2 = node.of.map(_temp2), $[4] = node.of, $[5] = t2) : t2 = $[5];\n  let t3;\n  return $[6] !== insertMenuOptions || $[7] !== onSelect || $[8] !== t2 || $[9] !== views ? (t3 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_insert_menu__WEBPACK_IMPORTED_MODULE_6__.InsertMenu, { ...insertMenuOptions, labels, schemaTypes: t2, onSelect, views }), $[6] = insertMenuOptions, $[7] = onSelect, $[8] = t2, $[9] = views, $[10] = t3) : t3 = $[10], t3;\n}, InsertMenuPopover = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_2__.c)(11), {\n    node,\n    onDismiss,\n    onSelect,\n    referenceElement\n  } = props;\n  let t0;\n  $[0] !== node || $[1] !== onSelect ? (t0 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(InsertMenu, { node, onSelect }), $[0] = node, $[1] = onSelect, $[2] = t0) : t0 = $[2];\n  const popoverContent = t0, width = (node.options?.insertMenu || {}).views?.some(_temp3) ? 0 : void 0;\n  let t1;\n  $[3] === Symbol.for(\"react.memo_cache_sentinel\") ? (t1 = [\"bottom\"], $[3] = t1) : t1 = $[3];\n  let t2;\n  $[4] !== popoverContent || $[5] !== referenceElement || $[6] !== width ? (t2 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_5__.Popover, { animate: !0, constrainSize: !0, content: popoverContent, fallbackPlacements: t1, open: !0, placement: \"top\", preventOverflow: !0, referenceElement, width }), $[4] = popoverContent, $[5] = referenceElement, $[6] = width, $[7] = t2) : t2 = $[7];\n  let t3;\n  return $[8] !== onDismiss || $[9] !== t2 ? (t3 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(PopoverPortal, { onDismiss, children: t2 }), $[8] = onDismiss, $[9] = t2, $[10] = t3) : t3 = $[10], t3;\n};\nfunction _temp(view) {\n  return view.name === \"grid\" ? {\n    ...view,\n    previewImageUrl: (name) => view.previewImageUrls?.[name]\n  } : view;\n}\nfunction _temp2(type) {\n  return {\n    ...type,\n    icon: getNodeIcon(type)\n  };\n}\nfunction _temp3(view) {\n  return view.name === \"grid\";\n}\nconst PointerEvents = (t0) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_2__.c)(10);\n  let children, rest, style;\n  $[0] !== t0 ? ({\n    children,\n    style,\n    ...rest\n  } = t0, $[0] = t0, $[1] = children, $[2] = rest, $[3] = style) : (children = $[1], rest = $[2], style = $[3]);\n  let t1;\n  $[4] !== style ? (t1 = {\n    ...style,\n    pointerEvents: \"all\"\n  }, $[4] = style, $[5] = t1) : t1 = $[5];\n  let t2;\n  return $[6] !== children || $[7] !== rest || $[8] !== t1 ? (t2 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(\"div\", { style: t1, \"data-sanity-overlay-element\": !0, ...rest, children }), $[6] = children, $[7] = rest, $[8] = t1, $[9] = t2) : t2 = $[9], t2;\n};\n\n//# sourceMappingURL=PointerEvents.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvdmlzdWFsLWVkaXRpbmcvZGlzdC9fY2h1bmtzLWVzL1BvaW50ZXJFdmVudHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQWtEO0FBQ0o7QUFDSDtBQUNzQjtBQUNKO0FBQ2xCO0FBQ29GO0FBQy9IO0FBQ0Esc0NBQXNDLHNEQUFHLENBQUMsbURBQVEsSUFBSTtBQUN0RDtBQUNBLDJCQUEyQixzREFBRyxDQUFDLHFEQUFVLElBQUk7QUFDN0M7QUFDQSwyQkFBMkIsc0RBQUcsQ0FBQyxxREFBVSxJQUFJO0FBQzdDO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSwyQkFBMkIsc0RBQUcsVUFBVTtBQUN4QztBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsMkJBQTJCLHNEQUFHLENBQUMscURBQVUsSUFBSTtBQUM3QztBQUNBLDJCQUEyQixzREFBRyxDQUFDLDhEQUFtQixJQUFJO0FBQ3REO0FBQ0EsMkJBQTJCLHNEQUFHLENBQUMscURBQVUsSUFBSTtBQUM3QztBQUNBLDJIQUEySCxzREFBRyxDQUFDLDJEQUFnQixJQUFJLG9CQUFvQixzREFBRyxDQUFDLHFEQUFVLElBQUk7QUFDekw7QUFDQTtBQUNBLDZCQUE2QixzREFBRyxDQUFDLG9EQUFTLElBQUk7QUFDOUM7QUFDQSw2QkFBNkIsc0RBQUcsQ0FBQyxxREFBVSxJQUFJO0FBQy9DO0FBQ0EseUJBQXlCLHNEQUFHLENBQUMsbURBQVEsSUFBSTtBQUN6QztBQUNBLHdCQUF3QixxREFBTTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IscURBQU07QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx5REFBQztBQUNiO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLDZDQUE2QyxzREFBRyxxQkFBcUIsMkJBQTJCO0FBQ2hHO0FBQ0EsaUdBQWlHLHNEQUFHLENBQUMsNkRBQU0sSUFBSSwwQkFBMEIsdURBQUksb0JBQW9CO0FBQ2pLO0FBQ0E7QUFDQSxLQUFLLEdBQUc7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxDQUFDLHFCQUFxQixvREFBYTtBQUNuQztBQUNBLGtCQUFrQixpREFBVTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCxZQUFZLHlEQUFDO0FBQ2I7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLDBFQUEwRTtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtIQUFrSCxzREFBRyxDQUFDLDJEQUFZLElBQUksZ0VBQWdFO0FBQ3RNLENBQUM7QUFDRCxZQUFZLHlEQUFDO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSw2REFBNkQsc0RBQUcsZUFBZSxnQkFBZ0I7QUFDL0Ysb0VBQW9FO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBLGlHQUFpRyxzREFBRyxDQUFDLDhEQUFPLElBQUksMkpBQTJKO0FBQzNRO0FBQ0EsbUVBQW1FLHNEQUFHLGtCQUFrQix5QkFBeUI7QUFDakg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx5REFBQztBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxtRkFBbUYsc0RBQUcsVUFBVSxpRUFBaUU7QUFDaks7QUFVRTtBQUNGIiwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL25vZGVfbW9kdWxlcy9uZXh0LXNhbml0eS9ub2RlX21vZHVsZXMvQHNhbml0eS92aXN1YWwtZWRpdGluZy9kaXN0L19jaHVua3MtZXMvUG9pbnRlckV2ZW50cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDb250ZXh0LCB1c2VDb250ZXh0IH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBqc3gsIGpzeHMgfSBmcm9tIFwicmVhY3QvanN4LXJ1bnRpbWVcIjtcbmltcG9ydCB7IGMgfSBmcm9tIFwicmVhY3QtY29tcGlsZXItcnVudGltZVwiO1xuaW1wb3J0IHsgSW5zZXJ0TWVudSBhcyBJbnNlcnRNZW51JDEgfSBmcm9tIFwiQHNhbml0eS9pbnNlcnQtbWVudVwiO1xuaW1wb3J0IHsgUG9ydGFsLCBQb3BvdmVyIH0gZnJvbSBcIkBzYW5pdHkvdWkvX3Zpc3VhbC1lZGl0aW5nXCI7XG5pbXBvcnQgeyBzdHlsZWQgfSBmcm9tIFwic3R5bGVkLWNvbXBvbmVudHNcIjtcbmltcG9ydCB7IEN1YmVJY29uLCBTdHJpbmdJY29uLCBOdW1iZXJJY29uLCBDaGVja21hcmtDaXJjbGVJY29uLCBCbG9ja0NvbnRlbnRJY29uLCBUaExpc3RJY29uLCBJbWFnZUljb24gfSBmcm9tIFwiQHNhbml0eS9pY29uc1wiO1xuZnVuY3Rpb24gZ2V0Tm9kZUljb24ob3B0aW9uKSB7XG4gIGlmICghb3B0aW9uKSByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeChDdWJlSWNvbiwge30pO1xuICBpZiAob3B0aW9uLnR5cGUgPT09IFwic3RyaW5nXCIpXG4gICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3goU3RyaW5nSWNvbiwge30pO1xuICBpZiAob3B0aW9uLnR5cGUgPT09IFwibnVtYmVyXCIpXG4gICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3goTnVtYmVySWNvbiwge30pO1xuICBjb25zdCB7XG4gICAgdmFsdWU6IG5vZGVcbiAgfSA9IG9wdGlvbjtcbiAgaWYgKFwiaWNvblwiIGluIG9wdGlvbiAmJiBvcHRpb24uaWNvbilcbiAgICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeChcImRpdlwiLCB7IGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MOiB7XG4gICAgICBfX2h0bWw6IG9wdGlvbi5pY29uXG4gICAgfSB9KTtcbiAgY29uc3Qge1xuICAgIHR5cGVcbiAgfSA9IG5vZGU7XG4gIGlmICh0eXBlID09PSBcInN0cmluZ1wiKVxuICAgIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4KFN0cmluZ0ljb24sIHt9KTtcbiAgaWYgKHR5cGUgPT09IFwiYm9vbGVhblwiKVxuICAgIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4KENoZWNrbWFya0NpcmNsZUljb24sIHt9KTtcbiAgaWYgKHR5cGUgPT09IFwibnVtYmVyXCIpXG4gICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3goTnVtYmVySWNvbiwge30pO1xuICBpZiAodHlwZSA9PT0gXCJhcnJheVwiIHx8IHR5cGUgPT09IFwidW5pb25cIilcbiAgICByZXR1cm4gKEFycmF5LmlzQXJyYXkobm9kZS5vZikgPyBub2RlLm9mIDogW25vZGUub2ZdKS5zb21lKChuKSA9PiBcIm5hbWVcIiBpbiBuICYmIG4ubmFtZSA9PT0gXCJibG9ja1wiKSA/IC8qIEBfX1BVUkVfXyAqLyBqc3goQmxvY2tDb250ZW50SWNvbiwge30pIDogLyogQF9fUFVSRV9fICovIGpzeChUaExpc3RJY29uLCB7fSk7XG4gIGlmICh0eXBlID09PSBcIm9iamVjdFwiKSB7XG4gICAgaWYgKG9wdGlvbi5uYW1lID09PSBcImltYWdlXCIpXG4gICAgICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeChJbWFnZUljb24sIHt9KTtcbiAgICBpZiAob3B0aW9uLm5hbWUgPT09IFwiYmxvY2tcIilcbiAgICAgIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4KFN0cmluZ0ljb24sIHt9KTtcbiAgfVxuICByZXR1cm4gLyogQF9fUFVSRV9fICovIGpzeChDdWJlSWNvbiwge30pO1xufVxuY29uc3QgUG9ydGFsQ29udGFpbmVyID0gc3R5bGVkLmRpdmBcbiAgaGVpZ2h0OiAxMDAlO1xuICBpbnNldDogMDtcbiAgb3ZlcmZsb3cteTogc2Nyb2xsO1xuICBvdmVyc2Nyb2xsLWJlaGF2aW9yOiBjb250YWluO1xuICBwb2ludGVyLWV2ZW50czogYWxsO1xuICBwb3NpdGlvbjogZml4ZWQ7XG4gIHdpZHRoOiAxMDAlO1xuICAtbXMtb3ZlcmZsb3ctc3R5bGU6IG5vbmU7XG4gIHNjcm9sbGJhci13aWR0aDogbm9uZTtcbiAgZGlzcGxheTogZmxleDtcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICY6YmVmb3JlIHtcbiAgICBjb250ZW50OiAnJztcbiAgICBkaXNwbGF5OiBibG9jaztcbiAgICBoZWlnaHQ6IGNhbGMoMTAwJSArIDFweCk7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIHRvcDogMDtcbiAgICB3aWR0aDogMTAwJTtcbiAgICB6LWluZGV4OiAtMTtcbiAgfVxuYCwgUG9ydGFsQmFja2dyb3VuZCA9IHN0eWxlZC5kaXZgXG4gIGJhY2tncm91bmQ6IHRyYW5zcGFyZW50O1xuICBoZWlnaHQ6IDEwMCU7XG4gIGluc2V0OiAwO1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHdpZHRoOiAxMDAlO1xuYCwgUG9wb3ZlclBvcnRhbCA9IChwcm9wcykgPT4ge1xuICBjb25zdCAkID0gYyg2KSwge1xuICAgIGNoaWxkcmVuLFxuICAgIG9uRGlzbWlzcyxcbiAgICBzZXRCb3VuZGFyeUVsZW1lbnRcbiAgfSA9IHByb3BzLCBoYW5kbGVDbGljayA9IF90ZW1wJDE7XG4gIGxldCB0MDtcbiAgJFswXSAhPT0gb25EaXNtaXNzID8gKHQwID0gLyogQF9fUFVSRV9fICovIGpzeChQb3J0YWxCYWNrZ3JvdW5kLCB7IG9uQ2xpY2tDYXB0dXJlOiBvbkRpc21pc3MgfSksICRbMF0gPSBvbkRpc21pc3MsICRbMV0gPSB0MCkgOiB0MCA9ICRbMV07XG4gIGxldCB0MTtcbiAgcmV0dXJuICRbMl0gIT09IGNoaWxkcmVuIHx8ICRbM10gIT09IHNldEJvdW5kYXJ5RWxlbWVudCB8fCAkWzRdICE9PSB0MCA/ICh0MSA9IC8qIEBfX1BVUkVfXyAqLyBqc3goUG9ydGFsLCB7IGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4cyhQb3J0YWxDb250YWluZXIsIHsgXCJkYXRhLXNhbml0eS1vdmVybGF5LWVsZW1lbnRcIjogITAsIHJlZjogc2V0Qm91bmRhcnlFbGVtZW50LCBvbkNsaWNrOiBoYW5kbGVDbGljaywgY2hpbGRyZW46IFtcbiAgICB0MCxcbiAgICBjaGlsZHJlblxuICBdIH0pIH0pLCAkWzJdID0gY2hpbGRyZW4sICRbM10gPSBzZXRCb3VuZGFyeUVsZW1lbnQsICRbNF0gPSB0MCwgJFs1XSA9IHQxKSA6IHQxID0gJFs1XSwgdDE7XG59O1xuZnVuY3Rpb24gX3RlbXAkMShldmVudCkge1xuICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbn1cbmZ1bmN0aW9uIGRlZmluZUV2ZW50KG9wdGlvbnMpIHtcbiAgcmV0dXJuIHtcbiAgICB0eXBlOiBcImxvZ1wiLFxuICAgIG5hbWU6IG9wdGlvbnMubmFtZSxcbiAgICB2ZXJzaW9uOiBvcHRpb25zLnZlcnNpb24sXG4gICAgZGVzY3JpcHRpb246IG9wdGlvbnMuZGVzY3JpcHRpb24sXG4gICAgbWF4U2FtcGxlUmF0ZTogb3B0aW9ucy5tYXhTYW1wbGVSYXRlLFxuICAgIHNjaGVtYTogdm9pZCAwXG4gIH07XG59XG5jb25zdCBldmVudHMgPSB7XG4gIFwiVmlzdWFsIEVkaXRpbmcgRHJhZyBTZXF1ZW5jZSBDb21wbGV0ZWRcIjogZGVmaW5lRXZlbnQoe1xuICAgIG5hbWU6IFwiVmlzdWFsIEVkaXRpbmcgRHJhZyBTZXF1ZW5jZSBDb21wbGV0ZWRcIixcbiAgICBkZXNjcmlwdGlvbjogXCJBbiBhcnJheSBpcyBzdWNjZXNzZnVsbHkgcmVvcmRlcmVkIHVzaW5nIGRyYWcgYW5kIGRyb3AuXCIsXG4gICAgdmVyc2lvbjogMVxuICB9KSxcbiAgXCJWaXN1YWwgRWRpdGluZyBEcmFnIE1pbmltYXAgRW5hYmxlZFwiOiBkZWZpbmVFdmVudCh7XG4gICAgbmFtZTogXCJWaXN1YWwgRWRpdGluZyBEcmFnIE1pbmltYXAgRW5hYmxlZFwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB6b29tZWQtb3V0IG1pbmltYXAgdmlldyBpcyBlbmFibGVkIGR1cmluZyBhIGRyYWcgc2VxdWVuY2UuXCIsXG4gICAgdmVyc2lvbjogMVxuICB9KSxcbiAgXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBSZW1vdmVkXCI6IGRlZmluZUV2ZW50KHtcbiAgICBuYW1lOiBcIlZpc3VhbCBFZGl0aW5nIENvbnRleHQgTWVudSBJdGVtIFJlbW92ZWRcIixcbiAgICBkZXNjcmlwdGlvbjogXCJBbiBpdGVtIGlzIHJlbW92ZWQgdXNpbmcgdGhlIENvbnRleHQgTWVudS5cIixcbiAgICB2ZXJzaW9uOiAxXG4gIH0pLFxuICBcIlZpc3VhbCBFZGl0aW5nIENvbnRleHQgTWVudSBJdGVtIER1cGxpY2F0ZWRcIjogZGVmaW5lRXZlbnQoe1xuICAgIG5hbWU6IFwiVmlzdWFsIEVkaXRpbmcgQ29udGV4dCBNZW51IEl0ZW0gRHVwbGljYXRlZFwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIkFuIGl0ZW0gaXMgZHVwbGljYXRlZCB1c2luZyB0aGUgQ29udGV4dCBNZW51LlwiLFxuICAgIHZlcnNpb246IDFcbiAgfSksXG4gIFwiVmlzdWFsIEVkaXRpbmcgQ29udGV4dCBNZW51IEl0ZW0gTW92ZWRcIjogZGVmaW5lRXZlbnQoe1xuICAgIG5hbWU6IFwiVmlzdWFsIEVkaXRpbmcgQ29udGV4dCBNZW51IEl0ZW0gTW92ZWRcIixcbiAgICBkZXNjcmlwdGlvbjogXCJBbiBpdGVtIGlzIG1vdmVkIHVzaW5nIHRoZSBDb250ZXh0IE1lbnUuXCIsXG4gICAgdmVyc2lvbjogMVxuICB9KSxcbiAgXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBJbnNlcnRlZFwiOiBkZWZpbmVFdmVudCh7XG4gICAgbmFtZTogXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBJbnNlcnRlZFwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIkFuIGl0ZW0gaXMgaW5zZXJ0ZWQgdXNpbmcgdGhlIENvbnRleHQgTWVudS5cIixcbiAgICB2ZXJzaW9uOiAxXG4gIH0pLFxuICBcIlZpc3VhbCBFZGl0aW5nIEluc2VydCBNZW51IEl0ZW0gSW5zZXJ0ZWRcIjogZGVmaW5lRXZlbnQoe1xuICAgIG5hbWU6IFwiVmlzdWFsIEVkaXRpbmcgSW5zZXJ0IE1lbnUgSXRlbSBJbnNlcnRlZFwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIkFuIGl0ZW0gaXMgaW5zZXJ0ZWQgdXNpbmcgdGhlIEluc2VydCBNZW51LlwiLFxuICAgIHZlcnNpb246IDFcbiAgfSksXG4gIFwiVmlzdWFsIEVkaXRpbmcgT3ZlcmxheSBDbGlja2VkXCI6IGRlZmluZUV2ZW50KHtcbiAgICBuYW1lOiBcIlZpc3VhbCBFZGl0aW5nIE92ZXJsYXkgQ2xpY2tlZFwiLFxuICAgIGRlc2NyaXB0aW9uOiBcIkFuIE92ZXJsYXkgaXMgY2xpY2tlZC5cIixcbiAgICB2ZXJzaW9uOiAxXG4gIH0pXG59LCBUZWxlbWV0cnlDb250ZXh0ID0gY3JlYXRlQ29udGV4dCh2b2lkIDApO1xuZnVuY3Rpb24gdXNlVGVsZW1ldHJ5KCkge1xuICBjb25zdCBjb250ZXh0ID0gdXNlQ29udGV4dChUZWxlbWV0cnlDb250ZXh0KTtcbiAgaWYgKCFjb250ZXh0KVxuICAgIHRocm93IG5ldyBFcnJvcihcIlRlbGVtZXRyeSBjb250ZXh0IGlzIG1pc3NpbmdcIik7XG4gIHJldHVybiBjb250ZXh0O1xufVxuY29uc3QgbGFiZWxzID0ge1xuICBcImluc2VydC1tZW51LmZpbHRlci5hbGwtaXRlbXNcIjogXCJBbGxcIixcbiAgXCJpbnNlcnQtbWVudS5zZWFyY2gubm8tcmVzdWx0c1wiOiBcIk5vIHJlc3VsdHNcIixcbiAgXCJpbnNlcnQtbWVudS5zZWFyY2gucGxhY2Vob2xkZXJcIjogXCJGaWx0ZXIgdHlwZXNcXHUyMDI2XCIsXG4gIFwiaW5zZXJ0LW1lbnUudG9nZ2xlLWdyaWQtdmlldy50b29sdGlwXCI6IFwiVG9nZ2xlIGdyaWQgdmlld1wiLFxuICBcImluc2VydC1tZW51LnRvZ2dsZS1saXN0LXZpZXcudG9vbHRpcFwiOiBcIlRvZ2dsZSBsaXN0IHZpZXdcIlxufSwgSW5zZXJ0TWVudSA9IChwcm9wcykgPT4ge1xuICBjb25zdCAkID0gYygxMSksIHtcbiAgICBub2RlLFxuICAgIG9uU2VsZWN0XG4gIH0gPSBwcm9wcztcbiAgbGV0IHQwO1xuICAkWzBdICE9PSBub2RlLm9wdGlvbnM/Lmluc2VydE1lbnUgPyAodDAgPSBub2RlLm9wdGlvbnM/Lmluc2VydE1lbnUgfHwge30sICRbMF0gPSBub2RlLm9wdGlvbnM/Lmluc2VydE1lbnUsICRbMV0gPSB0MCkgOiB0MCA9ICRbMV07XG4gIGNvbnN0IGluc2VydE1lbnVPcHRpb25zID0gdDA7XG4gIGxldCB0MTtcbiAgJFsyXSAhPT0gaW5zZXJ0TWVudU9wdGlvbnMudmlld3MgPyAodDEgPSBpbnNlcnRNZW51T3B0aW9ucy52aWV3cz8ubWFwKF90ZW1wKSwgJFsyXSA9IGluc2VydE1lbnVPcHRpb25zLnZpZXdzLCAkWzNdID0gdDEpIDogdDEgPSAkWzNdO1xuICBjb25zdCB2aWV3cyA9IHQxO1xuICBsZXQgdDI7XG4gICRbNF0gIT09IG5vZGUub2YgPyAodDIgPSBub2RlLm9mLm1hcChfdGVtcDIpLCAkWzRdID0gbm9kZS5vZiwgJFs1XSA9IHQyKSA6IHQyID0gJFs1XTtcbiAgbGV0IHQzO1xuICByZXR1cm4gJFs2XSAhPT0gaW5zZXJ0TWVudU9wdGlvbnMgfHwgJFs3XSAhPT0gb25TZWxlY3QgfHwgJFs4XSAhPT0gdDIgfHwgJFs5XSAhPT0gdmlld3MgPyAodDMgPSAvKiBAX19QVVJFX18gKi8ganN4KEluc2VydE1lbnUkMSwgeyAuLi5pbnNlcnRNZW51T3B0aW9ucywgbGFiZWxzLCBzY2hlbWFUeXBlczogdDIsIG9uU2VsZWN0LCB2aWV3cyB9KSwgJFs2XSA9IGluc2VydE1lbnVPcHRpb25zLCAkWzddID0gb25TZWxlY3QsICRbOF0gPSB0MiwgJFs5XSA9IHZpZXdzLCAkWzEwXSA9IHQzKSA6IHQzID0gJFsxMF0sIHQzO1xufSwgSW5zZXJ0TWVudVBvcG92ZXIgPSAocHJvcHMpID0+IHtcbiAgY29uc3QgJCA9IGMoMTEpLCB7XG4gICAgbm9kZSxcbiAgICBvbkRpc21pc3MsXG4gICAgb25TZWxlY3QsXG4gICAgcmVmZXJlbmNlRWxlbWVudFxuICB9ID0gcHJvcHM7XG4gIGxldCB0MDtcbiAgJFswXSAhPT0gbm9kZSB8fCAkWzFdICE9PSBvblNlbGVjdCA/ICh0MCA9IC8qIEBfX1BVUkVfXyAqLyBqc3goSW5zZXJ0TWVudSwgeyBub2RlLCBvblNlbGVjdCB9KSwgJFswXSA9IG5vZGUsICRbMV0gPSBvblNlbGVjdCwgJFsyXSA9IHQwKSA6IHQwID0gJFsyXTtcbiAgY29uc3QgcG9wb3ZlckNvbnRlbnQgPSB0MCwgd2lkdGggPSAobm9kZS5vcHRpb25zPy5pbnNlcnRNZW51IHx8IHt9KS52aWV3cz8uc29tZShfdGVtcDMpID8gMCA6IHZvaWQgMDtcbiAgbGV0IHQxO1xuICAkWzNdID09PSBTeW1ib2wuZm9yKFwicmVhY3QubWVtb19jYWNoZV9zZW50aW5lbFwiKSA/ICh0MSA9IFtcImJvdHRvbVwiXSwgJFszXSA9IHQxKSA6IHQxID0gJFszXTtcbiAgbGV0IHQyO1xuICAkWzRdICE9PSBwb3BvdmVyQ29udGVudCB8fCAkWzVdICE9PSByZWZlcmVuY2VFbGVtZW50IHx8ICRbNl0gIT09IHdpZHRoID8gKHQyID0gLyogQF9fUFVSRV9fICovIGpzeChQb3BvdmVyLCB7IGFuaW1hdGU6ICEwLCBjb25zdHJhaW5TaXplOiAhMCwgY29udGVudDogcG9wb3ZlckNvbnRlbnQsIGZhbGxiYWNrUGxhY2VtZW50czogdDEsIG9wZW46ICEwLCBwbGFjZW1lbnQ6IFwidG9wXCIsIHByZXZlbnRPdmVyZmxvdzogITAsIHJlZmVyZW5jZUVsZW1lbnQsIHdpZHRoIH0pLCAkWzRdID0gcG9wb3ZlckNvbnRlbnQsICRbNV0gPSByZWZlcmVuY2VFbGVtZW50LCAkWzZdID0gd2lkdGgsICRbN10gPSB0MikgOiB0MiA9ICRbN107XG4gIGxldCB0MztcbiAgcmV0dXJuICRbOF0gIT09IG9uRGlzbWlzcyB8fCAkWzldICE9PSB0MiA/ICh0MyA9IC8qIEBfX1BVUkVfXyAqLyBqc3goUG9wb3ZlclBvcnRhbCwgeyBvbkRpc21pc3MsIGNoaWxkcmVuOiB0MiB9KSwgJFs4XSA9IG9uRGlzbWlzcywgJFs5XSA9IHQyLCAkWzEwXSA9IHQzKSA6IHQzID0gJFsxMF0sIHQzO1xufTtcbmZ1bmN0aW9uIF90ZW1wKHZpZXcpIHtcbiAgcmV0dXJuIHZpZXcubmFtZSA9PT0gXCJncmlkXCIgPyB7XG4gICAgLi4udmlldyxcbiAgICBwcmV2aWV3SW1hZ2VVcmw6IChuYW1lKSA9PiB2aWV3LnByZXZpZXdJbWFnZVVybHM/LltuYW1lXVxuICB9IDogdmlldztcbn1cbmZ1bmN0aW9uIF90ZW1wMih0eXBlKSB7XG4gIHJldHVybiB7XG4gICAgLi4udHlwZSxcbiAgICBpY29uOiBnZXROb2RlSWNvbih0eXBlKVxuICB9O1xufVxuZnVuY3Rpb24gX3RlbXAzKHZpZXcpIHtcbiAgcmV0dXJuIHZpZXcubmFtZSA9PT0gXCJncmlkXCI7XG59XG5jb25zdCBQb2ludGVyRXZlbnRzID0gKHQwKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDEwKTtcbiAgbGV0IGNoaWxkcmVuLCByZXN0LCBzdHlsZTtcbiAgJFswXSAhPT0gdDAgPyAoe1xuICAgIGNoaWxkcmVuLFxuICAgIHN0eWxlLFxuICAgIC4uLnJlc3RcbiAgfSA9IHQwLCAkWzBdID0gdDAsICRbMV0gPSBjaGlsZHJlbiwgJFsyXSA9IHJlc3QsICRbM10gPSBzdHlsZSkgOiAoY2hpbGRyZW4gPSAkWzFdLCByZXN0ID0gJFsyXSwgc3R5bGUgPSAkWzNdKTtcbiAgbGV0IHQxO1xuICAkWzRdICE9PSBzdHlsZSA/ICh0MSA9IHtcbiAgICAuLi5zdHlsZSxcbiAgICBwb2ludGVyRXZlbnRzOiBcImFsbFwiXG4gIH0sICRbNF0gPSBzdHlsZSwgJFs1XSA9IHQxKSA6IHQxID0gJFs1XTtcbiAgbGV0IHQyO1xuICByZXR1cm4gJFs2XSAhPT0gY2hpbGRyZW4gfHwgJFs3XSAhPT0gcmVzdCB8fCAkWzhdICE9PSB0MSA/ICh0MiA9IC8qIEBfX1BVUkVfXyAqLyBqc3goXCJkaXZcIiwgeyBzdHlsZTogdDEsIFwiZGF0YS1zYW5pdHktb3ZlcmxheS1lbGVtZW50XCI6ICEwLCAuLi5yZXN0LCBjaGlsZHJlbiB9KSwgJFs2XSA9IGNoaWxkcmVuLCAkWzddID0gcmVzdCwgJFs4XSA9IHQxLCAkWzldID0gdDIpIDogdDIgPSAkWzldLCB0Mjtcbn07XG5leHBvcnQge1xuICBJbnNlcnRNZW51LFxuICBJbnNlcnRNZW51UG9wb3ZlcixcbiAgUG9pbnRlckV2ZW50cyxcbiAgUG9wb3ZlclBvcnRhbCxcbiAgVGVsZW1ldHJ5Q29udGV4dCxcbiAgZXZlbnRzLFxuICBnZXROb2RlSWNvbixcbiAgdXNlVGVsZW1ldHJ5XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9UG9pbnRlckV2ZW50cy5qcy5tYXBcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/PointerEvents.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/SharedStateContext.js":
/*!************************************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/SharedStateContext.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SharedStateContext: () => (/* binding */ SharedStateContext),\n/* harmony export */   createOverlayController: () => (/* binding */ createOverlayController),\n/* harmony export */   sanityNodesExistInSameArray: () => (/* binding */ sanityNodesExistInSameArray),\n/* harmony export */   useOptimistic: () => (/* binding */ useOptimistic)\n/* harmony export */ });\n/* harmony import */ var react_compiler_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react-compiler-runtime */ \"(ssr)/./node_modules/react-compiler-runtime/dist/index.js\");\n/* harmony import */ var _sanity_client_csm__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sanity/client/csm */ \"(ssr)/./node_modules/@sanity/client/dist/_chunks-es/resolveEditInfo.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var use_effect_event__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! use-effect-event */ \"(ssr)/./node_modules/use-effect-event/dist/index.js\");\n/* harmony import */ var _context_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./context.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js\");\n/* harmony import */ var _mutations_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./mutations.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/mutations.js\");\n/* harmony import */ var _sanity_visual_editing_csm__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @sanity/visual-editing-csm */ \"(ssr)/./node_modules/@sanity/visual-editing-csm/dist/index.js\");\n/* harmony import */ var _vercel_stega__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @vercel/stega */ \"(ssr)/./node_modules/@vercel/stega/dist/index.mjs\");\n\n\n\n\n\n\n\n\nfunction useOptimistic(passthrough, reducer) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_0__.c)(21), [pristine, setPristine] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!0), [optimistic, setOptimistic] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(passthrough), [lastEvent, setLastEvent] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null), [lastPassthrough, setLastPassthrough] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(passthrough), actor = (0,_mutations_js__WEBPACK_IMPORTED_MODULE_3__.useOptimisticActor)();\n  let t0;\n  $[0] !== reducer ? (t0 = (action, prevState) => (Array.isArray(reducer) ? reducer : [reducer]).reduce((acc, reducer_0) => reducer_0(acc, {\n    document: action.document,\n    id: (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_4__.getPublishedId)(action.id),\n    originalId: action.id,\n    type: action.type\n  }), prevState), $[0] = reducer, $[1] = t0) : t0 = $[1];\n  const reduceStateFromAction = (0,use_effect_event__WEBPACK_IMPORTED_MODULE_5__.useEffectEvent)(t0);\n  let t1;\n  $[2] !== passthrough ? (t1 = () => setLastPassthrough(passthrough), $[2] = passthrough, $[3] = t1) : t1 = $[3];\n  const updateLastPassthrough = (0,use_effect_event__WEBPACK_IMPORTED_MODULE_5__.useEffectEvent)(t1);\n  let t2;\n  $[4] !== actor || $[5] !== reduceStateFromAction || $[6] !== updateLastPassthrough ? (t2 = () => {\n    if ((0,_context_js__WEBPACK_IMPORTED_MODULE_6__.isEmptyActor)(actor))\n      return;\n    let pristineTimeout;\n    const rebasedSub = actor.on(\"rebased.local\", (_event) => {\n      const event = {\n        document: _event.document,\n        id: _event.id,\n        originalId: (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_4__.getPublishedId)(_event.id),\n        type: \"mutate\"\n      };\n      setOptimistic((prevState_0) => reduceStateFromAction(event, prevState_0)), setLastEvent(event), updateLastPassthrough(), setPristine(!1), clearTimeout(pristineTimeout);\n    }), pristineSub = actor.on(\"pristine\", () => {\n      pristineTimeout = setTimeout(() => {\n        (0,react__WEBPACK_IMPORTED_MODULE_1__.startTransition)(() => setPristine(!0));\n      }, 15e3);\n    });\n    return () => {\n      rebasedSub.unsubscribe(), pristineSub.unsubscribe();\n    };\n  }, $[4] = actor, $[5] = reduceStateFromAction, $[6] = updateLastPassthrough, $[7] = t2) : t2 = $[7];\n  let t3;\n  $[8] !== actor ? (t3 = [actor], $[8] = actor, $[9] = t3) : t3 = $[9], (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(t2, t3);\n  let t4;\n  $[10] !== lastEvent || $[11] !== lastPassthrough || $[12] !== passthrough || $[13] !== pristine || $[14] !== reduceStateFromAction ? (t4 = () => {\n    if (!pristine) {\n      if (!lastEvent)\n        throw new Error(\"No last event found when syncing passthrough\");\n      lastPassthrough !== passthrough && (0,react__WEBPACK_IMPORTED_MODULE_1__.startTransition)(() => {\n        setOptimistic(reduceStateFromAction(lastEvent, passthrough)), setLastPassthrough(passthrough);\n      });\n    }\n  }, $[10] = lastEvent, $[11] = lastPassthrough, $[12] = passthrough, $[13] = pristine, $[14] = reduceStateFromAction, $[15] = t4) : t4 = $[15];\n  let t5;\n  return $[16] !== lastEvent || $[17] !== lastPassthrough || $[18] !== passthrough || $[19] !== pristine ? (t5 = [lastEvent, lastPassthrough, passthrough, pristine], $[16] = lastEvent, $[17] = lastPassthrough, $[18] = passthrough, $[19] = pristine, $[20] = t5) : t5 = $[20], (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(t4, t5), pristine ? passthrough : optimistic;\n}\nconst byteToHex = [];\nfor (let i = 0; i < 256; ++i)\n  byteToHex.push((i + 256).toString(16).slice(1));\nfunction unsafeStringify(arr, offset = 0) {\n  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + \"-\" + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + \"-\" + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + \"-\" + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + \"-\" + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();\n}\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\nfunction rng() {\n  if (!getRandomValues) {\n    if (typeof crypto > \"u\" || !crypto.getRandomValues)\n      throw new Error(\"crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported\");\n    getRandomValues = crypto.getRandomValues.bind(crypto);\n  }\n  return getRandomValues(rnds8);\n}\nconst randomUUID = typeof crypto < \"u\" && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nvar native = {\n  randomUUID\n};\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !options)\n    return native.randomUUID();\n  options = options || {};\n  const rnds = options.random ?? options.rng?.() ?? rng();\n  if (rnds.length < 16)\n    throw new Error(\"Random bytes length must be >= 16\");\n  return rnds[6] = rnds[6] & 15 | 64, rnds[8] = rnds[8] & 63 | 128, unsafeStringify(rnds);\n}\nfunction getRect(element) {\n  const domRect = element.getBoundingClientRect();\n  return {\n    x: domRect.x + scrollX,\n    y: domRect.y + scrollY,\n    w: domRect.width,\n    h: domRect.height\n  };\n}\nfunction offsetRect(rect, px, axis) {\n  return axis === \"x\" ? {\n    x: rect.x + px,\n    y: rect.y,\n    w: rect.w - 2 * px,\n    h: rect.h\n  } : {\n    x: rect.x,\n    y: rect.y + px,\n    w: rect.w,\n    h: rect.h - 2 * px\n  };\n}\nfunction rayIntersect(l1, l2) {\n  const {\n    x1,\n    y1,\n    x2,\n    y2\n  } = l1, {\n    x1: x3,\n    y1: y3,\n    x2: x4,\n    y2: y4\n  } = l2;\n  if (x1 === x2 && y1 === y2 || x3 === x4 && y3 === y4)\n    return !1;\n  const denominator = (y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1);\n  if (denominator === 0)\n    return !1;\n  const ua = ((x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3)) / denominator, ub = ((x2 - x1) * (y1 - y3) - (y2 - y1) * (x1 - x3)) / denominator;\n  if (ua < 0 || ua > 1 || ub < 0 || ub > 1)\n    return !1;\n  const x = x1 + ua * (x2 - x1), y = y1 + ua * (y2 - y1);\n  return {\n    x,\n    y\n  };\n}\nfunction rectEqual(r1, r2) {\n  return r1.x === r2.x && r1.y === r2.y && r1.w === r2.w && r1.h === r2.h;\n}\nfunction rayRectIntersections(line, rect) {\n  const rectLines = [{\n    x1: rect.x,\n    y1: rect.y,\n    x2: rect.x + rect.w,\n    y2: rect.y\n  }, {\n    x1: rect.x + rect.w,\n    y1: rect.y,\n    x2: rect.x + rect.w,\n    y2: rect.y + rect.h\n  }, {\n    x1: rect.x + rect.w,\n    y1: rect.y + rect.h,\n    x2: rect.x,\n    y2: rect.y + rect.h\n  }, {\n    x1: rect.x,\n    y1: rect.y + rect.h,\n    x2: rect.x,\n    y2: rect.y\n  }], intersections = [];\n  for (let i = 0; i < rectLines.length; i++) {\n    const intersection = rayIntersect(line, rectLines[i]);\n    if (intersection) {\n      let isDuplicate = !1;\n      for (let j = 0; j < intersections.length; j++)\n        intersections[j].x === intersection.x && intersections[j].y === intersection.y && (isDuplicate = !0);\n      isDuplicate || intersections.push(intersection);\n    }\n  }\n  return intersections.length === 0 ? !1 : intersections.sort((a, b) => pointDist(a, {\n    x: line.x1,\n    y: line.y1\n  }) - pointDist(b, {\n    x: line.x1,\n    y: line.y1\n  }));\n}\nfunction pointDist(p1, p2) {\n  const a = p1.x - p2.x, b = p1.y - p2.y;\n  return Math.sqrt(a * a + b * b);\n}\nfunction pointInBounds(point, bounds) {\n  const withinX = point.x >= bounds.x && point.x <= bounds.x + bounds.w, withinY = point.y >= bounds.y && point.y <= bounds.y + bounds.h;\n  return withinX && withinY;\n}\nfunction findClosestIntersection(ray, targets, flow) {\n  const rayOrigin = {\n    x: ray.x1,\n    y: ray.y1\n  };\n  if (targets.some((t) => pointInBounds(rayOrigin, offsetRect(t, Math.min(t.w, t.h) / 10, flow === \"horizontal\" ? \"x\" : \"y\")))) return null;\n  let closestIntersection, closestRect;\n  for (const target of targets) {\n    const intersections = rayRectIntersections(ray, offsetRect(target, Math.min(target.w, target.h) / 10, flow === \"horizontal\" ? \"x\" : \"y\"));\n    if (intersections) {\n      const firstIntersection = intersections[0];\n      closestIntersection ? pointDist(rayOrigin, firstIntersection) < pointDist(rayOrigin, closestIntersection) && (closestIntersection = firstIntersection, closestRect = target) : (closestIntersection = firstIntersection, closestRect = target);\n    }\n  }\n  return closestRect || null;\n}\nfunction scaleRect(rect, scale, origin) {\n  const {\n    x,\n    y,\n    w,\n    h\n  } = rect, {\n    x: originX,\n    y: originY\n  } = origin, newX = originX + (x - originX) * scale, newY = originY + (y - originY) * scale, newWidth = w * scale, newHeight = h * scale;\n  return {\n    x: newX,\n    y: newY,\n    w: newWidth,\n    h: newHeight\n  };\n}\nfunction getRectGroupXExtent(rects) {\n  const minGroupX = Math.max(0, Math.min(...rects.map((r) => r.x))), maxGroupX = Math.min(document.body.offsetWidth, Math.max(...rects.map((r) => r.x + r.w)));\n  return {\n    min: minGroupX,\n    max: maxGroupX,\n    width: maxGroupX - minGroupX\n  };\n}\nfunction getRectGroupYExtent(rects) {\n  const minGroupY = Math.max(0, Math.min(...rects.map((r) => r.y))), maxGroupY = Math.min(document.body.scrollHeight, Math.max(...rects.map((r) => r.y + r.h)));\n  return {\n    min: minGroupY,\n    max: maxGroupY,\n    height: maxGroupY - minGroupY\n  };\n}\nfunction calcTargetFlow(targets) {\n  return targets.some((t1) => targets.filter((t2) => !rectEqual(t1, t2)).some((t2) => t1.y === t2.y)) ? \"horizontal\" : \"vertical\";\n}\nfunction calcInsertPosition(origin, targets, flow) {\n  if (flow === \"horizontal\") {\n    const rayLeft = {\n      x1: origin.x,\n      y1: origin.y,\n      x2: origin.x - 1e8,\n      y2: origin.y\n    }, rayRight = {\n      x1: origin.x,\n      y1: origin.y,\n      x2: origin.x + 1e8,\n      y2: origin.y\n    };\n    return {\n      left: findClosestIntersection(rayLeft, targets, flow),\n      right: findClosestIntersection(rayRight, targets, flow)\n    };\n  } else {\n    const rayTop = {\n      x1: origin.x,\n      y1: origin.y,\n      x2: origin.x,\n      y2: origin.y - 1e8\n    }, rayBottom = {\n      x1: origin.x,\n      y1: origin.y,\n      x2: origin.x,\n      y2: origin.y + 1e8\n    };\n    return {\n      top: findClosestIntersection(rayTop, targets, flow),\n      bottom: findClosestIntersection(rayBottom, targets, flow)\n    };\n  }\n}\nfunction findRectSanityData(rect, overlayGroup) {\n  return overlayGroup.find((e) => rectEqual(getRect(e.elements.element), rect))?.sanity;\n}\nfunction resolveInsertPosition(overlayGroup, insertPosition, flow) {\n  return Object.values(insertPosition).every((v) => v === null) ? null : flow === \"horizontal\" ? {\n    left: insertPosition.left ? {\n      rect: insertPosition.left,\n      sanity: findRectSanityData(insertPosition.left, overlayGroup)\n    } : null,\n    right: insertPosition.right ? {\n      rect: insertPosition.right,\n      sanity: findRectSanityData(insertPosition.right, overlayGroup)\n    } : null\n  } : {\n    top: insertPosition.top ? {\n      rect: insertPosition.top,\n      sanity: findRectSanityData(insertPosition.top, overlayGroup)\n    } : null,\n    bottom: insertPosition.bottom ? {\n      rect: insertPosition.bottom,\n      sanity: findRectSanityData(insertPosition.bottom, overlayGroup)\n    } : null\n  };\n}\nfunction calcMousePos(e) {\n  const bodyBounds = document.body.getBoundingClientRect();\n  return {\n    x: Math.max(bodyBounds.x, Math.min(e.clientX, bodyBounds.x + bodyBounds.width)),\n    y: e.clientY + window.scrollY\n  };\n}\nfunction calcMousePosInverseTransform(mousePos2) {\n  const body = document.body, transform = window.getComputedStyle(body).transform;\n  if (transform === \"none\")\n    return {\n      x: mousePos2.x,\n      y: mousePos2.y\n    };\n  const inverseMatrix = new DOMMatrix(transform).inverse(), transformedPoint = new DOMPoint(mousePos2.x, mousePos2.y).matrixTransform(inverseMatrix);\n  return {\n    x: transformedPoint.x,\n    y: transformedPoint.y\n  };\n}\nfunction buildPreviewSkeleton(mousePos2, element, scaleFactor) {\n  const bounds = getRect(element), children = [...element.querySelectorAll(\":where(h1, h2, h3, h4, p, a, img, span, button):not(:has(*))\")];\n  mousePos2.x <= bounds.x && (mousePos2.x = bounds.x), mousePos2.x >= bounds.x + bounds.w && (mousePos2.x = bounds.x + bounds.w), mousePos2.y >= bounds.y + bounds.h && (mousePos2.y = bounds.y + bounds.h), mousePos2.y <= bounds.y && (mousePos2.y = bounds.y);\n  const childRects = children.map((child) => {\n    const rect = scaleRect(getRect(child), scaleFactor, {\n      x: bounds.x,\n      y: bounds.y\n    });\n    return {\n      x: rect.x - bounds.x,\n      y: rect.y - bounds.y,\n      w: rect.w,\n      h: rect.h,\n      tagName: child.tagName\n    };\n  });\n  return {\n    offsetX: (bounds.x - mousePos2.x) * scaleFactor,\n    offsetY: (bounds.y - mousePos2.y) * scaleFactor,\n    w: bounds.w * scaleFactor,\n    h: bounds.h * scaleFactor,\n    maxWidth: bounds.w * scaleFactor * 0.75,\n    childRects\n  };\n}\nconst minDragDelta = 4;\nasync function applyMinimapWrapperTransform(target, scaleFactor, minYScaled, handler, rectUpdateFrequency) {\n  return new Promise((resolve) => {\n    target.addEventListener(\"transitionend\", () => {\n      setTimeout(() => {\n        handler({\n          type: \"overlay/dragEndMinimapTransition\"\n        });\n      }, rectUpdateFrequency * 2), resolve();\n    }, {\n      once: !0\n    }), handler({\n      type: \"overlay/dragStartMinimapTransition\"\n    }), handler({\n      type: \"overlay/dragToggleMinimap\",\n      display: !0\n    }), document.body.style.overflow = \"hidden\", document.body.style.height = \"100%\", document.documentElement.style.overflow = \"initial\", document.documentElement.style.height = \"100%\", setTimeout(() => {\n      target.style.transformOrigin = \"50% 0px\", target.style.transition = \"transform 150ms ease\", target.style.transform = `translate3d(0px, ${-minYScaled + scrollY}px, 0px) scale(${scaleFactor})`;\n    }, 25);\n  });\n}\nfunction calcMinimapTransformValues(rects, groupHeightOverride) {\n  let groupHeight = groupHeightOverride || getRectGroupYExtent(rects).height;\n  const padding = 100;\n  groupHeight += padding * 2;\n  const scaleFactor = groupHeight > window.innerHeight ? window.innerHeight / groupHeight : 1, scaledRects = rects.map((r) => scaleRect(r, scaleFactor, {\n    x: window.innerWidth / 2,\n    y: 0\n  })), {\n    min: minYScaled\n  } = getRectGroupYExtent(scaledRects);\n  return {\n    scaleFactor,\n    minYScaled: minYScaled - padding * scaleFactor\n  };\n}\nfunction calcGroupBoundsPreview(rects) {\n  const groupBoundsX = getRectGroupXExtent(rects), groupBoundsY = getRectGroupYExtent(rects), offsetDist = 8, canOffsetX = groupBoundsX.min > offsetDist && groupBoundsX.min + groupBoundsX.width <= window.innerWidth - offsetDist, canOffsetY = groupBoundsY.min > offsetDist && groupBoundsY.min + groupBoundsY.height <= document.body.scrollHeight - offsetDist, canOffset = canOffsetX && canOffsetY;\n  return {\n    x: canOffset ? groupBoundsX.min - offsetDist : groupBoundsX.min,\n    y: canOffset ? groupBoundsY.min - offsetDist : groupBoundsY.min,\n    w: canOffset ? groupBoundsX.width + offsetDist * 2 : groupBoundsX.width,\n    h: canOffset ? groupBoundsY.height + offsetDist * 2 : groupBoundsY.height\n  };\n}\nasync function resetMinimapWrapperTransform(endYOrigin, target, prescaleHeight2, handler, rectUpdateFrequency, previousRootStyleValues2) {\n  return new Promise((resolve) => {\n    const transform = window.getComputedStyle(target).transform;\n    if (new DOMMatrix(transform).a === 1) return;\n    const maxScroll = prescaleHeight2 - window.innerHeight, prevScrollY = scrollY;\n    endYOrigin -= window.innerHeight / 2, endYOrigin < 0 && (endYOrigin = 0), target.addEventListener(\"transitionend\", () => {\n      target.style.transition = \"none\", target.style.transform = \"none\", scrollTo({\n        top: endYOrigin,\n        behavior: \"instant\"\n      }), setTimeout(() => {\n        handler({\n          type: \"overlay/dragEndMinimapTransition\"\n        }), handler({\n          type: \"overlay/dragToggleMinimap\",\n          display: !1\n        });\n      }, rectUpdateFrequency * 2), resolve();\n    }, {\n      once: !0\n    }), handler({\n      type: \"overlay/dragStartMinimapTransition\"\n    }), target.style.transform = `translateY(${Math.max(prevScrollY - endYOrigin, -maxScroll + prevScrollY)}px) scale(1)`, previousRootStyleValues2 && (document.body.style.overflow = previousRootStyleValues2.body.overflow, document.body.style.height = previousRootStyleValues2.body.height, document.documentElement.style.overflow = previousRootStyleValues2.documentElement.overflow, document.documentElement.style.height = previousRootStyleValues2.documentElement.height);\n  });\n}\nlet minimapScaleApplied = !1, mousePosInverseTransform = {\n  y: 0\n}, mousePos = {\n  x: 0,\n  y: 0\n}, prescaleHeight = typeof document > \"u\" ? 0 : document.documentElement.scrollHeight, previousRootStyleValues = null;\nfunction handleOverlayDrag(opts) {\n  const {\n    mouseEvent,\n    element,\n    overlayGroup,\n    handler,\n    target,\n    onSequenceStart,\n    onSequenceEnd\n  } = opts;\n  if (mouseEvent.button !== 0) return;\n  window.focus();\n  const rectUpdateFrequency = 150;\n  let rects = overlayGroup.map((e) => getRect(e.elements.element));\n  const flow = element.getAttribute(\"data-sanity-drag-flow\") || calcTargetFlow(rects), dragGroup = element.getAttribute(\"data-sanity-drag-group\"), disableMinimap = !!element.getAttribute(\"data-sanity-drag-minimap-disable\"), preventInsertDefault = !!element.getAttribute(\"data-sanity-drag-prevent-default\"), documentHeightOverride = element.getAttribute(\"data-unstable_sanity-drag-document-height\"), groupHeightOverride = element.getAttribute(\"data-unstable_sanity-drag-group-height\");\n  let insertPosition = null;\n  const initialMousePos = calcMousePos(mouseEvent), scaleTarget = document.body, {\n    minYScaled,\n    scaleFactor\n  } = calcMinimapTransformValues(rects, groupHeightOverride ? ~~groupHeightOverride : null);\n  let sequenceStarted = !1, minimapPromptShown = !1, mousedown = !0;\n  minimapScaleApplied || (previousRootStyleValues = {\n    body: {\n      overflow: window.getComputedStyle(document.body).overflow,\n      height: window.getComputedStyle(document.body).height\n    },\n    documentElement: {\n      overflow: window.getComputedStyle(document.documentElement).overflow,\n      height: window.getComputedStyle(document.documentElement).height\n    }\n  }, prescaleHeight = documentHeightOverride ? ~~documentHeightOverride : document.documentElement.scrollHeight);\n  const rectsInterval = setInterval(() => {\n    rects = overlayGroup.map((e) => getRect(e.elements.element));\n  }, rectUpdateFrequency), applyMinimap = () => {\n    if (scaleFactor >= 1) return;\n    const skeleton = buildPreviewSkeleton(mousePos, element, scaleFactor);\n    handler({\n      type: \"overlay/dragUpdateSkeleton\",\n      skeleton\n    }), handler({\n      type: \"overlay/dragToggleMinimapPrompt\",\n      display: !1\n    }), applyMinimapWrapperTransform(scaleTarget, scaleFactor, minYScaled, handler, rectUpdateFrequency).then(() => {\n      setTimeout(() => {\n        handler({\n          type: \"overlay/dragUpdateGroupRect\",\n          groupRect: calcGroupBoundsPreview(rects)\n        });\n      }, rectUpdateFrequency * 2);\n    });\n  }, handleScroll = (e) => {\n    Math.abs(e.deltaY) >= 10 && scaleFactor < 1 && !minimapScaleApplied && !minimapPromptShown && !disableMinimap && mousedown && (handler({\n      type: \"overlay/dragToggleMinimapPrompt\",\n      display: !0\n    }), minimapPromptShown = !0), e.shiftKey && !minimapScaleApplied && !disableMinimap && (window.dispatchEvent(new CustomEvent(\"unstable_sanity/dragApplyMinimap\")), minimapScaleApplied = !0, setTimeout(() => {\n      applyMinimap();\n    }, 50));\n  }, handleMouseMove = (e) => {\n    if (e.preventDefault(), mousePos = calcMousePos(e), mousePosInverseTransform = calcMousePosInverseTransform(mousePos), Math.abs(pointDist(mousePos, initialMousePos)) < minDragDelta) return;\n    if (!sequenceStarted) {\n      const groupRect = calcGroupBoundsPreview(rects), skeleton = buildPreviewSkeleton(mousePos, element, 1);\n      handler({\n        type: \"overlay/dragStart\",\n        flow\n      }), handler({\n        type: \"overlay/dragUpdateSkeleton\",\n        skeleton\n      }), handler({\n        type: \"overlay/dragUpdateGroupRect\",\n        groupRect\n      }), sequenceStarted = !0, onSequenceStart();\n    }\n    handler({\n      type: \"overlay/dragUpdateCursorPosition\",\n      x: mousePos.x,\n      y: mousePos.y\n    }), e.shiftKey && !minimapScaleApplied && !disableMinimap && (window.dispatchEvent(new CustomEvent(\"unstable_sanity/dragApplyMinimap\")), minimapScaleApplied = !0, setTimeout(() => {\n      applyMinimap();\n    }, 50));\n    const newInsertPosition = calcInsertPosition(mousePos, rects, flow);\n    JSON.stringify(insertPosition) !== JSON.stringify(newInsertPosition) && (insertPosition = newInsertPosition, handler({\n      type: \"overlay/dragUpdateInsertPosition\",\n      insertPosition: resolveInsertPosition(overlayGroup, insertPosition, flow)\n    }));\n  }, handleMouseUp = () => {\n    mousedown = !1, handler({\n      type: \"overlay/dragEnd\",\n      target,\n      insertPosition: insertPosition ? resolveInsertPosition(overlayGroup, insertPosition, flow) : null,\n      dragGroup,\n      flow,\n      preventInsertDefault\n    }), minimapPromptShown && handler({\n      type: \"overlay/dragToggleMinimapPrompt\",\n      display: !1\n    }), minimapScaleApplied || (clearInterval(rectsInterval), onSequenceEnd(), removeFrameListeners(), removeKeyListeners()), removeMouseListeners();\n  }, handleKeyup = (e) => {\n    if (e.key === \"Shift\" && minimapScaleApplied) {\n      minimapScaleApplied = !1;\n      const skeleton = buildPreviewSkeleton(mousePos, element, 1 / scaleFactor);\n      handler({\n        type: \"overlay/dragUpdateSkeleton\",\n        skeleton\n      }), window.dispatchEvent(new CustomEvent(\"unstable_sanity/dragResetMinimap\")), setTimeout(() => {\n        resetMinimapWrapperTransform(mousePosInverseTransform.y, scaleTarget, prescaleHeight, handler, rectUpdateFrequency, previousRootStyleValues);\n      }, 50), handler({\n        type: \"overlay/dragUpdateGroupRect\",\n        groupRect: null\n      }), mousedown || (clearInterval(rectsInterval), removeMouseListeners(), removeFrameListeners(), removeKeyListeners(), onSequenceEnd());\n    }\n  }, handleBlur = () => {\n    handler({\n      type: \"overlay/dragUpdateGroupRect\",\n      groupRect: null\n    }), window.dispatchEvent(new CustomEvent(\"unstable_sanity/dragResetMinimap\")), setTimeout(() => {\n      resetMinimapWrapperTransform(mousePosInverseTransform.y, scaleTarget, prescaleHeight, handler, rectUpdateFrequency, previousRootStyleValues).then(() => {\n        minimapScaleApplied = !1;\n      });\n    }, 50), clearInterval(rectsInterval), removeMouseListeners(), removeFrameListeners(), removeKeyListeners(), onSequenceEnd();\n  }, removeMouseListeners = () => {\n    window.removeEventListener(\"mousemove\", handleMouseMove), window.removeEventListener(\"wheel\", handleScroll), window.removeEventListener(\"mouseup\", handleMouseUp);\n  }, removeKeyListeners = () => {\n    window.removeEventListener(\"keyup\", handleKeyup);\n  }, removeFrameListeners = () => {\n    window.removeEventListener(\"blur\", handleBlur);\n  };\n  window.addEventListener(\"blur\", handleBlur), window.addEventListener(\"keyup\", handleKeyup), window.addEventListener(\"wheel\", handleScroll), window.addEventListener(\"mousemove\", handleMouseMove), window.addEventListener(\"mouseup\", handleMouseUp);\n}\nconst isElementNode$1 = (target) => target instanceof HTMLElement || target instanceof SVGElement;\nfunction findNonInlineElement(element) {\n  const {\n    display\n  } = window.getComputedStyle(element);\n  if (display !== \"inline\") return element;\n  const parent = element.parentElement;\n  return parent ? findNonInlineElement(parent) : null;\n}\nconst findOverlayElement = (el) => !el || !isElementNode$1(el) ? null : el.dataset?.sanityOverlayElement ? el : findOverlayElement(el.parentElement);\nfunction testVercelStegaRegex(input) {\n  return _vercel_stega__WEBPACK_IMPORTED_MODULE_2__.VERCEL_STEGA_REGEX.lastIndex = 0, _vercel_stega__WEBPACK_IMPORTED_MODULE_2__.VERCEL_STEGA_REGEX.test(input);\n}\nfunction decodeStega(str, isAltText = !1) {\n  try {\n    const decoded = (0,_vercel_stega__WEBPACK_IMPORTED_MODULE_2__.vercelStegaDecode)(str);\n    return !decoded || decoded.origin !== \"sanity.io\" ? null : (isAltText && (decoded.href = decoded.href?.replace(\".alt\", \"\")), decoded);\n  } catch (err) {\n    return console.error(\"Failed to decode stega for string: \", str, \"with the original error: \", err), null;\n  }\n}\nfunction testAndDecodeStega(str, isAltText = !1) {\n  return testVercelStegaRegex(str) ? decodeStega(str, isAltText) : null;\n}\nconst isElementNode = (node) => node.nodeType === Node.ELEMENT_NODE, isImgElement = (el) => el.tagName === \"IMG\", isTimeElement = (el) => el.tagName === \"TIME\", isSvgRootElement = (el) => el.tagName.toUpperCase() === \"SVG\";\nfunction isSanityNode(node) {\n  return \"path\" in node;\n}\nfunction findCommonPath(first, second) {\n  let firstParts = first.split(\".\"), secondParts = second.split(\".\");\n  const maxLength = Math.min(firstParts.length, secondParts.length);\n  return firstParts = firstParts.slice(0, maxLength).reverse(), secondParts = secondParts.slice(0, maxLength).reverse(), firstParts.reduce((parts, part, i) => part === secondParts[i] ? [...parts, part] : [], []).reverse().join(\".\");\n}\nfunction findCommonSanityData(nodes) {\n  if (!nodes.length || !nodes.map((n) => isSanityNode(n)).every((n, _i, arr) => n === arr[0]))\n    return;\n  if (!isSanityNode(nodes[0])) return nodes[0];\n  const sanityNodes = nodes.filter(isSanityNode);\n  let common = nodes[0];\n  const consistentValueKeys = [\"projectId\", \"dataset\", \"id\", \"baseUrl\", \"workspace\", \"tool\"];\n  for (let i = 1; i < sanityNodes.length; i++) {\n    const node = sanityNodes[i];\n    if (consistentValueKeys.some((key) => node[key] !== common?.[key])) {\n      common = void 0;\n      break;\n    }\n    common.path = findCommonPath(common.path, node.path);\n  }\n  return common;\n}\nfunction findSanityNodes(el) {\n  const elements = [];\n  function addElement(element, data) {\n    const sanity = (0,_sanity_visual_editing_csm__WEBPACK_IMPORTED_MODULE_7__.decodeSanityNodeData)(data);\n    if (!sanity)\n      return;\n    const measureElement = findNonInlineElement(element);\n    measureElement && elements.push({\n      elements: {\n        element,\n        measureElement\n      },\n      sanity\n    });\n  }\n  if (el)\n    for (const node of el.childNodes) {\n      const {\n        nodeType,\n        parentElement,\n        textContent\n      } = node;\n      if (isElementNode(node) && node.dataset?.sanityEditTarget !== void 0) {\n        const nodesInTarget = findSanityNodes(node).map(({\n          sanity\n        }) => sanity);\n        if (!nodesInTarget.map((n) => isSanityNode(n)).every((n, _i, arr) => n === arr[0]))\n          continue;\n        const commonData = findCommonSanityData(nodesInTarget);\n        commonData && elements.push({\n          elements: {\n            element: node,\n            measureElement: node\n          },\n          sanity: commonData\n        });\n      } else if (nodeType === Node.TEXT_NODE && parentElement && textContent) {\n        const data = testAndDecodeStega(textContent);\n        if (!data) continue;\n        addElement(parentElement, data);\n      } else if (isElementNode(node)) {\n        if (node.tagName === \"SCRIPT\" || node.tagName === \"SANITY-VISUAL-EDITING\")\n          continue;\n        if (node.dataset?.sanity)\n          addElement(node, node.dataset.sanity);\n        else if (node.dataset?.sanityEditInfo)\n          addElement(node, node.dataset.sanityEditInfo);\n        else if (isImgElement(node)) {\n          const data = testAndDecodeStega(node.alt, !0);\n          if (!data) continue;\n          addElement(node, data);\n          continue;\n        } else if (isTimeElement(node)) {\n          const data = testAndDecodeStega(node.dateTime, !0);\n          if (!data) continue;\n          addElement(node, data);\n        } else if (isSvgRootElement(node)) {\n          if (!node.ariaLabel) continue;\n          const data = testAndDecodeStega(node.ariaLabel, !0);\n          if (!data) continue;\n          addElement(node, data);\n        }\n        elements.push(...findSanityNodes(node));\n      }\n    }\n  return elements;\n}\nfunction isSanityArrayPath(path) {\n  const lastDotIndex = path.lastIndexOf(\".\");\n  return path.substring(lastDotIndex, path.length).includes(\"[\");\n}\nfunction getSanityNodeArrayPath(path) {\n  if (!isSanityArrayPath(path)) return null;\n  const split = path.split(\".\");\n  return split[split.length - 1] = split[split.length - 1].replace(/\\[.*?\\]/g, \"[]\"), split.join(\".\");\n}\nfunction sanityNodesExistInSameArray(sanityNode1, sanityNode2) {\n  return !isSanityArrayPath(sanityNode1.path) || !isSanityArrayPath(sanityNode2.path) ? !1 : getSanityNodeArrayPath(sanityNode1.path) === getSanityNodeArrayPath(sanityNode2.path);\n}\nfunction resolveDragAndDropGroup(element, sanity, elementSet, elementsMap) {\n  if (!element.getAttribute(\"data-sanity\") || element.getAttribute(\"data-sanity-drag-disable\") || !sanity || !isSanityNode(sanity) || !isSanityArrayPath(sanity.path)) return null;\n  const targetDragGroup = element.getAttribute(\"data-sanity-drag-group\"), group = [...elementSet].reduce((acc, el) => {\n    const elData = elementsMap.get(el), elDragDisabled = el.getAttribute(\"data-sanity-drag-disable\"), elDragGroup = el.getAttribute(\"data-sanity-drag-group\"), elHasSanityAttribution = el.getAttribute(\"data-sanity\") !== null, sharedDragGroup = targetDragGroup !== null ? targetDragGroup === elDragGroup : !0;\n    return elData && !elDragDisabled && isSanityNode(elData.sanity) && sanityNodesExistInSameArray(sanity, elData.sanity) && sharedDragGroup && elHasSanityAttribution && acc.push(elData), acc;\n  }, []);\n  return group.length <= 1 ? null : group;\n}\nfunction createOverlayController({\n  handler,\n  overlayElement,\n  inFrame,\n  inPopUp,\n  optimisticActorReady\n}) {\n  let activated = !1;\n  const elementIdMap = /* @__PURE__ */ new Map(), elementsMap = /* @__PURE__ */ new WeakMap(), elementSet = /* @__PURE__ */ new Set(), measureElements = /* @__PURE__ */ new WeakMap(), cursorMap = /* @__PURE__ */ new WeakMap();\n  let ro, io, mo, activeDragSequence = !1, hoverStack = [];\n  const getHoveredElement = () => hoverStack[hoverStack.length - 1];\n  function addEventHandlers(el, handlers) {\n    el.addEventListener(\"click\", handlers.click, {\n      capture: !0\n    }), el.addEventListener(\"contextmenu\", handlers.contextmenu, {\n      capture: !0\n    }), el.addEventListener(\"mousemove\", handlers.mousemove, {\n      once: !0,\n      capture: !0\n    }), el.addEventListener(\"mousedown\", handlers.mousedown, {\n      capture: !0\n    });\n  }\n  function removeEventHandlers(el, handlers) {\n    el.removeEventListener(\"click\", handlers.click, {\n      capture: !0\n    }), el.removeEventListener(\"contextmenu\", handlers.contextmenu, {\n      capture: !0\n    }), el.removeEventListener(\"mousemove\", handlers.mousemove, {\n      capture: !0\n    }), el.removeEventListener(\"mousedown\", handlers.mousedown, {\n      capture: !0\n    }), el.removeEventListener(\"mouseenter\", handlers.mouseenter), el.removeEventListener(\"mouseleave\", handlers.mouseleave);\n  }\n  function activateElement({\n    id,\n    elements,\n    handlers\n  }) {\n    const {\n      element,\n      measureElement\n    } = elements;\n    addEventHandlers(element, handlers), ro.observe(measureElement), handler({\n      type: \"element/activate\",\n      id\n    });\n  }\n  function deactivateElement({\n    id,\n    elements,\n    handlers\n  }) {\n    const {\n      element,\n      measureElement\n    } = elements;\n    removeEventHandlers(element, handlers), ro.unobserve(measureElement), hoverStack = hoverStack.filter((el) => el !== element), handler({\n      type: \"element/deactivate\",\n      id\n    });\n  }\n  function setOverlayCursor(element) {\n    if (!(!inFrame && !inPopUp || !optimisticActorReady))\n      for (const hoverstackElement of hoverStack) {\n        if (element === hoverstackElement) {\n          const targetSanityData = elementsMap.get(element)?.sanity;\n          if (!targetSanityData || !isSanityNode(targetSanityData)) return;\n          if (resolveDragAndDropGroup(element, targetSanityData, elementSet, elementsMap)) {\n            const existingCursor = element.style.cursor;\n            existingCursor && cursorMap.set(element, existingCursor), handler({\n              type: \"overlay/setCursor\",\n              element,\n              cursor: \"move\"\n            });\n            continue;\n          }\n        }\n        restoreOverlayCursor(hoverstackElement);\n      }\n  }\n  function restoreOverlayCursor(element) {\n    const previousCursor = cursorMap.get(element);\n    handler({\n      type: \"overlay/setCursor\",\n      element,\n      cursor: previousCursor\n    });\n  }\n  function registerElement({\n    elements,\n    sanity\n  }) {\n    const {\n      element,\n      measureElement\n    } = elements, eventHandlers = {\n      click(event) {\n        const target = event.target;\n        if (element === getHoveredElement() && element.contains(target)) {\n          inFrame && (event.preventDefault(), event.stopPropagation());\n          const sanity2 = elementsMap.get(element)?.sanity;\n          sanity2 && !activeDragSequence && handler({\n            type: \"element/click\",\n            id,\n            sanity: sanity2\n          });\n        }\n      },\n      contextmenu(event) {\n        if (!(\"path\" in sanity) || !inFrame && !inPopUp || !optimisticActorReady || !sanity.path.split(\".\").pop()?.includes(\"[_key==\")) return;\n        const target = event.target;\n        element === getHoveredElement() && element.contains(target) && ((inFrame || inPopUp) && (event.preventDefault(), event.stopPropagation()), handler({\n          type: \"element/contextmenu\",\n          id,\n          position: {\n            x: event.clientX,\n            y: event.clientY\n          },\n          sanity\n        }));\n      },\n      mousedown(event) {\n        if (event.preventDefault(), event.currentTarget !== hoverStack.at(-1) || element.getAttribute(\"data-sanity-drag-disable\") || !inFrame && !inPopUp || !optimisticActorReady) return;\n        const targetSanityData = elementsMap.get(element)?.sanity;\n        if (!targetSanityData || !isSanityNode(targetSanityData) || !isSanityArrayPath(targetSanityData.path)) return;\n        const dragGroup = resolveDragAndDropGroup(element, sanity, elementSet, elementsMap);\n        dragGroup && handleOverlayDrag({\n          element,\n          handler,\n          mouseEvent: event,\n          overlayGroup: dragGroup,\n          target: targetSanityData,\n          onSequenceStart: () => {\n            activeDragSequence = !0;\n          },\n          onSequenceEnd: () => {\n            setTimeout(() => {\n              activeDragSequence = !1;\n            }, 250);\n          }\n        });\n      },\n      mousemove(event) {\n        eventHandlers.mouseenter(event);\n        const el = event.currentTarget;\n        el && (el.addEventListener(\"mouseenter\", eventHandlers.mouseenter), el.addEventListener(\"mouseleave\", eventHandlers.mouseleave));\n      },\n      mouseenter() {\n        document.querySelector(\"vercel-live-feedback\") && element.closest(\"[data-vercel-edit-info]\") || element.closest(\"[data-vercel-edit-target]\") || (hoverStack.push(element), handler({\n          type: \"element/mouseenter\",\n          id,\n          rect: getRect(element)\n        }), setOverlayCursor(element));\n      },\n      mouseleave(e) {\n        function leave() {\n          hoverStack.pop();\n          const hoveredElement = getHoveredElement();\n          if (handler({\n            type: \"element/mouseleave\",\n            id\n          }), hoveredElement) {\n            setOverlayCursor(hoveredElement);\n            const overlayElement2 = elementsMap.get(hoveredElement);\n            overlayElement2 && handler({\n              type: \"element/mouseenter\",\n              id: overlayElement2.id,\n              rect: getRect(hoveredElement)\n            });\n          }\n          restoreOverlayCursor(element);\n        }\n        function addDeferredLeave(el) {\n          const deferredLeave = (e2) => {\n            const {\n              relatedTarget: relatedTarget2\n            } = e2;\n            findOverlayElement(relatedTarget2) ? relatedTarget2 && isElementNode$1(relatedTarget2) && (el.removeEventListener(\"mouseleave\", deferredLeave), addDeferredLeave(relatedTarget2)) : (el.removeEventListener(\"mouseleave\", deferredLeave), leave());\n          };\n          el.addEventListener(\"mouseleave\", deferredLeave);\n        }\n        const {\n          relatedTarget\n        } = e, container = findOverlayElement(relatedTarget), isInteractiveOverlayElement = overlayElement.contains(container);\n        if (isElementNode$1(container) && isInteractiveOverlayElement)\n          return addDeferredLeave(container);\n        leave();\n      }\n    }, id = v4(), sanityNode = {\n      id,\n      elements,\n      sanity,\n      handlers: eventHandlers\n    };\n    elementSet.add(element), measureElements.set(measureElement, element), elementIdMap.set(id, element), elementsMap.set(element, sanityNode), io?.observe(element), handler({\n      type: \"element/register\",\n      id,\n      element,\n      rect: getRect(element),\n      sanity,\n      dragDisabled: !!element.getAttribute(\"data-sanity-drag-disable\")\n    }), activated && activateElement(sanityNode);\n  }\n  function updateElement({\n    elements,\n    sanity\n  }) {\n    const {\n      element\n    } = elements, overlayElement2 = elementsMap.get(element);\n    overlayElement2 && (elementsMap.set(element, {\n      ...overlayElement2,\n      sanity\n    }), handler({\n      type: \"element/update\",\n      id: overlayElement2.id,\n      rect: getRect(element),\n      sanity\n    }));\n  }\n  function parseElements(node) {\n    const sanityNodes = findSanityNodes(node);\n    for (const sanityNode of sanityNodes) {\n      const {\n        element\n      } = sanityNode.elements;\n      elementsMap.has(element) ? updateElement(sanityNode) : registerElement(sanityNode);\n    }\n  }\n  function unregisterElement(element) {\n    const overlayElement2 = elementsMap.get(element);\n    if (overlayElement2) {\n      const {\n        id,\n        handlers\n      } = overlayElement2;\n      removeEventHandlers(element, handlers), ro.unobserve(element), elementsMap.delete(element), elementSet.delete(element), elementIdMap.delete(id), handler({\n        type: \"element/unregister\",\n        id\n      });\n    }\n  }\n  function handleMutation(mutations) {\n    let mutationWasInScope = !1;\n    for (const mutation of mutations) {\n      const {\n        target,\n        type\n      } = mutation, node = type === \"characterData\" ? target.parentElement : target;\n      node === overlayElement || overlayElement.contains(node) || (mutationWasInScope = !0, isElementNode$1(node) && parseElements({\n        childNodes: [node]\n      }));\n    }\n    if (mutationWasInScope)\n      for (const element of elementSet)\n        element.isConnected || unregisterElement(element);\n  }\n  function updateRect(el) {\n    const overlayElement2 = elementsMap.get(el);\n    overlayElement2 && handler({\n      type: \"element/updateRect\",\n      id: overlayElement2.id,\n      rect: getRect(el)\n    });\n  }\n  function handleResize(entries) {\n    for (const entry of entries) {\n      const target = entry.target;\n      if (isElementNode$1(target)) {\n        const element = measureElements.get(target);\n        if (!element) return;\n        updateRect(element);\n      }\n    }\n  }\n  function handleIntersection(entries) {\n    if (activated)\n      for (const entry of entries) {\n        const {\n          target\n        } = entry, match = isElementNode$1(target) && elementsMap.get(target);\n        match && (entry.isIntersecting ? activateElement(match) : deactivateElement(match));\n      }\n  }\n  function handleBlur(event) {\n    const element = findOverlayElement(event.target);\n    if (element) {\n      element.dataset.sanityOverlayElement === \"capture\" && (event.preventDefault(), event.stopPropagation());\n      return;\n    }\n    hoverStack = [], handler({\n      type: \"overlay/blur\"\n    });\n  }\n  function handleWindowResize() {\n    for (const element of elementSet)\n      updateRect(element);\n  }\n  function handleKeydown(event) {\n    event.key === \"Escape\" && (hoverStack = [], handler({\n      type: \"overlay/blur\"\n    }));\n  }\n  function handleWindowScroll(event) {\n    const {\n      target\n    } = event;\n    if (!(target === window.document || !isElementNode$1(target)))\n      for (const element of elementSet)\n        target.contains(element) && updateRect(element);\n  }\n  function activate() {\n    activated || (io = new IntersectionObserver(handleIntersection, {\n      threshold: 0.3\n    }), elementSet.forEach((element) => io.observe(element)), handler({\n      type: \"overlay/activate\"\n    }), activated = !0);\n  }\n  function deactivate() {\n    activated && (io?.disconnect(), elementSet.forEach((element) => {\n      const overlayElement2 = elementsMap.get(element);\n      overlayElement2 && deactivateElement(overlayElement2);\n    }), handler({\n      type: \"overlay/deactivate\"\n    }), activated = !1);\n  }\n  function destroy() {\n    window.removeEventListener(\"click\", handleBlur), window.removeEventListener(\"contextmenu\", handleBlur), window.removeEventListener(\"keydown\", handleKeydown), window.removeEventListener(\"resize\", handleWindowResize), window.removeEventListener(\"scroll\", handleWindowScroll), mo.disconnect(), ro.disconnect(), elementSet.forEach((element) => {\n      unregisterElement(element);\n    }), elementIdMap.clear(), elementSet.clear(), hoverStack = [], deactivate();\n  }\n  function create() {\n    window.addEventListener(\"click\", handleBlur), window.addEventListener(\"contextmenu\", handleBlur), window.addEventListener(\"keydown\", handleKeydown), window.addEventListener(\"resize\", handleWindowResize), window.addEventListener(\"scroll\", handleWindowScroll, {\n      capture: !0,\n      passive: !0\n    }), ro = new ResizeObserver(handleResize), mo = new MutationObserver(handleMutation), mo.observe(document.body, {\n      attributes: !0,\n      characterData: !0,\n      childList: !0,\n      subtree: !0\n    }), parseElements(document.body), activate();\n  }\n  return window.document.fonts.ready.then(() => {\n    for (const element of elementSet)\n      updateRect(element);\n  }), create(), {\n    activate,\n    deactivate,\n    destroy\n  };\n}\nconst SharedStateContext = (0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)(null);\n\n//# sourceMappingURL=SharedStateContext.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvdmlzdWFsLWVkaXRpbmcvZGlzdC9fY2h1bmtzLWVzL1NoYXJlZFN0YXRlQ29udGV4dC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBMkM7QUFDUztBQUN3QjtBQUMxQjtBQUNOO0FBQ1E7QUFDYztBQUNJO0FBQ3RFO0FBQ0EsWUFBWSx5REFBQyxnQ0FBZ0MsK0NBQVEsb0NBQW9DLCtDQUFRLDJDQUEyQywrQ0FBUSxnREFBZ0QsK0NBQVEsdUJBQXVCLGlFQUFrQjtBQUNyUDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGtFQUFjO0FBQ3RCO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsZ0NBQWdDLGdFQUFjO0FBQzlDO0FBQ0E7QUFDQSxnQ0FBZ0MsZ0VBQWM7QUFDOUM7QUFDQTtBQUNBLFFBQVEseURBQVk7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLGtFQUFjO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLFFBQVEsc0RBQWU7QUFDdkIsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSx3RUFBd0UsZ0RBQVM7QUFDakY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxzREFBZTtBQUN4RDtBQUNBLE9BQU87QUFDUDtBQUNBLEdBQUc7QUFDSDtBQUNBLG1SQUFtUixnREFBUztBQUM1UjtBQUNBO0FBQ0EsZ0JBQWdCLFNBQVM7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILGtCQUFrQixzQkFBc0I7QUFDeEM7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLDBCQUEwQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTixJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTCwrSUFBK0ksc0JBQXNCLGlCQUFpQixZQUFZO0FBQ2xNLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSywwQ0FBMEMsNkRBQTZEO0FBQzVHLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLDZEQUFrQixnQkFBZ0IsNkRBQWtCO0FBQzdEO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixnRUFBaUI7QUFDckM7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0Isd0JBQXdCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixnRkFBb0I7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0EsU0FBUztBQUNULFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsb0RBQWE7QUFNdEM7QUFDRiIsInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvdmlzdWFsLWVkaXRpbmcvZGlzdC9fY2h1bmtzLWVzL1NoYXJlZFN0YXRlQ29udGV4dC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjIH0gZnJvbSBcInJlYWN0LWNvbXBpbGVyLXJ1bnRpbWVcIjtcbmltcG9ydCB7IGdldFB1Ymxpc2hlZElkIH0gZnJvbSBcIkBzYW5pdHkvY2xpZW50L2NzbVwiO1xuaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgc3RhcnRUcmFuc2l0aW9uLCBjcmVhdGVDb250ZXh0IH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyB1c2VFZmZlY3RFdmVudCB9IGZyb20gXCJ1c2UtZWZmZWN0LWV2ZW50XCI7XG5pbXBvcnQgeyBpc0VtcHR5QWN0b3IgfSBmcm9tIFwiLi9jb250ZXh0LmpzXCI7XG5pbXBvcnQgeyB1c2VPcHRpbWlzdGljQWN0b3IgfSBmcm9tIFwiLi9tdXRhdGlvbnMuanNcIjtcbmltcG9ydCB7IGRlY29kZVNhbml0eU5vZGVEYXRhIH0gZnJvbSBcIkBzYW5pdHkvdmlzdWFsLWVkaXRpbmctY3NtXCI7XG5pbXBvcnQgeyB2ZXJjZWxTdGVnYURlY29kZSwgVkVSQ0VMX1NURUdBX1JFR0VYIH0gZnJvbSBcIkB2ZXJjZWwvc3RlZ2FcIjtcbmZ1bmN0aW9uIHVzZU9wdGltaXN0aWMocGFzc3Rocm91Z2gsIHJlZHVjZXIpIHtcbiAgY29uc3QgJCA9IGMoMjEpLCBbcHJpc3RpbmUsIHNldFByaXN0aW5lXSA9IHVzZVN0YXRlKCEwKSwgW29wdGltaXN0aWMsIHNldE9wdGltaXN0aWNdID0gdXNlU3RhdGUocGFzc3Rocm91Z2gpLCBbbGFzdEV2ZW50LCBzZXRMYXN0RXZlbnRdID0gdXNlU3RhdGUobnVsbCksIFtsYXN0UGFzc3Rocm91Z2gsIHNldExhc3RQYXNzdGhyb3VnaF0gPSB1c2VTdGF0ZShwYXNzdGhyb3VnaCksIGFjdG9yID0gdXNlT3B0aW1pc3RpY0FjdG9yKCk7XG4gIGxldCB0MDtcbiAgJFswXSAhPT0gcmVkdWNlciA/ICh0MCA9IChhY3Rpb24sIHByZXZTdGF0ZSkgPT4gKEFycmF5LmlzQXJyYXkocmVkdWNlcikgPyByZWR1Y2VyIDogW3JlZHVjZXJdKS5yZWR1Y2UoKGFjYywgcmVkdWNlcl8wKSA9PiByZWR1Y2VyXzAoYWNjLCB7XG4gICAgZG9jdW1lbnQ6IGFjdGlvbi5kb2N1bWVudCxcbiAgICBpZDogZ2V0UHVibGlzaGVkSWQoYWN0aW9uLmlkKSxcbiAgICBvcmlnaW5hbElkOiBhY3Rpb24uaWQsXG4gICAgdHlwZTogYWN0aW9uLnR5cGVcbiAgfSksIHByZXZTdGF0ZSksICRbMF0gPSByZWR1Y2VyLCAkWzFdID0gdDApIDogdDAgPSAkWzFdO1xuICBjb25zdCByZWR1Y2VTdGF0ZUZyb21BY3Rpb24gPSB1c2VFZmZlY3RFdmVudCh0MCk7XG4gIGxldCB0MTtcbiAgJFsyXSAhPT0gcGFzc3Rocm91Z2ggPyAodDEgPSAoKSA9PiBzZXRMYXN0UGFzc3Rocm91Z2gocGFzc3Rocm91Z2gpLCAkWzJdID0gcGFzc3Rocm91Z2gsICRbM10gPSB0MSkgOiB0MSA9ICRbM107XG4gIGNvbnN0IHVwZGF0ZUxhc3RQYXNzdGhyb3VnaCA9IHVzZUVmZmVjdEV2ZW50KHQxKTtcbiAgbGV0IHQyO1xuICAkWzRdICE9PSBhY3RvciB8fCAkWzVdICE9PSByZWR1Y2VTdGF0ZUZyb21BY3Rpb24gfHwgJFs2XSAhPT0gdXBkYXRlTGFzdFBhc3N0aHJvdWdoID8gKHQyID0gKCkgPT4ge1xuICAgIGlmIChpc0VtcHR5QWN0b3IoYWN0b3IpKVxuICAgICAgcmV0dXJuO1xuICAgIGxldCBwcmlzdGluZVRpbWVvdXQ7XG4gICAgY29uc3QgcmViYXNlZFN1YiA9IGFjdG9yLm9uKFwicmViYXNlZC5sb2NhbFwiLCAoX2V2ZW50KSA9PiB7XG4gICAgICBjb25zdCBldmVudCA9IHtcbiAgICAgICAgZG9jdW1lbnQ6IF9ldmVudC5kb2N1bWVudCxcbiAgICAgICAgaWQ6IF9ldmVudC5pZCxcbiAgICAgICAgb3JpZ2luYWxJZDogZ2V0UHVibGlzaGVkSWQoX2V2ZW50LmlkKSxcbiAgICAgICAgdHlwZTogXCJtdXRhdGVcIlxuICAgICAgfTtcbiAgICAgIHNldE9wdGltaXN0aWMoKHByZXZTdGF0ZV8wKSA9PiByZWR1Y2VTdGF0ZUZyb21BY3Rpb24oZXZlbnQsIHByZXZTdGF0ZV8wKSksIHNldExhc3RFdmVudChldmVudCksIHVwZGF0ZUxhc3RQYXNzdGhyb3VnaCgpLCBzZXRQcmlzdGluZSghMSksIGNsZWFyVGltZW91dChwcmlzdGluZVRpbWVvdXQpO1xuICAgIH0pLCBwcmlzdGluZVN1YiA9IGFjdG9yLm9uKFwicHJpc3RpbmVcIiwgKCkgPT4ge1xuICAgICAgcHJpc3RpbmVUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHN0YXJ0VHJhbnNpdGlvbigoKSA9PiBzZXRQcmlzdGluZSghMCkpO1xuICAgICAgfSwgMTVlMyk7XG4gICAgfSk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHJlYmFzZWRTdWIudW5zdWJzY3JpYmUoKSwgcHJpc3RpbmVTdWIudW5zdWJzY3JpYmUoKTtcbiAgICB9O1xuICB9LCAkWzRdID0gYWN0b3IsICRbNV0gPSByZWR1Y2VTdGF0ZUZyb21BY3Rpb24sICRbNl0gPSB1cGRhdGVMYXN0UGFzc3Rocm91Z2gsICRbN10gPSB0MikgOiB0MiA9ICRbN107XG4gIGxldCB0MztcbiAgJFs4XSAhPT0gYWN0b3IgPyAodDMgPSBbYWN0b3JdLCAkWzhdID0gYWN0b3IsICRbOV0gPSB0MykgOiB0MyA9ICRbOV0sIHVzZUVmZmVjdCh0MiwgdDMpO1xuICBsZXQgdDQ7XG4gICRbMTBdICE9PSBsYXN0RXZlbnQgfHwgJFsxMV0gIT09IGxhc3RQYXNzdGhyb3VnaCB8fCAkWzEyXSAhPT0gcGFzc3Rocm91Z2ggfHwgJFsxM10gIT09IHByaXN0aW5lIHx8ICRbMTRdICE9PSByZWR1Y2VTdGF0ZUZyb21BY3Rpb24gPyAodDQgPSAoKSA9PiB7XG4gICAgaWYgKCFwcmlzdGluZSkge1xuICAgICAgaWYgKCFsYXN0RXZlbnQpXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIGxhc3QgZXZlbnQgZm91bmQgd2hlbiBzeW5jaW5nIHBhc3N0aHJvdWdoXCIpO1xuICAgICAgbGFzdFBhc3N0aHJvdWdoICE9PSBwYXNzdGhyb3VnaCAmJiBzdGFydFRyYW5zaXRpb24oKCkgPT4ge1xuICAgICAgICBzZXRPcHRpbWlzdGljKHJlZHVjZVN0YXRlRnJvbUFjdGlvbihsYXN0RXZlbnQsIHBhc3N0aHJvdWdoKSksIHNldExhc3RQYXNzdGhyb3VnaChwYXNzdGhyb3VnaCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0sICRbMTBdID0gbGFzdEV2ZW50LCAkWzExXSA9IGxhc3RQYXNzdGhyb3VnaCwgJFsxMl0gPSBwYXNzdGhyb3VnaCwgJFsxM10gPSBwcmlzdGluZSwgJFsxNF0gPSByZWR1Y2VTdGF0ZUZyb21BY3Rpb24sICRbMTVdID0gdDQpIDogdDQgPSAkWzE1XTtcbiAgbGV0IHQ1O1xuICByZXR1cm4gJFsxNl0gIT09IGxhc3RFdmVudCB8fCAkWzE3XSAhPT0gbGFzdFBhc3N0aHJvdWdoIHx8ICRbMThdICE9PSBwYXNzdGhyb3VnaCB8fCAkWzE5XSAhPT0gcHJpc3RpbmUgPyAodDUgPSBbbGFzdEV2ZW50LCBsYXN0UGFzc3Rocm91Z2gsIHBhc3N0aHJvdWdoLCBwcmlzdGluZV0sICRbMTZdID0gbGFzdEV2ZW50LCAkWzE3XSA9IGxhc3RQYXNzdGhyb3VnaCwgJFsxOF0gPSBwYXNzdGhyb3VnaCwgJFsxOV0gPSBwcmlzdGluZSwgJFsyMF0gPSB0NSkgOiB0NSA9ICRbMjBdLCB1c2VFZmZlY3QodDQsIHQ1KSwgcHJpc3RpbmUgPyBwYXNzdGhyb3VnaCA6IG9wdGltaXN0aWM7XG59XG5jb25zdCBieXRlVG9IZXggPSBbXTtcbmZvciAobGV0IGkgPSAwOyBpIDwgMjU2OyArK2kpXG4gIGJ5dGVUb0hleC5wdXNoKChpICsgMjU2KS50b1N0cmluZygxNikuc2xpY2UoMSkpO1xuZnVuY3Rpb24gdW5zYWZlU3RyaW5naWZ5KGFyciwgb2Zmc2V0ID0gMCkge1xuICByZXR1cm4gKGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDJdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgM11dICsgXCItXCIgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDRdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNV1dICsgXCItXCIgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDZdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgN11dICsgXCItXCIgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDhdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgOV1dICsgXCItXCIgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDEwXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDExXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDEyXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDEzXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDE0XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDE1XV0pLnRvTG93ZXJDYXNlKCk7XG59XG5sZXQgZ2V0UmFuZG9tVmFsdWVzO1xuY29uc3Qgcm5kczggPSBuZXcgVWludDhBcnJheSgxNik7XG5mdW5jdGlvbiBybmcoKSB7XG4gIGlmICghZ2V0UmFuZG9tVmFsdWVzKSB7XG4gICAgaWYgKHR5cGVvZiBjcnlwdG8gPiBcInVcIiB8fCAhY3J5cHRvLmdldFJhbmRvbVZhbHVlcylcbiAgICAgIHRocm93IG5ldyBFcnJvcihcImNyeXB0by5nZXRSYW5kb21WYWx1ZXMoKSBub3Qgc3VwcG9ydGVkLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3V1aWRqcy91dWlkI2dldHJhbmRvbXZhbHVlcy1ub3Qtc3VwcG9ydGVkXCIpO1xuICAgIGdldFJhbmRvbVZhbHVlcyA9IGNyeXB0by5nZXRSYW5kb21WYWx1ZXMuYmluZChjcnlwdG8pO1xuICB9XG4gIHJldHVybiBnZXRSYW5kb21WYWx1ZXMocm5kczgpO1xufVxuY29uc3QgcmFuZG9tVVVJRCA9IHR5cGVvZiBjcnlwdG8gPCBcInVcIiAmJiBjcnlwdG8ucmFuZG9tVVVJRCAmJiBjcnlwdG8ucmFuZG9tVVVJRC5iaW5kKGNyeXB0byk7XG52YXIgbmF0aXZlID0ge1xuICByYW5kb21VVUlEXG59O1xuZnVuY3Rpb24gdjQob3B0aW9ucywgYnVmLCBvZmZzZXQpIHtcbiAgaWYgKG5hdGl2ZS5yYW5kb21VVUlEICYmICFvcHRpb25zKVxuICAgIHJldHVybiBuYXRpdmUucmFuZG9tVVVJRCgpO1xuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgY29uc3Qgcm5kcyA9IG9wdGlvbnMucmFuZG9tID8/IG9wdGlvbnMucm5nPy4oKSA/PyBybmcoKTtcbiAgaWYgKHJuZHMubGVuZ3RoIDwgMTYpXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiUmFuZG9tIGJ5dGVzIGxlbmd0aCBtdXN0IGJlID49IDE2XCIpO1xuICByZXR1cm4gcm5kc1s2XSA9IHJuZHNbNl0gJiAxNSB8IDY0LCBybmRzWzhdID0gcm5kc1s4XSAmIDYzIHwgMTI4LCB1bnNhZmVTdHJpbmdpZnkocm5kcyk7XG59XG5mdW5jdGlvbiBnZXRSZWN0KGVsZW1lbnQpIHtcbiAgY29uc3QgZG9tUmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gIHJldHVybiB7XG4gICAgeDogZG9tUmVjdC54ICsgc2Nyb2xsWCxcbiAgICB5OiBkb21SZWN0LnkgKyBzY3JvbGxZLFxuICAgIHc6IGRvbVJlY3Qud2lkdGgsXG4gICAgaDogZG9tUmVjdC5oZWlnaHRcbiAgfTtcbn1cbmZ1bmN0aW9uIG9mZnNldFJlY3QocmVjdCwgcHgsIGF4aXMpIHtcbiAgcmV0dXJuIGF4aXMgPT09IFwieFwiID8ge1xuICAgIHg6IHJlY3QueCArIHB4LFxuICAgIHk6IHJlY3QueSxcbiAgICB3OiByZWN0LncgLSAyICogcHgsXG4gICAgaDogcmVjdC5oXG4gIH0gOiB7XG4gICAgeDogcmVjdC54LFxuICAgIHk6IHJlY3QueSArIHB4LFxuICAgIHc6IHJlY3QudyxcbiAgICBoOiByZWN0LmggLSAyICogcHhcbiAgfTtcbn1cbmZ1bmN0aW9uIHJheUludGVyc2VjdChsMSwgbDIpIHtcbiAgY29uc3Qge1xuICAgIHgxLFxuICAgIHkxLFxuICAgIHgyLFxuICAgIHkyXG4gIH0gPSBsMSwge1xuICAgIHgxOiB4MyxcbiAgICB5MTogeTMsXG4gICAgeDI6IHg0LFxuICAgIHkyOiB5NFxuICB9ID0gbDI7XG4gIGlmICh4MSA9PT0geDIgJiYgeTEgPT09IHkyIHx8IHgzID09PSB4NCAmJiB5MyA9PT0geTQpXG4gICAgcmV0dXJuICExO1xuICBjb25zdCBkZW5vbWluYXRvciA9ICh5NCAtIHkzKSAqICh4MiAtIHgxKSAtICh4NCAtIHgzKSAqICh5MiAtIHkxKTtcbiAgaWYgKGRlbm9taW5hdG9yID09PSAwKVxuICAgIHJldHVybiAhMTtcbiAgY29uc3QgdWEgPSAoKHg0IC0geDMpICogKHkxIC0geTMpIC0gKHk0IC0geTMpICogKHgxIC0geDMpKSAvIGRlbm9taW5hdG9yLCB1YiA9ICgoeDIgLSB4MSkgKiAoeTEgLSB5MykgLSAoeTIgLSB5MSkgKiAoeDEgLSB4MykpIC8gZGVub21pbmF0b3I7XG4gIGlmICh1YSA8IDAgfHwgdWEgPiAxIHx8IHViIDwgMCB8fCB1YiA+IDEpXG4gICAgcmV0dXJuICExO1xuICBjb25zdCB4ID0geDEgKyB1YSAqICh4MiAtIHgxKSwgeSA9IHkxICsgdWEgKiAoeTIgLSB5MSk7XG4gIHJldHVybiB7XG4gICAgeCxcbiAgICB5XG4gIH07XG59XG5mdW5jdGlvbiByZWN0RXF1YWwocjEsIHIyKSB7XG4gIHJldHVybiByMS54ID09PSByMi54ICYmIHIxLnkgPT09IHIyLnkgJiYgcjEudyA9PT0gcjIudyAmJiByMS5oID09PSByMi5oO1xufVxuZnVuY3Rpb24gcmF5UmVjdEludGVyc2VjdGlvbnMobGluZSwgcmVjdCkge1xuICBjb25zdCByZWN0TGluZXMgPSBbe1xuICAgIHgxOiByZWN0LngsXG4gICAgeTE6IHJlY3QueSxcbiAgICB4MjogcmVjdC54ICsgcmVjdC53LFxuICAgIHkyOiByZWN0LnlcbiAgfSwge1xuICAgIHgxOiByZWN0LnggKyByZWN0LncsXG4gICAgeTE6IHJlY3QueSxcbiAgICB4MjogcmVjdC54ICsgcmVjdC53LFxuICAgIHkyOiByZWN0LnkgKyByZWN0LmhcbiAgfSwge1xuICAgIHgxOiByZWN0LnggKyByZWN0LncsXG4gICAgeTE6IHJlY3QueSArIHJlY3QuaCxcbiAgICB4MjogcmVjdC54LFxuICAgIHkyOiByZWN0LnkgKyByZWN0LmhcbiAgfSwge1xuICAgIHgxOiByZWN0LngsXG4gICAgeTE6IHJlY3QueSArIHJlY3QuaCxcbiAgICB4MjogcmVjdC54LFxuICAgIHkyOiByZWN0LnlcbiAgfV0sIGludGVyc2VjdGlvbnMgPSBbXTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCByZWN0TGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBpbnRlcnNlY3Rpb24gPSByYXlJbnRlcnNlY3QobGluZSwgcmVjdExpbmVzW2ldKTtcbiAgICBpZiAoaW50ZXJzZWN0aW9uKSB7XG4gICAgICBsZXQgaXNEdXBsaWNhdGUgPSAhMTtcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgaW50ZXJzZWN0aW9ucy5sZW5ndGg7IGorKylcbiAgICAgICAgaW50ZXJzZWN0aW9uc1tqXS54ID09PSBpbnRlcnNlY3Rpb24ueCAmJiBpbnRlcnNlY3Rpb25zW2pdLnkgPT09IGludGVyc2VjdGlvbi55ICYmIChpc0R1cGxpY2F0ZSA9ICEwKTtcbiAgICAgIGlzRHVwbGljYXRlIHx8IGludGVyc2VjdGlvbnMucHVzaChpbnRlcnNlY3Rpb24pO1xuICAgIH1cbiAgfVxuICByZXR1cm4gaW50ZXJzZWN0aW9ucy5sZW5ndGggPT09IDAgPyAhMSA6IGludGVyc2VjdGlvbnMuc29ydCgoYSwgYikgPT4gcG9pbnREaXN0KGEsIHtcbiAgICB4OiBsaW5lLngxLFxuICAgIHk6IGxpbmUueTFcbiAgfSkgLSBwb2ludERpc3QoYiwge1xuICAgIHg6IGxpbmUueDEsXG4gICAgeTogbGluZS55MVxuICB9KSk7XG59XG5mdW5jdGlvbiBwb2ludERpc3QocDEsIHAyKSB7XG4gIGNvbnN0IGEgPSBwMS54IC0gcDIueCwgYiA9IHAxLnkgLSBwMi55O1xuICByZXR1cm4gTWF0aC5zcXJ0KGEgKiBhICsgYiAqIGIpO1xufVxuZnVuY3Rpb24gcG9pbnRJbkJvdW5kcyhwb2ludCwgYm91bmRzKSB7XG4gIGNvbnN0IHdpdGhpblggPSBwb2ludC54ID49IGJvdW5kcy54ICYmIHBvaW50LnggPD0gYm91bmRzLnggKyBib3VuZHMudywgd2l0aGluWSA9IHBvaW50LnkgPj0gYm91bmRzLnkgJiYgcG9pbnQueSA8PSBib3VuZHMueSArIGJvdW5kcy5oO1xuICByZXR1cm4gd2l0aGluWCAmJiB3aXRoaW5ZO1xufVxuZnVuY3Rpb24gZmluZENsb3Nlc3RJbnRlcnNlY3Rpb24ocmF5LCB0YXJnZXRzLCBmbG93KSB7XG4gIGNvbnN0IHJheU9yaWdpbiA9IHtcbiAgICB4OiByYXkueDEsXG4gICAgeTogcmF5LnkxXG4gIH07XG4gIGlmICh0YXJnZXRzLnNvbWUoKHQpID0+IHBvaW50SW5Cb3VuZHMocmF5T3JpZ2luLCBvZmZzZXRSZWN0KHQsIE1hdGgubWluKHQudywgdC5oKSAvIDEwLCBmbG93ID09PSBcImhvcml6b250YWxcIiA/IFwieFwiIDogXCJ5XCIpKSkpIHJldHVybiBudWxsO1xuICBsZXQgY2xvc2VzdEludGVyc2VjdGlvbiwgY2xvc2VzdFJlY3Q7XG4gIGZvciAoY29uc3QgdGFyZ2V0IG9mIHRhcmdldHMpIHtcbiAgICBjb25zdCBpbnRlcnNlY3Rpb25zID0gcmF5UmVjdEludGVyc2VjdGlvbnMocmF5LCBvZmZzZXRSZWN0KHRhcmdldCwgTWF0aC5taW4odGFyZ2V0LncsIHRhcmdldC5oKSAvIDEwLCBmbG93ID09PSBcImhvcml6b250YWxcIiA/IFwieFwiIDogXCJ5XCIpKTtcbiAgICBpZiAoaW50ZXJzZWN0aW9ucykge1xuICAgICAgY29uc3QgZmlyc3RJbnRlcnNlY3Rpb24gPSBpbnRlcnNlY3Rpb25zWzBdO1xuICAgICAgY2xvc2VzdEludGVyc2VjdGlvbiA/IHBvaW50RGlzdChyYXlPcmlnaW4sIGZpcnN0SW50ZXJzZWN0aW9uKSA8IHBvaW50RGlzdChyYXlPcmlnaW4sIGNsb3Nlc3RJbnRlcnNlY3Rpb24pICYmIChjbG9zZXN0SW50ZXJzZWN0aW9uID0gZmlyc3RJbnRlcnNlY3Rpb24sIGNsb3Nlc3RSZWN0ID0gdGFyZ2V0KSA6IChjbG9zZXN0SW50ZXJzZWN0aW9uID0gZmlyc3RJbnRlcnNlY3Rpb24sIGNsb3Nlc3RSZWN0ID0gdGFyZ2V0KTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGNsb3Nlc3RSZWN0IHx8IG51bGw7XG59XG5mdW5jdGlvbiBzY2FsZVJlY3QocmVjdCwgc2NhbGUsIG9yaWdpbikge1xuICBjb25zdCB7XG4gICAgeCxcbiAgICB5LFxuICAgIHcsXG4gICAgaFxuICB9ID0gcmVjdCwge1xuICAgIHg6IG9yaWdpblgsXG4gICAgeTogb3JpZ2luWVxuICB9ID0gb3JpZ2luLCBuZXdYID0gb3JpZ2luWCArICh4IC0gb3JpZ2luWCkgKiBzY2FsZSwgbmV3WSA9IG9yaWdpblkgKyAoeSAtIG9yaWdpblkpICogc2NhbGUsIG5ld1dpZHRoID0gdyAqIHNjYWxlLCBuZXdIZWlnaHQgPSBoICogc2NhbGU7XG4gIHJldHVybiB7XG4gICAgeDogbmV3WCxcbiAgICB5OiBuZXdZLFxuICAgIHc6IG5ld1dpZHRoLFxuICAgIGg6IG5ld0hlaWdodFxuICB9O1xufVxuZnVuY3Rpb24gZ2V0UmVjdEdyb3VwWEV4dGVudChyZWN0cykge1xuICBjb25zdCBtaW5Hcm91cFggPSBNYXRoLm1heCgwLCBNYXRoLm1pbiguLi5yZWN0cy5tYXAoKHIpID0+IHIueCkpKSwgbWF4R3JvdXBYID0gTWF0aC5taW4oZG9jdW1lbnQuYm9keS5vZmZzZXRXaWR0aCwgTWF0aC5tYXgoLi4ucmVjdHMubWFwKChyKSA9PiByLnggKyByLncpKSk7XG4gIHJldHVybiB7XG4gICAgbWluOiBtaW5Hcm91cFgsXG4gICAgbWF4OiBtYXhHcm91cFgsXG4gICAgd2lkdGg6IG1heEdyb3VwWCAtIG1pbkdyb3VwWFxuICB9O1xufVxuZnVuY3Rpb24gZ2V0UmVjdEdyb3VwWUV4dGVudChyZWN0cykge1xuICBjb25zdCBtaW5Hcm91cFkgPSBNYXRoLm1heCgwLCBNYXRoLm1pbiguLi5yZWN0cy5tYXAoKHIpID0+IHIueSkpKSwgbWF4R3JvdXBZID0gTWF0aC5taW4oZG9jdW1lbnQuYm9keS5zY3JvbGxIZWlnaHQsIE1hdGgubWF4KC4uLnJlY3RzLm1hcCgocikgPT4gci55ICsgci5oKSkpO1xuICByZXR1cm4ge1xuICAgIG1pbjogbWluR3JvdXBZLFxuICAgIG1heDogbWF4R3JvdXBZLFxuICAgIGhlaWdodDogbWF4R3JvdXBZIC0gbWluR3JvdXBZXG4gIH07XG59XG5mdW5jdGlvbiBjYWxjVGFyZ2V0Rmxvdyh0YXJnZXRzKSB7XG4gIHJldHVybiB0YXJnZXRzLnNvbWUoKHQxKSA9PiB0YXJnZXRzLmZpbHRlcigodDIpID0+ICFyZWN0RXF1YWwodDEsIHQyKSkuc29tZSgodDIpID0+IHQxLnkgPT09IHQyLnkpKSA/IFwiaG9yaXpvbnRhbFwiIDogXCJ2ZXJ0aWNhbFwiO1xufVxuZnVuY3Rpb24gY2FsY0luc2VydFBvc2l0aW9uKG9yaWdpbiwgdGFyZ2V0cywgZmxvdykge1xuICBpZiAoZmxvdyA9PT0gXCJob3Jpem9udGFsXCIpIHtcbiAgICBjb25zdCByYXlMZWZ0ID0ge1xuICAgICAgeDE6IG9yaWdpbi54LFxuICAgICAgeTE6IG9yaWdpbi55LFxuICAgICAgeDI6IG9yaWdpbi54IC0gMWU4LFxuICAgICAgeTI6IG9yaWdpbi55XG4gICAgfSwgcmF5UmlnaHQgPSB7XG4gICAgICB4MTogb3JpZ2luLngsXG4gICAgICB5MTogb3JpZ2luLnksXG4gICAgICB4Mjogb3JpZ2luLnggKyAxZTgsXG4gICAgICB5Mjogb3JpZ2luLnlcbiAgICB9O1xuICAgIHJldHVybiB7XG4gICAgICBsZWZ0OiBmaW5kQ2xvc2VzdEludGVyc2VjdGlvbihyYXlMZWZ0LCB0YXJnZXRzLCBmbG93KSxcbiAgICAgIHJpZ2h0OiBmaW5kQ2xvc2VzdEludGVyc2VjdGlvbihyYXlSaWdodCwgdGFyZ2V0cywgZmxvdylcbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IHJheVRvcCA9IHtcbiAgICAgIHgxOiBvcmlnaW4ueCxcbiAgICAgIHkxOiBvcmlnaW4ueSxcbiAgICAgIHgyOiBvcmlnaW4ueCxcbiAgICAgIHkyOiBvcmlnaW4ueSAtIDFlOFxuICAgIH0sIHJheUJvdHRvbSA9IHtcbiAgICAgIHgxOiBvcmlnaW4ueCxcbiAgICAgIHkxOiBvcmlnaW4ueSxcbiAgICAgIHgyOiBvcmlnaW4ueCxcbiAgICAgIHkyOiBvcmlnaW4ueSArIDFlOFxuICAgIH07XG4gICAgcmV0dXJuIHtcbiAgICAgIHRvcDogZmluZENsb3Nlc3RJbnRlcnNlY3Rpb24ocmF5VG9wLCB0YXJnZXRzLCBmbG93KSxcbiAgICAgIGJvdHRvbTogZmluZENsb3Nlc3RJbnRlcnNlY3Rpb24ocmF5Qm90dG9tLCB0YXJnZXRzLCBmbG93KVxuICAgIH07XG4gIH1cbn1cbmZ1bmN0aW9uIGZpbmRSZWN0U2FuaXR5RGF0YShyZWN0LCBvdmVybGF5R3JvdXApIHtcbiAgcmV0dXJuIG92ZXJsYXlHcm91cC5maW5kKChlKSA9PiByZWN0RXF1YWwoZ2V0UmVjdChlLmVsZW1lbnRzLmVsZW1lbnQpLCByZWN0KSk/LnNhbml0eTtcbn1cbmZ1bmN0aW9uIHJlc29sdmVJbnNlcnRQb3NpdGlvbihvdmVybGF5R3JvdXAsIGluc2VydFBvc2l0aW9uLCBmbG93KSB7XG4gIHJldHVybiBPYmplY3QudmFsdWVzKGluc2VydFBvc2l0aW9uKS5ldmVyeSgodikgPT4gdiA9PT0gbnVsbCkgPyBudWxsIDogZmxvdyA9PT0gXCJob3Jpem9udGFsXCIgPyB7XG4gICAgbGVmdDogaW5zZXJ0UG9zaXRpb24ubGVmdCA/IHtcbiAgICAgIHJlY3Q6IGluc2VydFBvc2l0aW9uLmxlZnQsXG4gICAgICBzYW5pdHk6IGZpbmRSZWN0U2FuaXR5RGF0YShpbnNlcnRQb3NpdGlvbi5sZWZ0LCBvdmVybGF5R3JvdXApXG4gICAgfSA6IG51bGwsXG4gICAgcmlnaHQ6IGluc2VydFBvc2l0aW9uLnJpZ2h0ID8ge1xuICAgICAgcmVjdDogaW5zZXJ0UG9zaXRpb24ucmlnaHQsXG4gICAgICBzYW5pdHk6IGZpbmRSZWN0U2FuaXR5RGF0YShpbnNlcnRQb3NpdGlvbi5yaWdodCwgb3ZlcmxheUdyb3VwKVxuICAgIH0gOiBudWxsXG4gIH0gOiB7XG4gICAgdG9wOiBpbnNlcnRQb3NpdGlvbi50b3AgPyB7XG4gICAgICByZWN0OiBpbnNlcnRQb3NpdGlvbi50b3AsXG4gICAgICBzYW5pdHk6IGZpbmRSZWN0U2FuaXR5RGF0YShpbnNlcnRQb3NpdGlvbi50b3AsIG92ZXJsYXlHcm91cClcbiAgICB9IDogbnVsbCxcbiAgICBib3R0b206IGluc2VydFBvc2l0aW9uLmJvdHRvbSA/IHtcbiAgICAgIHJlY3Q6IGluc2VydFBvc2l0aW9uLmJvdHRvbSxcbiAgICAgIHNhbml0eTogZmluZFJlY3RTYW5pdHlEYXRhKGluc2VydFBvc2l0aW9uLmJvdHRvbSwgb3ZlcmxheUdyb3VwKVxuICAgIH0gOiBudWxsXG4gIH07XG59XG5mdW5jdGlvbiBjYWxjTW91c2VQb3MoZSkge1xuICBjb25zdCBib2R5Qm91bmRzID0gZG9jdW1lbnQuYm9keS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgcmV0dXJuIHtcbiAgICB4OiBNYXRoLm1heChib2R5Qm91bmRzLngsIE1hdGgubWluKGUuY2xpZW50WCwgYm9keUJvdW5kcy54ICsgYm9keUJvdW5kcy53aWR0aCkpLFxuICAgIHk6IGUuY2xpZW50WSArIHdpbmRvdy5zY3JvbGxZXG4gIH07XG59XG5mdW5jdGlvbiBjYWxjTW91c2VQb3NJbnZlcnNlVHJhbnNmb3JtKG1vdXNlUG9zMikge1xuICBjb25zdCBib2R5ID0gZG9jdW1lbnQuYm9keSwgdHJhbnNmb3JtID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoYm9keSkudHJhbnNmb3JtO1xuICBpZiAodHJhbnNmb3JtID09PSBcIm5vbmVcIilcbiAgICByZXR1cm4ge1xuICAgICAgeDogbW91c2VQb3MyLngsXG4gICAgICB5OiBtb3VzZVBvczIueVxuICAgIH07XG4gIGNvbnN0IGludmVyc2VNYXRyaXggPSBuZXcgRE9NTWF0cml4KHRyYW5zZm9ybSkuaW52ZXJzZSgpLCB0cmFuc2Zvcm1lZFBvaW50ID0gbmV3IERPTVBvaW50KG1vdXNlUG9zMi54LCBtb3VzZVBvczIueSkubWF0cml4VHJhbnNmb3JtKGludmVyc2VNYXRyaXgpO1xuICByZXR1cm4ge1xuICAgIHg6IHRyYW5zZm9ybWVkUG9pbnQueCxcbiAgICB5OiB0cmFuc2Zvcm1lZFBvaW50LnlcbiAgfTtcbn1cbmZ1bmN0aW9uIGJ1aWxkUHJldmlld1NrZWxldG9uKG1vdXNlUG9zMiwgZWxlbWVudCwgc2NhbGVGYWN0b3IpIHtcbiAgY29uc3QgYm91bmRzID0gZ2V0UmVjdChlbGVtZW50KSwgY2hpbGRyZW4gPSBbLi4uZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiOndoZXJlKGgxLCBoMiwgaDMsIGg0LCBwLCBhLCBpbWcsIHNwYW4sIGJ1dHRvbik6bm90KDpoYXMoKikpXCIpXTtcbiAgbW91c2VQb3MyLnggPD0gYm91bmRzLnggJiYgKG1vdXNlUG9zMi54ID0gYm91bmRzLngpLCBtb3VzZVBvczIueCA+PSBib3VuZHMueCArIGJvdW5kcy53ICYmIChtb3VzZVBvczIueCA9IGJvdW5kcy54ICsgYm91bmRzLncpLCBtb3VzZVBvczIueSA+PSBib3VuZHMueSArIGJvdW5kcy5oICYmIChtb3VzZVBvczIueSA9IGJvdW5kcy55ICsgYm91bmRzLmgpLCBtb3VzZVBvczIueSA8PSBib3VuZHMueSAmJiAobW91c2VQb3MyLnkgPSBib3VuZHMueSk7XG4gIGNvbnN0IGNoaWxkUmVjdHMgPSBjaGlsZHJlbi5tYXAoKGNoaWxkKSA9PiB7XG4gICAgY29uc3QgcmVjdCA9IHNjYWxlUmVjdChnZXRSZWN0KGNoaWxkKSwgc2NhbGVGYWN0b3IsIHtcbiAgICAgIHg6IGJvdW5kcy54LFxuICAgICAgeTogYm91bmRzLnlcbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgeDogcmVjdC54IC0gYm91bmRzLngsXG4gICAgICB5OiByZWN0LnkgLSBib3VuZHMueSxcbiAgICAgIHc6IHJlY3QudyxcbiAgICAgIGg6IHJlY3QuaCxcbiAgICAgIHRhZ05hbWU6IGNoaWxkLnRhZ05hbWVcbiAgICB9O1xuICB9KTtcbiAgcmV0dXJuIHtcbiAgICBvZmZzZXRYOiAoYm91bmRzLnggLSBtb3VzZVBvczIueCkgKiBzY2FsZUZhY3RvcixcbiAgICBvZmZzZXRZOiAoYm91bmRzLnkgLSBtb3VzZVBvczIueSkgKiBzY2FsZUZhY3RvcixcbiAgICB3OiBib3VuZHMudyAqIHNjYWxlRmFjdG9yLFxuICAgIGg6IGJvdW5kcy5oICogc2NhbGVGYWN0b3IsXG4gICAgbWF4V2lkdGg6IGJvdW5kcy53ICogc2NhbGVGYWN0b3IgKiAwLjc1LFxuICAgIGNoaWxkUmVjdHNcbiAgfTtcbn1cbmNvbnN0IG1pbkRyYWdEZWx0YSA9IDQ7XG5hc3luYyBmdW5jdGlvbiBhcHBseU1pbmltYXBXcmFwcGVyVHJhbnNmb3JtKHRhcmdldCwgc2NhbGVGYWN0b3IsIG1pbllTY2FsZWQsIGhhbmRsZXIsIHJlY3RVcGRhdGVGcmVxdWVuY3kpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgdGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsICgpID0+IHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBoYW5kbGVyKHtcbiAgICAgICAgICB0eXBlOiBcIm92ZXJsYXkvZHJhZ0VuZE1pbmltYXBUcmFuc2l0aW9uXCJcbiAgICAgICAgfSk7XG4gICAgICB9LCByZWN0VXBkYXRlRnJlcXVlbmN5ICogMiksIHJlc29sdmUoKTtcbiAgICB9LCB7XG4gICAgICBvbmNlOiAhMFxuICAgIH0pLCBoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwib3ZlcmxheS9kcmFnU3RhcnRNaW5pbWFwVHJhbnNpdGlvblwiXG4gICAgfSksIGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJvdmVybGF5L2RyYWdUb2dnbGVNaW5pbWFwXCIsXG4gICAgICBkaXNwbGF5OiAhMFxuICAgIH0pLCBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gXCJoaWRkZW5cIiwgZG9jdW1lbnQuYm9keS5zdHlsZS5oZWlnaHQgPSBcIjEwMCVcIiwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnN0eWxlLm92ZXJmbG93ID0gXCJpbml0aWFsXCIsIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5oZWlnaHQgPSBcIjEwMCVcIiwgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0YXJnZXQuc3R5bGUudHJhbnNmb3JtT3JpZ2luID0gXCI1MCUgMHB4XCIsIHRhcmdldC5zdHlsZS50cmFuc2l0aW9uID0gXCJ0cmFuc2Zvcm0gMTUwbXMgZWFzZVwiLCB0YXJnZXQuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZTNkKDBweCwgJHstbWluWVNjYWxlZCArIHNjcm9sbFl9cHgsIDBweCkgc2NhbGUoJHtzY2FsZUZhY3Rvcn0pYDtcbiAgICB9LCAyNSk7XG4gIH0pO1xufVxuZnVuY3Rpb24gY2FsY01pbmltYXBUcmFuc2Zvcm1WYWx1ZXMocmVjdHMsIGdyb3VwSGVpZ2h0T3ZlcnJpZGUpIHtcbiAgbGV0IGdyb3VwSGVpZ2h0ID0gZ3JvdXBIZWlnaHRPdmVycmlkZSB8fCBnZXRSZWN0R3JvdXBZRXh0ZW50KHJlY3RzKS5oZWlnaHQ7XG4gIGNvbnN0IHBhZGRpbmcgPSAxMDA7XG4gIGdyb3VwSGVpZ2h0ICs9IHBhZGRpbmcgKiAyO1xuICBjb25zdCBzY2FsZUZhY3RvciA9IGdyb3VwSGVpZ2h0ID4gd2luZG93LmlubmVySGVpZ2h0ID8gd2luZG93LmlubmVySGVpZ2h0IC8gZ3JvdXBIZWlnaHQgOiAxLCBzY2FsZWRSZWN0cyA9IHJlY3RzLm1hcCgocikgPT4gc2NhbGVSZWN0KHIsIHNjYWxlRmFjdG9yLCB7XG4gICAgeDogd2luZG93LmlubmVyV2lkdGggLyAyLFxuICAgIHk6IDBcbiAgfSkpLCB7XG4gICAgbWluOiBtaW5ZU2NhbGVkXG4gIH0gPSBnZXRSZWN0R3JvdXBZRXh0ZW50KHNjYWxlZFJlY3RzKTtcbiAgcmV0dXJuIHtcbiAgICBzY2FsZUZhY3RvcixcbiAgICBtaW5ZU2NhbGVkOiBtaW5ZU2NhbGVkIC0gcGFkZGluZyAqIHNjYWxlRmFjdG9yXG4gIH07XG59XG5mdW5jdGlvbiBjYWxjR3JvdXBCb3VuZHNQcmV2aWV3KHJlY3RzKSB7XG4gIGNvbnN0IGdyb3VwQm91bmRzWCA9IGdldFJlY3RHcm91cFhFeHRlbnQocmVjdHMpLCBncm91cEJvdW5kc1kgPSBnZXRSZWN0R3JvdXBZRXh0ZW50KHJlY3RzKSwgb2Zmc2V0RGlzdCA9IDgsIGNhbk9mZnNldFggPSBncm91cEJvdW5kc1gubWluID4gb2Zmc2V0RGlzdCAmJiBncm91cEJvdW5kc1gubWluICsgZ3JvdXBCb3VuZHNYLndpZHRoIDw9IHdpbmRvdy5pbm5lcldpZHRoIC0gb2Zmc2V0RGlzdCwgY2FuT2Zmc2V0WSA9IGdyb3VwQm91bmRzWS5taW4gPiBvZmZzZXREaXN0ICYmIGdyb3VwQm91bmRzWS5taW4gKyBncm91cEJvdW5kc1kuaGVpZ2h0IDw9IGRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0IC0gb2Zmc2V0RGlzdCwgY2FuT2Zmc2V0ID0gY2FuT2Zmc2V0WCAmJiBjYW5PZmZzZXRZO1xuICByZXR1cm4ge1xuICAgIHg6IGNhbk9mZnNldCA/IGdyb3VwQm91bmRzWC5taW4gLSBvZmZzZXREaXN0IDogZ3JvdXBCb3VuZHNYLm1pbixcbiAgICB5OiBjYW5PZmZzZXQgPyBncm91cEJvdW5kc1kubWluIC0gb2Zmc2V0RGlzdCA6IGdyb3VwQm91bmRzWS5taW4sXG4gICAgdzogY2FuT2Zmc2V0ID8gZ3JvdXBCb3VuZHNYLndpZHRoICsgb2Zmc2V0RGlzdCAqIDIgOiBncm91cEJvdW5kc1gud2lkdGgsXG4gICAgaDogY2FuT2Zmc2V0ID8gZ3JvdXBCb3VuZHNZLmhlaWdodCArIG9mZnNldERpc3QgKiAyIDogZ3JvdXBCb3VuZHNZLmhlaWdodFxuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gcmVzZXRNaW5pbWFwV3JhcHBlclRyYW5zZm9ybShlbmRZT3JpZ2luLCB0YXJnZXQsIHByZXNjYWxlSGVpZ2h0MiwgaGFuZGxlciwgcmVjdFVwZGF0ZUZyZXF1ZW5jeSwgcHJldmlvdXNSb290U3R5bGVWYWx1ZXMyKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgIGNvbnN0IHRyYW5zZm9ybSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRhcmdldCkudHJhbnNmb3JtO1xuICAgIGlmIChuZXcgRE9NTWF0cml4KHRyYW5zZm9ybSkuYSA9PT0gMSkgcmV0dXJuO1xuICAgIGNvbnN0IG1heFNjcm9sbCA9IHByZXNjYWxlSGVpZ2h0MiAtIHdpbmRvdy5pbm5lckhlaWdodCwgcHJldlNjcm9sbFkgPSBzY3JvbGxZO1xuICAgIGVuZFlPcmlnaW4gLT0gd2luZG93LmlubmVySGVpZ2h0IC8gMiwgZW5kWU9yaWdpbiA8IDAgJiYgKGVuZFlPcmlnaW4gPSAwKSwgdGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsICgpID0+IHtcbiAgICAgIHRhcmdldC5zdHlsZS50cmFuc2l0aW9uID0gXCJub25lXCIsIHRhcmdldC5zdHlsZS50cmFuc2Zvcm0gPSBcIm5vbmVcIiwgc2Nyb2xsVG8oe1xuICAgICAgICB0b3A6IGVuZFlPcmlnaW4sXG4gICAgICAgIGJlaGF2aW9yOiBcImluc3RhbnRcIlxuICAgICAgfSksIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBoYW5kbGVyKHtcbiAgICAgICAgICB0eXBlOiBcIm92ZXJsYXkvZHJhZ0VuZE1pbmltYXBUcmFuc2l0aW9uXCJcbiAgICAgICAgfSksIGhhbmRsZXIoe1xuICAgICAgICAgIHR5cGU6IFwib3ZlcmxheS9kcmFnVG9nZ2xlTWluaW1hcFwiLFxuICAgICAgICAgIGRpc3BsYXk6ICExXG4gICAgICAgIH0pO1xuICAgICAgfSwgcmVjdFVwZGF0ZUZyZXF1ZW5jeSAqIDIpLCByZXNvbHZlKCk7XG4gICAgfSwge1xuICAgICAgb25jZTogITBcbiAgICB9KSwgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcIm92ZXJsYXkvZHJhZ1N0YXJ0TWluaW1hcFRyYW5zaXRpb25cIlxuICAgIH0pLCB0YXJnZXQuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVkoJHtNYXRoLm1heChwcmV2U2Nyb2xsWSAtIGVuZFlPcmlnaW4sIC1tYXhTY3JvbGwgKyBwcmV2U2Nyb2xsWSl9cHgpIHNjYWxlKDEpYCwgcHJldmlvdXNSb290U3R5bGVWYWx1ZXMyICYmIChkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gcHJldmlvdXNSb290U3R5bGVWYWx1ZXMyLmJvZHkub3ZlcmZsb3csIGRvY3VtZW50LmJvZHkuc3R5bGUuaGVpZ2h0ID0gcHJldmlvdXNSb290U3R5bGVWYWx1ZXMyLmJvZHkuaGVpZ2h0LCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUub3ZlcmZsb3cgPSBwcmV2aW91c1Jvb3RTdHlsZVZhbHVlczIuZG9jdW1lbnRFbGVtZW50Lm92ZXJmbG93LCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gcHJldmlvdXNSb290U3R5bGVWYWx1ZXMyLmRvY3VtZW50RWxlbWVudC5oZWlnaHQpO1xuICB9KTtcbn1cbmxldCBtaW5pbWFwU2NhbGVBcHBsaWVkID0gITEsIG1vdXNlUG9zSW52ZXJzZVRyYW5zZm9ybSA9IHtcbiAgeTogMFxufSwgbW91c2VQb3MgPSB7XG4gIHg6IDAsXG4gIHk6IDBcbn0sIHByZXNjYWxlSGVpZ2h0ID0gdHlwZW9mIGRvY3VtZW50ID4gXCJ1XCIgPyAwIDogZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbEhlaWdodCwgcHJldmlvdXNSb290U3R5bGVWYWx1ZXMgPSBudWxsO1xuZnVuY3Rpb24gaGFuZGxlT3ZlcmxheURyYWcob3B0cykge1xuICBjb25zdCB7XG4gICAgbW91c2VFdmVudCxcbiAgICBlbGVtZW50LFxuICAgIG92ZXJsYXlHcm91cCxcbiAgICBoYW5kbGVyLFxuICAgIHRhcmdldCxcbiAgICBvblNlcXVlbmNlU3RhcnQsXG4gICAgb25TZXF1ZW5jZUVuZFxuICB9ID0gb3B0cztcbiAgaWYgKG1vdXNlRXZlbnQuYnV0dG9uICE9PSAwKSByZXR1cm47XG4gIHdpbmRvdy5mb2N1cygpO1xuICBjb25zdCByZWN0VXBkYXRlRnJlcXVlbmN5ID0gMTUwO1xuICBsZXQgcmVjdHMgPSBvdmVybGF5R3JvdXAubWFwKChlKSA9PiBnZXRSZWN0KGUuZWxlbWVudHMuZWxlbWVudCkpO1xuICBjb25zdCBmbG93ID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNhbml0eS1kcmFnLWZsb3dcIikgfHwgY2FsY1RhcmdldEZsb3cocmVjdHMpLCBkcmFnR3JvdXAgPSBlbGVtZW50LmdldEF0dHJpYnV0ZShcImRhdGEtc2FuaXR5LWRyYWctZ3JvdXBcIiksIGRpc2FibGVNaW5pbWFwID0gISFlbGVtZW50LmdldEF0dHJpYnV0ZShcImRhdGEtc2FuaXR5LWRyYWctbWluaW1hcC1kaXNhYmxlXCIpLCBwcmV2ZW50SW5zZXJ0RGVmYXVsdCA9ICEhZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNhbml0eS1kcmFnLXByZXZlbnQtZGVmYXVsdFwiKSwgZG9jdW1lbnRIZWlnaHRPdmVycmlkZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS11bnN0YWJsZV9zYW5pdHktZHJhZy1kb2N1bWVudC1oZWlnaHRcIiksIGdyb3VwSGVpZ2h0T3ZlcnJpZGUgPSBlbGVtZW50LmdldEF0dHJpYnV0ZShcImRhdGEtdW5zdGFibGVfc2FuaXR5LWRyYWctZ3JvdXAtaGVpZ2h0XCIpO1xuICBsZXQgaW5zZXJ0UG9zaXRpb24gPSBudWxsO1xuICBjb25zdCBpbml0aWFsTW91c2VQb3MgPSBjYWxjTW91c2VQb3MobW91c2VFdmVudCksIHNjYWxlVGFyZ2V0ID0gZG9jdW1lbnQuYm9keSwge1xuICAgIG1pbllTY2FsZWQsXG4gICAgc2NhbGVGYWN0b3JcbiAgfSA9IGNhbGNNaW5pbWFwVHJhbnNmb3JtVmFsdWVzKHJlY3RzLCBncm91cEhlaWdodE92ZXJyaWRlID8gfn5ncm91cEhlaWdodE92ZXJyaWRlIDogbnVsbCk7XG4gIGxldCBzZXF1ZW5jZVN0YXJ0ZWQgPSAhMSwgbWluaW1hcFByb21wdFNob3duID0gITEsIG1vdXNlZG93biA9ICEwO1xuICBtaW5pbWFwU2NhbGVBcHBsaWVkIHx8IChwcmV2aW91c1Jvb3RTdHlsZVZhbHVlcyA9IHtcbiAgICBib2R5OiB7XG4gICAgICBvdmVyZmxvdzogd2luZG93LmdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkub3ZlcmZsb3csXG4gICAgICBoZWlnaHQ6IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmhlaWdodFxuICAgIH0sXG4gICAgZG9jdW1lbnRFbGVtZW50OiB7XG4gICAgICBvdmVyZmxvdzogd2luZG93LmdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5vdmVyZmxvdyxcbiAgICAgIGhlaWdodDogd2luZG93LmdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5oZWlnaHRcbiAgICB9XG4gIH0sIHByZXNjYWxlSGVpZ2h0ID0gZG9jdW1lbnRIZWlnaHRPdmVycmlkZSA/IH5+ZG9jdW1lbnRIZWlnaHRPdmVycmlkZSA6IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxIZWlnaHQpO1xuICBjb25zdCByZWN0c0ludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgIHJlY3RzID0gb3ZlcmxheUdyb3VwLm1hcCgoZSkgPT4gZ2V0UmVjdChlLmVsZW1lbnRzLmVsZW1lbnQpKTtcbiAgfSwgcmVjdFVwZGF0ZUZyZXF1ZW5jeSksIGFwcGx5TWluaW1hcCA9ICgpID0+IHtcbiAgICBpZiAoc2NhbGVGYWN0b3IgPj0gMSkgcmV0dXJuO1xuICAgIGNvbnN0IHNrZWxldG9uID0gYnVpbGRQcmV2aWV3U2tlbGV0b24obW91c2VQb3MsIGVsZW1lbnQsIHNjYWxlRmFjdG9yKTtcbiAgICBoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwib3ZlcmxheS9kcmFnVXBkYXRlU2tlbGV0b25cIixcbiAgICAgIHNrZWxldG9uXG4gICAgfSksIGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJvdmVybGF5L2RyYWdUb2dnbGVNaW5pbWFwUHJvbXB0XCIsXG4gICAgICBkaXNwbGF5OiAhMVxuICAgIH0pLCBhcHBseU1pbmltYXBXcmFwcGVyVHJhbnNmb3JtKHNjYWxlVGFyZ2V0LCBzY2FsZUZhY3RvciwgbWluWVNjYWxlZCwgaGFuZGxlciwgcmVjdFVwZGF0ZUZyZXF1ZW5jeSkudGhlbigoKSA9PiB7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgaGFuZGxlcih7XG4gICAgICAgICAgdHlwZTogXCJvdmVybGF5L2RyYWdVcGRhdGVHcm91cFJlY3RcIixcbiAgICAgICAgICBncm91cFJlY3Q6IGNhbGNHcm91cEJvdW5kc1ByZXZpZXcocmVjdHMpXG4gICAgICAgIH0pO1xuICAgICAgfSwgcmVjdFVwZGF0ZUZyZXF1ZW5jeSAqIDIpO1xuICAgIH0pO1xuICB9LCBoYW5kbGVTY3JvbGwgPSAoZSkgPT4ge1xuICAgIE1hdGguYWJzKGUuZGVsdGFZKSA+PSAxMCAmJiBzY2FsZUZhY3RvciA8IDEgJiYgIW1pbmltYXBTY2FsZUFwcGxpZWQgJiYgIW1pbmltYXBQcm9tcHRTaG93biAmJiAhZGlzYWJsZU1pbmltYXAgJiYgbW91c2Vkb3duICYmIChoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwib3ZlcmxheS9kcmFnVG9nZ2xlTWluaW1hcFByb21wdFwiLFxuICAgICAgZGlzcGxheTogITBcbiAgICB9KSwgbWluaW1hcFByb21wdFNob3duID0gITApLCBlLnNoaWZ0S2V5ICYmICFtaW5pbWFwU2NhbGVBcHBsaWVkICYmICFkaXNhYmxlTWluaW1hcCAmJiAod2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwidW5zdGFibGVfc2FuaXR5L2RyYWdBcHBseU1pbmltYXBcIikpLCBtaW5pbWFwU2NhbGVBcHBsaWVkID0gITAsIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgYXBwbHlNaW5pbWFwKCk7XG4gICAgfSwgNTApKTtcbiAgfSwgaGFuZGxlTW91c2VNb3ZlID0gKGUpID0+IHtcbiAgICBpZiAoZS5wcmV2ZW50RGVmYXVsdCgpLCBtb3VzZVBvcyA9IGNhbGNNb3VzZVBvcyhlKSwgbW91c2VQb3NJbnZlcnNlVHJhbnNmb3JtID0gY2FsY01vdXNlUG9zSW52ZXJzZVRyYW5zZm9ybShtb3VzZVBvcyksIE1hdGguYWJzKHBvaW50RGlzdChtb3VzZVBvcywgaW5pdGlhbE1vdXNlUG9zKSkgPCBtaW5EcmFnRGVsdGEpIHJldHVybjtcbiAgICBpZiAoIXNlcXVlbmNlU3RhcnRlZCkge1xuICAgICAgY29uc3QgZ3JvdXBSZWN0ID0gY2FsY0dyb3VwQm91bmRzUHJldmlldyhyZWN0cyksIHNrZWxldG9uID0gYnVpbGRQcmV2aWV3U2tlbGV0b24obW91c2VQb3MsIGVsZW1lbnQsIDEpO1xuICAgICAgaGFuZGxlcih7XG4gICAgICAgIHR5cGU6IFwib3ZlcmxheS9kcmFnU3RhcnRcIixcbiAgICAgICAgZmxvd1xuICAgICAgfSksIGhhbmRsZXIoe1xuICAgICAgICB0eXBlOiBcIm92ZXJsYXkvZHJhZ1VwZGF0ZVNrZWxldG9uXCIsXG4gICAgICAgIHNrZWxldG9uXG4gICAgICB9KSwgaGFuZGxlcih7XG4gICAgICAgIHR5cGU6IFwib3ZlcmxheS9kcmFnVXBkYXRlR3JvdXBSZWN0XCIsXG4gICAgICAgIGdyb3VwUmVjdFxuICAgICAgfSksIHNlcXVlbmNlU3RhcnRlZCA9ICEwLCBvblNlcXVlbmNlU3RhcnQoKTtcbiAgICB9XG4gICAgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcIm92ZXJsYXkvZHJhZ1VwZGF0ZUN1cnNvclBvc2l0aW9uXCIsXG4gICAgICB4OiBtb3VzZVBvcy54LFxuICAgICAgeTogbW91c2VQb3MueVxuICAgIH0pLCBlLnNoaWZ0S2V5ICYmICFtaW5pbWFwU2NhbGVBcHBsaWVkICYmICFkaXNhYmxlTWluaW1hcCAmJiAod2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwidW5zdGFibGVfc2FuaXR5L2RyYWdBcHBseU1pbmltYXBcIikpLCBtaW5pbWFwU2NhbGVBcHBsaWVkID0gITAsIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgYXBwbHlNaW5pbWFwKCk7XG4gICAgfSwgNTApKTtcbiAgICBjb25zdCBuZXdJbnNlcnRQb3NpdGlvbiA9IGNhbGNJbnNlcnRQb3NpdGlvbihtb3VzZVBvcywgcmVjdHMsIGZsb3cpO1xuICAgIEpTT04uc3RyaW5naWZ5KGluc2VydFBvc2l0aW9uKSAhPT0gSlNPTi5zdHJpbmdpZnkobmV3SW5zZXJ0UG9zaXRpb24pICYmIChpbnNlcnRQb3NpdGlvbiA9IG5ld0luc2VydFBvc2l0aW9uLCBoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwib3ZlcmxheS9kcmFnVXBkYXRlSW5zZXJ0UG9zaXRpb25cIixcbiAgICAgIGluc2VydFBvc2l0aW9uOiByZXNvbHZlSW5zZXJ0UG9zaXRpb24ob3ZlcmxheUdyb3VwLCBpbnNlcnRQb3NpdGlvbiwgZmxvdylcbiAgICB9KSk7XG4gIH0sIGhhbmRsZU1vdXNlVXAgPSAoKSA9PiB7XG4gICAgbW91c2Vkb3duID0gITEsIGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJvdmVybGF5L2RyYWdFbmRcIixcbiAgICAgIHRhcmdldCxcbiAgICAgIGluc2VydFBvc2l0aW9uOiBpbnNlcnRQb3NpdGlvbiA/IHJlc29sdmVJbnNlcnRQb3NpdGlvbihvdmVybGF5R3JvdXAsIGluc2VydFBvc2l0aW9uLCBmbG93KSA6IG51bGwsXG4gICAgICBkcmFnR3JvdXAsXG4gICAgICBmbG93LFxuICAgICAgcHJldmVudEluc2VydERlZmF1bHRcbiAgICB9KSwgbWluaW1hcFByb21wdFNob3duICYmIGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJvdmVybGF5L2RyYWdUb2dnbGVNaW5pbWFwUHJvbXB0XCIsXG4gICAgICBkaXNwbGF5OiAhMVxuICAgIH0pLCBtaW5pbWFwU2NhbGVBcHBsaWVkIHx8IChjbGVhckludGVydmFsKHJlY3RzSW50ZXJ2YWwpLCBvblNlcXVlbmNlRW5kKCksIHJlbW92ZUZyYW1lTGlzdGVuZXJzKCksIHJlbW92ZUtleUxpc3RlbmVycygpKSwgcmVtb3ZlTW91c2VMaXN0ZW5lcnMoKTtcbiAgfSwgaGFuZGxlS2V5dXAgPSAoZSkgPT4ge1xuICAgIGlmIChlLmtleSA9PT0gXCJTaGlmdFwiICYmIG1pbmltYXBTY2FsZUFwcGxpZWQpIHtcbiAgICAgIG1pbmltYXBTY2FsZUFwcGxpZWQgPSAhMTtcbiAgICAgIGNvbnN0IHNrZWxldG9uID0gYnVpbGRQcmV2aWV3U2tlbGV0b24obW91c2VQb3MsIGVsZW1lbnQsIDEgLyBzY2FsZUZhY3Rvcik7XG4gICAgICBoYW5kbGVyKHtcbiAgICAgICAgdHlwZTogXCJvdmVybGF5L2RyYWdVcGRhdGVTa2VsZXRvblwiLFxuICAgICAgICBza2VsZXRvblxuICAgICAgfSksIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcInVuc3RhYmxlX3Nhbml0eS9kcmFnUmVzZXRNaW5pbWFwXCIpKSwgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHJlc2V0TWluaW1hcFdyYXBwZXJUcmFuc2Zvcm0obW91c2VQb3NJbnZlcnNlVHJhbnNmb3JtLnksIHNjYWxlVGFyZ2V0LCBwcmVzY2FsZUhlaWdodCwgaGFuZGxlciwgcmVjdFVwZGF0ZUZyZXF1ZW5jeSwgcHJldmlvdXNSb290U3R5bGVWYWx1ZXMpO1xuICAgICAgfSwgNTApLCBoYW5kbGVyKHtcbiAgICAgICAgdHlwZTogXCJvdmVybGF5L2RyYWdVcGRhdGVHcm91cFJlY3RcIixcbiAgICAgICAgZ3JvdXBSZWN0OiBudWxsXG4gICAgICB9KSwgbW91c2Vkb3duIHx8IChjbGVhckludGVydmFsKHJlY3RzSW50ZXJ2YWwpLCByZW1vdmVNb3VzZUxpc3RlbmVycygpLCByZW1vdmVGcmFtZUxpc3RlbmVycygpLCByZW1vdmVLZXlMaXN0ZW5lcnMoKSwgb25TZXF1ZW5jZUVuZCgpKTtcbiAgICB9XG4gIH0sIGhhbmRsZUJsdXIgPSAoKSA9PiB7XG4gICAgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcIm92ZXJsYXkvZHJhZ1VwZGF0ZUdyb3VwUmVjdFwiLFxuICAgICAgZ3JvdXBSZWN0OiBudWxsXG4gICAgfSksIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudChcInVuc3RhYmxlX3Nhbml0eS9kcmFnUmVzZXRNaW5pbWFwXCIpKSwgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICByZXNldE1pbmltYXBXcmFwcGVyVHJhbnNmb3JtKG1vdXNlUG9zSW52ZXJzZVRyYW5zZm9ybS55LCBzY2FsZVRhcmdldCwgcHJlc2NhbGVIZWlnaHQsIGhhbmRsZXIsIHJlY3RVcGRhdGVGcmVxdWVuY3ksIHByZXZpb3VzUm9vdFN0eWxlVmFsdWVzKS50aGVuKCgpID0+IHtcbiAgICAgICAgbWluaW1hcFNjYWxlQXBwbGllZCA9ICExO1xuICAgICAgfSk7XG4gICAgfSwgNTApLCBjbGVhckludGVydmFsKHJlY3RzSW50ZXJ2YWwpLCByZW1vdmVNb3VzZUxpc3RlbmVycygpLCByZW1vdmVGcmFtZUxpc3RlbmVycygpLCByZW1vdmVLZXlMaXN0ZW5lcnMoKSwgb25TZXF1ZW5jZUVuZCgpO1xuICB9LCByZW1vdmVNb3VzZUxpc3RlbmVycyA9ICgpID0+IHtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBoYW5kbGVNb3VzZU1vdmUpLCB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIndoZWVsXCIsIGhhbmRsZVNjcm9sbCksIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBoYW5kbGVNb3VzZVVwKTtcbiAgfSwgcmVtb3ZlS2V5TGlzdGVuZXJzID0gKCkgPT4ge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgaGFuZGxlS2V5dXApO1xuICB9LCByZW1vdmVGcmFtZUxpc3RlbmVycyA9ICgpID0+IHtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgaGFuZGxlQmx1cik7XG4gIH07XG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLCBoYW5kbGVCbHVyKSwgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBoYW5kbGVLZXl1cCksIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwid2hlZWxcIiwgaGFuZGxlU2Nyb2xsKSwgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgaGFuZGxlTW91c2VNb3ZlKSwgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIGhhbmRsZU1vdXNlVXApO1xufVxuY29uc3QgaXNFbGVtZW50Tm9kZSQxID0gKHRhcmdldCkgPT4gdGFyZ2V0IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQgfHwgdGFyZ2V0IGluc3RhbmNlb2YgU1ZHRWxlbWVudDtcbmZ1bmN0aW9uIGZpbmROb25JbmxpbmVFbGVtZW50KGVsZW1lbnQpIHtcbiAgY29uc3Qge1xuICAgIGRpc3BsYXlcbiAgfSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpO1xuICBpZiAoZGlzcGxheSAhPT0gXCJpbmxpbmVcIikgcmV0dXJuIGVsZW1lbnQ7XG4gIGNvbnN0IHBhcmVudCA9IGVsZW1lbnQucGFyZW50RWxlbWVudDtcbiAgcmV0dXJuIHBhcmVudCA/IGZpbmROb25JbmxpbmVFbGVtZW50KHBhcmVudCkgOiBudWxsO1xufVxuY29uc3QgZmluZE92ZXJsYXlFbGVtZW50ID0gKGVsKSA9PiAhZWwgfHwgIWlzRWxlbWVudE5vZGUkMShlbCkgPyBudWxsIDogZWwuZGF0YXNldD8uc2FuaXR5T3ZlcmxheUVsZW1lbnQgPyBlbCA6IGZpbmRPdmVybGF5RWxlbWVudChlbC5wYXJlbnRFbGVtZW50KTtcbmZ1bmN0aW9uIHRlc3RWZXJjZWxTdGVnYVJlZ2V4KGlucHV0KSB7XG4gIHJldHVybiBWRVJDRUxfU1RFR0FfUkVHRVgubGFzdEluZGV4ID0gMCwgVkVSQ0VMX1NURUdBX1JFR0VYLnRlc3QoaW5wdXQpO1xufVxuZnVuY3Rpb24gZGVjb2RlU3RlZ2Eoc3RyLCBpc0FsdFRleHQgPSAhMSkge1xuICB0cnkge1xuICAgIGNvbnN0IGRlY29kZWQgPSB2ZXJjZWxTdGVnYURlY29kZShzdHIpO1xuICAgIHJldHVybiAhZGVjb2RlZCB8fCBkZWNvZGVkLm9yaWdpbiAhPT0gXCJzYW5pdHkuaW9cIiA/IG51bGwgOiAoaXNBbHRUZXh0ICYmIChkZWNvZGVkLmhyZWYgPSBkZWNvZGVkLmhyZWY/LnJlcGxhY2UoXCIuYWx0XCIsIFwiXCIpKSwgZGVjb2RlZCk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHJldHVybiBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGRlY29kZSBzdGVnYSBmb3Igc3RyaW5nOiBcIiwgc3RyLCBcIndpdGggdGhlIG9yaWdpbmFsIGVycm9yOiBcIiwgZXJyKSwgbnVsbDtcbiAgfVxufVxuZnVuY3Rpb24gdGVzdEFuZERlY29kZVN0ZWdhKHN0ciwgaXNBbHRUZXh0ID0gITEpIHtcbiAgcmV0dXJuIHRlc3RWZXJjZWxTdGVnYVJlZ2V4KHN0cikgPyBkZWNvZGVTdGVnYShzdHIsIGlzQWx0VGV4dCkgOiBudWxsO1xufVxuY29uc3QgaXNFbGVtZW50Tm9kZSA9IChub2RlKSA9PiBub2RlLm5vZGVUeXBlID09PSBOb2RlLkVMRU1FTlRfTk9ERSwgaXNJbWdFbGVtZW50ID0gKGVsKSA9PiBlbC50YWdOYW1lID09PSBcIklNR1wiLCBpc1RpbWVFbGVtZW50ID0gKGVsKSA9PiBlbC50YWdOYW1lID09PSBcIlRJTUVcIiwgaXNTdmdSb290RWxlbWVudCA9IChlbCkgPT4gZWwudGFnTmFtZS50b1VwcGVyQ2FzZSgpID09PSBcIlNWR1wiO1xuZnVuY3Rpb24gaXNTYW5pdHlOb2RlKG5vZGUpIHtcbiAgcmV0dXJuIFwicGF0aFwiIGluIG5vZGU7XG59XG5mdW5jdGlvbiBmaW5kQ29tbW9uUGF0aChmaXJzdCwgc2Vjb25kKSB7XG4gIGxldCBmaXJzdFBhcnRzID0gZmlyc3Quc3BsaXQoXCIuXCIpLCBzZWNvbmRQYXJ0cyA9IHNlY29uZC5zcGxpdChcIi5cIik7XG4gIGNvbnN0IG1heExlbmd0aCA9IE1hdGgubWluKGZpcnN0UGFydHMubGVuZ3RoLCBzZWNvbmRQYXJ0cy5sZW5ndGgpO1xuICByZXR1cm4gZmlyc3RQYXJ0cyA9IGZpcnN0UGFydHMuc2xpY2UoMCwgbWF4TGVuZ3RoKS5yZXZlcnNlKCksIHNlY29uZFBhcnRzID0gc2Vjb25kUGFydHMuc2xpY2UoMCwgbWF4TGVuZ3RoKS5yZXZlcnNlKCksIGZpcnN0UGFydHMucmVkdWNlKChwYXJ0cywgcGFydCwgaSkgPT4gcGFydCA9PT0gc2Vjb25kUGFydHNbaV0gPyBbLi4ucGFydHMsIHBhcnRdIDogW10sIFtdKS5yZXZlcnNlKCkuam9pbihcIi5cIik7XG59XG5mdW5jdGlvbiBmaW5kQ29tbW9uU2FuaXR5RGF0YShub2Rlcykge1xuICBpZiAoIW5vZGVzLmxlbmd0aCB8fCAhbm9kZXMubWFwKChuKSA9PiBpc1Nhbml0eU5vZGUobikpLmV2ZXJ5KChuLCBfaSwgYXJyKSA9PiBuID09PSBhcnJbMF0pKVxuICAgIHJldHVybjtcbiAgaWYgKCFpc1Nhbml0eU5vZGUobm9kZXNbMF0pKSByZXR1cm4gbm9kZXNbMF07XG4gIGNvbnN0IHNhbml0eU5vZGVzID0gbm9kZXMuZmlsdGVyKGlzU2FuaXR5Tm9kZSk7XG4gIGxldCBjb21tb24gPSBub2Rlc1swXTtcbiAgY29uc3QgY29uc2lzdGVudFZhbHVlS2V5cyA9IFtcInByb2plY3RJZFwiLCBcImRhdGFzZXRcIiwgXCJpZFwiLCBcImJhc2VVcmxcIiwgXCJ3b3Jrc3BhY2VcIiwgXCJ0b29sXCJdO1xuICBmb3IgKGxldCBpID0gMTsgaSA8IHNhbml0eU5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3Qgbm9kZSA9IHNhbml0eU5vZGVzW2ldO1xuICAgIGlmIChjb25zaXN0ZW50VmFsdWVLZXlzLnNvbWUoKGtleSkgPT4gbm9kZVtrZXldICE9PSBjb21tb24/LltrZXldKSkge1xuICAgICAgY29tbW9uID0gdm9pZCAwO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGNvbW1vbi5wYXRoID0gZmluZENvbW1vblBhdGgoY29tbW9uLnBhdGgsIG5vZGUucGF0aCk7XG4gIH1cbiAgcmV0dXJuIGNvbW1vbjtcbn1cbmZ1bmN0aW9uIGZpbmRTYW5pdHlOb2RlcyhlbCkge1xuICBjb25zdCBlbGVtZW50cyA9IFtdO1xuICBmdW5jdGlvbiBhZGRFbGVtZW50KGVsZW1lbnQsIGRhdGEpIHtcbiAgICBjb25zdCBzYW5pdHkgPSBkZWNvZGVTYW5pdHlOb2RlRGF0YShkYXRhKTtcbiAgICBpZiAoIXNhbml0eSlcbiAgICAgIHJldHVybjtcbiAgICBjb25zdCBtZWFzdXJlRWxlbWVudCA9IGZpbmROb25JbmxpbmVFbGVtZW50KGVsZW1lbnQpO1xuICAgIG1lYXN1cmVFbGVtZW50ICYmIGVsZW1lbnRzLnB1c2goe1xuICAgICAgZWxlbWVudHM6IHtcbiAgICAgICAgZWxlbWVudCxcbiAgICAgICAgbWVhc3VyZUVsZW1lbnRcbiAgICAgIH0sXG4gICAgICBzYW5pdHlcbiAgICB9KTtcbiAgfVxuICBpZiAoZWwpXG4gICAgZm9yIChjb25zdCBub2RlIG9mIGVsLmNoaWxkTm9kZXMpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgbm9kZVR5cGUsXG4gICAgICAgIHBhcmVudEVsZW1lbnQsXG4gICAgICAgIHRleHRDb250ZW50XG4gICAgICB9ID0gbm9kZTtcbiAgICAgIGlmIChpc0VsZW1lbnROb2RlKG5vZGUpICYmIG5vZGUuZGF0YXNldD8uc2FuaXR5RWRpdFRhcmdldCAhPT0gdm9pZCAwKSB7XG4gICAgICAgIGNvbnN0IG5vZGVzSW5UYXJnZXQgPSBmaW5kU2FuaXR5Tm9kZXMobm9kZSkubWFwKCh7XG4gICAgICAgICAgc2FuaXR5XG4gICAgICAgIH0pID0+IHNhbml0eSk7XG4gICAgICAgIGlmICghbm9kZXNJblRhcmdldC5tYXAoKG4pID0+IGlzU2FuaXR5Tm9kZShuKSkuZXZlcnkoKG4sIF9pLCBhcnIpID0+IG4gPT09IGFyclswXSkpXG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIGNvbnN0IGNvbW1vbkRhdGEgPSBmaW5kQ29tbW9uU2FuaXR5RGF0YShub2Rlc0luVGFyZ2V0KTtcbiAgICAgICAgY29tbW9uRGF0YSAmJiBlbGVtZW50cy5wdXNoKHtcbiAgICAgICAgICBlbGVtZW50czoge1xuICAgICAgICAgICAgZWxlbWVudDogbm9kZSxcbiAgICAgICAgICAgIG1lYXN1cmVFbGVtZW50OiBub2RlXG4gICAgICAgICAgfSxcbiAgICAgICAgICBzYW5pdHk6IGNvbW1vbkRhdGFcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2UgaWYgKG5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSAmJiBwYXJlbnRFbGVtZW50ICYmIHRleHRDb250ZW50KSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSB0ZXN0QW5kRGVjb2RlU3RlZ2EodGV4dENvbnRlbnQpO1xuICAgICAgICBpZiAoIWRhdGEpIGNvbnRpbnVlO1xuICAgICAgICBhZGRFbGVtZW50KHBhcmVudEVsZW1lbnQsIGRhdGEpO1xuICAgICAgfSBlbHNlIGlmIChpc0VsZW1lbnROb2RlKG5vZGUpKSB7XG4gICAgICAgIGlmIChub2RlLnRhZ05hbWUgPT09IFwiU0NSSVBUXCIgfHwgbm9kZS50YWdOYW1lID09PSBcIlNBTklUWS1WSVNVQUwtRURJVElOR1wiKVxuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICBpZiAobm9kZS5kYXRhc2V0Py5zYW5pdHkpXG4gICAgICAgICAgYWRkRWxlbWVudChub2RlLCBub2RlLmRhdGFzZXQuc2FuaXR5KTtcbiAgICAgICAgZWxzZSBpZiAobm9kZS5kYXRhc2V0Py5zYW5pdHlFZGl0SW5mbylcbiAgICAgICAgICBhZGRFbGVtZW50KG5vZGUsIG5vZGUuZGF0YXNldC5zYW5pdHlFZGl0SW5mbyk7XG4gICAgICAgIGVsc2UgaWYgKGlzSW1nRWxlbWVudChub2RlKSkge1xuICAgICAgICAgIGNvbnN0IGRhdGEgPSB0ZXN0QW5kRGVjb2RlU3RlZ2Eobm9kZS5hbHQsICEwKTtcbiAgICAgICAgICBpZiAoIWRhdGEpIGNvbnRpbnVlO1xuICAgICAgICAgIGFkZEVsZW1lbnQobm9kZSwgZGF0YSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNUaW1lRWxlbWVudChub2RlKSkge1xuICAgICAgICAgIGNvbnN0IGRhdGEgPSB0ZXN0QW5kRGVjb2RlU3RlZ2Eobm9kZS5kYXRlVGltZSwgITApO1xuICAgICAgICAgIGlmICghZGF0YSkgY29udGludWU7XG4gICAgICAgICAgYWRkRWxlbWVudChub2RlLCBkYXRhKTtcbiAgICAgICAgfSBlbHNlIGlmIChpc1N2Z1Jvb3RFbGVtZW50KG5vZGUpKSB7XG4gICAgICAgICAgaWYgKCFub2RlLmFyaWFMYWJlbCkgY29udGludWU7XG4gICAgICAgICAgY29uc3QgZGF0YSA9IHRlc3RBbmREZWNvZGVTdGVnYShub2RlLmFyaWFMYWJlbCwgITApO1xuICAgICAgICAgIGlmICghZGF0YSkgY29udGludWU7XG4gICAgICAgICAgYWRkRWxlbWVudChub2RlLCBkYXRhKTtcbiAgICAgICAgfVxuICAgICAgICBlbGVtZW50cy5wdXNoKC4uLmZpbmRTYW5pdHlOb2Rlcyhub2RlKSk7XG4gICAgICB9XG4gICAgfVxuICByZXR1cm4gZWxlbWVudHM7XG59XG5mdW5jdGlvbiBpc1Nhbml0eUFycmF5UGF0aChwYXRoKSB7XG4gIGNvbnN0IGxhc3REb3RJbmRleCA9IHBhdGgubGFzdEluZGV4T2YoXCIuXCIpO1xuICByZXR1cm4gcGF0aC5zdWJzdHJpbmcobGFzdERvdEluZGV4LCBwYXRoLmxlbmd0aCkuaW5jbHVkZXMoXCJbXCIpO1xufVxuZnVuY3Rpb24gZ2V0U2FuaXR5Tm9kZUFycmF5UGF0aChwYXRoKSB7XG4gIGlmICghaXNTYW5pdHlBcnJheVBhdGgocGF0aCkpIHJldHVybiBudWxsO1xuICBjb25zdCBzcGxpdCA9IHBhdGguc3BsaXQoXCIuXCIpO1xuICByZXR1cm4gc3BsaXRbc3BsaXQubGVuZ3RoIC0gMV0gPSBzcGxpdFtzcGxpdC5sZW5ndGggLSAxXS5yZXBsYWNlKC9cXFsuKj9cXF0vZywgXCJbXVwiKSwgc3BsaXQuam9pbihcIi5cIik7XG59XG5mdW5jdGlvbiBzYW5pdHlOb2Rlc0V4aXN0SW5TYW1lQXJyYXkoc2FuaXR5Tm9kZTEsIHNhbml0eU5vZGUyKSB7XG4gIHJldHVybiAhaXNTYW5pdHlBcnJheVBhdGgoc2FuaXR5Tm9kZTEucGF0aCkgfHwgIWlzU2FuaXR5QXJyYXlQYXRoKHNhbml0eU5vZGUyLnBhdGgpID8gITEgOiBnZXRTYW5pdHlOb2RlQXJyYXlQYXRoKHNhbml0eU5vZGUxLnBhdGgpID09PSBnZXRTYW5pdHlOb2RlQXJyYXlQYXRoKHNhbml0eU5vZGUyLnBhdGgpO1xufVxuZnVuY3Rpb24gcmVzb2x2ZURyYWdBbmREcm9wR3JvdXAoZWxlbWVudCwgc2FuaXR5LCBlbGVtZW50U2V0LCBlbGVtZW50c01hcCkge1xuICBpZiAoIWVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1zYW5pdHlcIikgfHwgZWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNhbml0eS1kcmFnLWRpc2FibGVcIikgfHwgIXNhbml0eSB8fCAhaXNTYW5pdHlOb2RlKHNhbml0eSkgfHwgIWlzU2FuaXR5QXJyYXlQYXRoKHNhbml0eS5wYXRoKSkgcmV0dXJuIG51bGw7XG4gIGNvbnN0IHRhcmdldERyYWdHcm91cCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1zYW5pdHktZHJhZy1ncm91cFwiKSwgZ3JvdXAgPSBbLi4uZWxlbWVudFNldF0ucmVkdWNlKChhY2MsIGVsKSA9PiB7XG4gICAgY29uc3QgZWxEYXRhID0gZWxlbWVudHNNYXAuZ2V0KGVsKSwgZWxEcmFnRGlzYWJsZWQgPSBlbC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNhbml0eS1kcmFnLWRpc2FibGVcIiksIGVsRHJhZ0dyb3VwID0gZWwuZ2V0QXR0cmlidXRlKFwiZGF0YS1zYW5pdHktZHJhZy1ncm91cFwiKSwgZWxIYXNTYW5pdHlBdHRyaWJ1dGlvbiA9IGVsLmdldEF0dHJpYnV0ZShcImRhdGEtc2FuaXR5XCIpICE9PSBudWxsLCBzaGFyZWREcmFnR3JvdXAgPSB0YXJnZXREcmFnR3JvdXAgIT09IG51bGwgPyB0YXJnZXREcmFnR3JvdXAgPT09IGVsRHJhZ0dyb3VwIDogITA7XG4gICAgcmV0dXJuIGVsRGF0YSAmJiAhZWxEcmFnRGlzYWJsZWQgJiYgaXNTYW5pdHlOb2RlKGVsRGF0YS5zYW5pdHkpICYmIHNhbml0eU5vZGVzRXhpc3RJblNhbWVBcnJheShzYW5pdHksIGVsRGF0YS5zYW5pdHkpICYmIHNoYXJlZERyYWdHcm91cCAmJiBlbEhhc1Nhbml0eUF0dHJpYnV0aW9uICYmIGFjYy5wdXNoKGVsRGF0YSksIGFjYztcbiAgfSwgW10pO1xuICByZXR1cm4gZ3JvdXAubGVuZ3RoIDw9IDEgPyBudWxsIDogZ3JvdXA7XG59XG5mdW5jdGlvbiBjcmVhdGVPdmVybGF5Q29udHJvbGxlcih7XG4gIGhhbmRsZXIsXG4gIG92ZXJsYXlFbGVtZW50LFxuICBpbkZyYW1lLFxuICBpblBvcFVwLFxuICBvcHRpbWlzdGljQWN0b3JSZWFkeVxufSkge1xuICBsZXQgYWN0aXZhdGVkID0gITE7XG4gIGNvbnN0IGVsZW1lbnRJZE1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCksIGVsZW1lbnRzTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCksIGVsZW1lbnRTZXQgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpLCBtZWFzdXJlRWxlbWVudHMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFdlYWtNYXAoKSwgY3Vyc29yTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBXZWFrTWFwKCk7XG4gIGxldCBybywgaW8sIG1vLCBhY3RpdmVEcmFnU2VxdWVuY2UgPSAhMSwgaG92ZXJTdGFjayA9IFtdO1xuICBjb25zdCBnZXRIb3ZlcmVkRWxlbWVudCA9ICgpID0+IGhvdmVyU3RhY2tbaG92ZXJTdGFjay5sZW5ndGggLSAxXTtcbiAgZnVuY3Rpb24gYWRkRXZlbnRIYW5kbGVycyhlbCwgaGFuZGxlcnMpIHtcbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlcnMuY2xpY2ssIHtcbiAgICAgIGNhcHR1cmU6ICEwXG4gICAgfSksIGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBoYW5kbGVycy5jb250ZXh0bWVudSwge1xuICAgICAgY2FwdHVyZTogITBcbiAgICB9KSwgZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBoYW5kbGVycy5tb3VzZW1vdmUsIHtcbiAgICAgIG9uY2U6ICEwLFxuICAgICAgY2FwdHVyZTogITBcbiAgICB9KSwgZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBoYW5kbGVycy5tb3VzZWRvd24sIHtcbiAgICAgIGNhcHR1cmU6ICEwXG4gICAgfSk7XG4gIH1cbiAgZnVuY3Rpb24gcmVtb3ZlRXZlbnRIYW5kbGVycyhlbCwgaGFuZGxlcnMpIHtcbiAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlcnMuY2xpY2ssIHtcbiAgICAgIGNhcHR1cmU6ICEwXG4gICAgfSksIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBoYW5kbGVycy5jb250ZXh0bWVudSwge1xuICAgICAgY2FwdHVyZTogITBcbiAgICB9KSwgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCBoYW5kbGVycy5tb3VzZW1vdmUsIHtcbiAgICAgIGNhcHR1cmU6ICEwXG4gICAgfSksIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgaGFuZGxlcnMubW91c2Vkb3duLCB7XG4gICAgICBjYXB0dXJlOiAhMFxuICAgIH0pLCBlbC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2VlbnRlclwiLCBoYW5kbGVycy5tb3VzZWVudGVyKSwgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgaGFuZGxlcnMubW91c2VsZWF2ZSk7XG4gIH1cbiAgZnVuY3Rpb24gYWN0aXZhdGVFbGVtZW50KHtcbiAgICBpZCxcbiAgICBlbGVtZW50cyxcbiAgICBoYW5kbGVyc1xuICB9KSB7XG4gICAgY29uc3Qge1xuICAgICAgZWxlbWVudCxcbiAgICAgIG1lYXN1cmVFbGVtZW50XG4gICAgfSA9IGVsZW1lbnRzO1xuICAgIGFkZEV2ZW50SGFuZGxlcnMoZWxlbWVudCwgaGFuZGxlcnMpLCByby5vYnNlcnZlKG1lYXN1cmVFbGVtZW50KSwgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcImVsZW1lbnQvYWN0aXZhdGVcIixcbiAgICAgIGlkXG4gICAgfSk7XG4gIH1cbiAgZnVuY3Rpb24gZGVhY3RpdmF0ZUVsZW1lbnQoe1xuICAgIGlkLFxuICAgIGVsZW1lbnRzLFxuICAgIGhhbmRsZXJzXG4gIH0pIHtcbiAgICBjb25zdCB7XG4gICAgICBlbGVtZW50LFxuICAgICAgbWVhc3VyZUVsZW1lbnRcbiAgICB9ID0gZWxlbWVudHM7XG4gICAgcmVtb3ZlRXZlbnRIYW5kbGVycyhlbGVtZW50LCBoYW5kbGVycyksIHJvLnVub2JzZXJ2ZShtZWFzdXJlRWxlbWVudCksIGhvdmVyU3RhY2sgPSBob3ZlclN0YWNrLmZpbHRlcigoZWwpID0+IGVsICE9PSBlbGVtZW50KSwgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcImVsZW1lbnQvZGVhY3RpdmF0ZVwiLFxuICAgICAgaWRcbiAgICB9KTtcbiAgfVxuICBmdW5jdGlvbiBzZXRPdmVybGF5Q3Vyc29yKGVsZW1lbnQpIHtcbiAgICBpZiAoISghaW5GcmFtZSAmJiAhaW5Qb3BVcCB8fCAhb3B0aW1pc3RpY0FjdG9yUmVhZHkpKVxuICAgICAgZm9yIChjb25zdCBob3ZlcnN0YWNrRWxlbWVudCBvZiBob3ZlclN0YWNrKSB7XG4gICAgICAgIGlmIChlbGVtZW50ID09PSBob3ZlcnN0YWNrRWxlbWVudCkge1xuICAgICAgICAgIGNvbnN0IHRhcmdldFNhbml0eURhdGEgPSBlbGVtZW50c01hcC5nZXQoZWxlbWVudCk/LnNhbml0eTtcbiAgICAgICAgICBpZiAoIXRhcmdldFNhbml0eURhdGEgfHwgIWlzU2FuaXR5Tm9kZSh0YXJnZXRTYW5pdHlEYXRhKSkgcmV0dXJuO1xuICAgICAgICAgIGlmIChyZXNvbHZlRHJhZ0FuZERyb3BHcm91cChlbGVtZW50LCB0YXJnZXRTYW5pdHlEYXRhLCBlbGVtZW50U2V0LCBlbGVtZW50c01hcCkpIHtcbiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nQ3Vyc29yID0gZWxlbWVudC5zdHlsZS5jdXJzb3I7XG4gICAgICAgICAgICBleGlzdGluZ0N1cnNvciAmJiBjdXJzb3JNYXAuc2V0KGVsZW1lbnQsIGV4aXN0aW5nQ3Vyc29yKSwgaGFuZGxlcih7XG4gICAgICAgICAgICAgIHR5cGU6IFwib3ZlcmxheS9zZXRDdXJzb3JcIixcbiAgICAgICAgICAgICAgZWxlbWVudCxcbiAgICAgICAgICAgICAgY3Vyc29yOiBcIm1vdmVcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmVzdG9yZU92ZXJsYXlDdXJzb3IoaG92ZXJzdGFja0VsZW1lbnQpO1xuICAgICAgfVxuICB9XG4gIGZ1bmN0aW9uIHJlc3RvcmVPdmVybGF5Q3Vyc29yKGVsZW1lbnQpIHtcbiAgICBjb25zdCBwcmV2aW91c0N1cnNvciA9IGN1cnNvck1hcC5nZXQoZWxlbWVudCk7XG4gICAgaGFuZGxlcih7XG4gICAgICB0eXBlOiBcIm92ZXJsYXkvc2V0Q3Vyc29yXCIsXG4gICAgICBlbGVtZW50LFxuICAgICAgY3Vyc29yOiBwcmV2aW91c0N1cnNvclxuICAgIH0pO1xuICB9XG4gIGZ1bmN0aW9uIHJlZ2lzdGVyRWxlbWVudCh7XG4gICAgZWxlbWVudHMsXG4gICAgc2FuaXR5XG4gIH0pIHtcbiAgICBjb25zdCB7XG4gICAgICBlbGVtZW50LFxuICAgICAgbWVhc3VyZUVsZW1lbnRcbiAgICB9ID0gZWxlbWVudHMsIGV2ZW50SGFuZGxlcnMgPSB7XG4gICAgICBjbGljayhldmVudCkge1xuICAgICAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG4gICAgICAgIGlmIChlbGVtZW50ID09PSBnZXRIb3ZlcmVkRWxlbWVudCgpICYmIGVsZW1lbnQuY29udGFpbnModGFyZ2V0KSkge1xuICAgICAgICAgIGluRnJhbWUgJiYgKGV2ZW50LnByZXZlbnREZWZhdWx0KCksIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpKTtcbiAgICAgICAgICBjb25zdCBzYW5pdHkyID0gZWxlbWVudHNNYXAuZ2V0KGVsZW1lbnQpPy5zYW5pdHk7XG4gICAgICAgICAgc2FuaXR5MiAmJiAhYWN0aXZlRHJhZ1NlcXVlbmNlICYmIGhhbmRsZXIoe1xuICAgICAgICAgICAgdHlwZTogXCJlbGVtZW50L2NsaWNrXCIsXG4gICAgICAgICAgICBpZCxcbiAgICAgICAgICAgIHNhbml0eTogc2FuaXR5MlxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgY29udGV4dG1lbnUoZXZlbnQpIHtcbiAgICAgICAgaWYgKCEoXCJwYXRoXCIgaW4gc2FuaXR5KSB8fCAhaW5GcmFtZSAmJiAhaW5Qb3BVcCB8fCAhb3B0aW1pc3RpY0FjdG9yUmVhZHkgfHwgIXNhbml0eS5wYXRoLnNwbGl0KFwiLlwiKS5wb3AoKT8uaW5jbHVkZXMoXCJbX2tleT09XCIpKSByZXR1cm47XG4gICAgICAgIGNvbnN0IHRhcmdldCA9IGV2ZW50LnRhcmdldDtcbiAgICAgICAgZWxlbWVudCA9PT0gZ2V0SG92ZXJlZEVsZW1lbnQoKSAmJiBlbGVtZW50LmNvbnRhaW5zKHRhcmdldCkgJiYgKChpbkZyYW1lIHx8IGluUG9wVXApICYmIChldmVudC5wcmV2ZW50RGVmYXVsdCgpLCBldmVudC5zdG9wUHJvcGFnYXRpb24oKSksIGhhbmRsZXIoe1xuICAgICAgICAgIHR5cGU6IFwiZWxlbWVudC9jb250ZXh0bWVudVwiLFxuICAgICAgICAgIGlkLFxuICAgICAgICAgIHBvc2l0aW9uOiB7XG4gICAgICAgICAgICB4OiBldmVudC5jbGllbnRYLFxuICAgICAgICAgICAgeTogZXZlbnQuY2xpZW50WVxuICAgICAgICAgIH0sXG4gICAgICAgICAgc2FuaXR5XG4gICAgICAgIH0pKTtcbiAgICAgIH0sXG4gICAgICBtb3VzZWRvd24oZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LnByZXZlbnREZWZhdWx0KCksIGV2ZW50LmN1cnJlbnRUYXJnZXQgIT09IGhvdmVyU3RhY2suYXQoLTEpIHx8IGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1zYW5pdHktZHJhZy1kaXNhYmxlXCIpIHx8ICFpbkZyYW1lICYmICFpblBvcFVwIHx8ICFvcHRpbWlzdGljQWN0b3JSZWFkeSkgcmV0dXJuO1xuICAgICAgICBjb25zdCB0YXJnZXRTYW5pdHlEYXRhID0gZWxlbWVudHNNYXAuZ2V0KGVsZW1lbnQpPy5zYW5pdHk7XG4gICAgICAgIGlmICghdGFyZ2V0U2FuaXR5RGF0YSB8fCAhaXNTYW5pdHlOb2RlKHRhcmdldFNhbml0eURhdGEpIHx8ICFpc1Nhbml0eUFycmF5UGF0aCh0YXJnZXRTYW5pdHlEYXRhLnBhdGgpKSByZXR1cm47XG4gICAgICAgIGNvbnN0IGRyYWdHcm91cCA9IHJlc29sdmVEcmFnQW5kRHJvcEdyb3VwKGVsZW1lbnQsIHNhbml0eSwgZWxlbWVudFNldCwgZWxlbWVudHNNYXApO1xuICAgICAgICBkcmFnR3JvdXAgJiYgaGFuZGxlT3ZlcmxheURyYWcoe1xuICAgICAgICAgIGVsZW1lbnQsXG4gICAgICAgICAgaGFuZGxlcixcbiAgICAgICAgICBtb3VzZUV2ZW50OiBldmVudCxcbiAgICAgICAgICBvdmVybGF5R3JvdXA6IGRyYWdHcm91cCxcbiAgICAgICAgICB0YXJnZXQ6IHRhcmdldFNhbml0eURhdGEsXG4gICAgICAgICAgb25TZXF1ZW5jZVN0YXJ0OiAoKSA9PiB7XG4gICAgICAgICAgICBhY3RpdmVEcmFnU2VxdWVuY2UgPSAhMDtcbiAgICAgICAgICB9LFxuICAgICAgICAgIG9uU2VxdWVuY2VFbmQ6ICgpID0+IHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICBhY3RpdmVEcmFnU2VxdWVuY2UgPSAhMTtcbiAgICAgICAgICAgIH0sIDI1MCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBtb3VzZW1vdmUoZXZlbnQpIHtcbiAgICAgICAgZXZlbnRIYW5kbGVycy5tb3VzZWVudGVyKGV2ZW50KTtcbiAgICAgICAgY29uc3QgZWwgPSBldmVudC5jdXJyZW50VGFyZ2V0O1xuICAgICAgICBlbCAmJiAoZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwgZXZlbnRIYW5kbGVycy5tb3VzZWVudGVyKSwgZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwgZXZlbnRIYW5kbGVycy5tb3VzZWxlYXZlKSk7XG4gICAgICB9LFxuICAgICAgbW91c2VlbnRlcigpIHtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcInZlcmNlbC1saXZlLWZlZWRiYWNrXCIpICYmIGVsZW1lbnQuY2xvc2VzdChcIltkYXRhLXZlcmNlbC1lZGl0LWluZm9dXCIpIHx8IGVsZW1lbnQuY2xvc2VzdChcIltkYXRhLXZlcmNlbC1lZGl0LXRhcmdldF1cIikgfHwgKGhvdmVyU3RhY2sucHVzaChlbGVtZW50KSwgaGFuZGxlcih7XG4gICAgICAgICAgdHlwZTogXCJlbGVtZW50L21vdXNlZW50ZXJcIixcbiAgICAgICAgICBpZCxcbiAgICAgICAgICByZWN0OiBnZXRSZWN0KGVsZW1lbnQpXG4gICAgICAgIH0pLCBzZXRPdmVybGF5Q3Vyc29yKGVsZW1lbnQpKTtcbiAgICAgIH0sXG4gICAgICBtb3VzZWxlYXZlKGUpIHtcbiAgICAgICAgZnVuY3Rpb24gbGVhdmUoKSB7XG4gICAgICAgICAgaG92ZXJTdGFjay5wb3AoKTtcbiAgICAgICAgICBjb25zdCBob3ZlcmVkRWxlbWVudCA9IGdldEhvdmVyZWRFbGVtZW50KCk7XG4gICAgICAgICAgaWYgKGhhbmRsZXIoe1xuICAgICAgICAgICAgdHlwZTogXCJlbGVtZW50L21vdXNlbGVhdmVcIixcbiAgICAgICAgICAgIGlkXG4gICAgICAgICAgfSksIGhvdmVyZWRFbGVtZW50KSB7XG4gICAgICAgICAgICBzZXRPdmVybGF5Q3Vyc29yKGhvdmVyZWRFbGVtZW50KTtcbiAgICAgICAgICAgIGNvbnN0IG92ZXJsYXlFbGVtZW50MiA9IGVsZW1lbnRzTWFwLmdldChob3ZlcmVkRWxlbWVudCk7XG4gICAgICAgICAgICBvdmVybGF5RWxlbWVudDIgJiYgaGFuZGxlcih7XG4gICAgICAgICAgICAgIHR5cGU6IFwiZWxlbWVudC9tb3VzZWVudGVyXCIsXG4gICAgICAgICAgICAgIGlkOiBvdmVybGF5RWxlbWVudDIuaWQsXG4gICAgICAgICAgICAgIHJlY3Q6IGdldFJlY3QoaG92ZXJlZEVsZW1lbnQpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmVzdG9yZU92ZXJsYXlDdXJzb3IoZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gYWRkRGVmZXJyZWRMZWF2ZShlbCkge1xuICAgICAgICAgIGNvbnN0IGRlZmVycmVkTGVhdmUgPSAoZTIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgICAgcmVsYXRlZFRhcmdldDogcmVsYXRlZFRhcmdldDJcbiAgICAgICAgICAgIH0gPSBlMjtcbiAgICAgICAgICAgIGZpbmRPdmVybGF5RWxlbWVudChyZWxhdGVkVGFyZ2V0MikgPyByZWxhdGVkVGFyZ2V0MiAmJiBpc0VsZW1lbnROb2RlJDEocmVsYXRlZFRhcmdldDIpICYmIChlbC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2VsZWF2ZVwiLCBkZWZlcnJlZExlYXZlKSwgYWRkRGVmZXJyZWRMZWF2ZShyZWxhdGVkVGFyZ2V0MikpIDogKGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsIGRlZmVycmVkTGVhdmUpLCBsZWF2ZSgpKTtcbiAgICAgICAgICB9O1xuICAgICAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWxlYXZlXCIsIGRlZmVycmVkTGVhdmUpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICByZWxhdGVkVGFyZ2V0XG4gICAgICAgIH0gPSBlLCBjb250YWluZXIgPSBmaW5kT3ZlcmxheUVsZW1lbnQocmVsYXRlZFRhcmdldCksIGlzSW50ZXJhY3RpdmVPdmVybGF5RWxlbWVudCA9IG92ZXJsYXlFbGVtZW50LmNvbnRhaW5zKGNvbnRhaW5lcik7XG4gICAgICAgIGlmIChpc0VsZW1lbnROb2RlJDEoY29udGFpbmVyKSAmJiBpc0ludGVyYWN0aXZlT3ZlcmxheUVsZW1lbnQpXG4gICAgICAgICAgcmV0dXJuIGFkZERlZmVycmVkTGVhdmUoY29udGFpbmVyKTtcbiAgICAgICAgbGVhdmUoKTtcbiAgICAgIH1cbiAgICB9LCBpZCA9IHY0KCksIHNhbml0eU5vZGUgPSB7XG4gICAgICBpZCxcbiAgICAgIGVsZW1lbnRzLFxuICAgICAgc2FuaXR5LFxuICAgICAgaGFuZGxlcnM6IGV2ZW50SGFuZGxlcnNcbiAgICB9O1xuICAgIGVsZW1lbnRTZXQuYWRkKGVsZW1lbnQpLCBtZWFzdXJlRWxlbWVudHMuc2V0KG1lYXN1cmVFbGVtZW50LCBlbGVtZW50KSwgZWxlbWVudElkTWFwLnNldChpZCwgZWxlbWVudCksIGVsZW1lbnRzTWFwLnNldChlbGVtZW50LCBzYW5pdHlOb2RlKSwgaW8/Lm9ic2VydmUoZWxlbWVudCksIGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJlbGVtZW50L3JlZ2lzdGVyXCIsXG4gICAgICBpZCxcbiAgICAgIGVsZW1lbnQsXG4gICAgICByZWN0OiBnZXRSZWN0KGVsZW1lbnQpLFxuICAgICAgc2FuaXR5LFxuICAgICAgZHJhZ0Rpc2FibGVkOiAhIWVsZW1lbnQuZ2V0QXR0cmlidXRlKFwiZGF0YS1zYW5pdHktZHJhZy1kaXNhYmxlXCIpXG4gICAgfSksIGFjdGl2YXRlZCAmJiBhY3RpdmF0ZUVsZW1lbnQoc2FuaXR5Tm9kZSk7XG4gIH1cbiAgZnVuY3Rpb24gdXBkYXRlRWxlbWVudCh7XG4gICAgZWxlbWVudHMsXG4gICAgc2FuaXR5XG4gIH0pIHtcbiAgICBjb25zdCB7XG4gICAgICBlbGVtZW50XG4gICAgfSA9IGVsZW1lbnRzLCBvdmVybGF5RWxlbWVudDIgPSBlbGVtZW50c01hcC5nZXQoZWxlbWVudCk7XG4gICAgb3ZlcmxheUVsZW1lbnQyICYmIChlbGVtZW50c01hcC5zZXQoZWxlbWVudCwge1xuICAgICAgLi4ub3ZlcmxheUVsZW1lbnQyLFxuICAgICAgc2FuaXR5XG4gICAgfSksIGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJlbGVtZW50L3VwZGF0ZVwiLFxuICAgICAgaWQ6IG92ZXJsYXlFbGVtZW50Mi5pZCxcbiAgICAgIHJlY3Q6IGdldFJlY3QoZWxlbWVudCksXG4gICAgICBzYW5pdHlcbiAgICB9KSk7XG4gIH1cbiAgZnVuY3Rpb24gcGFyc2VFbGVtZW50cyhub2RlKSB7XG4gICAgY29uc3Qgc2FuaXR5Tm9kZXMgPSBmaW5kU2FuaXR5Tm9kZXMobm9kZSk7XG4gICAgZm9yIChjb25zdCBzYW5pdHlOb2RlIG9mIHNhbml0eU5vZGVzKSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIGVsZW1lbnRcbiAgICAgIH0gPSBzYW5pdHlOb2RlLmVsZW1lbnRzO1xuICAgICAgZWxlbWVudHNNYXAuaGFzKGVsZW1lbnQpID8gdXBkYXRlRWxlbWVudChzYW5pdHlOb2RlKSA6IHJlZ2lzdGVyRWxlbWVudChzYW5pdHlOb2RlKTtcbiAgICB9XG4gIH1cbiAgZnVuY3Rpb24gdW5yZWdpc3RlckVsZW1lbnQoZWxlbWVudCkge1xuICAgIGNvbnN0IG92ZXJsYXlFbGVtZW50MiA9IGVsZW1lbnRzTWFwLmdldChlbGVtZW50KTtcbiAgICBpZiAob3ZlcmxheUVsZW1lbnQyKSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIGlkLFxuICAgICAgICBoYW5kbGVyc1xuICAgICAgfSA9IG92ZXJsYXlFbGVtZW50MjtcbiAgICAgIHJlbW92ZUV2ZW50SGFuZGxlcnMoZWxlbWVudCwgaGFuZGxlcnMpLCByby51bm9ic2VydmUoZWxlbWVudCksIGVsZW1lbnRzTWFwLmRlbGV0ZShlbGVtZW50KSwgZWxlbWVudFNldC5kZWxldGUoZWxlbWVudCksIGVsZW1lbnRJZE1hcC5kZWxldGUoaWQpLCBoYW5kbGVyKHtcbiAgICAgICAgdHlwZTogXCJlbGVtZW50L3VucmVnaXN0ZXJcIixcbiAgICAgICAgaWRcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBoYW5kbGVNdXRhdGlvbihtdXRhdGlvbnMpIHtcbiAgICBsZXQgbXV0YXRpb25XYXNJblNjb3BlID0gITE7XG4gICAgZm9yIChjb25zdCBtdXRhdGlvbiBvZiBtdXRhdGlvbnMpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgdGFyZ2V0LFxuICAgICAgICB0eXBlXG4gICAgICB9ID0gbXV0YXRpb24sIG5vZGUgPSB0eXBlID09PSBcImNoYXJhY3RlckRhdGFcIiA/IHRhcmdldC5wYXJlbnRFbGVtZW50IDogdGFyZ2V0O1xuICAgICAgbm9kZSA9PT0gb3ZlcmxheUVsZW1lbnQgfHwgb3ZlcmxheUVsZW1lbnQuY29udGFpbnMobm9kZSkgfHwgKG11dGF0aW9uV2FzSW5TY29wZSA9ICEwLCBpc0VsZW1lbnROb2RlJDEobm9kZSkgJiYgcGFyc2VFbGVtZW50cyh7XG4gICAgICAgIGNoaWxkTm9kZXM6IFtub2RlXVxuICAgICAgfSkpO1xuICAgIH1cbiAgICBpZiAobXV0YXRpb25XYXNJblNjb3BlKVxuICAgICAgZm9yIChjb25zdCBlbGVtZW50IG9mIGVsZW1lbnRTZXQpXG4gICAgICAgIGVsZW1lbnQuaXNDb25uZWN0ZWQgfHwgdW5yZWdpc3RlckVsZW1lbnQoZWxlbWVudCk7XG4gIH1cbiAgZnVuY3Rpb24gdXBkYXRlUmVjdChlbCkge1xuICAgIGNvbnN0IG92ZXJsYXlFbGVtZW50MiA9IGVsZW1lbnRzTWFwLmdldChlbCk7XG4gICAgb3ZlcmxheUVsZW1lbnQyICYmIGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJlbGVtZW50L3VwZGF0ZVJlY3RcIixcbiAgICAgIGlkOiBvdmVybGF5RWxlbWVudDIuaWQsXG4gICAgICByZWN0OiBnZXRSZWN0KGVsKVxuICAgIH0pO1xuICB9XG4gIGZ1bmN0aW9uIGhhbmRsZVJlc2l6ZShlbnRyaWVzKSB7XG4gICAgZm9yIChjb25zdCBlbnRyeSBvZiBlbnRyaWVzKSB7XG4gICAgICBjb25zdCB0YXJnZXQgPSBlbnRyeS50YXJnZXQ7XG4gICAgICBpZiAoaXNFbGVtZW50Tm9kZSQxKHRhcmdldCkpIHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IG1lYXN1cmVFbGVtZW50cy5nZXQodGFyZ2V0KTtcbiAgICAgICAgaWYgKCFlbGVtZW50KSByZXR1cm47XG4gICAgICAgIHVwZGF0ZVJlY3QoZWxlbWVudCk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGhhbmRsZUludGVyc2VjdGlvbihlbnRyaWVzKSB7XG4gICAgaWYgKGFjdGl2YXRlZClcbiAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgZW50cmllcykge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgdGFyZ2V0XG4gICAgICAgIH0gPSBlbnRyeSwgbWF0Y2ggPSBpc0VsZW1lbnROb2RlJDEodGFyZ2V0KSAmJiBlbGVtZW50c01hcC5nZXQodGFyZ2V0KTtcbiAgICAgICAgbWF0Y2ggJiYgKGVudHJ5LmlzSW50ZXJzZWN0aW5nID8gYWN0aXZhdGVFbGVtZW50KG1hdGNoKSA6IGRlYWN0aXZhdGVFbGVtZW50KG1hdGNoKSk7XG4gICAgICB9XG4gIH1cbiAgZnVuY3Rpb24gaGFuZGxlQmx1cihldmVudCkge1xuICAgIGNvbnN0IGVsZW1lbnQgPSBmaW5kT3ZlcmxheUVsZW1lbnQoZXZlbnQudGFyZ2V0KTtcbiAgICBpZiAoZWxlbWVudCkge1xuICAgICAgZWxlbWVudC5kYXRhc2V0LnNhbml0eU92ZXJsYXlFbGVtZW50ID09PSBcImNhcHR1cmVcIiAmJiAoZXZlbnQucHJldmVudERlZmF1bHQoKSwgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCkpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBob3ZlclN0YWNrID0gW10sIGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJvdmVybGF5L2JsdXJcIlxuICAgIH0pO1xuICB9XG4gIGZ1bmN0aW9uIGhhbmRsZVdpbmRvd1Jlc2l6ZSgpIHtcbiAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgZWxlbWVudFNldClcbiAgICAgIHVwZGF0ZVJlY3QoZWxlbWVudCk7XG4gIH1cbiAgZnVuY3Rpb24gaGFuZGxlS2V5ZG93bihldmVudCkge1xuICAgIGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIiAmJiAoaG92ZXJTdGFjayA9IFtdLCBoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwib3ZlcmxheS9ibHVyXCJcbiAgICB9KSk7XG4gIH1cbiAgZnVuY3Rpb24gaGFuZGxlV2luZG93U2Nyb2xsKGV2ZW50KSB7XG4gICAgY29uc3Qge1xuICAgICAgdGFyZ2V0XG4gICAgfSA9IGV2ZW50O1xuICAgIGlmICghKHRhcmdldCA9PT0gd2luZG93LmRvY3VtZW50IHx8ICFpc0VsZW1lbnROb2RlJDEodGFyZ2V0KSkpXG4gICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgZWxlbWVudFNldClcbiAgICAgICAgdGFyZ2V0LmNvbnRhaW5zKGVsZW1lbnQpICYmIHVwZGF0ZVJlY3QoZWxlbWVudCk7XG4gIH1cbiAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgYWN0aXZhdGVkIHx8IChpbyA9IG5ldyBJbnRlcnNlY3Rpb25PYnNlcnZlcihoYW5kbGVJbnRlcnNlY3Rpb24sIHtcbiAgICAgIHRocmVzaG9sZDogMC4zXG4gICAgfSksIGVsZW1lbnRTZXQuZm9yRWFjaCgoZWxlbWVudCkgPT4gaW8ub2JzZXJ2ZShlbGVtZW50KSksIGhhbmRsZXIoe1xuICAgICAgdHlwZTogXCJvdmVybGF5L2FjdGl2YXRlXCJcbiAgICB9KSwgYWN0aXZhdGVkID0gITApO1xuICB9XG4gIGZ1bmN0aW9uIGRlYWN0aXZhdGUoKSB7XG4gICAgYWN0aXZhdGVkICYmIChpbz8uZGlzY29ubmVjdCgpLCBlbGVtZW50U2V0LmZvckVhY2goKGVsZW1lbnQpID0+IHtcbiAgICAgIGNvbnN0IG92ZXJsYXlFbGVtZW50MiA9IGVsZW1lbnRzTWFwLmdldChlbGVtZW50KTtcbiAgICAgIG92ZXJsYXlFbGVtZW50MiAmJiBkZWFjdGl2YXRlRWxlbWVudChvdmVybGF5RWxlbWVudDIpO1xuICAgIH0pLCBoYW5kbGVyKHtcbiAgICAgIHR5cGU6IFwib3ZlcmxheS9kZWFjdGl2YXRlXCJcbiAgICB9KSwgYWN0aXZhdGVkID0gITEpO1xuICB9XG4gIGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVCbHVyKSwgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBoYW5kbGVCbHVyKSwgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUtleWRvd24pLCB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCBoYW5kbGVXaW5kb3dSZXNpemUpLCB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBoYW5kbGVXaW5kb3dTY3JvbGwpLCBtby5kaXNjb25uZWN0KCksIHJvLmRpc2Nvbm5lY3QoKSwgZWxlbWVudFNldC5mb3JFYWNoKChlbGVtZW50KSA9PiB7XG4gICAgICB1bnJlZ2lzdGVyRWxlbWVudChlbGVtZW50KTtcbiAgICB9KSwgZWxlbWVudElkTWFwLmNsZWFyKCksIGVsZW1lbnRTZXQuY2xlYXIoKSwgaG92ZXJTdGFjayA9IFtdLCBkZWFjdGl2YXRlKCk7XG4gIH1cbiAgZnVuY3Rpb24gY3JlYXRlKCkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQmx1ciksIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiY29udGV4dG1lbnVcIiwgaGFuZGxlQmx1ciksIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVLZXlkb3duKSwgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgaGFuZGxlV2luZG93UmVzaXplKSwgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgaGFuZGxlV2luZG93U2Nyb2xsLCB7XG4gICAgICBjYXB0dXJlOiAhMCxcbiAgICAgIHBhc3NpdmU6ICEwXG4gICAgfSksIHJvID0gbmV3IFJlc2l6ZU9ic2VydmVyKGhhbmRsZVJlc2l6ZSksIG1vID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoaGFuZGxlTXV0YXRpb24pLCBtby5vYnNlcnZlKGRvY3VtZW50LmJvZHksIHtcbiAgICAgIGF0dHJpYnV0ZXM6ICEwLFxuICAgICAgY2hhcmFjdGVyRGF0YTogITAsXG4gICAgICBjaGlsZExpc3Q6ICEwLFxuICAgICAgc3VidHJlZTogITBcbiAgICB9KSwgcGFyc2VFbGVtZW50cyhkb2N1bWVudC5ib2R5KSwgYWN0aXZhdGUoKTtcbiAgfVxuICByZXR1cm4gd2luZG93LmRvY3VtZW50LmZvbnRzLnJlYWR5LnRoZW4oKCkgPT4ge1xuICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBlbGVtZW50U2V0KVxuICAgICAgdXBkYXRlUmVjdChlbGVtZW50KTtcbiAgfSksIGNyZWF0ZSgpLCB7XG4gICAgYWN0aXZhdGUsXG4gICAgZGVhY3RpdmF0ZSxcbiAgICBkZXN0cm95XG4gIH07XG59XG5jb25zdCBTaGFyZWRTdGF0ZUNvbnRleHQgPSBjcmVhdGVDb250ZXh0KG51bGwpO1xuZXhwb3J0IHtcbiAgU2hhcmVkU3RhdGVDb250ZXh0LFxuICBjcmVhdGVPdmVybGF5Q29udHJvbGxlcixcbiAgc2FuaXR5Tm9kZXNFeGlzdEluU2FtZUFycmF5LFxuICB1c2VPcHRpbWlzdGljXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U2hhcmVkU3RhdGVDb250ZXh0LmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/SharedStateContext.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   actor: () => (/* binding */ actor),\n/* harmony export */   emptyActor: () => (/* binding */ emptyActor),\n/* harmony export */   isEmptyActor: () => (/* binding */ isEmptyActor),\n/* harmony export */   listeners: () => (/* binding */ listeners),\n/* harmony export */   setActor: () => (/* binding */ setActor)\n/* harmony export */ });\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/actors/dist/xstate-actors.development.esm.js\");\n\nconst emptyActor = (0,xstate__WEBPACK_IMPORTED_MODULE_0__.createEmptyActor)();\nlet actor = emptyActor;\nconst listeners = /* @__PURE__ */ new Set();\nfunction isEmptyActor(actor2) {\n  return actor2 === emptyActor;\n}\nfunction setActor(nextActor) {\n  actor = nextActor;\n  for (const onActorChange of listeners)\n    onActorChange();\n}\n\n//# sourceMappingURL=context.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvdmlzdWFsLWVkaXRpbmcvZGlzdC9fY2h1bmtzLWVzL2NvbnRleHQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQTBDO0FBQzFDLG1CQUFtQix3REFBZ0I7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPRTtBQUNGIiwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL25vZGVfbW9kdWxlcy9uZXh0LXNhbml0eS9ub2RlX21vZHVsZXMvQHNhbml0eS92aXN1YWwtZWRpdGluZy9kaXN0L19jaHVua3MtZXMvY29udGV4dC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVFbXB0eUFjdG9yIH0gZnJvbSBcInhzdGF0ZVwiO1xuY29uc3QgZW1wdHlBY3RvciA9IGNyZWF0ZUVtcHR5QWN0b3IoKTtcbmxldCBhY3RvciA9IGVtcHR5QWN0b3I7XG5jb25zdCBsaXN0ZW5lcnMgPSAvKiBAX19QVVJFX18gKi8gbmV3IFNldCgpO1xuZnVuY3Rpb24gaXNFbXB0eUFjdG9yKGFjdG9yMikge1xuICByZXR1cm4gYWN0b3IyID09PSBlbXB0eUFjdG9yO1xufVxuZnVuY3Rpb24gc2V0QWN0b3IobmV4dEFjdG9yKSB7XG4gIGFjdG9yID0gbmV4dEFjdG9yO1xuICBmb3IgKGNvbnN0IG9uQWN0b3JDaGFuZ2Ugb2YgbGlzdGVuZXJzKVxuICAgIG9uQWN0b3JDaGFuZ2UoKTtcbn1cbmV4cG9ydCB7XG4gIGFjdG9yLFxuICBlbXB0eUFjdG9yLFxuICBpc0VtcHR5QWN0b3IsXG4gIGxpc3RlbmVycyxcbiAgc2V0QWN0b3Jcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb250ZXh0LmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/mutations.js":
/*!***************************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/mutations.js ***!
  \***************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   get: () => (/* binding */ get),\n/* harmony export */   getArrayDuplicatePatches: () => (/* binding */ getArrayDuplicatePatches),\n/* harmony export */   getArrayInsertPatches: () => (/* binding */ getArrayInsertPatches),\n/* harmony export */   getArrayItemKeyAndParentPath: () => (/* binding */ getArrayItemKeyAndParentPath),\n/* harmony export */   getArrayMovePatches: () => (/* binding */ getArrayMovePatches),\n/* harmony export */   getArrayRemovePatches: () => (/* binding */ getArrayRemovePatches),\n/* harmony export */   useDocuments: () => (/* binding */ useDocuments),\n/* harmony export */   useOptimisticActor: () => (/* binding */ useOptimisticActor),\n/* harmony export */   useOptimisticActorReady: () => (/* binding */ useOptimisticActorReady)\n/* harmony export */ });\n/* harmony import */ var react_compiler_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react-compiler-runtime */ \"(ssr)/./node_modules/react-compiler-runtime/dist/index.js\");\n/* harmony import */ var _sanity_client_csm__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @sanity/client/csm */ \"(ssr)/./node_modules/@sanity/client/dist/_chunks-es/resolveEditInfo.js\");\n/* harmony import */ var _sanity_mutate__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sanity/mutate */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/index.js\");\n/* harmony import */ var _sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sanity/presentation-comlink */ \"(ssr)/./node_modules/@sanity/presentation-comlink/dist/index.js\");\n/* harmony import */ var _context_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./context.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var get_random_values_esm__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! get-random-values-esm */ \"(ssr)/./node_modules/get-random-values-esm/index.mjs\");\n\n\n\n\n\n\n\nconst reKeySegment$1 = /_key\\s*==\\s*['\"](.*)['\"]/, reIndexTuple = /^\\d*:\\d*$/;\nfunction isIndexSegment(segment) {\n  return typeof segment == \"number\" || typeof segment == \"string\" && /^\\[\\d+\\]$/.test(segment);\n}\nfunction isKeySegment(segment) {\n  return typeof segment == \"string\" ? reKeySegment$1.test(segment.trim()) : typeof segment == \"object\" && \"_key\" in segment;\n}\nfunction isIndexTuple(segment) {\n  if (typeof segment == \"string\" && reIndexTuple.test(segment))\n    return !0;\n  if (!Array.isArray(segment) || segment.length !== 2)\n    return !1;\n  const [from, to] = segment;\n  return (typeof from == \"number\" || from === \"\") && (typeof to == \"number\" || to === \"\");\n}\nconst rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g, reKeySegment = /_key\\s*==\\s*['\"](.*)['\"]/;\nfunction get(obj, path, defaultVal) {\n  const select = typeof path == \"string\" ? fromString(path) : path;\n  if (!Array.isArray(select))\n    throw new Error(\"Path must be an array or a string\");\n  let acc = obj;\n  for (let i = 0; i < select.length; i++) {\n    const segment = select[i];\n    if (isIndexSegment(segment)) {\n      if (!Array.isArray(acc))\n        return defaultVal;\n      acc = acc[segment];\n    }\n    if (isKeySegment(segment)) {\n      if (!Array.isArray(acc))\n        return defaultVal;\n      acc = acc.find((item) => item._key === segment._key);\n    }\n    if (typeof segment == \"string\" && (acc = typeof acc == \"object\" && acc !== null ? acc[segment] : void 0), typeof acc > \"u\")\n      return defaultVal;\n  }\n  return acc;\n}\nfunction fromString(path) {\n  if (typeof path != \"string\")\n    throw new Error(\"Path is not a string\");\n  const segments = path.match(rePropName);\n  if (!segments)\n    throw new Error(\"Invalid path string\");\n  return segments.map(normalizePathSegment);\n}\nfunction normalizePathSegment(segment) {\n  return isIndexSegment(segment) ? normalizeIndexSegment(segment) : isKeySegment(segment) ? normalizeKeySegment(segment) : isIndexTuple(segment) ? normalizeIndexTupleSegment(segment) : segment;\n}\nfunction normalizeIndexSegment(segment) {\n  return Number(segment.replace(/[^\\d]/g, \"\"));\n}\nfunction normalizeKeySegment(segment) {\n  return { _key: segment.match(reKeySegment)[1] };\n}\nfunction normalizeIndexTupleSegment(segment) {\n  const [from, to] = segment.split(\":\").map((seg) => seg === \"\" ? seg : Number(seg));\n  return [from, to];\n}\nfunction useOptimisticActor() {\n  return (0,react__WEBPACK_IMPORTED_MODULE_1__.useSyncExternalStore)(_temp, _temp2, _temp3);\n}\nfunction _temp3() {\n  return _context_js__WEBPACK_IMPORTED_MODULE_2__.emptyActor;\n}\nfunction _temp2() {\n  return _context_js__WEBPACK_IMPORTED_MODULE_2__.actor;\n}\nfunction _temp(listener) {\n  return _context_js__WEBPACK_IMPORTED_MODULE_2__.listeners.add(listener), () => _context_js__WEBPACK_IMPORTED_MODULE_2__.listeners.delete(listener);\n}\nfunction useOptimisticActorReady() {\n  const actor2 = useOptimisticActor();\n  let t0;\n  return t0 = !(0,_context_js__WEBPACK_IMPORTED_MODULE_2__.isEmptyActor)(actor2), t0;\n}\nfunction debounce(fn, timeout) {\n  let timer;\n  return (...args) => {\n    clearTimeout(timer), timer = setTimeout(() => {\n      fn.apply(fn, args);\n    }, timeout);\n  };\n}\nfunction getDocumentsAndSnapshot(id, actor2) {\n  const inFrame = (0,_sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_3__.isMaybePreviewIframe)(), inPopUp = (0,_sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_3__.isMaybePreviewWindow)();\n  if ((0,_context_js__WEBPACK_IMPORTED_MODULE_2__.isEmptyActor)(actor2) || !inFrame && !inPopUp)\n    throw new Error(\"The `useDocuments` hook cannot be used in this context\");\n  const draftId = (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_4__.getDraftId)(id), publishedId = (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_4__.getPublishedId)(id), documents = actor2.getSnapshot().context?.documents, draftDoc = documents?.[draftId], publishedDoc = documents?.[publishedId], doc = draftDoc || publishedDoc;\n  if (!doc)\n    throw new Error(`Document \"${id}\" not found`);\n  const snapshot = draftDoc.getSnapshot().context?.local || publishedDoc.getSnapshot().context?.local, snapshotPromise = new Promise((resolve) => {\n    if (snapshot)\n      resolve(snapshot);\n    else {\n      const subscriber = doc.on(\"ready\", (event) => {\n        const {\n          snapshot: snapshot2\n        } = event;\n        resolve(snapshot2 || null), subscriber.unsubscribe();\n      });\n    }\n  });\n  return {\n    draftDoc,\n    draftId,\n    getSnapshot: () => snapshotPromise,\n    publishedDoc,\n    publishedId,\n    /**\n     * @deprecated - use `getSnapshot` instead\n     */\n    get snapshot() {\n      if (!snapshot)\n        throw new Error(`Snapshot for document \"${id}\" not found`);\n      return snapshot;\n    }\n  };\n}\nfunction createDocumentCommit(id, actor2) {\n  return () => {\n    const {\n      draftDoc\n    } = getDocumentsAndSnapshot(id, actor2);\n    draftDoc.send({\n      type: \"submit\"\n    });\n  };\n}\nfunction createDocumentGet(id, actor2) {\n  return (path) => {\n    const {\n      snapshot\n    } = getDocumentsAndSnapshot(id, actor2);\n    return path ? get(snapshot, path) : snapshot;\n  };\n}\nfunction createDocumentGetSnapshot(id, actor2) {\n  const {\n    getSnapshot\n  } = getDocumentsAndSnapshot(id, actor2);\n  return getSnapshot;\n}\nfunction createDocumentPatch(id, actor2) {\n  return async (patches, options) => {\n    const result = getDocumentsAndSnapshot(id, actor2), {\n      draftDoc,\n      draftId,\n      getSnapshot,\n      publishedId\n    } = result, {\n      commit = !0\n    } = options || {}, resolvedPatches = await (typeof patches == \"function\" ? patches({\n      draftId,\n      publishedId,\n      /**\n       * @deprecated - use `getSnapshot` instead\n       */\n      get snapshot() {\n        return result.snapshot;\n      },\n      getSnapshot\n    }) : patches), _snapshot = await getSnapshot();\n    if (!_snapshot)\n      throw new Error(`Snapshot for document \"${id}\" not found`);\n    draftDoc.send({\n      type: \"mutate\",\n      mutations: [\n        // Attempt to create the draft document, it might not exist if the\n        // snapshot was from the published document\n        (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.createIfNotExists)({\n          ..._snapshot,\n          _id: draftId\n        }),\n        // Patch the draft document with the resolved patches\n        (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.patch)(draftId, resolvedPatches)\n      ]\n    }), commit && (typeof commit == \"object\" && \"debounce\" in commit ? debounce(() => draftDoc.send({\n      type: \"submit\"\n    }), commit.debounce)() : draftDoc.send({\n      type: \"submit\"\n    }));\n  };\n}\nfunction useDocuments() {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_0__.c)(7), actor2 = useOptimisticActor();\n  let t0;\n  $[0] !== actor2 ? (t0 = (documentId) => ({\n    id: documentId,\n    commit: createDocumentCommit(documentId, actor2),\n    get: createDocumentGet(documentId, actor2),\n    getSnapshot: createDocumentGetSnapshot(documentId, actor2),\n    patch: createDocumentPatch(documentId, actor2)\n  }), $[0] = actor2, $[1] = t0) : t0 = $[1];\n  const getDocument = t0;\n  let t1;\n  $[2] !== actor2 ? (t1 = (id, mutations, options) => {\n    const {\n      draftDoc\n    } = getDocumentsAndSnapshot(id, actor2), {\n      commit: t22\n    } = options || {}, commit = t22 === void 0 ? !0 : t22;\n    draftDoc.send({\n      type: \"mutate\",\n      mutations\n    }), commit && (typeof commit == \"object\" && \"debounce\" in commit ? debounce(() => draftDoc.send({\n      type: \"submit\"\n    }), commit.debounce)() : draftDoc.send({\n      type: \"submit\"\n    }));\n  }, $[2] = actor2, $[3] = t1) : t1 = $[3];\n  const mutateDocument = t1;\n  let t2;\n  return $[4] !== getDocument || $[5] !== mutateDocument ? (t2 = {\n    getDocument,\n    mutateDocument\n  }, $[4] = getDocument, $[5] = mutateDocument, $[6] = t2) : t2 = $[6], t2;\n}\nfunction whatwgRNG(length = 16) {\n  const rnds8 = new Uint8Array(length);\n  return (0,get_random_values_esm__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(rnds8), rnds8;\n}\nconst getByteHexTable = /* @__PURE__ */ (() => {\n  let table;\n  return () => {\n    if (table)\n      return table;\n    table = [];\n    for (let i = 0; i < 256; ++i)\n      table[i] = (i + 256).toString(16).slice(1);\n    return table;\n  };\n})();\nfunction randomKey(length) {\n  const table = getByteHexTable();\n  return whatwgRNG(length).reduce((str, n) => str + table[n], \"\").slice(0, length);\n}\nfunction getArrayItemKeyAndParentPath(pathOrNode) {\n  const elementPath = typeof pathOrNode == \"string\" ? pathOrNode : pathOrNode.path, lastDotIndex = elementPath.lastIndexOf(\".\"), lastPathItem = elementPath.substring(lastDotIndex + 1, elementPath.length);\n  if (!lastPathItem.indexOf(\"[\")) throw new Error(\"Invalid path: not an array\");\n  const lastArrayIndex = elementPath.lastIndexOf(\"[\"), path = elementPath.substring(0, lastArrayIndex);\n  let key, hasExplicitKey;\n  if (lastPathItem.includes(\"_key\")) {\n    const startIndex = lastPathItem.indexOf('\"') + 1, endIndex = lastPathItem.indexOf('\"', startIndex);\n    key = lastPathItem.substring(startIndex, endIndex), hasExplicitKey = !0;\n  } else {\n    const startIndex = lastPathItem.indexOf(\"[\") + 1, endIndex = lastPathItem.indexOf(\"]\", startIndex);\n    key = lastPathItem.substring(startIndex, endIndex), hasExplicitKey = !1;\n  }\n  if (!path || !key) throw new Error(\"Invalid path\");\n  return {\n    path,\n    key,\n    hasExplicitKey\n  };\n}\nfunction getArrayDuplicatePatches(node, snapshot, position = \"after\") {\n  const {\n    path: arrayPath,\n    key: itemKey\n  } = getArrayItemKeyAndParentPath(node), duplicate = {\n    ...get(snapshot, node.path),\n    _key: randomKey()\n  };\n  return [(0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.insert)(duplicate, position, {\n    _key: itemKey\n  }))];\n}\nfunction getArrayRemovePatches(node, snapshot) {\n  const {\n    path: arrayPath,\n    key: itemKey\n  } = getArrayItemKeyAndParentPath(node), currentIndex = get(snapshot, arrayPath).findIndex((item) => item._key === itemKey);\n  return [(0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.truncate)(currentIndex, currentIndex + 1))];\n}\nfunction getArrayInsertPatches(node, insertType, position) {\n  const {\n    path: arrayPath,\n    key: itemKey\n  } = getArrayItemKeyAndParentPath(node), insertKey = randomKey();\n  return [(0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.insert)([{\n    _type: insertType,\n    _key: insertKey\n  }], position, {\n    _key: itemKey\n  }))];\n}\nasync function getArrayMovePatches(node, doc, moveTo) {\n  if (!node.type) throw new Error(\"Node type is missing\");\n  const {\n    path: arrayPath,\n    key: itemKey\n  } = getArrayItemKeyAndParentPath(node), snapshot = await doc.getSnapshot(), array = get(snapshot, arrayPath), item = get(snapshot, node.path), currentIndex = array.findIndex((item2) => item2._key === itemKey);\n  let nextIndex = -1, position = \"before\";\n  if (moveTo === \"first\") {\n    if (currentIndex === 0) return [];\n    nextIndex = 0, position = \"before\";\n  } else if (moveTo === \"last\") {\n    if (currentIndex === array.length - 1) return [];\n    nextIndex = -1, position = \"after\";\n  } else if (moveTo === \"next\") {\n    if (currentIndex === array.length - 1) return [];\n    nextIndex = currentIndex, position = \"after\";\n  } else if (moveTo === \"previous\") {\n    if (currentIndex === 0) return [];\n    nextIndex = currentIndex - 1, position = \"before\";\n  }\n  return [(0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.truncate)(currentIndex, currentIndex + 1)), (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.insert)(item, position, nextIndex))];\n}\n\n//# sourceMappingURL=mutations.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvdmlzdWFsLWVkaXRpbmcvZGlzdC9fY2h1bmtzLWVzL211dGF0aW9ucy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQTJDO0FBQ3FCO0FBQ2dCO0FBQ1U7QUFDaEI7QUFDN0I7QUFDTztBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsbUJBQW1CO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsMkRBQW9CO0FBQzdCO0FBQ0E7QUFDQSxTQUFTLG1EQUFVO0FBQ25CO0FBQ0E7QUFDQSxTQUFTLDhDQUFLO0FBQ2Q7QUFDQTtBQUNBLFNBQVMsa0RBQVMsc0JBQXNCLGtEQUFTO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSx5REFBWTtBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLGtGQUFvQixjQUFjLGtGQUFvQjtBQUN4RSxNQUFNLHlEQUFZO0FBQ2xCO0FBQ0Esa0JBQWtCLDhEQUFVLG9CQUFvQixrRUFBYztBQUM5RDtBQUNBLGlDQUFpQyxHQUFHO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0EsT0FBTztBQUNQO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrREFBa0QsR0FBRztBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNLGVBQWU7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQSxnREFBZ0QsR0FBRztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUI7QUFDekI7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFFBQVEscURBQUs7QUFDYjtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxZQUFZLHlEQUFDO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU0sZUFBZTtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsU0FBUyxpRUFBZTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixTQUFTO0FBQzdCO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxVQUFVLGtEQUFFLFlBQVksc0RBQU07QUFDOUI7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixVQUFVLGtEQUFFLFlBQVksd0RBQVE7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixVQUFVLGtEQUFFLFlBQVksc0RBQU07QUFDOUI7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLFVBQVUsa0RBQUUsWUFBWSx3REFBUSxtQ0FBbUMsa0RBQUUsWUFBWSxzREFBTTtBQUN2RjtBQVdFO0FBQ0YiLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3Jrc3BhY2Uvbm9kZV9tb2R1bGVzL25leHQtc2FuaXR5L25vZGVfbW9kdWxlcy9Ac2FuaXR5L3Zpc3VhbC1lZGl0aW5nL2Rpc3QvX2NodW5rcy1lcy9tdXRhdGlvbnMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYyB9IGZyb20gXCJyZWFjdC1jb21waWxlci1ydW50aW1lXCI7XG5pbXBvcnQgeyBnZXREcmFmdElkLCBnZXRQdWJsaXNoZWRJZCB9IGZyb20gXCJAc2FuaXR5L2NsaWVudC9jc21cIjtcbmltcG9ydCB7IGNyZWF0ZUlmTm90RXhpc3RzLCBwYXRjaCwgYXQsIGluc2VydCwgdHJ1bmNhdGUgfSBmcm9tIFwiQHNhbml0eS9tdXRhdGVcIjtcbmltcG9ydCB7IGlzTWF5YmVQcmV2aWV3SWZyYW1lLCBpc01heWJlUHJldmlld1dpbmRvdyB9IGZyb20gXCJAc2FuaXR5L3ByZXNlbnRhdGlvbi1jb21saW5rXCI7XG5pbXBvcnQgeyBpc0VtcHR5QWN0b3IsIGxpc3RlbmVycywgYWN0b3IsIGVtcHR5QWN0b3IgfSBmcm9tIFwiLi9jb250ZXh0LmpzXCI7XG5pbXBvcnQgeyB1c2VTeW5jRXh0ZXJuYWxTdG9yZSB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IGdldFJhbmRvbVZhbHVlcyBmcm9tIFwiZ2V0LXJhbmRvbS12YWx1ZXMtZXNtXCI7XG5jb25zdCByZUtleVNlZ21lbnQkMSA9IC9fa2V5XFxzKj09XFxzKlsnXCJdKC4qKVsnXCJdLywgcmVJbmRleFR1cGxlID0gL15cXGQqOlxcZCokLztcbmZ1bmN0aW9uIGlzSW5kZXhTZWdtZW50KHNlZ21lbnQpIHtcbiAgcmV0dXJuIHR5cGVvZiBzZWdtZW50ID09IFwibnVtYmVyXCIgfHwgdHlwZW9mIHNlZ21lbnQgPT0gXCJzdHJpbmdcIiAmJiAvXlxcW1xcZCtcXF0kLy50ZXN0KHNlZ21lbnQpO1xufVxuZnVuY3Rpb24gaXNLZXlTZWdtZW50KHNlZ21lbnQpIHtcbiAgcmV0dXJuIHR5cGVvZiBzZWdtZW50ID09IFwic3RyaW5nXCIgPyByZUtleVNlZ21lbnQkMS50ZXN0KHNlZ21lbnQudHJpbSgpKSA6IHR5cGVvZiBzZWdtZW50ID09IFwib2JqZWN0XCIgJiYgXCJfa2V5XCIgaW4gc2VnbWVudDtcbn1cbmZ1bmN0aW9uIGlzSW5kZXhUdXBsZShzZWdtZW50KSB7XG4gIGlmICh0eXBlb2Ygc2VnbWVudCA9PSBcInN0cmluZ1wiICYmIHJlSW5kZXhUdXBsZS50ZXN0KHNlZ21lbnQpKVxuICAgIHJldHVybiAhMDtcbiAgaWYgKCFBcnJheS5pc0FycmF5KHNlZ21lbnQpIHx8IHNlZ21lbnQubGVuZ3RoICE9PSAyKVxuICAgIHJldHVybiAhMTtcbiAgY29uc3QgW2Zyb20sIHRvXSA9IHNlZ21lbnQ7XG4gIHJldHVybiAodHlwZW9mIGZyb20gPT0gXCJudW1iZXJcIiB8fCBmcm9tID09PSBcIlwiKSAmJiAodHlwZW9mIHRvID09IFwibnVtYmVyXCIgfHwgdG8gPT09IFwiXCIpO1xufVxuY29uc3QgcmVQcm9wTmFtZSA9IC9bXi5bXFxdXSt8XFxbKD86KC0/XFxkKyg/OlxcLlxcZCspPyl8KFtcIiddKSgoPzooPyFcXDIpW15cXFxcXXxcXFxcLikqPylcXDIpXFxdfCg/PSg/OlxcLnxcXFtcXF0pKD86XFwufFxcW1xcXXwkKSkvZywgcmVLZXlTZWdtZW50ID0gL19rZXlcXHMqPT1cXHMqWydcIl0oLiopWydcIl0vO1xuZnVuY3Rpb24gZ2V0KG9iaiwgcGF0aCwgZGVmYXVsdFZhbCkge1xuICBjb25zdCBzZWxlY3QgPSB0eXBlb2YgcGF0aCA9PSBcInN0cmluZ1wiID8gZnJvbVN0cmluZyhwYXRoKSA6IHBhdGg7XG4gIGlmICghQXJyYXkuaXNBcnJheShzZWxlY3QpKVxuICAgIHRocm93IG5ldyBFcnJvcihcIlBhdGggbXVzdCBiZSBhbiBhcnJheSBvciBhIHN0cmluZ1wiKTtcbiAgbGV0IGFjYyA9IG9iajtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3QubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBzZWdtZW50ID0gc2VsZWN0W2ldO1xuICAgIGlmIChpc0luZGV4U2VnbWVudChzZWdtZW50KSkge1xuICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGFjYykpXG4gICAgICAgIHJldHVybiBkZWZhdWx0VmFsO1xuICAgICAgYWNjID0gYWNjW3NlZ21lbnRdO1xuICAgIH1cbiAgICBpZiAoaXNLZXlTZWdtZW50KHNlZ21lbnQpKSB7XG4gICAgICBpZiAoIUFycmF5LmlzQXJyYXkoYWNjKSlcbiAgICAgICAgcmV0dXJuIGRlZmF1bHRWYWw7XG4gICAgICBhY2MgPSBhY2MuZmluZCgoaXRlbSkgPT4gaXRlbS5fa2V5ID09PSBzZWdtZW50Ll9rZXkpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHNlZ21lbnQgPT0gXCJzdHJpbmdcIiAmJiAoYWNjID0gdHlwZW9mIGFjYyA9PSBcIm9iamVjdFwiICYmIGFjYyAhPT0gbnVsbCA/IGFjY1tzZWdtZW50XSA6IHZvaWQgMCksIHR5cGVvZiBhY2MgPiBcInVcIilcbiAgICAgIHJldHVybiBkZWZhdWx0VmFsO1xuICB9XG4gIHJldHVybiBhY2M7XG59XG5mdW5jdGlvbiBmcm9tU3RyaW5nKHBhdGgpIHtcbiAgaWYgKHR5cGVvZiBwYXRoICE9IFwic3RyaW5nXCIpXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiUGF0aCBpcyBub3QgYSBzdHJpbmdcIik7XG4gIGNvbnN0IHNlZ21lbnRzID0gcGF0aC5tYXRjaChyZVByb3BOYW1lKTtcbiAgaWYgKCFzZWdtZW50cylcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHBhdGggc3RyaW5nXCIpO1xuICByZXR1cm4gc2VnbWVudHMubWFwKG5vcm1hbGl6ZVBhdGhTZWdtZW50KTtcbn1cbmZ1bmN0aW9uIG5vcm1hbGl6ZVBhdGhTZWdtZW50KHNlZ21lbnQpIHtcbiAgcmV0dXJuIGlzSW5kZXhTZWdtZW50KHNlZ21lbnQpID8gbm9ybWFsaXplSW5kZXhTZWdtZW50KHNlZ21lbnQpIDogaXNLZXlTZWdtZW50KHNlZ21lbnQpID8gbm9ybWFsaXplS2V5U2VnbWVudChzZWdtZW50KSA6IGlzSW5kZXhUdXBsZShzZWdtZW50KSA/IG5vcm1hbGl6ZUluZGV4VHVwbGVTZWdtZW50KHNlZ21lbnQpIDogc2VnbWVudDtcbn1cbmZ1bmN0aW9uIG5vcm1hbGl6ZUluZGV4U2VnbWVudChzZWdtZW50KSB7XG4gIHJldHVybiBOdW1iZXIoc2VnbWVudC5yZXBsYWNlKC9bXlxcZF0vZywgXCJcIikpO1xufVxuZnVuY3Rpb24gbm9ybWFsaXplS2V5U2VnbWVudChzZWdtZW50KSB7XG4gIHJldHVybiB7IF9rZXk6IHNlZ21lbnQubWF0Y2gocmVLZXlTZWdtZW50KVsxXSB9O1xufVxuZnVuY3Rpb24gbm9ybWFsaXplSW5kZXhUdXBsZVNlZ21lbnQoc2VnbWVudCkge1xuICBjb25zdCBbZnJvbSwgdG9dID0gc2VnbWVudC5zcGxpdChcIjpcIikubWFwKChzZWcpID0+IHNlZyA9PT0gXCJcIiA/IHNlZyA6IE51bWJlcihzZWcpKTtcbiAgcmV0dXJuIFtmcm9tLCB0b107XG59XG5mdW5jdGlvbiB1c2VPcHRpbWlzdGljQWN0b3IoKSB7XG4gIHJldHVybiB1c2VTeW5jRXh0ZXJuYWxTdG9yZShfdGVtcCwgX3RlbXAyLCBfdGVtcDMpO1xufVxuZnVuY3Rpb24gX3RlbXAzKCkge1xuICByZXR1cm4gZW1wdHlBY3Rvcjtcbn1cbmZ1bmN0aW9uIF90ZW1wMigpIHtcbiAgcmV0dXJuIGFjdG9yO1xufVxuZnVuY3Rpb24gX3RlbXAobGlzdGVuZXIpIHtcbiAgcmV0dXJuIGxpc3RlbmVycy5hZGQobGlzdGVuZXIpLCAoKSA9PiBsaXN0ZW5lcnMuZGVsZXRlKGxpc3RlbmVyKTtcbn1cbmZ1bmN0aW9uIHVzZU9wdGltaXN0aWNBY3RvclJlYWR5KCkge1xuICBjb25zdCBhY3RvcjIgPSB1c2VPcHRpbWlzdGljQWN0b3IoKTtcbiAgbGV0IHQwO1xuICByZXR1cm4gdDAgPSAhaXNFbXB0eUFjdG9yKGFjdG9yMiksIHQwO1xufVxuZnVuY3Rpb24gZGVib3VuY2UoZm4sIHRpbWVvdXQpIHtcbiAgbGV0IHRpbWVyO1xuICByZXR1cm4gKC4uLmFyZ3MpID0+IHtcbiAgICBjbGVhclRpbWVvdXQodGltZXIpLCB0aW1lciA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgZm4uYXBwbHkoZm4sIGFyZ3MpO1xuICAgIH0sIHRpbWVvdXQpO1xuICB9O1xufVxuZnVuY3Rpb24gZ2V0RG9jdW1lbnRzQW5kU25hcHNob3QoaWQsIGFjdG9yMikge1xuICBjb25zdCBpbkZyYW1lID0gaXNNYXliZVByZXZpZXdJZnJhbWUoKSwgaW5Qb3BVcCA9IGlzTWF5YmVQcmV2aWV3V2luZG93KCk7XG4gIGlmIChpc0VtcHR5QWN0b3IoYWN0b3IyKSB8fCAhaW5GcmFtZSAmJiAhaW5Qb3BVcClcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGUgYHVzZURvY3VtZW50c2AgaG9vayBjYW5ub3QgYmUgdXNlZCBpbiB0aGlzIGNvbnRleHRcIik7XG4gIGNvbnN0IGRyYWZ0SWQgPSBnZXREcmFmdElkKGlkKSwgcHVibGlzaGVkSWQgPSBnZXRQdWJsaXNoZWRJZChpZCksIGRvY3VtZW50cyA9IGFjdG9yMi5nZXRTbmFwc2hvdCgpLmNvbnRleHQ/LmRvY3VtZW50cywgZHJhZnREb2MgPSBkb2N1bWVudHM/LltkcmFmdElkXSwgcHVibGlzaGVkRG9jID0gZG9jdW1lbnRzPy5bcHVibGlzaGVkSWRdLCBkb2MgPSBkcmFmdERvYyB8fCBwdWJsaXNoZWREb2M7XG4gIGlmICghZG9jKVxuICAgIHRocm93IG5ldyBFcnJvcihgRG9jdW1lbnQgXCIke2lkfVwiIG5vdCBmb3VuZGApO1xuICBjb25zdCBzbmFwc2hvdCA9IGRyYWZ0RG9jLmdldFNuYXBzaG90KCkuY29udGV4dD8ubG9jYWwgfHwgcHVibGlzaGVkRG9jLmdldFNuYXBzaG90KCkuY29udGV4dD8ubG9jYWwsIHNuYXBzaG90UHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgaWYgKHNuYXBzaG90KVxuICAgICAgcmVzb2x2ZShzbmFwc2hvdCk7XG4gICAgZWxzZSB7XG4gICAgICBjb25zdCBzdWJzY3JpYmVyID0gZG9jLm9uKFwicmVhZHlcIiwgKGV2ZW50KSA9PiB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICBzbmFwc2hvdDogc25hcHNob3QyXG4gICAgICAgIH0gPSBldmVudDtcbiAgICAgICAgcmVzb2x2ZShzbmFwc2hvdDIgfHwgbnVsbCksIHN1YnNjcmliZXIudW5zdWJzY3JpYmUoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiB7XG4gICAgZHJhZnREb2MsXG4gICAgZHJhZnRJZCxcbiAgICBnZXRTbmFwc2hvdDogKCkgPT4gc25hcHNob3RQcm9taXNlLFxuICAgIHB1Ymxpc2hlZERvYyxcbiAgICBwdWJsaXNoZWRJZCxcbiAgICAvKipcbiAgICAgKiBAZGVwcmVjYXRlZCAtIHVzZSBgZ2V0U25hcHNob3RgIGluc3RlYWRcbiAgICAgKi9cbiAgICBnZXQgc25hcHNob3QoKSB7XG4gICAgICBpZiAoIXNuYXBzaG90KVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFNuYXBzaG90IGZvciBkb2N1bWVudCBcIiR7aWR9XCIgbm90IGZvdW5kYCk7XG4gICAgICByZXR1cm4gc25hcHNob3Q7XG4gICAgfVxuICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlRG9jdW1lbnRDb21taXQoaWQsIGFjdG9yMikge1xuICByZXR1cm4gKCkgPT4ge1xuICAgIGNvbnN0IHtcbiAgICAgIGRyYWZ0RG9jXG4gICAgfSA9IGdldERvY3VtZW50c0FuZFNuYXBzaG90KGlkLCBhY3RvcjIpO1xuICAgIGRyYWZ0RG9jLnNlbmQoe1xuICAgICAgdHlwZTogXCJzdWJtaXRcIlxuICAgIH0pO1xuICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlRG9jdW1lbnRHZXQoaWQsIGFjdG9yMikge1xuICByZXR1cm4gKHBhdGgpID0+IHtcbiAgICBjb25zdCB7XG4gICAgICBzbmFwc2hvdFxuICAgIH0gPSBnZXREb2N1bWVudHNBbmRTbmFwc2hvdChpZCwgYWN0b3IyKTtcbiAgICByZXR1cm4gcGF0aCA/IGdldChzbmFwc2hvdCwgcGF0aCkgOiBzbmFwc2hvdDtcbiAgfTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZURvY3VtZW50R2V0U25hcHNob3QoaWQsIGFjdG9yMikge1xuICBjb25zdCB7XG4gICAgZ2V0U25hcHNob3RcbiAgfSA9IGdldERvY3VtZW50c0FuZFNuYXBzaG90KGlkLCBhY3RvcjIpO1xuICByZXR1cm4gZ2V0U25hcHNob3Q7XG59XG5mdW5jdGlvbiBjcmVhdGVEb2N1bWVudFBhdGNoKGlkLCBhY3RvcjIpIHtcbiAgcmV0dXJuIGFzeW5jIChwYXRjaGVzLCBvcHRpb25zKSA9PiB7XG4gICAgY29uc3QgcmVzdWx0ID0gZ2V0RG9jdW1lbnRzQW5kU25hcHNob3QoaWQsIGFjdG9yMiksIHtcbiAgICAgIGRyYWZ0RG9jLFxuICAgICAgZHJhZnRJZCxcbiAgICAgIGdldFNuYXBzaG90LFxuICAgICAgcHVibGlzaGVkSWRcbiAgICB9ID0gcmVzdWx0LCB7XG4gICAgICBjb21taXQgPSAhMFxuICAgIH0gPSBvcHRpb25zIHx8IHt9LCByZXNvbHZlZFBhdGNoZXMgPSBhd2FpdCAodHlwZW9mIHBhdGNoZXMgPT0gXCJmdW5jdGlvblwiID8gcGF0Y2hlcyh7XG4gICAgICBkcmFmdElkLFxuICAgICAgcHVibGlzaGVkSWQsXG4gICAgICAvKipcbiAgICAgICAqIEBkZXByZWNhdGVkIC0gdXNlIGBnZXRTbmFwc2hvdGAgaW5zdGVhZFxuICAgICAgICovXG4gICAgICBnZXQgc25hcHNob3QoKSB7XG4gICAgICAgIHJldHVybiByZXN1bHQuc25hcHNob3Q7XG4gICAgICB9LFxuICAgICAgZ2V0U25hcHNob3RcbiAgICB9KSA6IHBhdGNoZXMpLCBfc25hcHNob3QgPSBhd2FpdCBnZXRTbmFwc2hvdCgpO1xuICAgIGlmICghX3NuYXBzaG90KVxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBTbmFwc2hvdCBmb3IgZG9jdW1lbnQgXCIke2lkfVwiIG5vdCBmb3VuZGApO1xuICAgIGRyYWZ0RG9jLnNlbmQoe1xuICAgICAgdHlwZTogXCJtdXRhdGVcIixcbiAgICAgIG11dGF0aW9uczogW1xuICAgICAgICAvLyBBdHRlbXB0IHRvIGNyZWF0ZSB0aGUgZHJhZnQgZG9jdW1lbnQsIGl0IG1pZ2h0IG5vdCBleGlzdCBpZiB0aGVcbiAgICAgICAgLy8gc25hcHNob3Qgd2FzIGZyb20gdGhlIHB1Ymxpc2hlZCBkb2N1bWVudFxuICAgICAgICBjcmVhdGVJZk5vdEV4aXN0cyh7XG4gICAgICAgICAgLi4uX3NuYXBzaG90LFxuICAgICAgICAgIF9pZDogZHJhZnRJZFxuICAgICAgICB9KSxcbiAgICAgICAgLy8gUGF0Y2ggdGhlIGRyYWZ0IGRvY3VtZW50IHdpdGggdGhlIHJlc29sdmVkIHBhdGNoZXNcbiAgICAgICAgcGF0Y2goZHJhZnRJZCwgcmVzb2x2ZWRQYXRjaGVzKVxuICAgICAgXVxuICAgIH0pLCBjb21taXQgJiYgKHR5cGVvZiBjb21taXQgPT0gXCJvYmplY3RcIiAmJiBcImRlYm91bmNlXCIgaW4gY29tbWl0ID8gZGVib3VuY2UoKCkgPT4gZHJhZnREb2Muc2VuZCh7XG4gICAgICB0eXBlOiBcInN1Ym1pdFwiXG4gICAgfSksIGNvbW1pdC5kZWJvdW5jZSkoKSA6IGRyYWZ0RG9jLnNlbmQoe1xuICAgICAgdHlwZTogXCJzdWJtaXRcIlxuICAgIH0pKTtcbiAgfTtcbn1cbmZ1bmN0aW9uIHVzZURvY3VtZW50cygpIHtcbiAgY29uc3QgJCA9IGMoNyksIGFjdG9yMiA9IHVzZU9wdGltaXN0aWNBY3RvcigpO1xuICBsZXQgdDA7XG4gICRbMF0gIT09IGFjdG9yMiA/ICh0MCA9IChkb2N1bWVudElkKSA9PiAoe1xuICAgIGlkOiBkb2N1bWVudElkLFxuICAgIGNvbW1pdDogY3JlYXRlRG9jdW1lbnRDb21taXQoZG9jdW1lbnRJZCwgYWN0b3IyKSxcbiAgICBnZXQ6IGNyZWF0ZURvY3VtZW50R2V0KGRvY3VtZW50SWQsIGFjdG9yMiksXG4gICAgZ2V0U25hcHNob3Q6IGNyZWF0ZURvY3VtZW50R2V0U25hcHNob3QoZG9jdW1lbnRJZCwgYWN0b3IyKSxcbiAgICBwYXRjaDogY3JlYXRlRG9jdW1lbnRQYXRjaChkb2N1bWVudElkLCBhY3RvcjIpXG4gIH0pLCAkWzBdID0gYWN0b3IyLCAkWzFdID0gdDApIDogdDAgPSAkWzFdO1xuICBjb25zdCBnZXREb2N1bWVudCA9IHQwO1xuICBsZXQgdDE7XG4gICRbMl0gIT09IGFjdG9yMiA/ICh0MSA9IChpZCwgbXV0YXRpb25zLCBvcHRpb25zKSA9PiB7XG4gICAgY29uc3Qge1xuICAgICAgZHJhZnREb2NcbiAgICB9ID0gZ2V0RG9jdW1lbnRzQW5kU25hcHNob3QoaWQsIGFjdG9yMiksIHtcbiAgICAgIGNvbW1pdDogdDIyXG4gICAgfSA9IG9wdGlvbnMgfHwge30sIGNvbW1pdCA9IHQyMiA9PT0gdm9pZCAwID8gITAgOiB0MjI7XG4gICAgZHJhZnREb2Muc2VuZCh7XG4gICAgICB0eXBlOiBcIm11dGF0ZVwiLFxuICAgICAgbXV0YXRpb25zXG4gICAgfSksIGNvbW1pdCAmJiAodHlwZW9mIGNvbW1pdCA9PSBcIm9iamVjdFwiICYmIFwiZGVib3VuY2VcIiBpbiBjb21taXQgPyBkZWJvdW5jZSgoKSA9PiBkcmFmdERvYy5zZW5kKHtcbiAgICAgIHR5cGU6IFwic3VibWl0XCJcbiAgICB9KSwgY29tbWl0LmRlYm91bmNlKSgpIDogZHJhZnREb2Muc2VuZCh7XG4gICAgICB0eXBlOiBcInN1Ym1pdFwiXG4gICAgfSkpO1xuICB9LCAkWzJdID0gYWN0b3IyLCAkWzNdID0gdDEpIDogdDEgPSAkWzNdO1xuICBjb25zdCBtdXRhdGVEb2N1bWVudCA9IHQxO1xuICBsZXQgdDI7XG4gIHJldHVybiAkWzRdICE9PSBnZXREb2N1bWVudCB8fCAkWzVdICE9PSBtdXRhdGVEb2N1bWVudCA/ICh0MiA9IHtcbiAgICBnZXREb2N1bWVudCxcbiAgICBtdXRhdGVEb2N1bWVudFxuICB9LCAkWzRdID0gZ2V0RG9jdW1lbnQsICRbNV0gPSBtdXRhdGVEb2N1bWVudCwgJFs2XSA9IHQyKSA6IHQyID0gJFs2XSwgdDI7XG59XG5mdW5jdGlvbiB3aGF0d2dSTkcobGVuZ3RoID0gMTYpIHtcbiAgY29uc3Qgcm5kczggPSBuZXcgVWludDhBcnJheShsZW5ndGgpO1xuICByZXR1cm4gZ2V0UmFuZG9tVmFsdWVzKHJuZHM4KSwgcm5kczg7XG59XG5jb25zdCBnZXRCeXRlSGV4VGFibGUgPSAvKiBAX19QVVJFX18gKi8gKCgpID0+IHtcbiAgbGV0IHRhYmxlO1xuICByZXR1cm4gKCkgPT4ge1xuICAgIGlmICh0YWJsZSlcbiAgICAgIHJldHVybiB0YWJsZTtcbiAgICB0YWJsZSA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMjU2OyArK2kpXG4gICAgICB0YWJsZVtpXSA9IChpICsgMjU2KS50b1N0cmluZygxNikuc2xpY2UoMSk7XG4gICAgcmV0dXJuIHRhYmxlO1xuICB9O1xufSkoKTtcbmZ1bmN0aW9uIHJhbmRvbUtleShsZW5ndGgpIHtcbiAgY29uc3QgdGFibGUgPSBnZXRCeXRlSGV4VGFibGUoKTtcbiAgcmV0dXJuIHdoYXR3Z1JORyhsZW5ndGgpLnJlZHVjZSgoc3RyLCBuKSA9PiBzdHIgKyB0YWJsZVtuXSwgXCJcIikuc2xpY2UoMCwgbGVuZ3RoKTtcbn1cbmZ1bmN0aW9uIGdldEFycmF5SXRlbUtleUFuZFBhcmVudFBhdGgocGF0aE9yTm9kZSkge1xuICBjb25zdCBlbGVtZW50UGF0aCA9IHR5cGVvZiBwYXRoT3JOb2RlID09IFwic3RyaW5nXCIgPyBwYXRoT3JOb2RlIDogcGF0aE9yTm9kZS5wYXRoLCBsYXN0RG90SW5kZXggPSBlbGVtZW50UGF0aC5sYXN0SW5kZXhPZihcIi5cIiksIGxhc3RQYXRoSXRlbSA9IGVsZW1lbnRQYXRoLnN1YnN0cmluZyhsYXN0RG90SW5kZXggKyAxLCBlbGVtZW50UGF0aC5sZW5ndGgpO1xuICBpZiAoIWxhc3RQYXRoSXRlbS5pbmRleE9mKFwiW1wiKSkgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBwYXRoOiBub3QgYW4gYXJyYXlcIik7XG4gIGNvbnN0IGxhc3RBcnJheUluZGV4ID0gZWxlbWVudFBhdGgubGFzdEluZGV4T2YoXCJbXCIpLCBwYXRoID0gZWxlbWVudFBhdGguc3Vic3RyaW5nKDAsIGxhc3RBcnJheUluZGV4KTtcbiAgbGV0IGtleSwgaGFzRXhwbGljaXRLZXk7XG4gIGlmIChsYXN0UGF0aEl0ZW0uaW5jbHVkZXMoXCJfa2V5XCIpKSB7XG4gICAgY29uc3Qgc3RhcnRJbmRleCA9IGxhc3RQYXRoSXRlbS5pbmRleE9mKCdcIicpICsgMSwgZW5kSW5kZXggPSBsYXN0UGF0aEl0ZW0uaW5kZXhPZignXCInLCBzdGFydEluZGV4KTtcbiAgICBrZXkgPSBsYXN0UGF0aEl0ZW0uc3Vic3RyaW5nKHN0YXJ0SW5kZXgsIGVuZEluZGV4KSwgaGFzRXhwbGljaXRLZXkgPSAhMDtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBzdGFydEluZGV4ID0gbGFzdFBhdGhJdGVtLmluZGV4T2YoXCJbXCIpICsgMSwgZW5kSW5kZXggPSBsYXN0UGF0aEl0ZW0uaW5kZXhPZihcIl1cIiwgc3RhcnRJbmRleCk7XG4gICAga2V5ID0gbGFzdFBhdGhJdGVtLnN1YnN0cmluZyhzdGFydEluZGV4LCBlbmRJbmRleCksIGhhc0V4cGxpY2l0S2V5ID0gITE7XG4gIH1cbiAgaWYgKCFwYXRoIHx8ICFrZXkpIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcGF0aFwiKTtcbiAgcmV0dXJuIHtcbiAgICBwYXRoLFxuICAgIGtleSxcbiAgICBoYXNFeHBsaWNpdEtleVxuICB9O1xufVxuZnVuY3Rpb24gZ2V0QXJyYXlEdXBsaWNhdGVQYXRjaGVzKG5vZGUsIHNuYXBzaG90LCBwb3NpdGlvbiA9IFwiYWZ0ZXJcIikge1xuICBjb25zdCB7XG4gICAgcGF0aDogYXJyYXlQYXRoLFxuICAgIGtleTogaXRlbUtleVxuICB9ID0gZ2V0QXJyYXlJdGVtS2V5QW5kUGFyZW50UGF0aChub2RlKSwgZHVwbGljYXRlID0ge1xuICAgIC4uLmdldChzbmFwc2hvdCwgbm9kZS5wYXRoKSxcbiAgICBfa2V5OiByYW5kb21LZXkoKVxuICB9O1xuICByZXR1cm4gW2F0KGFycmF5UGF0aCwgaW5zZXJ0KGR1cGxpY2F0ZSwgcG9zaXRpb24sIHtcbiAgICBfa2V5OiBpdGVtS2V5XG4gIH0pKV07XG59XG5mdW5jdGlvbiBnZXRBcnJheVJlbW92ZVBhdGNoZXMobm9kZSwgc25hcHNob3QpIHtcbiAgY29uc3Qge1xuICAgIHBhdGg6IGFycmF5UGF0aCxcbiAgICBrZXk6IGl0ZW1LZXlcbiAgfSA9IGdldEFycmF5SXRlbUtleUFuZFBhcmVudFBhdGgobm9kZSksIGN1cnJlbnRJbmRleCA9IGdldChzbmFwc2hvdCwgYXJyYXlQYXRoKS5maW5kSW5kZXgoKGl0ZW0pID0+IGl0ZW0uX2tleSA9PT0gaXRlbUtleSk7XG4gIHJldHVybiBbYXQoYXJyYXlQYXRoLCB0cnVuY2F0ZShjdXJyZW50SW5kZXgsIGN1cnJlbnRJbmRleCArIDEpKV07XG59XG5mdW5jdGlvbiBnZXRBcnJheUluc2VydFBhdGNoZXMobm9kZSwgaW5zZXJ0VHlwZSwgcG9zaXRpb24pIHtcbiAgY29uc3Qge1xuICAgIHBhdGg6IGFycmF5UGF0aCxcbiAgICBrZXk6IGl0ZW1LZXlcbiAgfSA9IGdldEFycmF5SXRlbUtleUFuZFBhcmVudFBhdGgobm9kZSksIGluc2VydEtleSA9IHJhbmRvbUtleSgpO1xuICByZXR1cm4gW2F0KGFycmF5UGF0aCwgaW5zZXJ0KFt7XG4gICAgX3R5cGU6IGluc2VydFR5cGUsXG4gICAgX2tleTogaW5zZXJ0S2V5XG4gIH1dLCBwb3NpdGlvbiwge1xuICAgIF9rZXk6IGl0ZW1LZXlcbiAgfSkpXTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGdldEFycmF5TW92ZVBhdGNoZXMobm9kZSwgZG9jLCBtb3ZlVG8pIHtcbiAgaWYgKCFub2RlLnR5cGUpIHRocm93IG5ldyBFcnJvcihcIk5vZGUgdHlwZSBpcyBtaXNzaW5nXCIpO1xuICBjb25zdCB7XG4gICAgcGF0aDogYXJyYXlQYXRoLFxuICAgIGtleTogaXRlbUtleVxuICB9ID0gZ2V0QXJyYXlJdGVtS2V5QW5kUGFyZW50UGF0aChub2RlKSwgc25hcHNob3QgPSBhd2FpdCBkb2MuZ2V0U25hcHNob3QoKSwgYXJyYXkgPSBnZXQoc25hcHNob3QsIGFycmF5UGF0aCksIGl0ZW0gPSBnZXQoc25hcHNob3QsIG5vZGUucGF0aCksIGN1cnJlbnRJbmRleCA9IGFycmF5LmZpbmRJbmRleCgoaXRlbTIpID0+IGl0ZW0yLl9rZXkgPT09IGl0ZW1LZXkpO1xuICBsZXQgbmV4dEluZGV4ID0gLTEsIHBvc2l0aW9uID0gXCJiZWZvcmVcIjtcbiAgaWYgKG1vdmVUbyA9PT0gXCJmaXJzdFwiKSB7XG4gICAgaWYgKGN1cnJlbnRJbmRleCA9PT0gMCkgcmV0dXJuIFtdO1xuICAgIG5leHRJbmRleCA9IDAsIHBvc2l0aW9uID0gXCJiZWZvcmVcIjtcbiAgfSBlbHNlIGlmIChtb3ZlVG8gPT09IFwibGFzdFwiKSB7XG4gICAgaWYgKGN1cnJlbnRJbmRleCA9PT0gYXJyYXkubGVuZ3RoIC0gMSkgcmV0dXJuIFtdO1xuICAgIG5leHRJbmRleCA9IC0xLCBwb3NpdGlvbiA9IFwiYWZ0ZXJcIjtcbiAgfSBlbHNlIGlmIChtb3ZlVG8gPT09IFwibmV4dFwiKSB7XG4gICAgaWYgKGN1cnJlbnRJbmRleCA9PT0gYXJyYXkubGVuZ3RoIC0gMSkgcmV0dXJuIFtdO1xuICAgIG5leHRJbmRleCA9IGN1cnJlbnRJbmRleCwgcG9zaXRpb24gPSBcImFmdGVyXCI7XG4gIH0gZWxzZSBpZiAobW92ZVRvID09PSBcInByZXZpb3VzXCIpIHtcbiAgICBpZiAoY3VycmVudEluZGV4ID09PSAwKSByZXR1cm4gW107XG4gICAgbmV4dEluZGV4ID0gY3VycmVudEluZGV4IC0gMSwgcG9zaXRpb24gPSBcImJlZm9yZVwiO1xuICB9XG4gIHJldHVybiBbYXQoYXJyYXlQYXRoLCB0cnVuY2F0ZShjdXJyZW50SW5kZXgsIGN1cnJlbnRJbmRleCArIDEpKSwgYXQoYXJyYXlQYXRoLCBpbnNlcnQoaXRlbSwgcG9zaXRpb24sIG5leHRJbmRleCkpXTtcbn1cbmV4cG9ydCB7XG4gIGdldCxcbiAgZ2V0QXJyYXlEdXBsaWNhdGVQYXRjaGVzLFxuICBnZXRBcnJheUluc2VydFBhdGNoZXMsXG4gIGdldEFycmF5SXRlbUtleUFuZFBhcmVudFBhdGgsXG4gIGdldEFycmF5TW92ZVBhdGNoZXMsXG4gIGdldEFycmF5UmVtb3ZlUGF0Y2hlcyxcbiAgdXNlRG9jdW1lbnRzLFxuICB1c2VPcHRpbWlzdGljQWN0b3IsXG4gIHVzZU9wdGltaXN0aWNBY3RvclJlYWR5XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bXV0YXRpb25zLmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/mutations.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/optimistic/index.js":
/*!***********************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/optimistic/index.js ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   actor: () => (/* reexport safe */ _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_6__.actor),\n/* harmony export */   createDatasetMutator: () => (/* binding */ createDatasetMutator),\n/* harmony export */   createDocumentMutator: () => (/* binding */ createDocumentMutator),\n/* harmony export */   emptyActor: () => (/* reexport safe */ _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_6__.emptyActor),\n/* harmony export */   isEmptyActor: () => (/* reexport safe */ _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_6__.isEmptyActor),\n/* harmony export */   listeners: () => (/* reexport safe */ _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_6__.listeners),\n/* harmony export */   setActor: () => (/* reexport safe */ _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_6__.setActor)\n/* harmony export */ });\n/* harmony import */ var _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../_chunks-es/context.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js\");\n/* harmony import */ var _sanity_mutate_unstable_machine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @sanity/mutate/_unstable_machine */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/_unstable_machine.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/actors/dist/xstate-actors.development.esm.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/dist/log-0acd9069.development.esm.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/dist/xstate.development.esm.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/dist/raise-1db27a82.development.esm.js\");\n/* harmony import */ var _sanity_mutate__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @sanity/mutate */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/index.js\");\n\n\n\n\nconst createDocumentMutator = (comlink) => {\n  const fetchSnapshot = (0,xstate__WEBPACK_IMPORTED_MODULE_0__.fromPromise)(async ({\n    input,\n    signal\n  }) => {\n    const {\n      id\n    } = input, {\n      snapshot\n    } = await comlink.fetch(\"visual-editing/fetch-snapshot\", {\n      documentId: id\n    }, {\n      signal\n    });\n    return snapshot;\n  }), submitMutations = (0,xstate__WEBPACK_IMPORTED_MODULE_0__.fromPromise)(async ({\n    input\n  }) => {\n    const {\n      transactions\n    } = input;\n    for (const transaction of transactions) {\n      const data = _sanity_mutate__WEBPACK_IMPORTED_MODULE_1__.SanityEncoder.encodeTransaction(transaction);\n      return comlink.post(\"visual-editing/mutate\", data);\n    }\n  });\n  return _sanity_mutate_unstable_machine__WEBPACK_IMPORTED_MODULE_2__.documentMutatorMachine.provide({\n    actions: {\n      \"send sync event to parent\": (0,xstate__WEBPACK_IMPORTED_MODULE_3__.b)(({\n        enqueue\n      }) => {\n        enqueue.sendParent(({\n          context\n        }) => ({\n          type: \"sync\",\n          id: context.id,\n          document: context.remote\n        })), enqueue.emit(({\n          context\n        }) => ({\n          type: \"ready\",\n          snapshot: context.local\n        }));\n      })\n    },\n    actors: {\n      \"fetch remote snapshot\": fetchSnapshot,\n      \"submit mutations as transactions\": submitMutations\n    }\n  });\n}, datasetMutatorMachine = (0,xstate__WEBPACK_IMPORTED_MODULE_4__.setup)({\n  types: {},\n  actions: {\n    \"emit sync event\": (0,xstate__WEBPACK_IMPORTED_MODULE_3__.e)(({\n      event\n    }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"sync\"), event)),\n    \"emit mutation event\": (0,xstate__WEBPACK_IMPORTED_MODULE_3__.e)(({\n      event\n    }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"mutation\"), event)),\n    \"emit rebased event\": (0,xstate__WEBPACK_IMPORTED_MODULE_3__.e)(({\n      event\n    }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, [\"rebased.local\", \"rebased.remote\"]), event)),\n    \"emit pristine event\": (0,xstate__WEBPACK_IMPORTED_MODULE_3__.e)(({\n      event\n    }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, [\"pristine\"]), event)),\n    \"add document actor\": (0,xstate__WEBPACK_IMPORTED_MODULE_3__.a)({\n      documents: ({\n        context,\n        event,\n        spawn\n      }) => {\n        (0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"observe\");\n        const id = event.documentId;\n        return context.documents[id] ? context.documents : {\n          ...context.documents,\n          [id]: spawn(\"documentMutatorMachine\", {\n            input: {\n              id,\n              client: context.client,\n              sharedListener: context.sharedListener || (0,_sanity_mutate_unstable_machine__WEBPACK_IMPORTED_MODULE_2__.createSharedListener)(context.client)\n            },\n            id\n          })\n        };\n      }\n    }),\n    \"stop remote snapshot\": (0,xstate__WEBPACK_IMPORTED_MODULE_5__.R)(({\n      context,\n      event\n    }) => ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"unobserve\"), context.documents[event.documentId])),\n    \"remove remote snapshot from context\": (0,xstate__WEBPACK_IMPORTED_MODULE_3__.a)({\n      documents: ({\n        context,\n        event\n      }) => {\n        if ((0,xstate__WEBPACK_IMPORTED_MODULE_4__.assertEvent)(event, \"unobserve\"), !context.documents[event.documentId]) return context.documents;\n        const {\n          [event.documentId]: _,\n          ...documents\n        } = context.documents;\n        return documents;\n      }\n    })\n  },\n  actors: {\n    documentMutatorMachine: _sanity_mutate_unstable_machine__WEBPACK_IMPORTED_MODULE_2__.documentMutatorMachine\n  }\n}).createMachine({\n  /** @xstate-layout N4IgpgJg5mDOIC5QBsD2BjAhsgIhgrgLZgB2ALgMTICWsZpA2gAwC6ioADqrNWdaiXYgAHogC0ADgBMAOgkA2ACyKArBICcTdfKXSANCACeiFQHYZpgMxWV800yYqp6gIyn5AXw8G0WXAWJyCnwSGjpGViEuHj4BIVEEKUt5OSlFU1smFwkFW0sDY0T1GRUXRXkXKVN7HSYJJkUvHwxsPHQiUjIZDgAnWj4SMApCfDJMemY2JBBo3n5BaYSXeVlbKRUsiXdFSxcXfKNERSqZTbr1zVMJNyaQX1aAzpkIah6yQwp0VEJCXkmo7hzOKLRDLFwyFxaSzXKTOKQudSKCQFRDOczqCSWJjwjbHCQqRFebwgEioCBwIT3fztQJkAExebxcQuFEIZaWGRIrF7dSXKTyFSNYlUtodcjdPp0aiDelAhagBLpVmWAmc46mNwSZTyLQuFS3EWPcUvN6FTiA2LykSoq6c6wbCqVUzparKioyRFVfkq1zqNSWIkeIA */\n  id: \"dataset-mutator\",\n  context: ({\n    input\n  }) => ({\n    documents: {},\n    client: input.client,\n    sharedListener: input.sharedListener\n  }),\n  on: {\n    sync: {\n      actions: [\"emit sync event\"]\n    },\n    mutation: {\n      actions: [\"emit mutation event\"]\n    },\n    \"rebased.*\": {\n      actions: [\"emit rebased event\"]\n    },\n    pristine: {\n      actions: [\"emit pristine event\"]\n    },\n    observe: {\n      actions: [\"add document actor\"]\n    },\n    unobserve: {\n      actions: [\"stop remote snapshot\", \"remove remote snapshot from context\"]\n    }\n  },\n  initial: \"pristine\",\n  states: {\n    pristine: {}\n  }\n}), createDatasetMutator = (comlink) => datasetMutatorMachine.provide({\n  actors: {\n    documentMutatorMachine: createDocumentMutator(comlink)\n  }\n});\n\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvdmlzdWFsLWVkaXRpbmcvZGlzdC9vcHRpbWlzdGljL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQWdHO0FBQ0E7QUFDRTtBQUNuRDtBQUMvQztBQUNBLHdCQUF3QixtREFBVztBQUNuQztBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQSxNQUFNO0FBQ047QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHLHFCQUFxQixtREFBVztBQUNuQztBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0EsbUJBQW1CLHlEQUFhO0FBQ2hDO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsU0FBUyxtRkFBc0I7QUFDL0I7QUFDQSxtQ0FBbUMseUNBQWM7QUFDakQ7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVCxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILENBQUMsMEJBQTBCLDZDQUFLO0FBQ2hDLFdBQVc7QUFDWDtBQUNBLHVCQUF1Qix5Q0FBSTtBQUMzQjtBQUNBLEtBQUssTUFBTSxtREFBVztBQUN0QiwyQkFBMkIseUNBQUk7QUFDL0I7QUFDQSxLQUFLLE1BQU0sbURBQVc7QUFDdEIsMEJBQTBCLHlDQUFJO0FBQzlCO0FBQ0EsS0FBSyxNQUFNLG1EQUFXO0FBQ3RCLDJCQUEyQix5Q0FBSTtBQUMvQjtBQUNBLEtBQUssTUFBTSxtREFBVztBQUN0QiwwQkFBMEIseUNBQU07QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsUUFBUSxtREFBVztBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCxxRkFBb0I7QUFDNUUsYUFBYTtBQUNiO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsNEJBQTRCLHlDQUFTO0FBQ3JDO0FBQ0E7QUFDQSxLQUFLLE1BQU0sbURBQVc7QUFDdEIsMkNBQTJDLHlDQUFNO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxZQUFZLG1EQUFXO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQVNDO0FBQ0YiLCJzb3VyY2VzIjpbIi9ob21lL3J1bm5lci93b3Jrc3BhY2Uvbm9kZV9tb2R1bGVzL25leHQtc2FuaXR5L25vZGVfbW9kdWxlcy9Ac2FuaXR5L3Zpc3VhbC1lZGl0aW5nL2Rpc3Qvb3B0aW1pc3RpYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBhY3RvciwgZW1wdHlBY3RvciwgaXNFbXB0eUFjdG9yLCBsaXN0ZW5lcnMsIHNldEFjdG9yIH0gZnJvbSBcIi4uL19jaHVua3MtZXMvY29udGV4dC5qc1wiO1xuaW1wb3J0IHsgZG9jdW1lbnRNdXRhdG9yTWFjaGluZSwgY3JlYXRlU2hhcmVkTGlzdGVuZXIgfSBmcm9tIFwiQHNhbml0eS9tdXRhdGUvX3Vuc3RhYmxlX21hY2hpbmVcIjtcbmltcG9ydCB7IGZyb21Qcm9taXNlLCBlbnF1ZXVlQWN0aW9ucywgc2V0dXAsIGFzc2lnbiwgc3RvcENoaWxkLCBlbWl0LCBhc3NlcnRFdmVudCB9IGZyb20gXCJ4c3RhdGVcIjtcbmltcG9ydCB7IFNhbml0eUVuY29kZXIgfSBmcm9tIFwiQHNhbml0eS9tdXRhdGVcIjtcbmNvbnN0IGNyZWF0ZURvY3VtZW50TXV0YXRvciA9IChjb21saW5rKSA9PiB7XG4gIGNvbnN0IGZldGNoU25hcHNob3QgPSBmcm9tUHJvbWlzZShhc3luYyAoe1xuICAgIGlucHV0LFxuICAgIHNpZ25hbFxuICB9KSA9PiB7XG4gICAgY29uc3Qge1xuICAgICAgaWRcbiAgICB9ID0gaW5wdXQsIHtcbiAgICAgIHNuYXBzaG90XG4gICAgfSA9IGF3YWl0IGNvbWxpbmsuZmV0Y2goXCJ2aXN1YWwtZWRpdGluZy9mZXRjaC1zbmFwc2hvdFwiLCB7XG4gICAgICBkb2N1bWVudElkOiBpZFxuICAgIH0sIHtcbiAgICAgIHNpZ25hbFxuICAgIH0pO1xuICAgIHJldHVybiBzbmFwc2hvdDtcbiAgfSksIHN1Ym1pdE11dGF0aW9ucyA9IGZyb21Qcm9taXNlKGFzeW5jICh7XG4gICAgaW5wdXRcbiAgfSkgPT4ge1xuICAgIGNvbnN0IHtcbiAgICAgIHRyYW5zYWN0aW9uc1xuICAgIH0gPSBpbnB1dDtcbiAgICBmb3IgKGNvbnN0IHRyYW5zYWN0aW9uIG9mIHRyYW5zYWN0aW9ucykge1xuICAgICAgY29uc3QgZGF0YSA9IFNhbml0eUVuY29kZXIuZW5jb2RlVHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pO1xuICAgICAgcmV0dXJuIGNvbWxpbmsucG9zdChcInZpc3VhbC1lZGl0aW5nL211dGF0ZVwiLCBkYXRhKTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gZG9jdW1lbnRNdXRhdG9yTWFjaGluZS5wcm92aWRlKHtcbiAgICBhY3Rpb25zOiB7XG4gICAgICBcInNlbmQgc3luYyBldmVudCB0byBwYXJlbnRcIjogZW5xdWV1ZUFjdGlvbnMoKHtcbiAgICAgICAgZW5xdWV1ZVxuICAgICAgfSkgPT4ge1xuICAgICAgICBlbnF1ZXVlLnNlbmRQYXJlbnQoKHtcbiAgICAgICAgICBjb250ZXh0XG4gICAgICAgIH0pID0+ICh7XG4gICAgICAgICAgdHlwZTogXCJzeW5jXCIsXG4gICAgICAgICAgaWQ6IGNvbnRleHQuaWQsXG4gICAgICAgICAgZG9jdW1lbnQ6IGNvbnRleHQucmVtb3RlXG4gICAgICAgIH0pKSwgZW5xdWV1ZS5lbWl0KCh7XG4gICAgICAgICAgY29udGV4dFxuICAgICAgICB9KSA9PiAoe1xuICAgICAgICAgIHR5cGU6IFwicmVhZHlcIixcbiAgICAgICAgICBzbmFwc2hvdDogY29udGV4dC5sb2NhbFxuICAgICAgICB9KSk7XG4gICAgICB9KVxuICAgIH0sXG4gICAgYWN0b3JzOiB7XG4gICAgICBcImZldGNoIHJlbW90ZSBzbmFwc2hvdFwiOiBmZXRjaFNuYXBzaG90LFxuICAgICAgXCJzdWJtaXQgbXV0YXRpb25zIGFzIHRyYW5zYWN0aW9uc1wiOiBzdWJtaXRNdXRhdGlvbnNcbiAgICB9XG4gIH0pO1xufSwgZGF0YXNldE11dGF0b3JNYWNoaW5lID0gc2V0dXAoe1xuICB0eXBlczoge30sXG4gIGFjdGlvbnM6IHtcbiAgICBcImVtaXQgc3luYyBldmVudFwiOiBlbWl0KCh7XG4gICAgICBldmVudFxuICAgIH0pID0+IChhc3NlcnRFdmVudChldmVudCwgXCJzeW5jXCIpLCBldmVudCkpLFxuICAgIFwiZW1pdCBtdXRhdGlvbiBldmVudFwiOiBlbWl0KCh7XG4gICAgICBldmVudFxuICAgIH0pID0+IChhc3NlcnRFdmVudChldmVudCwgXCJtdXRhdGlvblwiKSwgZXZlbnQpKSxcbiAgICBcImVtaXQgcmViYXNlZCBldmVudFwiOiBlbWl0KCh7XG4gICAgICBldmVudFxuICAgIH0pID0+IChhc3NlcnRFdmVudChldmVudCwgW1wicmViYXNlZC5sb2NhbFwiLCBcInJlYmFzZWQucmVtb3RlXCJdKSwgZXZlbnQpKSxcbiAgICBcImVtaXQgcHJpc3RpbmUgZXZlbnRcIjogZW1pdCgoe1xuICAgICAgZXZlbnRcbiAgICB9KSA9PiAoYXNzZXJ0RXZlbnQoZXZlbnQsIFtcInByaXN0aW5lXCJdKSwgZXZlbnQpKSxcbiAgICBcImFkZCBkb2N1bWVudCBhY3RvclwiOiBhc3NpZ24oe1xuICAgICAgZG9jdW1lbnRzOiAoe1xuICAgICAgICBjb250ZXh0LFxuICAgICAgICBldmVudCxcbiAgICAgICAgc3Bhd25cbiAgICAgIH0pID0+IHtcbiAgICAgICAgYXNzZXJ0RXZlbnQoZXZlbnQsIFwib2JzZXJ2ZVwiKTtcbiAgICAgICAgY29uc3QgaWQgPSBldmVudC5kb2N1bWVudElkO1xuICAgICAgICByZXR1cm4gY29udGV4dC5kb2N1bWVudHNbaWRdID8gY29udGV4dC5kb2N1bWVudHMgOiB7XG4gICAgICAgICAgLi4uY29udGV4dC5kb2N1bWVudHMsXG4gICAgICAgICAgW2lkXTogc3Bhd24oXCJkb2N1bWVudE11dGF0b3JNYWNoaW5lXCIsIHtcbiAgICAgICAgICAgIGlucHV0OiB7XG4gICAgICAgICAgICAgIGlkLFxuICAgICAgICAgICAgICBjbGllbnQ6IGNvbnRleHQuY2xpZW50LFxuICAgICAgICAgICAgICBzaGFyZWRMaXN0ZW5lcjogY29udGV4dC5zaGFyZWRMaXN0ZW5lciB8fCBjcmVhdGVTaGFyZWRMaXN0ZW5lcihjb250ZXh0LmNsaWVudClcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpZFxuICAgICAgICAgIH0pXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfSksXG4gICAgXCJzdG9wIHJlbW90ZSBzbmFwc2hvdFwiOiBzdG9wQ2hpbGQoKHtcbiAgICAgIGNvbnRleHQsXG4gICAgICBldmVudFxuICAgIH0pID0+IChhc3NlcnRFdmVudChldmVudCwgXCJ1bm9ic2VydmVcIiksIGNvbnRleHQuZG9jdW1lbnRzW2V2ZW50LmRvY3VtZW50SWRdKSksXG4gICAgXCJyZW1vdmUgcmVtb3RlIHNuYXBzaG90IGZyb20gY29udGV4dFwiOiBhc3NpZ24oe1xuICAgICAgZG9jdW1lbnRzOiAoe1xuICAgICAgICBjb250ZXh0LFxuICAgICAgICBldmVudFxuICAgICAgfSkgPT4ge1xuICAgICAgICBpZiAoYXNzZXJ0RXZlbnQoZXZlbnQsIFwidW5vYnNlcnZlXCIpLCAhY29udGV4dC5kb2N1bWVudHNbZXZlbnQuZG9jdW1lbnRJZF0pIHJldHVybiBjb250ZXh0LmRvY3VtZW50cztcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgIFtldmVudC5kb2N1bWVudElkXTogXyxcbiAgICAgICAgICAuLi5kb2N1bWVudHNcbiAgICAgICAgfSA9IGNvbnRleHQuZG9jdW1lbnRzO1xuICAgICAgICByZXR1cm4gZG9jdW1lbnRzO1xuICAgICAgfVxuICAgIH0pXG4gIH0sXG4gIGFjdG9yczoge1xuICAgIGRvY3VtZW50TXV0YXRvck1hY2hpbmVcbiAgfVxufSkuY3JlYXRlTWFjaGluZSh7XG4gIC8qKiBAeHN0YXRlLWxheW91dCBONElncGdKZzVtRE9JQzVRQnNEMkJqQWhzZ0loZ3JnTFpnQjJBTGdNVElDV3NacEEyZ0F3QzZpb0FEcXJOV2RhaVhZZ0FIb2dDMEFEZ0JNQU9na0EyQUN5S0FyQklDY1RkZktYU0FOQ0FDZWlGUUhZWnBnTXhXVjgwMHlZcXA2Z0l5bjVBWHc4RzBXWEFXSnlDbndTR2pwR1ZpRXVIajRCSVZFRUtVdDVPU2xGVTFzbUZ3a0ZXMHNEWTBUMUdSVVhSWGtYS1ZON0hTWUpKa1V2SHd4c1BIUWlVaklaRGdBbldqNFNNQXBDZkRKTWVtWTJKQkJvM241QmFZU1hlVmxiS1JVc2lYZEZTeGNYZktORVJTcVpUYnIxelZNSk55YVFYMWFBenBrSWFoNnlRd3AwVkVKQ1hrbW83aHpPS0xSRExGd3lGeGFTelhLVE9LUXVkU0tDUUZSRE9jenFDU1dKandqYkhDUXFSRmVid2dFaW9DQndJVDNmenRRSmtBRXhlYnhjUXVGRUlaYVdHUklyRjdkU1hLVHlGU05ZbFV0b2RjamRQcDBhaURlbEFoYWdCTHBWbVdBbWM0Nm1Od1NaVHlMUXVGUzNFV1BjVXZONkZUaUEyTHlrU29xNmM2d2JDcVZVenBhcktpb3lSRlZma3ExenFOU1dJa2VJQSAqL1xuICBpZDogXCJkYXRhc2V0LW11dGF0b3JcIixcbiAgY29udGV4dDogKHtcbiAgICBpbnB1dFxuICB9KSA9PiAoe1xuICAgIGRvY3VtZW50czoge30sXG4gICAgY2xpZW50OiBpbnB1dC5jbGllbnQsXG4gICAgc2hhcmVkTGlzdGVuZXI6IGlucHV0LnNoYXJlZExpc3RlbmVyXG4gIH0pLFxuICBvbjoge1xuICAgIHN5bmM6IHtcbiAgICAgIGFjdGlvbnM6IFtcImVtaXQgc3luYyBldmVudFwiXVxuICAgIH0sXG4gICAgbXV0YXRpb246IHtcbiAgICAgIGFjdGlvbnM6IFtcImVtaXQgbXV0YXRpb24gZXZlbnRcIl1cbiAgICB9LFxuICAgIFwicmViYXNlZC4qXCI6IHtcbiAgICAgIGFjdGlvbnM6IFtcImVtaXQgcmViYXNlZCBldmVudFwiXVxuICAgIH0sXG4gICAgcHJpc3RpbmU6IHtcbiAgICAgIGFjdGlvbnM6IFtcImVtaXQgcHJpc3RpbmUgZXZlbnRcIl1cbiAgICB9LFxuICAgIG9ic2VydmU6IHtcbiAgICAgIGFjdGlvbnM6IFtcImFkZCBkb2N1bWVudCBhY3RvclwiXVxuICAgIH0sXG4gICAgdW5vYnNlcnZlOiB7XG4gICAgICBhY3Rpb25zOiBbXCJzdG9wIHJlbW90ZSBzbmFwc2hvdFwiLCBcInJlbW92ZSByZW1vdGUgc25hcHNob3QgZnJvbSBjb250ZXh0XCJdXG4gICAgfVxuICB9LFxuICBpbml0aWFsOiBcInByaXN0aW5lXCIsXG4gIHN0YXRlczoge1xuICAgIHByaXN0aW5lOiB7fVxuICB9XG59KSwgY3JlYXRlRGF0YXNldE11dGF0b3IgPSAoY29tbGluaykgPT4gZGF0YXNldE11dGF0b3JNYWNoaW5lLnByb3ZpZGUoe1xuICBhY3RvcnM6IHtcbiAgICBkb2N1bWVudE11dGF0b3JNYWNoaW5lOiBjcmVhdGVEb2N1bWVudE11dGF0b3IoY29tbGluaylcbiAgfVxufSk7XG5leHBvcnQge1xuICBhY3RvcixcbiAgY3JlYXRlRGF0YXNldE11dGF0b3IsXG4gIGNyZWF0ZURvY3VtZW50TXV0YXRvcixcbiAgZW1wdHlBY3RvcixcbiAgaXNFbXB0eUFjdG9yLFxuICBsaXN0ZW5lcnMsXG4gIHNldEFjdG9yXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/optimistic/index.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/react/index.js":
/*!******************************************************************************************!*\
  !*** ./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/react/index.js ***!
  \******************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VisualEditing: () => (/* binding */ VisualEditing),\n/* harmony export */   createDataAttribute: () => (/* reexport safe */ _sanity_visual_editing_csm__WEBPACK_IMPORTED_MODULE_11__.createDataAttribute),\n/* harmony export */   createDatasetMutator: () => (/* reexport safe */ _optimistic_index_js__WEBPACK_IMPORTED_MODULE_19__.createDatasetMutator),\n/* harmony export */   createDocumentMutator: () => (/* reexport safe */ _optimistic_index_js__WEBPACK_IMPORTED_MODULE_19__.createDocumentMutator),\n/* harmony export */   emptyActor: () => (/* reexport safe */ _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_21__.emptyActor),\n/* harmony export */   useDocuments: () => (/* reexport safe */ _chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useDocuments),\n/* harmony export */   useOptimistic: () => (/* reexport safe */ _chunks_es_SharedStateContext_js__WEBPACK_IMPORTED_MODULE_13__.useOptimistic),\n/* harmony export */   useOptimisticActor: () => (/* reexport safe */ _chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useOptimisticActor)\n/* harmony export */ });\n/* harmony import */ var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-runtime */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.js\");\n/* harmony import */ var react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-compiler-runtime */ \"(ssr)/./node_modules/react-compiler-runtime/dist/index.js\");\n/* harmony import */ var _sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @sanity/presentation-comlink */ \"(ssr)/./node_modules/@sanity/presentation-comlink/dist/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react-dom */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react-dom.js\");\n/* harmony import */ var _sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @sanity/client/csm */ \"(ssr)/./node_modules/@sanity/client/dist/_chunks-es/resolveEditInfo.js\");\n/* harmony import */ var _sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @sanity/ui/_visual-editing */ \"(ssr)/./node_modules/@sanity/ui/dist/_chunks-es/_visual-editing.mjs\");\n/* harmony import */ var styled_components__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! styled-components */ \"(ssr)/./node_modules/styled-components/dist/styled-components.esm.js\");\n/* harmony import */ var _chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../_chunks-es/mutations.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/mutations.js\");\n/* harmony import */ var _chunks_es_SharedStateContext_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../_chunks-es/SharedStateContext.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/SharedStateContext.js\");\n/* harmony import */ var _sanity_mutate__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @sanity/mutate */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/mutate/dist/index.js\");\n/* harmony import */ var _chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../_chunks-es/PointerEvents.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/PointerEvents.js\");\n/* harmony import */ var _sanity_icons__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @sanity/icons */ \"(ssr)/./node_modules/@sanity/icons/dist/index.js\");\n/* harmony import */ var _sanity_visual_editing_csm__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @sanity/visual-editing-csm */ \"(ssr)/./node_modules/@sanity/visual-editing-csm/dist/index.js\");\n/* harmony import */ var scroll_into_view_if_needed__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! scroll-into-view-if-needed */ \"(ssr)/./node_modules/scroll-into-view-if-needed/dist/index.js\");\n/* harmony import */ var _sanity_comlink__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @sanity/comlink */ \"(ssr)/./node_modules/@sanity/comlink/dist/index.js\");\n/* harmony import */ var xstate__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! xstate */ \"(ssr)/./node_modules/xstate/dist/raise-1db27a82.development.esm.js\");\n/* harmony import */ var _chunks_es_context_js__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../_chunks-es/context.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/_chunks-es/context.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/rxjs/dist/esm5/internal/ReplaySubject.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/rxjs/dist/esm5/internal/Subject.js\");\n/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! rxjs */ \"(ssr)/./node_modules/rxjs/dist/esm5/internal/observable/merge.js\");\n/* harmony import */ var _optimistic_index_js__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../optimistic/index.js */ \"(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/optimistic/index.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst History = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(8), {\n    comlink,\n    history\n  } = props;\n  let t0, t1;\n  $[0] !== comlink || $[1] !== history ? (t0 = () => comlink?.on(\"presentation/navigate\", (data) => {\n    history?.update(data);\n  }), t1 = [comlink, history], $[0] = comlink, $[1] = history, $[2] = t0, $[3] = t1) : (t0 = $[2], t1 = $[3]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1);\n  let t2, t3;\n  return $[4] !== comlink || $[5] !== history ? (t2 = () => {\n    if (history)\n      return history.subscribe((update) => {\n        update.title = update.title || document.title, comlink?.post(\"visual-editing/navigate\", update);\n      });\n  }, t3 = [comlink, history], $[4] = comlink, $[5] = history, $[6] = t2, $[7] = t3) : (t2 = $[6], t3 = $[7]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t2, t3), null;\n}, Meta = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(3), {\n    comlink\n  } = props;\n  let t0, t1;\n  return $[0] !== comlink ? (t0 = () => {\n    const sendMeta = () => {\n      comlink.post(\"visual-editing/meta\", {\n        title: document.title\n      });\n    }, observer = new MutationObserver((t2) => {\n      const [mutation] = t2;\n      mutation.target.nodeName === \"TITLE\" && sendMeta();\n    });\n    return observer.observe(document.head, {\n      subtree: !0,\n      characterData: !0,\n      childList: !0\n    }), sendMeta(), () => observer.disconnect();\n  }, t1 = [comlink], $[0] = comlink, $[1] = t0, $[2] = t1) : (t0 = $[1], t1 = $[2]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1), null;\n};\nfunction getReferenceNodeAndInsertPosition(position) {\n  if (position) {\n    const {\n      top,\n      right,\n      bottom,\n      left\n    } = position;\n    if (left || top)\n      return {\n        node: (left ?? top).sanity,\n        position: \"after\"\n      };\n    if (right || bottom)\n      return {\n        node: (right ?? bottom).sanity,\n        position: \"before\"\n      };\n  }\n}\nfunction useDragEndEvents() {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(4), {\n    getDocument\n  } = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useDocuments)();\n  let t0, t1;\n  $[0] !== getDocument ? (t0 = () => {\n    const handler = (e) => {\n      const {\n        insertPosition,\n        target,\n        preventInsertDefault\n      } = e.detail;\n      if (preventInsertDefault)\n        return;\n      const reference = getReferenceNodeAndInsertPosition(insertPosition);\n      if (reference) {\n        const doc = getDocument(target.id), {\n          node,\n          position\n        } = reference, {\n          key: targetKey,\n          hasExplicitKey\n        } = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayItemKeyAndParentPath)(target), {\n          path: arrayPath,\n          key: referenceItemKey\n        } = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayItemKeyAndParentPath)(node);\n        arrayPath && referenceItemKey && referenceItemKey !== targetKey && doc.patch(async (t22) => {\n          const {\n            getSnapshot\n          } = t22, snapshot = await getSnapshot(), elementValue = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.get)(snapshot, target.path);\n          return hasExplicitKey ? [(0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.remove)({\n            _key: targetKey\n          })), (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.insert)(elementValue, position, {\n            _key: referenceItemKey\n          }))] : [(0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.remove)(~~targetKey)), (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.at)(arrayPath, (0,_sanity_mutate__WEBPACK_IMPORTED_MODULE_5__.insert)(elementValue, position, referenceItemKey > targetKey ? ~~referenceItemKey - 1 : ~~referenceItemKey))];\n        });\n      }\n    };\n    return window.addEventListener(\"sanity/dragEnd\", handler), () => {\n      window.removeEventListener(\"sanity/dragEnd\", handler);\n    };\n  }, t1 = [getDocument], $[0] = getDocument, $[1] = t0, $[2] = t1) : (t0 = $[1], t1 = $[2]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1);\n  const dispatchDragEndEvent = _temp$9;\n  let t2;\n  return $[3] === Symbol.for(\"react.memo_cache_sentinel\") ? (t2 = {\n    dispatchDragEndEvent\n  }, $[3] = t2) : t2 = $[3], t2;\n}\nfunction _temp$9(event) {\n  const customEvent = new CustomEvent(\"sanity/dragEnd\", {\n    detail: event,\n    cancelable: !0\n  });\n  window.dispatchEvent(customEvent);\n}\nconst SchemaContext = (0,react__WEBPACK_IMPORTED_MODULE_2__.createContext)(null);\nfunction useSchema() {\n  const context = (0,react__WEBPACK_IMPORTED_MODULE_2__.useContext)(SchemaContext);\n  if (!context)\n    throw new Error(\"Schema context is missing\");\n  return context;\n}\nfunction getArrayRemoveAction(node, doc) {\n  if (!node.type) throw new Error(\"Node type is missing\");\n  return () => doc.patch(async ({\n    getSnapshot\n  }) => (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayRemovePatches)(node, await getSnapshot()));\n}\nfunction getArrayInsertAction(node, doc, insertType, position) {\n  if (!node.type) throw new Error(\"Node type is missing\");\n  return () => doc.patch(() => (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayInsertPatches)(node, insertType, position));\n}\nfunction getDuplicateAction(node, doc) {\n  if (!node.type) throw new Error(\"Node type is missing\");\n  return () => doc.patch(async ({\n    getSnapshot\n  }) => (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayDuplicatePatches)(node, await getSnapshot()));\n}\nfunction getContextMenuItems(context) {\n  const {\n    node,\n    field,\n    parent,\n    doc\n  } = context;\n  return field?.type === \"arrayItem\" ? getContextMenuArrayItems({\n    node,\n    field,\n    doc\n  }) : parent?.type === \"union\" ? getContextMenuUnionItems({\n    node,\n    parent,\n    doc\n  }) : Promise.resolve([]);\n}\nfunction getDuplicateItem(context) {\n  const {\n    node,\n    doc\n  } = context;\n  return doc ? [{\n    type: \"action\",\n    label: \"Duplicate\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.CopyIcon,\n    action: getDuplicateAction(node, doc),\n    telemetryEvent: \"Visual Editing Context Menu Item Duplicated\"\n  }] : [];\n}\nfunction getRemoveItems(context) {\n  const {\n    node,\n    doc\n  } = context;\n  return doc ? [{\n    type: \"action\",\n    label: \"Remove\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.RemoveIcon,\n    action: getArrayRemoveAction(node, doc),\n    telemetryEvent: \"Visual Editing Context Menu Item Removed\"\n  }] : [];\n}\nasync function getMoveItems(context, withDivider = !0) {\n  const {\n    node,\n    doc\n  } = context;\n  if (!doc) return [];\n  const items = [], groupItems = [], [moveUpPatches, moveDownPatches, moveFirstPatches, moveLastPatches] = await Promise.all([(0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayMovePatches)(node, doc, \"previous\"), (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayMovePatches)(node, doc, \"next\"), (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayMovePatches)(node, doc, \"first\"), (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.getArrayMovePatches)(node, doc, \"last\")]);\n  return moveFirstPatches.length && groupItems.push({\n    type: \"action\",\n    label: \"To top\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.PublishIcon,\n    action: () => doc.patch(moveFirstPatches),\n    telemetryEvent: \"Visual Editing Context Menu Item Moved\"\n  }), moveUpPatches.length && groupItems.push({\n    type: \"action\",\n    label: \"Up\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.ArrowUpIcon,\n    action: () => doc.patch(moveUpPatches),\n    telemetryEvent: \"Visual Editing Context Menu Item Moved\"\n  }), moveDownPatches.length && groupItems.push({\n    type: \"action\",\n    label: \"Down\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.ArrowDownIcon,\n    action: () => doc.patch(moveDownPatches),\n    telemetryEvent: \"Visual Editing Context Menu Item Moved\"\n  }), moveLastPatches.length && groupItems.push({\n    type: \"action\",\n    label: \"To bottom\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.UnpublishIcon,\n    action: () => doc.patch(moveLastPatches),\n    telemetryEvent: \"Visual Editing Context Menu Item Moved\"\n  }), groupItems.length && (items.push({\n    type: \"group\",\n    label: \"Move\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.SortIcon,\n    items: groupItems\n  }), withDivider && items.push({\n    type: \"divider\"\n  })), items;\n}\nasync function getContextMenuArrayItems(context) {\n  const {\n    node,\n    field,\n    doc\n  } = context, items = [];\n  return items.push(...getDuplicateItem(context)), items.push(...getRemoveItems(context)), items.push(...await getMoveItems(context)), items.push({\n    type: \"action\",\n    label: \"Insert before\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.InsertAboveIcon,\n    action: getArrayInsertAction(node, doc, field.name, \"before\"),\n    telemetryEvent: \"Visual Editing Context Menu Item Inserted\"\n  }), items.push({\n    type: \"action\",\n    label: \"Insert after\",\n    icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.InsertBelowIcon,\n    action: getArrayInsertAction(node, doc, field.name, \"after\"),\n    telemetryEvent: \"Visual Editing Context Menu Item Inserted\"\n  }), items;\n}\nconst InsertMenuWrapper = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(12), {\n    label,\n    parent,\n    width,\n    onSelect,\n    boundaryElement\n  } = props;\n  let t0;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t0 = [\"left-start\", \"right\", \"left\", \"right-end\", \"left-end\", \"bottom\", \"top\"], $[0] = t0) : t0 = $[0];\n  let t1;\n  $[1] === Symbol.for(\"react.memo_cache_sentinel\") ? (t1 = [4, 4, 4, 4], $[1] = t1) : t1 = $[1];\n  let t2;\n  $[2] !== boundaryElement || $[3] !== width ? (t2 = {\n    arrow: !1,\n    constrainSize: !0,\n    floatingBoundary: boundaryElement,\n    padding: 0,\n    placement: \"right-start\",\n    fallbackPlacements: t0,\n    preventOverflow: !0,\n    width,\n    __unstable_margins: t1\n  }, $[2] = boundaryElement, $[3] = width, $[4] = t2) : t2 = $[4];\n  let t3;\n  $[5] !== onSelect || $[6] !== parent ? (t3 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.InsertMenu, { node: parent, onSelect }), $[5] = onSelect, $[6] = parent, $[7] = t3) : t3 = $[7];\n  let t4;\n  return $[8] !== label || $[9] !== t2 || $[10] !== t3 ? (t4 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.MenuGroup, { fontSize: 1, icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.InsertBelowIcon, padding: 2, popover: t2, space: 2, text: label, children: t3 }), $[8] = label, $[9] = t2, $[10] = t3, $[11] = t4) : t4 = $[11], t4;\n};\nasync function getContextMenuUnionItems(context) {\n  const {\n    doc,\n    node,\n    parent\n  } = context, items = [];\n  if (items.push(...getDuplicateItem(context)), items.push(...getRemoveItems(context)), items.push(...await getMoveItems(context)), parent.options?.insertMenu) {\n    const width = (parent.options.insertMenu || {}).views?.some((view) => view.name === \"grid\") ? 0 : void 0;\n    items.push({\n      type: \"custom\",\n      component: ({\n        boundaryElement,\n        sendTelemetry\n      }) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(InsertMenuWrapper, { label: \"Insert before\", onSelect: (schemaType) => {\n        getArrayInsertAction(node, doc, schemaType.name, \"before\")(), sendTelemetry(\"Visual Editing Context Menu Item Inserted\", null);\n      }, parent, width, boundaryElement })\n    }), items.push({\n      type: \"custom\",\n      component: ({\n        boundaryElement,\n        sendTelemetry\n      }) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(InsertMenuWrapper, { label: \"Insert after\", onSelect: (schemaType) => {\n        getArrayInsertAction(node, doc, schemaType.name, \"after\")(), sendTelemetry(\"Visual Editing Context Menu Item Inserted\", null);\n      }, parent, width, boundaryElement })\n    });\n  } else\n    items.push({\n      type: \"group\",\n      label: \"Insert before\",\n      icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.InsertAboveIcon,\n      items: parent.of.filter((item) => item.type === \"unionOption\").map((t) => ({\n        type: \"action\",\n        icon: (0,_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.getNodeIcon)(t),\n        label: t.name === \"block\" ? \"Paragraph\" : t.title || t.name,\n        action: getArrayInsertAction(node, doc, t.name, \"before\"),\n        telemetryEvent: \"Visual Editing Context Menu Item Inserted\"\n      }))\n    }), items.push({\n      type: \"group\",\n      label: \"Insert after\",\n      icon: _sanity_icons__WEBPACK_IMPORTED_MODULE_6__.InsertBelowIcon,\n      items: parent.of.filter((item) => item.type === \"unionOption\").map((t) => ({\n        type: \"action\",\n        label: t.name === \"block\" ? \"Paragraph\" : t.title || t.name,\n        icon: (0,_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.getNodeIcon)(t),\n        action: getArrayInsertAction(node, doc, t.name, \"after\"),\n        telemetryEvent: \"Visual Editing Context Menu Item Inserted\"\n      }))\n    });\n  return items;\n}\nconst POPOVER_MARGINS = [-4, 4, -4, 4];\nfunction ContextMenuItem(props) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(27), {\n    node,\n    onDismiss,\n    boundaryElement\n  } = props, sendTelemetry = (0,_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.useTelemetry)();\n  let t0;\n  $[0] !== node || $[1] !== onDismiss || $[2] !== sendTelemetry ? (t0 = () => {\n    node.type === \"action\" && (node.action?.(), onDismiss?.(), node.telemetryEvent && sendTelemetry(node.telemetryEvent, null));\n  }, $[0] = node, $[1] = onDismiss, $[2] = sendTelemetry, $[3] = t0) : t0 = $[3];\n  const onClick = t0;\n  if (node.type === \"divider\") {\n    let t1;\n    return $[4] === Symbol.for(\"react.memo_cache_sentinel\") ? (t1 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.MenuDivider, {}), $[4] = t1) : t1 = $[4], t1;\n  }\n  if (node.type === \"action\") {\n    const t1 = !node.action;\n    let t2;\n    return $[5] !== node.hotkeys || $[6] !== node.icon || $[7] !== node.label || $[8] !== onClick || $[9] !== t1 ? (t2 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.MenuItem, { fontSize: 1, hotkeys: node.hotkeys, icon: node.icon, padding: 2, space: 2, text: node.label, disabled: t1, onClick }), $[5] = node.hotkeys, $[6] = node.icon, $[7] = node.label, $[8] = onClick, $[9] = t1, $[10] = t2) : t2 = $[10], t2;\n  }\n  if (node.type === \"group\") {\n    const t1 = node.icon;\n    let t2;\n    $[11] === Symbol.for(\"react.memo_cache_sentinel\") ? (t2 = {\n      arrow: !1,\n      constrainSize: !0,\n      placement: \"right-start\",\n      fallbackPlacements: [\"left-start\", \"right\", \"left\", \"right-end\", \"left-end\", \"bottom\", \"top\"],\n      preventOverflow: !0,\n      __unstable_margins: POPOVER_MARGINS\n    }, $[11] = t2) : t2 = $[11];\n    const t3 = node.label;\n    let t4;\n    if ($[12] !== boundaryElement || $[13] !== node.items || $[14] !== onDismiss) {\n      let t52;\n      $[16] !== boundaryElement || $[17] !== onDismiss ? (t52 = (item, itemIndex) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ContextMenuItem, { node: item, onDismiss, boundaryElement }, itemIndex), $[16] = boundaryElement, $[17] = onDismiss, $[18] = t52) : t52 = $[18], t4 = node.items.map(t52), $[12] = boundaryElement, $[13] = node.items, $[14] = onDismiss, $[15] = t4;\n    } else\n      t4 = $[15];\n    let t5;\n    return $[19] !== node.icon || $[20] !== node.label || $[21] !== t4 ? (t5 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.MenuGroup, { fontSize: 1, icon: t1, padding: 2, popover: t2, space: 2, text: t3, children: t4 }), $[19] = node.icon, $[20] = node.label, $[21] = t4, $[22] = t5) : t5 = $[22], t5;\n  }\n  if (node.type === \"custom\") {\n    const {\n      component: Component\n    } = node;\n    let t1;\n    return $[23] !== Component || $[24] !== boundaryElement || $[25] !== sendTelemetry ? (t1 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Component, { boundaryElement, sendTelemetry }), $[23] = Component, $[24] = boundaryElement, $[25] = sendTelemetry, $[26] = t1) : t1 = $[26], t1;\n  }\n  return null;\n}\nconst ContextMenu = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(43), {\n    node,\n    onDismiss,\n    position: t0\n  } = props, {\n    x,\n    y\n  } = t0, [boundaryElement, setBoundaryElement] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null), {\n    getField\n  } = useSchema(), {\n    getDocument\n  } = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useDocuments)();\n  let t1;\n  $[0] !== getField || $[1] !== node ? (t1 = getField(node), $[0] = getField, $[1] = node, $[2] = t1) : t1 = $[2];\n  const {\n    field,\n    parent\n  } = t1;\n  let t2;\n  t2 = field?.title || field?.name || \"Unknown type\";\n  const title = t2, [items, setItems] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(void 0);\n  let t3, t4;\n  $[3] !== field || $[4] !== getDocument || $[5] !== node || $[6] !== parent ? (t3 = () => {\n    (async () => {\n      const doc = getDocument(node.id);\n      if (!doc)\n        return;\n      const items_0 = await getContextMenuItems({\n        node,\n        field,\n        parent,\n        doc\n      });\n      setItems(items_0);\n    })();\n  }, t4 = [field, node, parent, getDocument], $[3] = field, $[4] = getDocument, $[5] = node, $[6] = parent, $[7] = t3, $[8] = t4) : (t3 = $[7], t4 = $[8]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t3, t4);\n  let t5, t6;\n  $[9] !== x || $[10] !== y ? (t6 = {\n    getBoundingClientRect: () => ({\n      bottom: y,\n      left: x,\n      right: x,\n      top: y,\n      width: 0,\n      height: 0\n    })\n  }, $[9] = x, $[10] = y, $[11] = t6) : t6 = $[11], t5 = t6;\n  const contextMenuReferenceElement = t5;\n  let t7, t8;\n  $[12] !== field ? (t8 = (0,_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.getNodeIcon)(field), $[12] = field, $[13] = t8) : t8 = $[13], t7 = t8;\n  const icon = t7;\n  let t9;\n  $[14] === Symbol.for(\"react.memo_cache_sentinel\") ? (t9 = {\n    minWidth: 120,\n    maxWidth: 160\n  }, $[14] = t9) : t9 = $[14];\n  let t10;\n  $[15] !== icon || $[16] !== items ? (t10 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Box, { flex: \"none\", children: items ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { size: 1, children: icon }) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Spinner, { size: 1 }) }), $[15] = icon, $[16] = items, $[17] = t10) : t10 = $[17];\n  const t11 = items ? title : \"Loading...\";\n  let t12;\n  $[18] !== t11 ? (t12 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Stack, { flex: 1, space: 2, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { size: 1, weight: \"semibold\", children: t11 }) }), $[18] = t11, $[19] = t12) : t12 = $[19];\n  let t13;\n  $[20] !== t10 || $[21] !== t12 ? (t13 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Flex, { gap: 2, padding: 2, children: [\n    t10,\n    t12\n  ] }), $[20] = t10, $[21] = t12, $[22] = t13) : t13 = $[22];\n  let t14;\n  $[23] !== boundaryElement || $[24] !== items || $[25] !== onDismiss ? (t14 = items && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.MenuDivider, {}),\n    items.map((item, i) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ContextMenuItem, { node: item, onDismiss, boundaryElement }, i))\n  ] }), $[23] = boundaryElement, $[24] = items, $[25] = onDismiss, $[26] = t14) : t14 = $[26];\n  let t15;\n  $[27] !== t13 || $[28] !== t14 ? (t15 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Menu, { style: t9, children: [\n    t13,\n    t14\n  ] }), $[27] = t13, $[28] = t14, $[29] = t15) : t15 = $[29];\n  const t16 = `${x}-${y}`;\n  let t17;\n  $[30] !== x || $[31] !== y ? (t17 = {\n    position: \"absolute\",\n    left: x,\n    top: y\n  }, $[30] = x, $[31] = y, $[32] = t17) : t17 = $[32];\n  let t18;\n  $[33] !== t16 || $[34] !== t17 ? (t18 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { style: t17 }, t16), $[33] = t16, $[34] = t17, $[35] = t18) : t18 = $[35];\n  let t19;\n  $[36] !== contextMenuReferenceElement || $[37] !== t15 || $[38] !== t18 ? (t19 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Popover, { __unstable_margins: POPOVER_MARGINS, arrow: !1, open: !0, placement: \"right-start\", referenceElement: contextMenuReferenceElement, content: t15, children: t18 }), $[36] = contextMenuReferenceElement, $[37] = t15, $[38] = t18, $[39] = t19) : t19 = $[39];\n  let t20;\n  return $[40] !== onDismiss || $[41] !== t19 ? (t20 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.PopoverPortal, { setBoundaryElement, onDismiss, children: t19 }), $[40] = onDismiss, $[41] = t19, $[42] = t20) : t20 = $[42], t20;\n};\nfunction getLinkHref(href, referer) {\n  try {\n    const parsed = new URL(href, typeof location > \"u\" ? void 0 : location.origin);\n    if (parsed.hash) {\n      const hash = new URL(getLinkHref(parsed.hash.slice(1), referer));\n      return `${parsed.origin}${parsed.pathname}${parsed.search}#${hash.pathname}${hash.search}`;\n    }\n    return parsed.searchParams.set(\"preview\", referer), parsed.toString();\n  } catch {\n    return href;\n  }\n}\nconst PreviewSnapshotsContext = (0,react__WEBPACK_IMPORTED_MODULE_2__.createContext)(null);\nfunction usePreviewSnapshots() {\n  const context = (0,react__WEBPACK_IMPORTED_MODULE_2__.useContext)(PreviewSnapshotsContext);\n  if (!context)\n    throw new Error(\"Preview Snapshots context is missing\");\n  return context;\n}\nconst isReactElementOverlayComponent = (component) => (0,react__WEBPACK_IMPORTED_MODULE_2__.isValidElement)(component), Root$3 = (0,styled_components__WEBPACK_IMPORTED_MODULE_9__.styled)((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Card))`\n  background-color: var(--overlay-bg);\n  border-radius: 3px;\n  pointer-events: none;\n  position: absolute;\n  will-change: transform;\n  box-shadow: var(--overlay-box-shadow);\n  transition: none;\n\n  --overlay-bg: transparent;\n  --overlay-box-shadow: inset 0 0 0 1px transparent;\n\n  [data-overlays] & {\n    --overlay-bg: color-mix(in srgb, transparent 95%, var(--card-focus-ring-color));\n    --overlay-box-shadow: inset 0 0 0 2px\n      color-mix(in srgb, transparent 50%, var(--card-focus-ring-color));\n  }\n\n  [data-fading-out] & {\n    transition:\n      box-shadow 1550ms,\n      background-color 1550ms;\n\n    --overlay-bg: rgba(0, 0, 255, 0);\n    --overlay-box-shadow: inset 0 0 0 1px transparent;\n  }\n\n  &[data-focused] {\n    --overlay-box-shadow: inset 0 0 0 1px var(--card-focus-ring-color);\n  }\n\n  &[data-hovered]:not([data-focused]) {\n    transition: none;\n    --overlay-box-shadow: inset 0 0 0 2px var(--card-focus-ring-color);\n  }\n\n  /* [data-unmounted] & {\n    --overlay-box-shadow: inset 0 0 0 1px var(--card-focus-ring-color);\n  } */\n\n  :link {\n    text-decoration: none;\n  }\n`, Actions = (0,styled_components__WEBPACK_IMPORTED_MODULE_9__.styled)((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Flex))`\n  bottom: 100%;\n  cursor: pointer;\n  pointer-events: none;\n  position: absolute;\n  right: 0;\n\n  [data-hovered] & {\n    pointer-events: all;\n  }\n\n  [data-flipped] & {\n    bottom: auto;\n    top: 100%;\n  }\n`, Tab = (0,styled_components__WEBPACK_IMPORTED_MODULE_9__.styled)((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Flex))`\n  bottom: 100%;\n  cursor: pointer;\n  pointer-events: none;\n  position: absolute;\n  left: 0;\n\n  [data-hovered] & {\n    pointer-events: all;\n  }\n\n  [data-flipped] & {\n    bottom: auto;\n    top: 100%;\n  }\n`, ActionOpen = (0,styled_components__WEBPACK_IMPORTED_MODULE_9__.styled)((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Card))`\n  cursor: pointer;\n  background-color: var(--card-focus-ring-color);\n  right: 0;\n  border-radius: 3px;\n\n  & [data-ui='Text'] {\n    color: #fff;\n    white-space: nowrap;\n  }\n`, Labels = (0,styled_components__WEBPACK_IMPORTED_MODULE_9__.styled)((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Flex))`\n  display: flex;\n  align-items: center;\n  background-color: var(--card-focus-ring-color);\n  right: 0;\n  border-radius: 3px;\n  & [data-ui='Text'],\n  & [data-sanity-icon] {\n    color: #fff;\n    white-space: nowrap;\n  }\n`;\nfunction createIntentLink(node) {\n  const {\n    id,\n    type,\n    path,\n    baseUrl,\n    tool,\n    workspace\n  } = node;\n  return (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__.createEditUrl)({\n    baseUrl,\n    workspace,\n    tool,\n    type,\n    id,\n    path: (0,_sanity_visual_editing_csm__WEBPACK_IMPORTED_MODULE_11__.pathToUrlString)(_sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__.studioPath.fromString(path))\n  });\n}\nconst ElementOverlayInner = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(35), {\n    element,\n    focused,\n    componentResolver,\n    node,\n    showActions,\n    draggable\n  } = props, {\n    getField,\n    getType\n  } = useSchema();\n  let t0;\n  $[0] !== getType || $[1] !== node ? (t0 = getType(node), $[0] = getType, $[1] = node, $[2] = t0) : t0 = $[2];\n  const schemaType = t0;\n  let t1;\n  $[3] !== getField || $[4] !== node ? (t1 = getField(node), $[3] = getField, $[4] = node, $[5] = t1) : t1 = $[5];\n  const {\n    field,\n    parent\n  } = t1;\n  let t2;\n  $[6] !== node ? (t2 = \"path\" in node ? createIntentLink(node) : node.href, $[6] = node, $[7] = t2) : t2 = $[7];\n  const href = t2, previewSnapshots = usePreviewSnapshots();\n  let t3;\n  bb0: {\n    if (!(\"path\" in node)) {\n      t3 = void 0;\n      break bb0;\n    }\n    let t42;\n    $[8] !== node || $[9] !== previewSnapshots ? (t42 = previewSnapshots.find((snapshot) => snapshot._id === node.id)?.title, $[8] = node, $[9] = previewSnapshots, $[10] = t42) : t42 = $[10], t3 = t42;\n  }\n  const title = t3;\n  let t4;\n  bb1: {\n    if (!(\"path\" in node)) {\n      t4 = void 0;\n      break bb1;\n    }\n    if (!field || !schemaType) {\n      t4 = void 0;\n      break bb1;\n    }\n    const type = field.value.type, t52 = !!focused;\n    let t62;\n    $[11] !== element || $[12] !== field || $[13] !== node || $[14] !== parent || $[15] !== schemaType || $[16] !== t52 || $[17] !== type ? (t62 = {\n      document: schemaType,\n      element,\n      field,\n      focused: t52,\n      node,\n      parent,\n      type\n    }, $[11] = element, $[12] = field, $[13] = node, $[14] = parent, $[15] = schemaType, $[16] = t52, $[17] = type, $[18] = t62) : t62 = $[18], t4 = t62;\n  }\n  const componentContext = t4, customComponents = useCustomComponents(componentContext, componentResolver);\n  let t5;\n  $[19] !== schemaType ? (t5 = schemaType?.icon ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { dangerouslySetInnerHTML: {\n    __html: schemaType.icon\n  } }) : /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_6__.DocumentIcon, {}), $[19] = schemaType, $[20] = t5) : t5 = $[20];\n  const icon = t5;\n  let t6;\n  $[21] !== href || $[22] !== showActions ? (t6 = showActions ? /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Actions, { gap: 1, paddingY: 1, \"data-sanity-overlay-element\": !0, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Link, { href }) }) : null, $[21] = href, $[22] = showActions, $[23] = t6) : t6 = $[23];\n  let t7;\n  $[24] !== draggable || $[25] !== icon || $[26] !== title ? (t7 = title && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Tab, { gap: 1, paddingY: 1, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(Labels, { gap: 2, padding: 2, children: [\n    draggable && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Box, { marginRight: 1, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { className: \"drag-handle\", size: 0, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_6__.DragHandleIcon, {}) }) }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { size: 0, children: icon }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { size: 1, weight: \"medium\", children: title })\n  ] }) }), $[24] = draggable, $[25] = icon, $[26] = title, $[27] = t7) : t7 = $[27];\n  let t8;\n  $[28] !== componentContext || $[29] !== customComponents ? (t8 = Array.isArray(customComponents) ? customComponents.map((t92, i) => {\n    const {\n      component: Component,\n      props: props_0\n    } = t92;\n    return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Component, { PointerEvents: _chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.PointerEvents, ...componentContext, ...props_0 }, i);\n  }) : customComponents, $[28] = componentContext, $[29] = customComponents, $[30] = t8) : t8 = $[30];\n  let t9;\n  return $[31] !== t6 || $[32] !== t7 || $[33] !== t8 ? (t9 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n    t6,\n    t7,\n    t8\n  ] }), $[31] = t6, $[32] = t7, $[33] = t8, $[34] = t9) : t9 = $[34], t9;\n}, ElementOverlay = (0,react__WEBPACK_IMPORTED_MODULE_2__.memo)(function(props) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(24), {\n    draggable,\n    focused,\n    hovered,\n    rect,\n    wasMaybeCollapsed,\n    enableScrollIntoView\n  } = props, ref = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(null), scrolledIntoViewRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(!1);\n  let t0;\n  const t1 = `${rect.w}px`, t2 = `${rect.h}px`, t3 = `translate(${rect.x}px, ${rect.y}px)`;\n  let t4;\n  $[0] !== t1 || $[1] !== t2 || $[2] !== t3 ? (t4 = {\n    width: t1,\n    height: t2,\n    transform: t3\n  }, $[0] = t1, $[1] = t2, $[2] = t3, $[3] = t4) : t4 = $[3], t0 = t4;\n  const style = t0;\n  let t5, t6;\n  $[4] !== enableScrollIntoView || $[5] !== focused || $[6] !== wasMaybeCollapsed ? (t5 = () => {\n    if (!scrolledIntoViewRef.current && !wasMaybeCollapsed && focused === !0 && ref.current && enableScrollIntoView) {\n      const target = ref.current;\n      (0,scroll_into_view_if_needed__WEBPACK_IMPORTED_MODULE_12__[\"default\"])(ref.current, {\n        behavior: (actions) => {\n          actions.length !== 0 && target.scrollIntoView({\n            behavior: \"smooth\",\n            block: \"center\",\n            inline: \"nearest\"\n          });\n        },\n        scrollMode: \"if-needed\",\n        block: \"center\",\n        inline: \"nearest\"\n      });\n    }\n    scrolledIntoViewRef.current = focused === !0;\n  }, t6 = [focused, wasMaybeCollapsed, enableScrollIntoView], $[4] = enableScrollIntoView, $[5] = focused, $[6] = wasMaybeCollapsed, $[7] = t5, $[8] = t6) : (t5 = $[7], t6 = $[8]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t5, t6);\n  const [isNearTop, setIsNearTop] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(!1);\n  let t7;\n  $[9] !== hovered ? (t7 = () => {\n    if (!ref.current || !hovered)\n      return;\n    const io = new IntersectionObserver((t82) => {\n      const [intersection] = t82;\n      setIsNearTop(intersection.boundingClientRect.top < 0);\n    }, {\n      threshold: 1\n    });\n    return io.observe(ref.current), () => io.disconnect();\n  }, $[9] = hovered, $[10] = t7) : t7 = $[10];\n  let t8;\n  $[11] !== hovered || $[12] !== isNearTop ? (t8 = [hovered, isNearTop], $[11] = hovered, $[12] = isNearTop, $[13] = t8) : t8 = $[13], (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t7, t8);\n  const t9 = focused ? \"\" : void 0, t10 = hovered ? \"\" : void 0, t11 = isNearTop ? \"\" : void 0, t12 = draggable ? \"\" : void 0;\n  let t13;\n  $[14] !== hovered || $[15] !== props ? (t13 = hovered && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ElementOverlayInner, { ...props }), $[14] = hovered, $[15] = props, $[16] = t13) : t13 = $[16];\n  let t14;\n  return $[17] !== style || $[18] !== t10 || $[19] !== t11 || $[20] !== t12 || $[21] !== t13 || $[22] !== t9 ? (t14 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Root$3, { \"data-focused\": t9, \"data-hovered\": t10, \"data-flipped\": t11, \"data-draggable\": t12, ref, style, children: t13 }), $[17] = style, $[18] = t10, $[19] = t11, $[20] = t12, $[21] = t13, $[22] = t9, $[23] = t14) : t14 = $[23], t14;\n});\nfunction useCustomComponents(componentContext, componentResolver) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(4);\n  let t0;\n  bb0: {\n    if (!componentContext) {\n      t0 = void 0;\n      break bb0;\n    }\n    let t1;\n    if ($[0] !== componentContext || $[1] !== componentResolver) {\n      const resolved = componentResolver?.(componentContext);\n      if (!resolved) {\n        t0 = void 0;\n        break bb0;\n      }\n      if (isReactElementOverlayComponent(resolved)) {\n        t0 = resolved;\n        break bb0;\n      }\n      t1 = (Array.isArray(resolved) ? resolved : [resolved]).map(_temp$8), $[0] = componentContext, $[1] = componentResolver, $[2] = t1, $[3] = t0;\n    } else\n      t1 = $[2], t0 = $[3];\n    t0 = t1;\n  }\n  return t0;\n}\nfunction _temp$8(component) {\n  return typeof component == \"object\" && \"component\" in component ? component : {\n    component,\n    props: {}\n  };\n}\nconst Link = (0,react__WEBPACK_IMPORTED_MODULE_2__.memo)(function(props) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(6), referer = (0,react__WEBPACK_IMPORTED_MODULE_2__.useSyncExternalStore)(_temp2$5, _temp3$2);\n  let t0, t1;\n  $[0] !== props.href || $[1] !== referer ? (t1 = getLinkHref(props.href, referer), $[0] = props.href, $[1] = referer, $[2] = t1) : t1 = $[2], t0 = t1;\n  const href = t0;\n  let t2;\n  $[3] === Symbol.for(\"react.memo_cache_sentinel\") ? (t2 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ActionOpen, { padding: 2, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { size: 1, weight: \"medium\", children: \"Open in Studio\" }) }), $[3] = t2) : t2 = $[3];\n  let t3;\n  return $[4] !== href ? (t3 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Box, { as: \"a\", href, target: \"_blank\", rel: \"noopener noreferrer\", children: t2 }), $[4] = href, $[5] = t3) : t3 = $[5], t3;\n});\nfunction _temp2$5(onStoreChange) {\n  const handlePopState = () => onStoreChange();\n  return window.addEventListener(\"popstate\", handlePopState), () => window.removeEventListener(\"popstate\", handlePopState);\n}\nfunction _temp3$2() {\n  return window.location.href;\n}\nconst OverlayDragGroupRect = (t0) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(5), {\n    dragGroupRect\n  } = t0, t1 = `${dragGroupRect.y}px`, t2 = `${dragGroupRect.x}px`, t3 = `${dragGroupRect.w - 1}px`, t4 = `${dragGroupRect.h - 1}px`;\n  let t5;\n  return $[0] !== t1 || $[1] !== t2 || $[2] !== t3 || $[3] !== t4 ? (t5 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { style: {\n    position: \"absolute\",\n    top: t1,\n    left: t2,\n    width: t3,\n    height: t4,\n    border: \"1px dashed #f0709b\",\n    pointerEvents: \"none\"\n  } }), $[0] = t1, $[1] = t2, $[2] = t3, $[3] = t4, $[4] = t5) : t5 = $[4], t5;\n}, markerThickness = 6;\nfunction lerp(v0, v1, t) {\n  return v0 * (1 - t) + v1 * t;\n}\nconst OverlayDragInsertMarker = (t0) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(4), {\n    dragInsertPosition\n  } = t0;\n  if (dragInsertPosition === null)\n    return;\n  const flow = dragInsertPosition?.left || dragInsertPosition?.right ? \"horizontal\" : \"vertical\";\n  let x = 0, y = 0, width = 0, height = 0;\n  if (flow === \"horizontal\") {\n    const {\n      left,\n      right\n    } = dragInsertPosition;\n    if (width = markerThickness, right && left) {\n      const startX = left.rect.x + left.rect.w, endX = right.rect.x, offset = Math.min(right.rect.h, left.rect.h) * 0.0125;\n      x = lerp(startX, endX, 0.5) - markerThickness / 2, y = left.rect.y + offset, height = Math.min(right.rect.h, left.rect.h) - offset * 2;\n    } else if (right && !left) {\n      const offset_0 = right.rect.h * 0.0125;\n      x = right.rect.x - markerThickness / 2, y = right.rect.y + offset_0, height = right.rect.h - offset_0 * 2;\n    } else if (left && !right) {\n      const offset_1 = left.rect.h * 0.0125;\n      x = left.rect.x + left.rect.w - markerThickness / 2, y = left.rect.y + offset_1, height = left.rect.h - offset_1 * 2;\n    }\n  } else {\n    const {\n      bottom,\n      top\n    } = dragInsertPosition;\n    if (bottom && top) {\n      const startX_0 = Math.min(top.rect.x, bottom.rect.x), startY = top.rect.y + top.rect.h, endY = bottom.rect.y, offset_2 = Math.min(bottom.rect.w, top.rect.w) * 0.0125;\n      height = markerThickness, x = startX_0 + offset_2, y = lerp(startY, endY, 0.5) - markerThickness / 2, width = Math.max(bottom.rect.w, top.rect.w) - offset_2 * 2;\n    } else if (bottom && !top) {\n      const offset_3 = bottom.rect.w * 0.0125;\n      x = bottom.rect.x + offset_3, y = bottom.rect.y - markerThickness / 2, width = bottom.rect.w - offset_3 * 2, height = markerThickness;\n    } else if (top && !bottom) {\n      const offset_4 = top.rect.w * 0.0125;\n      x = top.rect.x + offset_4, y = top.rect.y + top.rect.h - markerThickness / 2, width = top.rect.w - offset_4 * 2, height = markerThickness;\n    }\n  }\n  const t1 = `${width}px`, t2 = `${height}px`, t3 = `translate(${x}px, ${y}px)`;\n  let t4;\n  return $[0] !== t1 || $[1] !== t2 || $[2] !== t3 ? (t4 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { style: {\n    position: \"absolute\",\n    width: t1,\n    height: t2,\n    transform: t3,\n    background: \"#556bfc\",\n    border: \"2px solid white\",\n    borderRadius: \"999px\",\n    zIndex: \"999999\"\n  } }), $[0] = t1, $[1] = t2, $[2] = t3, $[3] = t4) : t4 = $[3], t4;\n}, Root$2 = styled_components__WEBPACK_IMPORTED_MODULE_9__.styled.div`\n  --drag-preview-opacity: 0.98;\n  --drag-preview-skeleton-stroke: #ffffff;\n\n  @media (prefers-color-scheme: dark) {\n    --drag-preview-skeleton-stroke: #383d51;\n  }\n\n  position: fixed;\n  display: grid;\n  transform: ${({\n  $scaleFactor,\n  $width,\n  $height\n}) => `translate(calc(var(--drag-preview-x) - ${$width / 2}px), calc(var(--drag-preview-y) - ${$height / 2}px)) scale(${$scaleFactor})`};\n  width: ${({\n  $width\n}) => `${$width}px`};\n  height: ${({\n  $height\n}) => `${$height}px`};\n  z-index: 9999999;\n  opacity: var(--drag-preview-opacity);\n  cursor: move;\n\n  .drag-preview-content-wrapper {\n    position: relative;\n    width: 100%;\n    height: 100%;\n    container-type: inline-size;\n  }\n\n  [data-ui='card'] {\n    position: relative;\n    width: 100%;\n    height: 100%;\n  }\n\n  .drag-preview-skeleton {\n    position: absolute;\n    inset: 0;\n\n    rect {\n      stroke: var(--drag-preview-skeleton-stroke);\n    }\n  }\n\n  .drag-preview-handle {\n    position: absolute;\n    top: 4cqmin;\n    left: 4cqmin;\n    width: 6cqmin;\n    fill: var(--drag-preview-handle-fill);\n  }\n`;\nfunction clamp(number, min, max) {\n  return number < min ? min : number > max ? max : number;\n}\nfunction map(number, inMin, inMax, outMin, outMax) {\n  const mapped = (number - inMin) * (outMax - outMin) / (inMax - inMin) + outMin;\n  return clamp(mapped, outMin, outMax);\n}\nconst OverlayDragPreview = (t0) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(50), {\n    skeleton\n  } = t0, maxSkeletonWidth = Math.min(skeleton.maxWidth, window.innerWidth / 2), scaleFactor = skeleton.w > maxSkeletonWidth ? maxSkeletonWidth / skeleton.w : 1, offsetX = skeleton.offsetX * scaleFactor, offsetY = skeleton.offsetY * scaleFactor, prefersDark = (0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.usePrefersDark)(), theme = (0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.useTheme_v2)(), radius = theme.radius[~~map(skeleton.w, 0, 1920, 1, theme.radius.length - 2)];\n  let T0, T1, t1, t10, t11, t12, t13, t14, t2, t3, t4, t5, t6, t7, t8, t9;\n  if ($[0] !== offsetX || $[1] !== offsetY || $[2] !== prefersDark || $[3] !== radius || $[4] !== scaleFactor || $[5] !== skeleton.childRects || $[6] !== skeleton.h || $[7] !== skeleton.w) {\n    const imageRects = skeleton.childRects.filter(_temp$7), textRects = skeleton.childRects.filter(_temp2$4);\n    T1 = Root$2, t10 = skeleton.w, t11 = skeleton.h, t12 = offsetX, t13 = offsetY, t14 = scaleFactor, T0 = _sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Card, t5 = radius, t6 = 4, t7 = \"hidden\", t8 = \"transparent\", t9 = prefersDark ? \"dark\" : \"light\", t4 = \"drag-preview-content-wrapper\", t2 = \"drag-preview-skeleton\", t3 = `0 0 ${skeleton.w} ${skeleton.h}`, t1 = [...imageRects, ...textRects], $[0] = offsetX, $[1] = offsetY, $[2] = prefersDark, $[3] = radius, $[4] = scaleFactor, $[5] = skeleton.childRects, $[6] = skeleton.h, $[7] = skeleton.w, $[8] = T0, $[9] = T1, $[10] = t1, $[11] = t10, $[12] = t11, $[13] = t12, $[14] = t13, $[15] = t14, $[16] = t2, $[17] = t3, $[18] = t4, $[19] = t5, $[20] = t6, $[21] = t7, $[22] = t8, $[23] = t9;\n  } else\n    T0 = $[8], T1 = $[9], t1 = $[10], t10 = $[11], t11 = $[12], t12 = $[13], t13 = $[14], t14 = $[15], t2 = $[16], t3 = $[17], t4 = $[18], t5 = $[19], t6 = $[20], t7 = $[21], t8 = $[22], t9 = $[23];\n  let t15;\n  $[24] !== t1 || $[25] !== theme.color ? (t15 = t1.map((r_1, i) => /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"rect\", { x: r_1.x, y: r_1.y, width: r_1.w, height: r_1.h, fill: theme.color.skeleton.from }, i)), $[24] = t1, $[25] = theme.color, $[26] = t15) : t15 = $[26];\n  let t16;\n  $[27] !== t15 || $[28] !== t2 || $[29] !== t3 ? (t16 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"svg\", { className: t2, viewBox: t3, children: t15 }), $[27] = t15, $[28] = t2, $[29] = t3, $[30] = t16) : t16 = $[30];\n  let t17;\n  $[31] !== t16 || $[32] !== t4 ? (t17 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(\"div\", { className: t4, children: t16 }), $[31] = t16, $[32] = t4, $[33] = t17) : t17 = $[33];\n  let t18;\n  $[34] !== T0 || $[35] !== t17 || $[36] !== t5 || $[37] !== t6 || $[38] !== t7 || $[39] !== t8 || $[40] !== t9 ? (t18 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(T0, { radius: t5, shadow: t6, overflow: t7, tone: t8, scheme: t9, children: t17 }), $[34] = T0, $[35] = t17, $[36] = t5, $[37] = t6, $[38] = t7, $[39] = t8, $[40] = t9, $[41] = t18) : t18 = $[41];\n  let t19;\n  return $[42] !== T1 || $[43] !== t10 || $[44] !== t11 || $[45] !== t12 || $[46] !== t13 || $[47] !== t14 || $[48] !== t18 ? (t19 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(T1, { $width: t10, $height: t11, $offsetX: t12, $offsetY: t13, $scaleFactor: t14, children: t18 }), $[42] = T1, $[43] = t10, $[44] = t11, $[45] = t12, $[46] = t13, $[47] = t14, $[48] = t18, $[49] = t19) : t19 = $[49], t19;\n};\nfunction _temp$7(r) {\n  return r.tagName === \"IMG\";\n}\nfunction _temp2$4(r_0) {\n  return r_0.tagName !== \"IMG\";\n}\nconst Root$1 = (0,styled_components__WEBPACK_IMPORTED_MODULE_9__.styled)((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Card))`\n  position: fixed;\n  bottom: 2rem;\n  left: 2rem;\n`, OverlayMinimapPrompt = () => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(2);\n  let t0;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t0 = {\n    zIndex: \"999999\"\n  }, $[0] = t0) : t0 = $[0];\n  let t1;\n  return $[1] === Symbol.for(\"react.memo_cache_sentinel\") ? (t1 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Root$1, { padding: 2, shadow: 2, radius: 2, style: t0, children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Flex, { align: \"center\", gap: 2, children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Hotkeys, { keys: [\"Shift\"] }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.Text, { size: 1, children: \"Zoom Out\" }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_icons__WEBPACK_IMPORTED_MODULE_6__.ExpandIcon, {})\n  ] }) }), $[1] = t1) : t1 = $[1], t1;\n}, elementsReducer = (elements, message) => {\n  const {\n    type\n  } = message;\n  switch (type) {\n    case \"element/register\":\n      return elements.find((e) => e.id === message.id) ? elements : [...elements, {\n        id: message.id,\n        activated: !1,\n        element: message.element,\n        focused: !1,\n        hovered: !1,\n        rect: message.rect,\n        sanity: message.sanity,\n        dragDisabled: message.dragDisabled\n      }];\n    case \"element/activate\":\n      return elements.map((e) => e.id === message.id ? {\n        ...e,\n        activated: !0\n      } : e);\n    case \"element/update\":\n      return elements.map((e) => e.id === message.id ? {\n        ...e,\n        sanity: message.sanity,\n        rect: message.rect\n      } : e);\n    case \"element/unregister\":\n      return elements.filter((e) => e.id !== message.id);\n    case \"element/deactivate\":\n      return elements.map((e) => e.id === message.id ? {\n        ...e,\n        activated: !1,\n        hovered: !1\n      } : e);\n    case \"element/mouseenter\":\n      return elements.map((e) => e.id === message.id ? {\n        ...e,\n        rect: message.rect,\n        hovered: !0\n      } : {\n        ...e,\n        hovered: !1\n      });\n    case \"element/mouseleave\":\n      return elements.map((element) => element.id === message.id ? {\n        ...element,\n        hovered: !1\n      } : element);\n    case \"element/updateRect\":\n      return elements.map((element) => element.id === message.id ? {\n        ...element,\n        rect: message.rect\n      } : element);\n    case \"element/click\":\n      return elements.map((e) => ({\n        ...e,\n        focused: e.id === message.id && \"clicked\"\n      }));\n    case \"overlay/blur\":\n      return elements.map((e) => ({\n        ...e,\n        focused: !1\n      }));\n    case \"presentation/blur\":\n      return elements.map((e) => ({\n        ...e,\n        focused: !1\n      }));\n    case \"presentation/focus\": {\n      const clickedElement = elements.find((e) => e.focused === \"clicked\");\n      return elements.map((e) => {\n        const focused = \"path\" in e.sanity && e.sanity.id === message.data.id && e.sanity.path === message.data.path;\n        return clickedElement && e === clickedElement && focused ? e : {\n          ...e,\n          // Mark as a dupe if another matching item has been clicked to prevent\n          // scrolling, otherwise just set focus as a boolean\n          focused: focused && clickedElement ? \"duplicate\" : focused\n        };\n      });\n    }\n    default:\n      return elements;\n  }\n};\nfunction overlayStateReducer(state, message) {\n  const {\n    type\n  } = message;\n  let {\n    contextMenu,\n    focusPath,\n    perspective,\n    isDragging,\n    dragInsertPosition,\n    dragShowMinimap,\n    dragShowMinimapPrompt,\n    dragSkeleton,\n    dragMinimapTransition,\n    dragGroupRect\n  } = state, wasMaybeCollapsed = !1;\n  if (type === \"presentation/focus\") {\n    const prevFocusPath = state.focusPath;\n    focusPath = message.data.path, prevFocusPath !== focusPath && (wasMaybeCollapsed = prevFocusPath.slice(focusPath.length).startsWith(\"[\"));\n  }\n  return type === \"presentation/perspective\" && (perspective = message.data.perspective), type === \"element/contextmenu\" && (\"sanity\" in message ? contextMenu = {\n    node: message.sanity,\n    position: message.position\n  } : contextMenu = null), (type === \"element/click\" || type === \"element/mouseleave\" || type === \"overlay/blur\" || type === \"presentation/blur\" || type === \"presentation/focus\") && (contextMenu = null), type === \"overlay/dragUpdateInsertPosition\" && (dragInsertPosition = message.insertPosition), type === \"overlay/dragStart\" && (isDragging = !0), message.type === \"overlay/dragUpdateSkeleton\" && (dragSkeleton = message.skeleton), type === \"overlay/dragEnd\" && (isDragging = !1), message.type === \"overlay/dragToggleMinimapPrompt\" && (dragShowMinimapPrompt = message.display), type === \"overlay/dragStartMinimapTransition\" && (dragMinimapTransition = !0), type === \"overlay/dragEndMinimapTransition\" && (dragMinimapTransition = !1), type === \"overlay/dragUpdateGroupRect\" && (dragGroupRect = message.groupRect), type === \"overlay/dragToggleMinimap\" && (dragShowMinimap = message.display), {\n    ...state,\n    contextMenu,\n    elements: elementsReducer(state.elements, message),\n    dragInsertPosition,\n    dragSkeleton,\n    dragGroupRect,\n    isDragging,\n    focusPath,\n    perspective,\n    wasMaybeCollapsed,\n    dragShowMinimap,\n    dragShowMinimapPrompt,\n    dragMinimapTransition\n  };\n}\nconst PreviewSnapshotsProvider = function(props) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(13), {\n    comlink,\n    children\n  } = props;\n  let t0;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t0 = [], $[0] = t0) : t0 = $[0];\n  const [previewSnapshots, setPreviewSnapshots] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(t0);\n  let t1;\n  $[1] !== comlink ? (t1 = async (signal) => {\n    if (comlink)\n      try {\n        const response = await comlink.fetch(\"visual-editing/preview-snapshots\", void 0, {\n          signal,\n          suppressWarnings: !0\n        });\n        setPreviewSnapshots(response.snapshots);\n      } catch {\n      }\n  }, $[1] = comlink, $[2] = t1) : t1 = $[2];\n  const fetchPreviewSnapshots = t1;\n  let t2, t3;\n  $[3] !== comlink || $[4] !== fetchPreviewSnapshots ? (t2 = () => {\n    if (!comlink)\n      return;\n    const previewSapshotsFetch = new AbortController(), unsub = comlink.onStatus(() => {\n      fetchPreviewSnapshots(previewSapshotsFetch.signal);\n    }, \"connected\");\n    return () => {\n      previewSapshotsFetch.abort(), unsub();\n    };\n  }, t3 = [comlink, fetchPreviewSnapshots], $[3] = comlink, $[4] = fetchPreviewSnapshots, $[5] = t2, $[6] = t3) : (t2 = $[5], t3 = $[6]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t2, t3);\n  let t4, t5;\n  $[7] !== comlink ? (t4 = () => comlink?.on(\"presentation/preview-snapshots\", (data) => {\n    setPreviewSnapshots(data.snapshots);\n  }), t5 = [comlink], $[7] = comlink, $[8] = t4, $[9] = t5) : (t4 = $[8], t5 = $[9]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t4, t5);\n  let t6;\n  t6 = previewSnapshots;\n  const context = t6;\n  let t7;\n  return $[10] !== children || $[11] !== context ? (t7 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(PreviewSnapshotsContext.Provider, { value: context, children }), $[10] = children, $[11] = context, $[12] = t7) : t7 = $[12], t7;\n};\nfunction isSanityNode(node) {\n  return \"path\" in node;\n}\nfunction isDocumentSchemaType(type) {\n  return type.type === \"document\";\n}\nfunction isTypeSchemaType(type) {\n  return type.type === \"type\";\n}\nfunction popUnkeyedPathSegments(path) {\n  return path.split(\".\").toReversed().reduce((acc, part) => acc.length ? [part, ...acc] : part.includes(\"[_key==\") ? [part] : [], []).join(\".\");\n}\nfunction getPathsWithUnresolvedTypes(elements) {\n  return elements.reduce((acc, element) => {\n    const {\n      sanity\n    } = element;\n    if (!(\"id\" in sanity) || !sanity.path.includes(\"[_key==\")) return acc;\n    const path = popUnkeyedPathSegments(sanity.path);\n    return acc.find((item) => item.id === sanity.id && item.path === path) || acc.push({\n      id: sanity.id,\n      path\n    }), acc;\n  }, []);\n}\nconst SchemaProvider = function(props) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(22), {\n    comlink,\n    children,\n    elements\n  } = props;\n  let t0;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t0 = /* @__PURE__ */ new Map(), $[0] = t0) : t0 = $[0];\n  const [resolvedTypes, setResolvedTypes] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(t0), [schema, setSchema] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null);\n  let t1, t2;\n  $[1] !== comlink ? (t1 = () => {\n    if (!comlink)\n      return;\n    const fetchSchema = async function(signal) {\n      if (comlink)\n        try {\n          const response = await comlink.fetch(\"visual-editing/schema\", void 0, {\n            signal,\n            suppressWarnings: !0\n          });\n          setSchema(response.schema);\n        } catch {\n        }\n    }, schemaFetch = new AbortController(), unsub = comlink.onStatus(() => {\n      fetchSchema(schemaFetch.signal);\n    }, \"connected\");\n    return () => {\n      schemaFetch.abort(), unsub();\n    };\n  }, t2 = [comlink], $[1] = comlink, $[2] = t1, $[3] = t2) : (t1 = $[2], t2 = $[3]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t1, t2);\n  let t3;\n  $[4] === Symbol.for(\"react.memo_cache_sentinel\") ? (t3 = [], $[4] = t3) : t3 = $[4];\n  const reportedPathsRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(t3), t4 = (0,react__WEBPACK_IMPORTED_MODULE_2__.useDeferredValue)(elements);\n  let t5;\n  $[5] !== t4 ? (t5 = getPathsWithUnresolvedTypes(t4), $[5] = t4, $[6] = t5) : t5 = $[6];\n  const paths = t5, controllerRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(null);\n  let t6, t7;\n  $[7] !== comlink || $[8] !== paths ? (t6 = () => {\n    if (!paths.length || !comlink)\n      return;\n    const reportPaths = async (paths_0, signal_0) => {\n      const initialReportedPaths = reportedPathsRef.current;\n      try {\n        reportedPathsRef.current = paths_0;\n        const response_0 = await comlink.fetch(\"visual-editing/schema-union-types\", {\n          paths: paths_0\n        }, {\n          signal: signal_0,\n          suppressWarnings: !0\n        });\n        if (signal_0.aborted)\n          return;\n        setResolvedTypes(response_0.types), controllerRef.current = null;\n      } catch {\n      }\n      signal_0.aborted && (reportedPathsRef.current = initialReportedPaths);\n    };\n    paths.some((p) => !reportedPathsRef.current.find((t82) => {\n      const {\n        id,\n        path\n      } = t82;\n      return id === p.id && path === p.path;\n    })) && (controllerRef.current?.abort(), controllerRef.current = new AbortController(), reportPaths(paths, controllerRef.current.signal));\n  }, t7 = [comlink, paths], $[7] = comlink, $[8] = paths, $[9] = t6, $[10] = t7) : (t6 = $[9], t7 = $[10]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t6, t7);\n  let t8;\n  $[11] !== schema ? (t8 = (node, _type) => {\n    const type = _type || \"document\";\n    if (!schema || typeof node != \"string\" && (!isSanityNode(node) || !Array.isArray(schema)))\n      return;\n    const name = typeof node == \"string\" ? node : node.type, filter = type === \"document\" ? isDocumentSchemaType : isTypeSchemaType;\n    return schema.filter(filter).find((schemaType) => schemaType.name === name);\n  }, $[11] = schema, $[12] = t8) : t8 = $[12];\n  const getType = t8;\n  let t9;\n  $[13] !== getType || $[14] !== resolvedTypes ? (t9 = (node_0) => {\n    if (!isSanityNode(node_0))\n      return {\n        field: void 0,\n        parent: void 0\n      };\n    const schemaType_0 = getType(node_0);\n    if (!schemaType_0)\n      return {\n        field: void 0,\n        parent: void 0\n      };\n    function fieldFromPath(schemaType_1, path_0, parent, t102) {\n      const prevPath = t102 === void 0 ? [] : t102;\n      if (!schemaType_1)\n        return {\n          field: void 0,\n          parent: void 0\n        };\n      const [next, ...rest] = path_0;\n      if (\"fields\" in schemaType_1) {\n        const objectField = schemaType_1.fields[next];\n        if (!objectField && \"rest\" in schemaType_1)\n          return fieldFromPath(schemaType_1.rest, path_0, schemaType_1, prevPath);\n        if (!rest.length)\n          return {\n            field: objectField,\n            parent\n          };\n        if (!objectField)\n          throw new Error(`[@sanity/visual-editing] No field could be resolved at path: \"${[...prevPath, ...path_0].join(\".\")}\"`);\n        return fieldFromPath(objectField.value, rest, schemaType_1, [...prevPath, next]);\n      } else {\n        if (schemaType_1.type === \"array\")\n          return fieldFromPath(schemaType_1.of, path_0, schemaType_1, prevPath);\n        if (schemaType_1.type === \"arrayItem\")\n          return rest.length ? fieldFromPath(schemaType_1.value, rest, schemaType_1, [...prevPath, next]) : {\n            field: schemaType_1,\n            parent\n          };\n        if (schemaType_1.type === \"union\") {\n          const name_0 = next.startsWith(\"[_key==\") ? resolvedTypes?.get(node_0.id)?.get([prevPath.join(\".\"), next].filter(Boolean).join(\"\")) : next;\n          return fieldFromPath(schemaType_1.of.find((item) => item.type === \"unionOption\" ? item.name === name_0 : item), rest, schemaType_1, [...prevPath, next]);\n        } else {\n          if (schemaType_1.type === \"unionOption\")\n            return next ? fieldFromPath(schemaType_1.value, path_0, schemaType_1, prevPath) : {\n              field: schemaType_1,\n              parent\n            };\n          if (schemaType_1.type === \"inline\") {\n            const type_0 = getType(schemaType_1.name, \"type\");\n            return fieldFromPath(type_0.value, path_0, schemaType_1, prevPath);\n          }\n        }\n      }\n      throw new Error(`[@sanity/visual-editing] No field could be resolved at path: \"${[...prevPath, ...path_0].join(\".\")}\"`);\n    }\n    const nodePath = node_0.path.split(\".\").flatMap(_temp$6);\n    try {\n      return fieldFromPath(schemaType_0, nodePath, void 0);\n    } catch (t112) {\n      const e = t112;\n      return e instanceof Error && console.warn(e.message), {\n        field: void 0,\n        parent: void 0\n      };\n    }\n  }, $[13] = getType, $[14] = resolvedTypes, $[15] = t9) : t9 = $[15];\n  const getField = t9;\n  let t10, t11;\n  $[16] !== getField || $[17] !== getType ? (t11 = {\n    getField,\n    getType\n  }, $[16] = getField, $[17] = getType, $[18] = t11) : t11 = $[18], t10 = t11;\n  const context = t10;\n  let t12;\n  return $[19] !== children || $[20] !== context ? (t12 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SchemaContext.Provider, { value: context, children }), $[19] = children, $[20] = context, $[21] = t12) : t12 = $[21], t12;\n};\nfunction _temp$6(part) {\n  return part.includes(\"[\") ? part.split(/(\\[.+\\])/, 2) : [part];\n}\nconst createStore = (initialState) => {\n  let state = initialState;\n  const getState = () => state, listeners = /* @__PURE__ */ new Set();\n  return {\n    getState,\n    setState: (fn) => {\n      state = fn(state), listeners.forEach((l) => l());\n    },\n    subscribe: (listener) => (listeners.add(listener), () => listeners.delete(listener))\n  };\n}, store = createStore({}), SharedStateProvider = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(11), {\n    comlink,\n    children\n  } = props;\n  let t0, t1;\n  $[0] !== comlink ? (t0 = () => comlink?.on(\"presentation/shared-state\", _temp$5), t1 = [comlink], $[0] = comlink, $[1] = t0, $[2] = t1) : (t0 = $[1], t1 = $[2]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1);\n  let t2, t3;\n  $[3] !== comlink ? (t2 = () => {\n    (async function() {\n      const value = await comlink?.fetch(\"visual-editing/shared-state\", void 0, {\n        suppressWarnings: !0\n      });\n      value && store.setState(() => value.state);\n    })().catch(_temp2$3);\n  }, t3 = [comlink], $[3] = comlink, $[4] = t2, $[5] = t3) : (t2 = $[4], t3 = $[5]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t2, t3);\n  let t4, t5;\n  $[6] !== comlink ? (t5 = {\n    comlink,\n    store\n  }, $[6] = comlink, $[7] = t5) : t5 = $[7], t4 = t5;\n  const value_0 = t4;\n  let t6;\n  return $[8] !== children || $[9] !== value_0 ? (t6 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_chunks_es_SharedStateContext_js__WEBPACK_IMPORTED_MODULE_13__.SharedStateContext.Provider, { value: value_0, children }), $[8] = children, $[9] = value_0, $[10] = t6) : t6 = $[10], t6;\n};\nfunction _temp$5(data) {\n  \"value\" in data ? store.setState((prev) => ({\n    ...prev,\n    [data.key]: data.value\n  })) : store.setState((prev_0) => Object.fromEntries(Object.entries(prev_0).filter((t0) => {\n    const [key] = t0;\n    return key !== data.key;\n  })));\n}\nfunction _temp2$3(reason) {\n  console.debug(reason), console.warn(\"[@sanity/visual-editing]: Failed to fetch shared state. Check your version of `sanity` is up-to-date\");\n}\nconst TelemetryProvider = (t0) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(5), {\n    children,\n    comlink\n  } = t0;\n  let t1;\n  $[0] !== comlink ? (t1 = (name, data) => {\n    if (!comlink)\n      return;\n    const event = _chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.events[name];\n    if (event)\n      comlink.post(\"visual-editing/telemetry-log\", {\n        event,\n        data\n      });\n    else\n      throw new Error(`Telemetry event: ${name} does not exist`);\n  }, $[0] = comlink, $[1] = t1) : t1 = $[1];\n  const log = t1;\n  let t2;\n  return $[2] !== children || $[3] !== log ? (t2 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.TelemetryContext.Provider, { value: log, children }), $[2] = children, $[3] = log, $[4] = t2) : t2 = $[4], t2;\n};\nfunction useController(element, handler, inFrame, inPopUp) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(7), overlayController = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(void 0), optimisticActorReady = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useOptimisticActorReady)();\n  let t0, t1;\n  return $[0] !== element || $[1] !== handler || $[2] !== inFrame || $[3] !== inPopUp || $[4] !== optimisticActorReady ? (t0 = () => {\n    if (element)\n      return overlayController.current = (0,_chunks_es_SharedStateContext_js__WEBPACK_IMPORTED_MODULE_13__.createOverlayController)({\n        handler,\n        overlayElement: element,\n        inFrame,\n        inPopUp,\n        optimisticActorReady\n      }), () => {\n        overlayController.current?.destroy(), overlayController.current = void 0;\n      };\n  }, t1 = [element, handler, inFrame, inPopUp, optimisticActorReady], $[0] = element, $[1] = handler, $[2] = inFrame, $[3] = inPopUp, $[4] = optimisticActorReady, $[5] = t0, $[6] = t1) : (t0 = $[5], t1 = $[6]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1), overlayController;\n}\nfunction usePerspectiveSync(comlink, dispatch) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(4);\n  let t0, t1;\n  $[0] !== comlink || $[1] !== dispatch ? (t0 = () => {\n    const controller = new AbortController();\n    comlink?.fetch(\"visual-editing/fetch-perspective\", void 0, {\n      signal: controller.signal,\n      suppressWarnings: !0\n    }).then((data) => {\n      dispatch({\n        type: \"presentation/perspective\",\n        data\n      });\n    }).catch(_temp$4);\n    const unsub = comlink?.on(\"presentation/perspective\", (data_0) => {\n      dispatch({\n        type: \"presentation/perspective\",\n        data: data_0\n      });\n    });\n    return () => {\n      unsub?.(), controller.abort();\n    };\n  }, t1 = [comlink, dispatch], $[0] = comlink, $[1] = dispatch, $[2] = t0, $[3] = t1) : (t0 = $[2], t1 = $[3]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1);\n}\nfunction _temp$4() {\n}\nfunction isEqualSets(a, b) {\n  if (a === b) return !0;\n  if (a.size !== b.size) return !1;\n  for (const value of a) if (!b.has(value)) return !1;\n  return !0;\n}\nfunction useReportDocuments(comlink, elements, perspective) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(7), lastReported = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(void 0);\n  let t0;\n  $[0] !== comlink ? (t0 = (documents, perspective_0) => {\n    comlink?.post(\"visual-editing/documents\", {\n      documents,\n      perspective: perspective_0\n    });\n  }, $[0] = comlink, $[1] = t0) : t0 = $[1];\n  const reportDocuments = t0;\n  let t1, t2;\n  $[2] !== elements || $[3] !== perspective || $[4] !== reportDocuments ? (t1 = () => {\n    const nodes = elements.map(_temp$3).filter(_temp2$2), nodeIds = new Set(nodes.map(_temp3$1));\n    if (!lastReported.current || !isEqualSets(nodeIds, lastReported.current.nodeIds) || perspective !== lastReported.current.perspective) {\n      const documentsOnPage = Array.from(nodeIds).map((_id) => {\n        const node_0 = nodes.find((node) => node.id === _id), {\n          type,\n          projectId: _projectId,\n          dataset: _dataset\n        } = node_0;\n        return _projectId && _dataset ? {\n          _id,\n          _type: type,\n          _projectId,\n          _dataset\n        } : {\n          _id,\n          _type: type\n        };\n      });\n      lastReported.current = {\n        nodeIds,\n        perspective\n      }, reportDocuments(documentsOnPage, perspective);\n    }\n  }, t2 = [elements, perspective, reportDocuments], $[2] = elements, $[3] = perspective, $[4] = reportDocuments, $[5] = t1, $[6] = t2) : (t1 = $[5], t2 = $[6]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t1, t2);\n}\nfunction _temp3$1(e_0) {\n  return e_0.id;\n}\nfunction _temp2$2(s) {\n  return !!s;\n}\nfunction _temp$3(e) {\n  const {\n    sanity\n  } = e;\n  return \"id\" in sanity ? sanity : null;\n}\nconst Root = styled_components__WEBPACK_IMPORTED_MODULE_9__.styled.div`\n  background-color: transparent;\n  direction: ltr;\n  inset: 0;\n  pointer-events: none;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: ${({\n  $zIndex\n}) => $zIndex ?? \"9999999\"};\n`;\nfunction raf2(fn) {\n  let r0, r1;\n  return r0 = requestAnimationFrame(() => {\n    r1 = requestAnimationFrame(fn);\n  }), () => {\n    r0 !== void 0 && cancelAnimationFrame(r0), r1 !== void 0 && cancelAnimationFrame(r1);\n  };\n}\nconst DocumentReporter = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(8), {\n    documentIds\n  } = props;\n  let t0;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t0 = [], $[0] = t0) : t0 = $[0];\n  const [uniqueIds, setUniqueIds] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(t0);\n  let t1, t2;\n  $[1] !== documentIds ? (t1 = () => {\n    setUniqueIds((prev) => {\n      const next = Array.from(new Set(documentIds));\n      return prev.length === next.length && prev.reduce(_temp$2, next)?.length === 0 ? prev : next;\n    });\n  }, t2 = [documentIds], $[1] = documentIds, $[2] = t1, $[3] = t2) : (t1 = $[2], t2 = $[3]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t1, t2);\n  const actor = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useOptimisticActor)();\n  let t3, t4;\n  return $[4] !== actor || $[5] !== uniqueIds ? (t3 = () => {\n    for (const id_0 of uniqueIds)\n      actor.send({\n        type: \"observe\",\n        documentId: (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__.getDraftId)(id_0)\n      }), actor.send({\n        type: \"observe\",\n        documentId: (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__.getPublishedId)(id_0)\n      });\n    return () => {\n      for (const id_1 of uniqueIds)\n        actor.send({\n          type: \"unobserve\",\n          documentId: (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__.getDraftId)(id_1)\n        }), actor.send({\n          type: \"unobserve\",\n          documentId: (0,_sanity_client_csm__WEBPACK_IMPORTED_MODULE_10__.getPublishedId)(id_1)\n        });\n    };\n  }, t4 = [actor, uniqueIds], $[4] = actor, $[5] = uniqueIds, $[6] = t3, $[7] = t4) : (t3 = $[6], t4 = $[7]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t3, t4), null;\n}, OverlaysController = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(12), {\n    comlink,\n    dispatch,\n    inFrame,\n    inPopUp,\n    onDrag,\n    overlayEnabled,\n    rootElement\n  } = props, {\n    dispatchDragEndEvent\n  } = useDragEndEvents(), sendTelemetry = (0,_chunks_es_PointerEvents_js__WEBPACK_IMPORTED_MODULE_7__.useTelemetry)();\n  let t0;\n  $[0] !== comlink || $[1] !== dispatch || $[2] !== dispatchDragEndEvent || $[3] !== onDrag || $[4] !== sendTelemetry ? (t0 = (message) => {\n    if (message.type === \"element/click\") {\n      const {\n        sanity\n      } = message;\n      comlink?.post(\"visual-editing/focus\", sanity), sendTelemetry(\"Visual Editing Overlay Clicked\", null);\n    } else if (message.type === \"overlay/activate\")\n      comlink?.post(\"visual-editing/toggle\", {\n        enabled: !0\n      });\n    else if (message.type === \"overlay/deactivate\")\n      comlink?.post(\"visual-editing/toggle\", {\n        enabled: !1\n      });\n    else if (message.type === \"overlay/dragEnd\") {\n      const {\n        insertPosition,\n        target,\n        dragGroup,\n        flow,\n        preventInsertDefault\n      } = message;\n      dispatchDragEndEvent({\n        insertPosition,\n        target,\n        dragGroup,\n        flow,\n        preventInsertDefault\n      }), insertPosition && sendTelemetry(\"Visual Editing Drag Sequence Completed\", null);\n    } else if (message.type === \"overlay/dragUpdateCursorPosition\") {\n      onDrag(message.x, message.y);\n      return;\n    } else if (message.type === \"overlay/dragToggleMinimap\" && message.display === !0)\n      sendTelemetry(\"Visual Editing Drag Minimap Enabled\", null);\n    else if (message.type === \"overlay/setCursor\") {\n      const {\n        element,\n        cursor\n      } = message;\n      cursor ? element.style.cursor = cursor : element.style.removeProperty(\"cursor\");\n    }\n    dispatch(message);\n  }, $[0] = comlink, $[1] = dispatch, $[2] = dispatchDragEndEvent, $[3] = onDrag, $[4] = sendTelemetry, $[5] = t0) : t0 = $[5];\n  const controller = useController(rootElement, t0, inFrame, inPopUp);\n  let t1;\n  $[6] !== controller.current || $[7] !== overlayEnabled ? (t1 = () => {\n    overlayEnabled ? controller.current?.activate() : controller.current?.deactivate();\n  }, $[6] = controller.current, $[7] = overlayEnabled, $[8] = t1) : t1 = $[8];\n  let t2;\n  return $[9] !== controller || $[10] !== overlayEnabled ? (t2 = [controller, overlayEnabled], $[9] = controller, $[10] = overlayEnabled, $[11] = t2) : t2 = $[11], (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t1, t2), null;\n}, Overlays = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(74), {\n    comlink,\n    comlinkStatus,\n    componentResolver: _componentResolver,\n    inFrame,\n    inPopUp,\n    zIndex\n  } = props, prefersDark = (0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.usePrefersDark)();\n  let t0;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t0 = {\n    contextMenu: null,\n    dragInsertPosition: null,\n    dragShowMinimap: !1,\n    dragShowMinimapPrompt: !1,\n    dragSkeleton: null,\n    elements: [],\n    focusPath: \"\",\n    isDragging: !1,\n    perspective: \"published\",\n    wasMaybeCollapsed: !1,\n    dragMinimapTransition: !1,\n    dragGroupRect: null\n  }, $[0] = t0) : t0 = $[0];\n  const [t1, dispatch] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useReducer)(overlayStateReducer, t0), {\n    contextMenu,\n    dragInsertPosition,\n    dragShowMinimap,\n    dragShowMinimapPrompt,\n    dragSkeleton,\n    elements,\n    isDragging,\n    perspective,\n    wasMaybeCollapsed,\n    dragMinimapTransition,\n    dragGroupRect\n  } = t1, [rootElement, setRootElement] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null), [overlayEnabled, setOverlayEnabled] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(!0);\n  let t2, t3;\n  $[1] !== comlink ? (t2 = () => {\n    const unsubs = [comlink?.on(\"presentation/focus\", (data) => {\n      dispatch({\n        type: \"presentation/focus\",\n        data\n      });\n    }), comlink?.on(\"presentation/blur\", (data_0) => {\n      dispatch({\n        type: \"presentation/blur\",\n        data: data_0\n      });\n    }), comlink?.on(\"presentation/toggle-overlay\", () => {\n      setOverlayEnabled(_temp2$1);\n    })].filter(Boolean);\n    return () => unsubs.forEach(_temp3);\n  }, t3 = [comlink], $[1] = comlink, $[2] = t2, $[3] = t3) : (t2 = $[2], t3 = $[3]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t2, t3), usePerspectiveSync(comlink, dispatch), useReportDocuments(comlink, elements, perspective);\n  let t4;\n  $[4] !== rootElement ? (t4 = (x, y) => {\n    rootElement && (rootElement.style.setProperty(\"--drag-preview-x\", `${x}px`), rootElement.style.setProperty(\"--drag-preview-y\", `${y - window.scrollY}px`));\n  }, $[4] = rootElement, $[5] = t4) : t4 = $[5];\n  const updateDragPreviewCustomProps = t4;\n  let t5, t6;\n  $[6] === Symbol.for(\"react.memo_cache_sentinel\") ? (t5 = () => {\n    const handleClick = _temp4, handleKeyUp = (e) => {\n      isAltKey(e) && setOverlayEnabled(_temp5);\n    }, handleKeydown = (e_0) => {\n      isAltKey(e_0) && setOverlayEnabled(_temp6), isHotkey([\"mod\", \"\\\\\"], e_0) && setOverlayEnabled(_temp7);\n    };\n    return window.addEventListener(\"click\", handleClick), window.addEventListener(\"keydown\", handleKeydown), window.addEventListener(\"keyup\", handleKeyUp), () => {\n      window.removeEventListener(\"click\", handleClick), window.removeEventListener(\"keydown\", handleKeydown), window.removeEventListener(\"keyup\", handleKeyUp);\n    };\n  }, t6 = [setOverlayEnabled], $[6] = t5, $[7] = t6) : (t5 = $[6], t6 = $[7]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t5, t6);\n  const [overlaysFlash, setOverlaysFlash] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(!1), [fadingOut, setFadingOut] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(!1), fadeOutTimeoutRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(void 0);\n  let t7, t8;\n  $[8] !== overlayEnabled ? (t7 = () => {\n    if (overlayEnabled)\n      return raf2(() => {\n        setOverlaysFlash(!0), raf2(() => {\n          setFadingOut(!0), fadeOutTimeoutRef.current = setTimeout(() => {\n            setFadingOut(!1), setOverlaysFlash(!1);\n          }, 1500);\n        });\n      });\n    fadeOutTimeoutRef.current && (clearTimeout(fadeOutTimeoutRef.current), setOverlaysFlash(!1), setFadingOut(!1));\n  }, t8 = [overlayEnabled], $[8] = overlayEnabled, $[9] = t7, $[10] = t8) : (t7 = $[9], t8 = $[10]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t7, t8);\n  let t9, t10;\n  $[11] !== elements ? (t10 = elements.flatMap(_temp8), $[11] = elements, $[12] = t10) : t10 = $[12], t9 = t10;\n  const documentIds = t9;\n  let t11;\n  $[13] === Symbol.for(\"react.memo_cache_sentinel\") ? (t11 = () => {\n    dispatch({\n      type: \"overlay/blur\"\n    });\n  }, $[13] = t11) : t11 = $[13];\n  const closeContextMenu = t11, optimisticActorReady = (0,_chunks_es_mutations_js__WEBPACK_IMPORTED_MODULE_4__.useOptimisticActorReady)();\n  let t12;\n  t12 = optimisticActorReady ? _componentResolver : void 0;\n  const componentResolver = t12;\n  let t13;\n  bb0: {\n    if ((inFrame || inPopUp) && comlinkStatus !== \"connected\" || isDragging) {\n      let t143;\n      $[14] === Symbol.for(\"react.memo_cache_sentinel\") ? (t143 = [], $[14] = t143) : t143 = $[14], t13 = t143;\n      break bb0;\n    }\n    let t142;\n    $[15] !== componentResolver || $[16] !== dragMinimapTransition || $[17] !== dragShowMinimap || $[18] !== elements || $[19] !== inFrame || $[20] !== isDragging || $[21] !== optimisticActorReady || $[22] !== wasMaybeCollapsed ? (t142 = elements.filter(_temp9).map((t152) => {\n      const {\n        id,\n        element: element_0,\n        focused,\n        hovered,\n        rect,\n        sanity,\n        dragDisabled\n      } = t152, draggable = !dragDisabled && !!element_0.getAttribute(\"data-sanity\") && optimisticActorReady && elements.some((e_2) => \"id\" in e_2.sanity && \"id\" in sanity ? (0,_chunks_es_SharedStateContext_js__WEBPACK_IMPORTED_MODULE_13__.sanityNodesExistInSameArray)(e_2.sanity, sanity) && e_2.sanity.path !== sanity.path : !1);\n      return /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ElementOverlay, { componentResolver, element: element_0, enableScrollIntoView: !isDragging && !dragMinimapTransition && !dragShowMinimap, focused, hovered, node: sanity, rect, showActions: !inFrame, draggable, isDragging: isDragging || dragMinimapTransition, wasMaybeCollapsed: focused && wasMaybeCollapsed }, id);\n    }), $[15] = componentResolver, $[16] = dragMinimapTransition, $[17] = dragShowMinimap, $[18] = elements, $[19] = inFrame, $[20] = isDragging, $[21] = optimisticActorReady, $[22] = wasMaybeCollapsed, $[23] = t142) : t142 = $[23], t13 = t142;\n  }\n  const elementsToRender = t13, t14 = prefersDark ? \"dark\" : \"light\", t15 = fadingOut ? \"\" : void 0, t16 = overlaysFlash ? \"\" : void 0;\n  let t17;\n  $[24] !== documentIds || $[25] !== perspective ? (t17 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(DocumentReporter, { documentIds, perspective }), $[24] = documentIds, $[25] = perspective, $[26] = t17) : t17 = $[26];\n  let t18;\n  $[27] !== comlink || $[28] !== inFrame || $[29] !== inPopUp || $[30] !== overlayEnabled || $[31] !== rootElement || $[32] !== updateDragPreviewCustomProps ? (t18 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(OverlaysController, { comlink, dispatch, inFrame, inPopUp, onDrag: updateDragPreviewCustomProps, overlayEnabled, rootElement }), $[27] = comlink, $[28] = inFrame, $[29] = inPopUp, $[30] = overlayEnabled, $[31] = rootElement, $[32] = updateDragPreviewCustomProps, $[33] = t18) : t18 = $[33];\n  let t19;\n  $[34] !== contextMenu ? (t19 = contextMenu && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(ContextMenu, { ...contextMenu, onDismiss: closeContextMenu }), $[34] = contextMenu, $[35] = t19) : t19 = $[35];\n  let t20;\n  $[36] !== dragGroupRect || $[37] !== dragInsertPosition || $[38] !== dragMinimapTransition || $[39] !== dragShowMinimapPrompt || $[40] !== isDragging ? (t20 = isDragging && !dragMinimapTransition && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n    dragInsertPosition && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(OverlayDragInsertMarker, { dragInsertPosition }),\n    dragShowMinimapPrompt && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(OverlayMinimapPrompt, {}),\n    dragGroupRect && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(OverlayDragGroupRect, { dragGroupRect })\n  ] }), $[36] = dragGroupRect, $[37] = dragInsertPosition, $[38] = dragMinimapTransition, $[39] = dragShowMinimapPrompt, $[40] = isDragging, $[41] = t20) : t20 = $[41];\n  let t21;\n  $[42] !== dragSkeleton || $[43] !== isDragging ? (t21 = isDragging && dragSkeleton && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(OverlayDragPreview, { skeleton: dragSkeleton }), $[42] = dragSkeleton, $[43] = isDragging, $[44] = t21) : t21 = $[44];\n  let t22;\n  $[45] !== elementsToRender || $[46] !== t15 || $[47] !== t16 || $[48] !== t17 || $[49] !== t18 || $[50] !== t19 || $[51] !== t20 || $[52] !== t21 || $[53] !== zIndex ? (t22 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(Root, { \"data-fading-out\": t15, \"data-overlays\": t16, ref: setRootElement, $zIndex: zIndex, children: [\n    t17,\n    t18,\n    t19,\n    elementsToRender,\n    t20,\n    t21\n  ] }), $[45] = elementsToRender, $[46] = t15, $[47] = t16, $[48] = t17, $[49] = t18, $[50] = t19, $[51] = t20, $[52] = t21, $[53] = zIndex, $[54] = t22) : t22 = $[54];\n  let t23;\n  $[55] !== comlink || $[56] !== t22 ? (t23 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SharedStateProvider, { comlink, children: t22 }), $[55] = comlink, $[56] = t22, $[57] = t23) : t23 = $[57];\n  let t24;\n  $[58] !== comlink || $[59] !== t23 ? (t24 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(PreviewSnapshotsProvider, { comlink, children: t23 }), $[58] = comlink, $[59] = t23, $[60] = t24) : t24 = $[60];\n  let t25;\n  $[61] !== comlink || $[62] !== elements || $[63] !== t24 ? (t25 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(SchemaProvider, { comlink, elements, children: t24 }), $[61] = comlink, $[62] = elements, $[63] = t24, $[64] = t25) : t25 = $[64];\n  let t26;\n  $[65] !== rootElement || $[66] !== t25 ? (t26 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.LayerProvider, { children: /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.PortalProvider, { element: rootElement, children: t25 }) }), $[65] = rootElement, $[66] = t25, $[67] = t26) : t26 = $[67];\n  let t27;\n  $[68] !== t14 || $[69] !== t26 ? (t27 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.ThemeProvider, { scheme: t14, theme: _sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.studioTheme, tone: \"transparent\", children: t26 }), $[68] = t14, $[69] = t26, $[70] = t27) : t27 = $[70];\n  let t28;\n  return $[71] !== comlink || $[72] !== t27 ? (t28 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(TelemetryProvider, { comlink, children: t27 }), $[71] = comlink, $[72] = t27, $[73] = t28) : t28 = $[73], t28;\n}, IS_MAC = typeof window < \"u\" && /Mac|iPod|iPhone|iPad/.test(window.navigator.platform), MODIFIERS = {\n  alt: \"altKey\",\n  ctrl: \"ctrlKey\",\n  mod: IS_MAC ? \"metaKey\" : \"ctrlKey\",\n  shift: \"shiftKey\"\n};\nfunction isHotkey(keys, event) {\n  return keys.every((key) => MODIFIERS[key] ? event[MODIFIERS[key]] : event.key === key.toUpperCase());\n}\nfunction isAltKey(event) {\n  return event.key === \"Alt\";\n}\nfunction _temp$2(acc, prevId) {\n  return acc.filter((id) => id !== prevId);\n}\nfunction _temp2$1(enabled) {\n  return !enabled;\n}\nfunction _temp3(unsub) {\n  return unsub();\n}\nfunction _temp4(event) {\n  const target = event.target;\n  if (((0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.isHTMLAnchorElement)(target) || (0,_sanity_ui_visual_editing__WEBPACK_IMPORTED_MODULE_8__.isHTMLElement)(target) && target.closest(\"a\")) && event.altKey) {\n    event.preventDefault(), event.stopPropagation();\n    const newEvent = new MouseEvent(event.type, {\n      ...event,\n      altKey: !1,\n      bubbles: !0,\n      cancelable: !0\n    });\n    event.target?.dispatchEvent(newEvent);\n  }\n}\nfunction _temp5(enabled_0) {\n  return !enabled_0;\n}\nfunction _temp6(enabled_1) {\n  return !enabled_1;\n}\nfunction _temp7(enabled_2) {\n  return !enabled_2;\n}\nfunction _temp8(element) {\n  return \"id\" in element.sanity ? [element.sanity.id] : [];\n}\nfunction _temp9(e_1) {\n  return e_1.activated || e_1.focused;\n}\nconst Refresh = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(4), {\n    comlink,\n    refresh\n  } = props, manualRefreshRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(0), mutationRefreshRef = (0,react__WEBPACK_IMPORTED_MODULE_2__.useRef)(0);\n  let t0, t1;\n  return $[0] !== comlink || $[1] !== refresh ? (t0 = () => comlink.on(\"presentation/refresh\", (data) => {\n    if (data.source === \"manual\") {\n      clearTimeout(manualRefreshRef.current);\n      const promise = refresh(data);\n      if (promise === !1)\n        return;\n      comlink.post(\"visual-editing/refreshing\", data);\n      let timedOut;\n      timedOut = !1, manualRefreshRef.current = window.setTimeout(() => {\n        comlink.post(\"visual-editing/refreshed\", data), timedOut = !0;\n      }, 3e3), promise?.finally?.(() => {\n        timedOut || (clearTimeout(manualRefreshRef.current), comlink.post(\"visual-editing/refreshed\", data));\n      });\n    } else if (data.source === \"mutation\") {\n      clearTimeout(mutationRefreshRef.current);\n      const promise_0 = refresh(data);\n      if (promise_0 === !1)\n        return;\n      comlink.post(\"visual-editing/refreshing\", data), mutationRefreshRef.current = window.setTimeout(() => {\n        const promise_1 = refresh(data);\n        promise_1 !== !1 && (comlink.post(\"visual-editing/refreshing\", data), promise_1?.finally?.(() => {\n          comlink.post(\"visual-editing/refreshed\", data);\n        }) || comlink.post(\"visual-editing/refreshed\", data));\n      }, 1e3), promise_0?.finally?.(() => {\n        comlink.post(\"visual-editing/refreshed\", data);\n      }) || comlink.post(\"visual-editing/refreshed\", data);\n    }\n  }), t1 = [comlink, refresh], $[0] = comlink, $[1] = refresh, $[2] = t0, $[3] = t1) : (t0 = $[2], t1 = $[3]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1), null;\n};\nfunction useComlink(t0) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(9), active = t0 === void 0 ? !0 : t0, [node, setNode] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(), [status, setStatus] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(\"idle\");\n  let t1, t2;\n  $[0] !== active ? (t1 = () => {\n    if (!active)\n      return;\n    const instance = (0,_sanity_comlink__WEBPACK_IMPORTED_MODULE_14__.createNode)({\n      name: \"visual-editing\",\n      connectTo: \"presentation\"\n    }, (0,_sanity_comlink__WEBPACK_IMPORTED_MODULE_14__.createNodeMachine)().provide({\n      actors: (0,_sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_15__.createCompatibilityActors)()\n    })), unsub = instance.onStatus(() => setStatus(\"connected\"), \"connected\");\n    setNode(instance);\n    const stop = instance.start();\n    return () => {\n      unsub(), stop(), setNode(void 0);\n    };\n  }, t2 = [active], $[0] = active, $[1] = t1, $[2] = t2) : (t1 = $[1], t2 = $[2]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t1, t2);\n  let t3, t4;\n  $[3] !== status ? (t3 = () => {\n    if (status === \"connected\")\n      return;\n    const controller = new AbortController();\n    return window.addEventListener(\"message\", _temp$1, {\n      signal: controller.signal\n    }), () => {\n      controller.abort();\n    };\n  }, t4 = [status], $[3] = status, $[4] = t3, $[5] = t4) : (t3 = $[4], t4 = $[5]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t3, t4);\n  let t5;\n  return $[6] !== node || $[7] !== status ? (t5 = [node, status], $[6] = node, $[7] = status, $[8] = t5) : t5 = $[8], t5;\n}\nfunction _temp$1(t0) {\n  const {\n    data,\n    origin\n  } = t0;\n  data && typeof data == \"object\" && \"domain\" in data && data.domain === \"sanity/channels\" && \"from\" in data && data.from === \"presentation\" && \"type\" in data && data.type === \"presentation/status\" && window.parent.postMessage({\n    domain: \"sanity/channels\",\n    type: \"visual-editing/status\",\n    data: {\n      origin: location.origin\n    }\n  }, origin);\n}\nfunction createSharedListener(comlink) {\n  const incomingConnection$ = new rxjs__WEBPACK_IMPORTED_MODULE_16__.ReplaySubject(1), incomingMutations$ = new rxjs__WEBPACK_IMPORTED_MODULE_17__.Subject();\n  return comlink.fetch(\"visual-editing/snapshot-welcome\", void 0, {\n    suppressWarnings: !0\n  }).then((data) => {\n    incomingConnection$.next(data.event);\n  }).catch(() => {\n  }), comlink.on(\"presentation/snapshot-event\", (data) => {\n    data.event.type === \"reconnect\" && incomingConnection$.next(data.event), data.event.type === \"mutation\" && incomingMutations$.next(data.event);\n  }), (0,rxjs__WEBPACK_IMPORTED_MODULE_18__.merge)(incomingConnection$, incomingMutations$);\n}\nfunction useDatasetMutator(comlink) {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(3);\n  let t0, t1;\n  $[0] !== comlink ? (t0 = () => {\n    if (!comlink)\n      return;\n    const listener = createSharedListener(comlink), datasetMutator = (0,_optimistic_index_js__WEBPACK_IMPORTED_MODULE_19__.createDatasetMutator)(comlink), mutator = (0,xstate__WEBPACK_IMPORTED_MODULE_20__.A)(datasetMutator, {\n      input: {\n        client: {\n          withConfig: _temp\n        },\n        sharedListener: listener\n      }\n    });\n    mutator.start();\n    const featuresFetch = new AbortController();\n    return comlink.fetch(\"visual-editing/features\", void 0, {\n      signal: featuresFetch.signal,\n      suppressWarnings: !0\n    }).then((data) => {\n      data.features.optimistic && (0,_chunks_es_context_js__WEBPACK_IMPORTED_MODULE_21__.setActor)(mutator);\n    }).catch(_temp2), () => {\n      mutator.stop(), featuresFetch.abort();\n    };\n  }, t1 = [comlink], $[0] = comlink, $[1] = t0, $[2] = t1) : (t0 = $[1], t1 = $[2]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t0, t1);\n}\nfunction _temp2() {\n  console.warn(\"[@sanity/visual-editing] Package version mismatch detected: Please update your Sanity studio to prevent potential compatibility issues.\");\n}\nfunction _temp() {\n}\nconst VisualEditing = (props) => {\n  const $ = (0,react_compiler_runtime__WEBPACK_IMPORTED_MODULE_1__.c)(22), {\n    components,\n    history,\n    portal: t0,\n    refresh,\n    zIndex\n  } = props, portal = t0 === void 0 ? !0 : t0, [inFrame, setInFrame] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null), [inPopUp, setInPopUp] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null);\n  let t1, t2;\n  $[0] === Symbol.for(\"react.memo_cache_sentinel\") ? (t1 = () => {\n    setInFrame((0,_sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_15__.isMaybePreviewIframe)()), setInPopUp((0,_sanity_presentation_comlink__WEBPACK_IMPORTED_MODULE_15__.isMaybePreviewWindow)());\n  }, t2 = [], $[0] = t1, $[1] = t2) : (t1 = $[0], t2 = $[1]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t1, t2);\n  const [portalElement, setPortalElement] = (0,react__WEBPACK_IMPORTED_MODULE_2__.useState)(null);\n  let t3, t4;\n  $[2] !== portal ? (t3 = () => {\n    if (portal === !1)\n      return;\n    const node = document.createElement(\"sanity-visual-editing\");\n    return document.documentElement.appendChild(node), setPortalElement(node), () => {\n      setPortalElement(null), document.documentElement.contains(node) && document.documentElement.removeChild(node);\n    };\n  }, t4 = [portal], $[2] = portal, $[3] = t3, $[4] = t4) : (t3 = $[3], t4 = $[4]), (0,react__WEBPACK_IMPORTED_MODULE_2__.useEffect)(t3, t4);\n  const [comlink, comlinkStatus] = useComlink(inFrame === !0 || inPopUp === !0);\n  useDatasetMutator(comlinkStatus === \"connected\" ? comlink : void 0);\n  let t5;\n  $[5] !== comlink || $[6] !== comlinkStatus || $[7] !== components || $[8] !== inFrame || $[9] !== inPopUp || $[10] !== zIndex ? (t5 = inFrame !== null && inPopUp !== null && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Overlays, { comlink, comlinkStatus, componentResolver: components, inFrame, inPopUp, zIndex }), $[5] = comlink, $[6] = comlinkStatus, $[7] = components, $[8] = inFrame, $[9] = inPopUp, $[10] = zIndex, $[11] = t5) : t5 = $[11];\n  let t6;\n  $[12] !== comlink || $[13] !== history || $[14] !== refresh ? (t6 = comlink && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(History, { comlink, history }),\n    /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Meta, { comlink }),\n    refresh && /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Refresh, { comlink, refresh })\n  ] }), $[12] = comlink, $[13] = history, $[14] = refresh, $[15] = t6) : t6 = $[15];\n  let t7;\n  $[16] !== t5 || $[17] !== t6 ? (t7 = /* @__PURE__ */ (0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, { children: [\n    t5,\n    t6\n  ] }), $[16] = t5, $[17] = t6, $[18] = t7) : t7 = $[18];\n  const children = t7;\n  if (portal === !1 || !portalElement)\n    return children;\n  let t8;\n  return $[19] !== children || $[20] !== portalElement ? (t8 = (0,react_dom__WEBPACK_IMPORTED_MODULE_3__.createPortal)(children, portalElement), $[19] = children, $[20] = portalElement, $[21] = t8) : t8 = $[21], t8;\n};\nVisualEditing.displayName = \"VisualEditing\";\n\n//# sourceMappingURL=index.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvbmV4dC1zYW5pdHkvbm9kZV9tb2R1bGVzL0BzYW5pdHkvdmlzdWFsLWVkaXRpbmcvZGlzdC9yZWFjdC9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBd0Q7QUFDYjtBQUMwRTtBQUNvQztBQUNoSDtBQUNrRDtBQUM4SztBQUM5TjtBQUM0TDtBQUN4RztBQUMzRDtBQUNoQjtBQUMyRjtBQUNvRDtBQUN0STtBQUNJO0FBQ1Q7QUFDUTtBQUMzQjtBQUNlO0FBQ0U7QUFDRDtBQUNTO0FBQ0M7QUFDL0Q7QUFDQSxZQUFZLHlEQUFDO0FBQ2I7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQSxHQUFHLDRHQUE0RyxnREFBUztBQUN4SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEdBQUcsMkdBQTJHLGdEQUFTO0FBQ3ZILENBQUM7QUFDRCxZQUFZLHlEQUFDO0FBQ2I7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHLGtGQUFrRixnREFBUztBQUM5RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx5REFBQztBQUNiO0FBQ0EsSUFBSSxFQUFFLHFFQUFZO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQSxVQUFVLEVBQUUscUZBQTRCO0FBQ3hDO0FBQ0E7QUFDQSxVQUFVLEVBQUUscUZBQTRCO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBLFlBQVksc0RBQXNELDREQUFHO0FBQ3JFLG1DQUFtQyxrREFBRSxZQUFZLHNEQUFNO0FBQ3ZEO0FBQ0EsV0FBVyxJQUFJLGtEQUFFLFlBQVksc0RBQU07QUFDbkM7QUFDQSxXQUFXLE9BQU8sa0RBQUUsWUFBWSxzREFBTSxnQkFBZ0Isa0RBQUUsWUFBWSxzREFBTTtBQUMxRSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsMEZBQTBGLGdEQUFTO0FBQ3RHO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLHNCQUFzQixvREFBYTtBQUNuQztBQUNBLGtCQUFrQixpREFBVTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxLQUFLLDhFQUFxQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsOEVBQXFCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLEtBQUssaUZBQXdCO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLFVBQVUsbURBQVE7QUFDbEI7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLFVBQVUscURBQVU7QUFDcEI7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsOEhBQThILDRFQUFtQix5QkFBeUIsNEVBQW1CLHFCQUFxQiw0RUFBbUIsc0JBQXNCLDRFQUFtQjtBQUM5UTtBQUNBO0FBQ0E7QUFDQSxVQUFVLHNEQUFXO0FBQ3JCO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLFVBQVUsc0RBQVc7QUFDckI7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsVUFBVSx3REFBYTtBQUN2QjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxVQUFVLHdEQUFhO0FBQ3ZCO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLFVBQVUsbURBQVE7QUFDbEI7QUFDQSxHQUFHO0FBQ0g7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLFVBQVUsMERBQWU7QUFDekI7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsVUFBVSwwREFBZTtBQUN6QjtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxZQUFZLHlEQUFDO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSwrREFBK0Qsc0RBQUcsQ0FBQyxtRUFBVSxJQUFJLHdCQUF3QjtBQUN6RztBQUNBLCtFQUErRSxzREFBRyxDQUFDLGdFQUFTLElBQUksbUJBQW1CLDBEQUFlLGdFQUFnRTtBQUNsTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQSxrREFBa0Q7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU8scUJBQXFCLHNEQUFHLHNCQUFzQjtBQUNyRDtBQUNBLE9BQU8sa0NBQWtDO0FBQ3pDLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU8scUJBQXFCLHNEQUFHLHNCQUFzQjtBQUNyRDtBQUNBLE9BQU8sa0NBQWtDO0FBQ3pDLEtBQUs7QUFDTCxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsWUFBWSwwREFBZTtBQUMzQjtBQUNBO0FBQ0EsY0FBYyx3RUFBVztBQUN6QjtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZLDBEQUFlO0FBQzNCO0FBQ0E7QUFDQTtBQUNBLGNBQWMsd0VBQVc7QUFDekI7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHlEQUFDO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsSUFBSSx5QkFBeUIseUVBQVk7QUFDekM7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLG9GQUFvRixzREFBRyxDQUFDLGtFQUFXLElBQUk7QUFDdkc7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5SUFBeUksc0RBQUcsQ0FBQywrREFBUSxJQUFJLG9IQUFvSDtBQUM3UTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUdBQXFHLHNEQUFHLG9CQUFvQix3Q0FBd0M7QUFDcEssTUFBTTtBQUNOO0FBQ0E7QUFDQSwrRkFBK0Ysc0RBQUcsQ0FBQyxnRUFBUyxJQUFJLGtGQUFrRjtBQUNsTTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLCtHQUErRyxzREFBRyxjQUFjLGdDQUFnQztBQUNoSztBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkseURBQUM7QUFDYjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLElBQUksOENBQThDLCtDQUFRO0FBQzFEO0FBQ0EsSUFBSTtBQUNKO0FBQ0EsSUFBSSxFQUFFLHFFQUFZO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLHdDQUF3QywrQ0FBUTtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMLEdBQUcseUpBQXlKLGdEQUFTO0FBQ3JLO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBLDBCQUEwQix3RUFBVztBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsNkRBQTZELHNEQUFHLENBQUMsMERBQUcsSUFBSSxnREFBZ0Qsc0RBQUcsQ0FBQywyREFBSSxJQUFJLHlCQUF5QixvQkFBb0Isc0RBQUcsQ0FBQyw4REFBTyxJQUFJLFNBQVMsR0FBRztBQUM1TTtBQUNBO0FBQ0EseUNBQXlDLHNEQUFHLENBQUMsNERBQUssSUFBSSw2Q0FBNkMsc0RBQUcsQ0FBQywyREFBSSxJQUFJLDRDQUE0QyxHQUFHO0FBQzlKO0FBQ0EsMERBQTBELHVEQUFJLENBQUMsMkRBQUksSUFBSTtBQUN2RTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0Esd0dBQXdHLHVEQUFJLENBQUMsdURBQVEsSUFBSTtBQUN6SCxvQkFBb0Isc0RBQUcsQ0FBQyxrRUFBVyxJQUFJO0FBQ3ZDLDJDQUEyQyxzREFBRyxvQkFBb0Isd0NBQXdDO0FBQzFHLEtBQUs7QUFDTDtBQUNBLDBEQUEwRCx1REFBSSxDQUFDLDJEQUFJLElBQUk7QUFDdkU7QUFDQTtBQUNBLEtBQUs7QUFDTCxpQkFBaUIsRUFBRSxHQUFHLEVBQUU7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLDBEQUEwRCxzREFBRyxVQUFVLFlBQVk7QUFDbkY7QUFDQSxtR0FBbUcsc0RBQUcsQ0FBQyw4REFBTyxJQUFJLGdLQUFnSztBQUNsUjtBQUNBLHVFQUF1RSxzREFBRyxDQUFDLHNFQUFhLElBQUksOENBQThDO0FBQzFJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixjQUFjLEVBQUUsZ0JBQWdCLEVBQUUsY0FBYyxHQUFHLGNBQWMsRUFBRSxZQUFZO0FBQy9GO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLG9EQUFhO0FBQzdDO0FBQ0Esa0JBQWtCLGlEQUFVO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQXNELHFEQUFjLHNCQUFzQix5REFBTSxDQUFDLCtEQUFJO0FBQ3JHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxJQUFJOztBQUVKO0FBQ0E7QUFDQTtBQUNBLGFBQWEseURBQU0sQ0FBQywrREFBSTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMseURBQU0sQ0FBQywrREFBSTtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix5REFBTSxDQUFDLCtEQUFJO0FBQzNCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx5REFBTSxDQUFDLCtEQUFJO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKLFNBQVMsa0VBQWE7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsNEVBQWUsQ0FBQywyREFBVTtBQUNwQyxHQUFHO0FBQ0g7QUFDQTtBQUNBLFlBQVkseURBQUM7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxrRUFBa0Usc0RBQUcsVUFBVTtBQUMvRTtBQUNBLEtBQUssb0JBQW9CLHNEQUFHLENBQUMsdURBQVksSUFBSTtBQUM3QztBQUNBO0FBQ0EsZ0ZBQWdGLHNEQUFHLFlBQVksa0ZBQWtGLHNEQUFHLFNBQVMsTUFBTSxHQUFHO0FBQ3RNO0FBQ0EsNEZBQTRGLHNEQUFHLFFBQVEsK0NBQStDLHVEQUFJLFdBQVc7QUFDckssaUNBQWlDLHNEQUFHLENBQUMsMERBQUcsSUFBSSwwQ0FBMEMsc0RBQUcsQ0FBQywyREFBSSxJQUFJLDZEQUE2RCxzREFBRyxDQUFDLHlEQUFjLElBQUksR0FBRyxHQUFHO0FBQzNMLG9CQUFvQixzREFBRyxDQUFDLDJEQUFJLElBQUkseUJBQXlCO0FBQ3pELG9CQUFvQixzREFBRyxDQUFDLDJEQUFJLElBQUksNENBQTRDO0FBQzVFLEtBQUssR0FBRztBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ04sMkJBQTJCLHNEQUFHLGNBQWMsYUFBYSwyR0FBbUM7QUFDNUYsR0FBRztBQUNIO0FBQ0EsOEVBQThFLHVEQUFJLENBQUMsdURBQVEsSUFBSTtBQUMvRjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsQ0FBQyxtQkFBbUIsMkNBQUk7QUFDeEIsWUFBWSx5REFBQztBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksZUFBZSw2Q0FBTSw4QkFBOEIsNkNBQU07QUFDN0Q7QUFDQSxnQkFBZ0IsT0FBTyxhQUFhLE9BQU8sdUJBQXVCLE9BQU8sTUFBTSxPQUFPO0FBQ3RGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU0sdUVBQWM7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWCxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxHQUFHLGtMQUFrTCxnREFBUztBQUM5TCxvQ0FBb0MsK0NBQVE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHO0FBQ0g7QUFDQSx1SUFBdUksZ0RBQVM7QUFDaEo7QUFDQTtBQUNBLDJFQUEyRSxzREFBRyx3QkFBd0IsVUFBVTtBQUNoSDtBQUNBLHNJQUFzSSxzREFBRyxXQUFXLGdIQUFnSDtBQUNwUSxDQUFDO0FBQ0Q7QUFDQSxZQUFZLHlEQUFDO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLDJDQUFJO0FBQ2pCLFlBQVkseURBQUMsZUFBZSwyREFBb0I7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyRUFBMkUsc0RBQUcsZUFBZSxzQ0FBc0Msc0RBQUcsQ0FBQywyREFBSSxJQUFJLHVEQUF1RCxHQUFHO0FBQ3pNO0FBQ0EsK0NBQStDLHNEQUFHLENBQUMsMERBQUcsSUFBSSwyRUFBMkU7QUFDckksQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHlEQUFDO0FBQ2I7QUFDQSxJQUFJLGNBQWMsZ0JBQWdCLGFBQWEsZ0JBQWdCLGFBQWEsb0JBQW9CLGFBQWEsb0JBQW9CO0FBQ2pJO0FBQ0EsMEZBQTBGLHNEQUFHLFVBQVU7QUFDdkc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx5REFBQztBQUNiO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixNQUFNLGFBQWEsT0FBTyx1QkFBdUIsRUFBRSxNQUFNLEVBQUU7QUFDM0U7QUFDQSwyRUFBMkUsc0RBQUcsVUFBVTtBQUN4RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLENBQUMsV0FBVyxxREFBTTtBQUNsQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBLENBQUMsK0NBQStDLFdBQVcsb0NBQW9DLFlBQVksYUFBYSxhQUFhO0FBQ3JJLFdBQVc7QUFDWDtBQUNBLENBQUMsUUFBUSxPQUFPO0FBQ2hCLFlBQVk7QUFDWjtBQUNBLENBQUMsUUFBUSxRQUFRO0FBQ2pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHlEQUFDO0FBQ2I7QUFDQSxJQUFJLGdRQUFnUSx5RUFBYyxZQUFZLHNFQUFXO0FBQ3pTO0FBQ0E7QUFDQTtBQUNBLDJHQUEyRywyREFBSSw4S0FBOEssWUFBWSxFQUFFLFdBQVc7QUFDdFQsSUFBSTtBQUNKO0FBQ0E7QUFDQSxvRkFBb0Ysc0RBQUcsV0FBVyxrRkFBa0Y7QUFDcEw7QUFDQSx5RUFBeUUsc0RBQUcsVUFBVSwyQ0FBMkM7QUFDakk7QUFDQSx5REFBeUQsc0RBQUcsVUFBVSw4QkFBOEI7QUFDcEc7QUFDQSx5SUFBeUksc0RBQUcsT0FBTywyRUFBMkU7QUFDOU47QUFDQSxxSkFBcUosc0RBQUcsT0FBTywyRkFBMkY7QUFDMVA7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLHlEQUFNLENBQUMsK0RBQUk7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHlEQUFDO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esa0ZBQWtGLHNEQUFHLFdBQVcsdUVBQXVFLHVEQUFJLENBQUMsMkRBQUksSUFBSTtBQUNwTCxvQkFBb0Isc0RBQUcsQ0FBQyw4REFBTyxJQUFJLGlCQUFpQjtBQUNwRCxvQkFBb0Isc0RBQUcsQ0FBQywyREFBSSxJQUFJLCtCQUErQjtBQUMvRCxvQkFBb0Isc0RBQUcsQ0FBQyxxREFBVSxJQUFJO0FBQ3RDLEtBQUssR0FBRztBQUNSLENBQUM7QUFDRDtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx5REFBQztBQUNiO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLGtEQUFrRCwrQ0FBUTtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFFBQVE7QUFDUjtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxHQUFHLHVJQUF1SSxnREFBUztBQUNuSjtBQUNBO0FBQ0E7QUFDQSxHQUFHLG1GQUFtRixnREFBUztBQUMvRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlFQUF5RSxzREFBRyxxQ0FBcUMsMEJBQTBCO0FBQzNJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBLFlBQVkseURBQUM7QUFDYjtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBLDRDQUE0QywrQ0FBUSw0QkFBNEIsK0NBQVE7QUFDeEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxVQUFVO0FBQ1Y7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRyxrRkFBa0YsZ0RBQVM7QUFDOUY7QUFDQTtBQUNBLDJCQUEyQiw2Q0FBTSxXQUFXLHVEQUFnQjtBQUM1RDtBQUNBO0FBQ0Esb0NBQW9DLDZDQUFNO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsS0FBSztBQUNMLEdBQUcseUdBQXlHLGdEQUFTO0FBQ3JIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyRkFBMkYsbUNBQW1DO0FBQzlIO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1RkFBdUYsbUNBQW1DO0FBQzFIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSwwRUFBMEUsc0RBQUcsMkJBQTJCLDBCQUEwQjtBQUNsSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxDQUFDLHdCQUF3QjtBQUN6QixZQUFZLHlEQUFDO0FBQ2I7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLG9LQUFvSyxnREFBUztBQUM3SztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsS0FBSztBQUNMLEdBQUcsa0ZBQWtGLGdEQUFTO0FBQzlGO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSx1RUFBdUUsc0RBQUcsQ0FBQyxpRkFBa0IsYUFBYSwwQkFBMEI7QUFDcEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHlEQUFDO0FBQ2I7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiwrREFBTTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLDBDQUEwQyxNQUFNO0FBQ2hELEdBQUc7QUFDSDtBQUNBO0FBQ0EsbUVBQW1FLHNEQUFHLENBQUMseUVBQWdCLGFBQWEsc0JBQXNCO0FBQzFIO0FBQ0E7QUFDQSxZQUFZLHlEQUFDLHlCQUF5Qiw2Q0FBTSxpQ0FBaUMsZ0ZBQXVCO0FBQ3BHO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QywwRkFBdUI7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsR0FBRyxnTkFBZ04sZ0RBQVM7QUFDNU47QUFDQTtBQUNBLFlBQVkseURBQUM7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsR0FBRyw2R0FBNkcsZ0RBQVM7QUFDekg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHlEQUFDLG9CQUFvQiw2Q0FBTTtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxHQUFHLDhKQUE4SixnREFBUztBQUMxSztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsYUFBYSxxREFBTTtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx5REFBQztBQUNiO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQSxvQ0FBb0MsK0NBQVE7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxHQUFHLDBGQUEwRixnREFBUztBQUN0RyxnQkFBZ0IsMkVBQWtCO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsK0RBQVU7QUFDOUIsT0FBTztBQUNQO0FBQ0Esb0JBQW9CLG1FQUFjO0FBQ2xDLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQiwrREFBVTtBQUNoQyxTQUFTO0FBQ1Q7QUFDQSxzQkFBc0IsbUVBQWM7QUFDcEMsU0FBUztBQUNUO0FBQ0EsR0FBRywyR0FBMkcsZ0RBQVM7QUFDdkgsQ0FBQztBQUNELFlBQVkseURBQUM7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBLElBQUksc0NBQXNDLHlFQUFZO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLE1BQU07QUFDTjtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0Esb0tBQW9LLGdEQUFTO0FBQzdLLENBQUM7QUFDRCxZQUFZLHlEQUFDO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSx1QkFBdUIseUVBQWM7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCx5QkFBeUIsaURBQVU7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksc0NBQXNDLCtDQUFRLDhDQUE4QywrQ0FBUTtBQUN4RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQSxHQUFHLGtGQUFrRixnREFBUztBQUM5RjtBQUNBO0FBQ0EseUVBQXlFLEVBQUUsMkRBQTJELG1CQUFtQjtBQUN6SixHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyw0RUFBNEUsZ0RBQVM7QUFDeEYsNENBQTRDLCtDQUFRLGtDQUFrQywrQ0FBUSwwQkFBMEIsNkNBQU07QUFDOUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1gsU0FBUztBQUNULE9BQU87QUFDUDtBQUNBLEdBQUcsa0dBQWtHLGdEQUFTO0FBQzlHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLEdBQUc7QUFDSCx1REFBdUQsZ0ZBQXVCO0FBQzlFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLHNLQUFzSyw4RkFBMkI7QUFDek0sNkJBQTZCLHNEQUFHLG1CQUFtQixrU0FBa1M7QUFDclYsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLDBFQUEwRSxzREFBRyxxQkFBcUIsMEJBQTBCO0FBQzVIO0FBQ0Esc0xBQXNMLHNEQUFHLHVCQUF1Qix3R0FBd0c7QUFDeFQ7QUFDQSxnRUFBZ0Usc0RBQUcsZ0JBQWdCLDZDQUE2QztBQUNoSTtBQUNBLHlOQUF5Tix1REFBSSxDQUFDLHVEQUFRLElBQUk7QUFDMU8sMENBQTBDLHNEQUFHLDRCQUE0QixvQkFBb0I7QUFDN0YsNkNBQTZDLHNEQUFHLHlCQUF5QjtBQUN6RSxxQ0FBcUMsc0RBQUcseUJBQXlCLGVBQWU7QUFDaEYsS0FBSztBQUNMO0FBQ0Esd0dBQXdHLHNEQUFHLHVCQUF1Qix3QkFBd0I7QUFDMUo7QUFDQSxpTUFBaU0sdURBQUksU0FBUztBQUM5TTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSw4REFBOEQsc0RBQUcsd0JBQXdCLHdCQUF3QjtBQUNqSDtBQUNBLDhEQUE4RCxzREFBRyw2QkFBNkIsd0JBQXdCO0FBQ3RIO0FBQ0Esb0ZBQW9GLHNEQUFHLG1CQUFtQixrQ0FBa0M7QUFDNUk7QUFDQSxrRUFBa0Usc0RBQUcsQ0FBQyxvRUFBYSxJQUFJLDBCQUEwQixzREFBRyxDQUFDLHFFQUFjLElBQUkscUNBQXFDLEdBQUc7QUFDL0s7QUFDQSwwREFBMEQsc0RBQUcsQ0FBQyxvRUFBYSxJQUFJLG9CQUFvQixrRUFBVyxzQ0FBc0M7QUFDcEo7QUFDQSxxRUFBcUUsc0RBQUcsc0JBQXNCLHdCQUF3QjtBQUN0SCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPLDhFQUFtQixZQUFZLHdFQUFhO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkseURBQUM7QUFDYjtBQUNBO0FBQ0EsSUFBSSw0QkFBNEIsNkNBQU0sMEJBQTBCLDZDQUFNO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxPQUFPO0FBQ1AsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0EsT0FBTztBQUNQO0FBQ0EsR0FBRyw0R0FBNEcsZ0RBQVM7QUFDeEg7QUFDQTtBQUNBLFlBQVkseURBQUMseURBQXlELCtDQUFRLDBCQUEwQiwrQ0FBUTtBQUNoSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQiw0REFBVTtBQUMvQjtBQUNBO0FBQ0EsS0FBSyxFQUFFLG1FQUFpQjtBQUN4QixjQUFjLHdGQUF5QjtBQUN2QyxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUcsZ0ZBQWdGLGdEQUFTO0FBQzVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxHQUFHLGdGQUFnRixnREFBUztBQUM1RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLGtDQUFrQyxnREFBYSw4QkFBOEIsMENBQU87QUFDcEY7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLEdBQUc7QUFDSCxHQUFHO0FBQ0g7QUFDQSxHQUFHLEdBQUcsNENBQUs7QUFDWDtBQUNBO0FBQ0EsWUFBWSx5REFBQztBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUVBQXFFLDJFQUFvQixxQkFBcUIsMENBQVc7QUFDekg7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxrQ0FBa0MsZ0VBQVE7QUFDMUMsS0FBSztBQUNMO0FBQ0E7QUFDQSxHQUFHLGtGQUFrRixnREFBUztBQUM5RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkseURBQUM7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxtRUFBbUUsK0NBQVEsZ0NBQWdDLCtDQUFRO0FBQ3ZIO0FBQ0E7QUFDQSxlQUFlLG1GQUFvQixnQkFBZ0IsbUZBQW9CO0FBQ3ZFLEdBQUcsMkRBQTJELGdEQUFTO0FBQ3ZFLDRDQUE0QywrQ0FBUTtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRyxnRkFBZ0YsZ0RBQVM7QUFDNUY7QUFDQTtBQUNBO0FBQ0EsZ01BQWdNLHNEQUFHLGFBQWEsaUZBQWlGO0FBQ2pTO0FBQ0EsaUdBQWlHLHVEQUFJLENBQUMsdURBQVEsSUFBSTtBQUNsSCxvQkFBb0Isc0RBQUcsWUFBWSxrQkFBa0I7QUFDckQsb0JBQW9CLHNEQUFHLFNBQVMsU0FBUztBQUN6QywrQkFBK0Isc0RBQUcsWUFBWSxrQkFBa0I7QUFDaEUsS0FBSztBQUNMO0FBQ0EsdURBQXVELHVEQUFJLENBQUMsdURBQVEsSUFBSTtBQUN4RTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0RBQStELHVEQUFZO0FBQzNFO0FBQ0E7QUFVRTtBQUNGIiwic291cmNlcyI6WyIvaG9tZS9ydW5uZXIvd29ya3NwYWNlL25vZGVfbW9kdWxlcy9uZXh0LXNhbml0eS9ub2RlX21vZHVsZXMvQHNhbml0eS92aXN1YWwtZWRpdGluZy9kaXN0L3JlYWN0L2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGpzeCwganN4cywgRnJhZ21lbnQgfSBmcm9tIFwicmVhY3QvanN4LXJ1bnRpbWVcIjtcbmltcG9ydCB7IGMgfSBmcm9tIFwicmVhY3QtY29tcGlsZXItcnVudGltZVwiO1xuaW1wb3J0IHsgY3JlYXRlQ29tcGF0aWJpbGl0eUFjdG9ycywgaXNNYXliZVByZXZpZXdJZnJhbWUsIGlzTWF5YmVQcmV2aWV3V2luZG93IH0gZnJvbSBcIkBzYW5pdHkvcHJlc2VudGF0aW9uLWNvbWxpbmtcIjtcbmltcG9ydCB7IHVzZUVmZmVjdCwgY3JlYXRlQ29udGV4dCwgdXNlQ29udGV4dCwgdXNlU3RhdGUsIG1lbW8sIHVzZVJlZiwgaXNWYWxpZEVsZW1lbnQsIHVzZVN5bmNFeHRlcm5hbFN0b3JlLCB1c2VEZWZlcnJlZFZhbHVlLCB1c2VSZWR1Y2VyIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBjcmVhdGVQb3J0YWwgfSBmcm9tIFwicmVhY3QtZG9tXCI7XG5pbXBvcnQgeyBjcmVhdGVFZGl0VXJsLCBzdHVkaW9QYXRoLCBnZXREcmFmdElkLCBnZXRQdWJsaXNoZWRJZCB9IGZyb20gXCJAc2FuaXR5L2NsaWVudC9jc21cIjtcbmltcG9ydCB7IE1lbnVHcm91cCwgTWVudURpdmlkZXIsIE1lbnVJdGVtLCBCb3gsIFRleHQsIFNwaW5uZXIsIFN0YWNrLCBGbGV4LCBNZW51LCBQb3BvdmVyLCBDYXJkLCB1c2VQcmVmZXJzRGFyaywgdXNlVGhlbWVfdjIsIEhvdGtleXMsIExheWVyUHJvdmlkZXIsIFBvcnRhbFByb3ZpZGVyLCBUaGVtZVByb3ZpZGVyLCBzdHVkaW9UaGVtZSwgaXNIVE1MQW5jaG9yRWxlbWVudCwgaXNIVE1MRWxlbWVudCB9IGZyb20gXCJAc2FuaXR5L3VpL192aXN1YWwtZWRpdGluZ1wiO1xuaW1wb3J0IHsgc3R5bGVkIH0gZnJvbSBcInN0eWxlZC1jb21wb25lbnRzXCI7XG5pbXBvcnQgeyB1c2VEb2N1bWVudHMsIGdldEFycmF5SXRlbUtleUFuZFBhcmVudFBhdGgsIGdldCwgZ2V0QXJyYXlNb3ZlUGF0Y2hlcywgZ2V0QXJyYXlJbnNlcnRQYXRjaGVzLCBnZXRBcnJheUR1cGxpY2F0ZVBhdGNoZXMsIGdldEFycmF5UmVtb3ZlUGF0Y2hlcywgdXNlT3B0aW1pc3RpY0FjdG9yUmVhZHksIHVzZU9wdGltaXN0aWNBY3RvciB9IGZyb20gXCIuLi9fY2h1bmtzLWVzL211dGF0aW9ucy5qc1wiO1xuaW1wb3J0IHsgU2hhcmVkU3RhdGVDb250ZXh0LCBjcmVhdGVPdmVybGF5Q29udHJvbGxlciwgc2FuaXR5Tm9kZXNFeGlzdEluU2FtZUFycmF5IH0gZnJvbSBcIi4uL19jaHVua3MtZXMvU2hhcmVkU3RhdGVDb250ZXh0LmpzXCI7XG5pbXBvcnQgeyB1c2VPcHRpbWlzdGljIH0gZnJvbSBcIi4uL19jaHVua3MtZXMvU2hhcmVkU3RhdGVDb250ZXh0LmpzXCI7XG5pbXBvcnQgeyBhdCwgcmVtb3ZlLCBpbnNlcnQgfSBmcm9tIFwiQHNhbml0eS9tdXRhdGVcIjtcbmltcG9ydCB7IGdldE5vZGVJY29uLCBJbnNlcnRNZW51LCBQb3BvdmVyUG9ydGFsLCB1c2VUZWxlbWV0cnksIFBvaW50ZXJFdmVudHMsIFRlbGVtZXRyeUNvbnRleHQsIGV2ZW50cyB9IGZyb20gXCIuLi9fY2h1bmtzLWVzL1BvaW50ZXJFdmVudHMuanNcIjtcbmltcG9ydCB7IEluc2VydEFib3ZlSWNvbiwgSW5zZXJ0QmVsb3dJY29uLCBDb3B5SWNvbiwgUmVtb3ZlSWNvbiwgU29ydEljb24sIFB1Ymxpc2hJY29uLCBBcnJvd1VwSWNvbiwgQXJyb3dEb3duSWNvbiwgVW5wdWJsaXNoSWNvbiwgRG9jdW1lbnRJY29uLCBEcmFnSGFuZGxlSWNvbiwgRXhwYW5kSWNvbiB9IGZyb20gXCJAc2FuaXR5L2ljb25zXCI7XG5pbXBvcnQgeyBwYXRoVG9VcmxTdHJpbmcgfSBmcm9tIFwiQHNhbml0eS92aXN1YWwtZWRpdGluZy1jc21cIjtcbmltcG9ydCB7IGNyZWF0ZURhdGFBdHRyaWJ1dGUgfSBmcm9tIFwiQHNhbml0eS92aXN1YWwtZWRpdGluZy1jc21cIjtcbmltcG9ydCBzY3JvbGxJbnRvVmlldyBmcm9tIFwic2Nyb2xsLWludG8tdmlldy1pZi1uZWVkZWRcIjtcbmltcG9ydCB7IGNyZWF0ZU5vZGUsIGNyZWF0ZU5vZGVNYWNoaW5lIH0gZnJvbSBcIkBzYW5pdHkvY29tbGlua1wiO1xuaW1wb3J0IHsgY3JlYXRlQWN0b3IgfSBmcm9tIFwieHN0YXRlXCI7XG5pbXBvcnQgeyBzZXRBY3RvciB9IGZyb20gXCIuLi9fY2h1bmtzLWVzL2NvbnRleHQuanNcIjtcbmltcG9ydCB7IGVtcHR5QWN0b3IgfSBmcm9tIFwiLi4vX2NodW5rcy1lcy9jb250ZXh0LmpzXCI7XG5pbXBvcnQgeyBSZXBsYXlTdWJqZWN0LCBTdWJqZWN0LCBtZXJnZSB9IGZyb20gXCJyeGpzXCI7XG5pbXBvcnQgeyBjcmVhdGVEYXRhc2V0TXV0YXRvciB9IGZyb20gXCIuLi9vcHRpbWlzdGljL2luZGV4LmpzXCI7XG5pbXBvcnQgeyBjcmVhdGVEb2N1bWVudE11dGF0b3IgfSBmcm9tIFwiLi4vb3B0aW1pc3RpYy9pbmRleC5qc1wiO1xuY29uc3QgSGlzdG9yeSA9IChwcm9wcykgPT4ge1xuICBjb25zdCAkID0gYyg4KSwge1xuICAgIGNvbWxpbmssXG4gICAgaGlzdG9yeVxuICB9ID0gcHJvcHM7XG4gIGxldCB0MCwgdDE7XG4gICRbMF0gIT09IGNvbWxpbmsgfHwgJFsxXSAhPT0gaGlzdG9yeSA/ICh0MCA9ICgpID0+IGNvbWxpbms/Lm9uKFwicHJlc2VudGF0aW9uL25hdmlnYXRlXCIsIChkYXRhKSA9PiB7XG4gICAgaGlzdG9yeT8udXBkYXRlKGRhdGEpO1xuICB9KSwgdDEgPSBbY29tbGluaywgaGlzdG9yeV0sICRbMF0gPSBjb21saW5rLCAkWzFdID0gaGlzdG9yeSwgJFsyXSA9IHQwLCAkWzNdID0gdDEpIDogKHQwID0gJFsyXSwgdDEgPSAkWzNdKSwgdXNlRWZmZWN0KHQwLCB0MSk7XG4gIGxldCB0MiwgdDM7XG4gIHJldHVybiAkWzRdICE9PSBjb21saW5rIHx8ICRbNV0gIT09IGhpc3RvcnkgPyAodDIgPSAoKSA9PiB7XG4gICAgaWYgKGhpc3RvcnkpXG4gICAgICByZXR1cm4gaGlzdG9yeS5zdWJzY3JpYmUoKHVwZGF0ZSkgPT4ge1xuICAgICAgICB1cGRhdGUudGl0bGUgPSB1cGRhdGUudGl0bGUgfHwgZG9jdW1lbnQudGl0bGUsIGNvbWxpbms/LnBvc3QoXCJ2aXN1YWwtZWRpdGluZy9uYXZpZ2F0ZVwiLCB1cGRhdGUpO1xuICAgICAgfSk7XG4gIH0sIHQzID0gW2NvbWxpbmssIGhpc3RvcnldLCAkWzRdID0gY29tbGluaywgJFs1XSA9IGhpc3RvcnksICRbNl0gPSB0MiwgJFs3XSA9IHQzKSA6ICh0MiA9ICRbNl0sIHQzID0gJFs3XSksIHVzZUVmZmVjdCh0MiwgdDMpLCBudWxsO1xufSwgTWV0YSA9IChwcm9wcykgPT4ge1xuICBjb25zdCAkID0gYygzKSwge1xuICAgIGNvbWxpbmtcbiAgfSA9IHByb3BzO1xuICBsZXQgdDAsIHQxO1xuICByZXR1cm4gJFswXSAhPT0gY29tbGluayA/ICh0MCA9ICgpID0+IHtcbiAgICBjb25zdCBzZW5kTWV0YSA9ICgpID0+IHtcbiAgICAgIGNvbWxpbmsucG9zdChcInZpc3VhbC1lZGl0aW5nL21ldGFcIiwge1xuICAgICAgICB0aXRsZTogZG9jdW1lbnQudGl0bGVcbiAgICAgIH0pO1xuICAgIH0sIG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKHQyKSA9PiB7XG4gICAgICBjb25zdCBbbXV0YXRpb25dID0gdDI7XG4gICAgICBtdXRhdGlvbi50YXJnZXQubm9kZU5hbWUgPT09IFwiVElUTEVcIiAmJiBzZW5kTWV0YSgpO1xuICAgIH0pO1xuICAgIHJldHVybiBvYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LmhlYWQsIHtcbiAgICAgIHN1YnRyZWU6ICEwLFxuICAgICAgY2hhcmFjdGVyRGF0YTogITAsXG4gICAgICBjaGlsZExpc3Q6ICEwXG4gICAgfSksIHNlbmRNZXRhKCksICgpID0+IG9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgfSwgdDEgPSBbY29tbGlua10sICRbMF0gPSBjb21saW5rLCAkWzFdID0gdDAsICRbMl0gPSB0MSkgOiAodDAgPSAkWzFdLCB0MSA9ICRbMl0pLCB1c2VFZmZlY3QodDAsIHQxKSwgbnVsbDtcbn07XG5mdW5jdGlvbiBnZXRSZWZlcmVuY2VOb2RlQW5kSW5zZXJ0UG9zaXRpb24ocG9zaXRpb24pIHtcbiAgaWYgKHBvc2l0aW9uKSB7XG4gICAgY29uc3Qge1xuICAgICAgdG9wLFxuICAgICAgcmlnaHQsXG4gICAgICBib3R0b20sXG4gICAgICBsZWZ0XG4gICAgfSA9IHBvc2l0aW9uO1xuICAgIGlmIChsZWZ0IHx8IHRvcClcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG5vZGU6IChsZWZ0ID8/IHRvcCkuc2FuaXR5LFxuICAgICAgICBwb3NpdGlvbjogXCJhZnRlclwiXG4gICAgICB9O1xuICAgIGlmIChyaWdodCB8fCBib3R0b20pXG4gICAgICByZXR1cm4ge1xuICAgICAgICBub2RlOiAocmlnaHQgPz8gYm90dG9tKS5zYW5pdHksXG4gICAgICAgIHBvc2l0aW9uOiBcImJlZm9yZVwiXG4gICAgICB9O1xuICB9XG59XG5mdW5jdGlvbiB1c2VEcmFnRW5kRXZlbnRzKCkge1xuICBjb25zdCAkID0gYyg0KSwge1xuICAgIGdldERvY3VtZW50XG4gIH0gPSB1c2VEb2N1bWVudHMoKTtcbiAgbGV0IHQwLCB0MTtcbiAgJFswXSAhPT0gZ2V0RG9jdW1lbnQgPyAodDAgPSAoKSA9PiB7XG4gICAgY29uc3QgaGFuZGxlciA9IChlKSA9PiB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIGluc2VydFBvc2l0aW9uLFxuICAgICAgICB0YXJnZXQsXG4gICAgICAgIHByZXZlbnRJbnNlcnREZWZhdWx0XG4gICAgICB9ID0gZS5kZXRhaWw7XG4gICAgICBpZiAocHJldmVudEluc2VydERlZmF1bHQpXG4gICAgICAgIHJldHVybjtcbiAgICAgIGNvbnN0IHJlZmVyZW5jZSA9IGdldFJlZmVyZW5jZU5vZGVBbmRJbnNlcnRQb3NpdGlvbihpbnNlcnRQb3NpdGlvbik7XG4gICAgICBpZiAocmVmZXJlbmNlKSB7XG4gICAgICAgIGNvbnN0IGRvYyA9IGdldERvY3VtZW50KHRhcmdldC5pZCksIHtcbiAgICAgICAgICBub2RlLFxuICAgICAgICAgIHBvc2l0aW9uXG4gICAgICAgIH0gPSByZWZlcmVuY2UsIHtcbiAgICAgICAgICBrZXk6IHRhcmdldEtleSxcbiAgICAgICAgICBoYXNFeHBsaWNpdEtleVxuICAgICAgICB9ID0gZ2V0QXJyYXlJdGVtS2V5QW5kUGFyZW50UGF0aCh0YXJnZXQpLCB7XG4gICAgICAgICAgcGF0aDogYXJyYXlQYXRoLFxuICAgICAgICAgIGtleTogcmVmZXJlbmNlSXRlbUtleVxuICAgICAgICB9ID0gZ2V0QXJyYXlJdGVtS2V5QW5kUGFyZW50UGF0aChub2RlKTtcbiAgICAgICAgYXJyYXlQYXRoICYmIHJlZmVyZW5jZUl0ZW1LZXkgJiYgcmVmZXJlbmNlSXRlbUtleSAhPT0gdGFyZ2V0S2V5ICYmIGRvYy5wYXRjaChhc3luYyAodDIyKSA9PiB7XG4gICAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgZ2V0U25hcHNob3RcbiAgICAgICAgICB9ID0gdDIyLCBzbmFwc2hvdCA9IGF3YWl0IGdldFNuYXBzaG90KCksIGVsZW1lbnRWYWx1ZSA9IGdldChzbmFwc2hvdCwgdGFyZ2V0LnBhdGgpO1xuICAgICAgICAgIHJldHVybiBoYXNFeHBsaWNpdEtleSA/IFthdChhcnJheVBhdGgsIHJlbW92ZSh7XG4gICAgICAgICAgICBfa2V5OiB0YXJnZXRLZXlcbiAgICAgICAgICB9KSksIGF0KGFycmF5UGF0aCwgaW5zZXJ0KGVsZW1lbnRWYWx1ZSwgcG9zaXRpb24sIHtcbiAgICAgICAgICAgIF9rZXk6IHJlZmVyZW5jZUl0ZW1LZXlcbiAgICAgICAgICB9KSldIDogW2F0KGFycmF5UGF0aCwgcmVtb3ZlKH5+dGFyZ2V0S2V5KSksIGF0KGFycmF5UGF0aCwgaW5zZXJ0KGVsZW1lbnRWYWx1ZSwgcG9zaXRpb24sIHJlZmVyZW5jZUl0ZW1LZXkgPiB0YXJnZXRLZXkgPyB+fnJlZmVyZW5jZUl0ZW1LZXkgLSAxIDogfn5yZWZlcmVuY2VJdGVtS2V5KSldO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInNhbml0eS9kcmFnRW5kXCIsIGhhbmRsZXIpLCAoKSA9PiB7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInNhbml0eS9kcmFnRW5kXCIsIGhhbmRsZXIpO1xuICAgIH07XG4gIH0sIHQxID0gW2dldERvY3VtZW50XSwgJFswXSA9IGdldERvY3VtZW50LCAkWzFdID0gdDAsICRbMl0gPSB0MSkgOiAodDAgPSAkWzFdLCB0MSA9ICRbMl0pLCB1c2VFZmZlY3QodDAsIHQxKTtcbiAgY29uc3QgZGlzcGF0Y2hEcmFnRW5kRXZlbnQgPSBfdGVtcCQ5O1xuICBsZXQgdDI7XG4gIHJldHVybiAkWzNdID09PSBTeW1ib2wuZm9yKFwicmVhY3QubWVtb19jYWNoZV9zZW50aW5lbFwiKSA/ICh0MiA9IHtcbiAgICBkaXNwYXRjaERyYWdFbmRFdmVudFxuICB9LCAkWzNdID0gdDIpIDogdDIgPSAkWzNdLCB0Mjtcbn1cbmZ1bmN0aW9uIF90ZW1wJDkoZXZlbnQpIHtcbiAgY29uc3QgY3VzdG9tRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoXCJzYW5pdHkvZHJhZ0VuZFwiLCB7XG4gICAgZGV0YWlsOiBldmVudCxcbiAgICBjYW5jZWxhYmxlOiAhMFxuICB9KTtcbiAgd2luZG93LmRpc3BhdGNoRXZlbnQoY3VzdG9tRXZlbnQpO1xufVxuY29uc3QgU2NoZW1hQ29udGV4dCA9IGNyZWF0ZUNvbnRleHQobnVsbCk7XG5mdW5jdGlvbiB1c2VTY2hlbWEoKSB7XG4gIGNvbnN0IGNvbnRleHQgPSB1c2VDb250ZXh0KFNjaGVtYUNvbnRleHQpO1xuICBpZiAoIWNvbnRleHQpXG4gICAgdGhyb3cgbmV3IEVycm9yKFwiU2NoZW1hIGNvbnRleHQgaXMgbWlzc2luZ1wiKTtcbiAgcmV0dXJuIGNvbnRleHQ7XG59XG5mdW5jdGlvbiBnZXRBcnJheVJlbW92ZUFjdGlvbihub2RlLCBkb2MpIHtcbiAgaWYgKCFub2RlLnR5cGUpIHRocm93IG5ldyBFcnJvcihcIk5vZGUgdHlwZSBpcyBtaXNzaW5nXCIpO1xuICByZXR1cm4gKCkgPT4gZG9jLnBhdGNoKGFzeW5jICh7XG4gICAgZ2V0U25hcHNob3RcbiAgfSkgPT4gZ2V0QXJyYXlSZW1vdmVQYXRjaGVzKG5vZGUsIGF3YWl0IGdldFNuYXBzaG90KCkpKTtcbn1cbmZ1bmN0aW9uIGdldEFycmF5SW5zZXJ0QWN0aW9uKG5vZGUsIGRvYywgaW5zZXJ0VHlwZSwgcG9zaXRpb24pIHtcbiAgaWYgKCFub2RlLnR5cGUpIHRocm93IG5ldyBFcnJvcihcIk5vZGUgdHlwZSBpcyBtaXNzaW5nXCIpO1xuICByZXR1cm4gKCkgPT4gZG9jLnBhdGNoKCgpID0+IGdldEFycmF5SW5zZXJ0UGF0Y2hlcyhub2RlLCBpbnNlcnRUeXBlLCBwb3NpdGlvbikpO1xufVxuZnVuY3Rpb24gZ2V0RHVwbGljYXRlQWN0aW9uKG5vZGUsIGRvYykge1xuICBpZiAoIW5vZGUudHlwZSkgdGhyb3cgbmV3IEVycm9yKFwiTm9kZSB0eXBlIGlzIG1pc3NpbmdcIik7XG4gIHJldHVybiAoKSA9PiBkb2MucGF0Y2goYXN5bmMgKHtcbiAgICBnZXRTbmFwc2hvdFxuICB9KSA9PiBnZXRBcnJheUR1cGxpY2F0ZVBhdGNoZXMobm9kZSwgYXdhaXQgZ2V0U25hcHNob3QoKSkpO1xufVxuZnVuY3Rpb24gZ2V0Q29udGV4dE1lbnVJdGVtcyhjb250ZXh0KSB7XG4gIGNvbnN0IHtcbiAgICBub2RlLFxuICAgIGZpZWxkLFxuICAgIHBhcmVudCxcbiAgICBkb2NcbiAgfSA9IGNvbnRleHQ7XG4gIHJldHVybiBmaWVsZD8udHlwZSA9PT0gXCJhcnJheUl0ZW1cIiA/IGdldENvbnRleHRNZW51QXJyYXlJdGVtcyh7XG4gICAgbm9kZSxcbiAgICBmaWVsZCxcbiAgICBkb2NcbiAgfSkgOiBwYXJlbnQ/LnR5cGUgPT09IFwidW5pb25cIiA/IGdldENvbnRleHRNZW51VW5pb25JdGVtcyh7XG4gICAgbm9kZSxcbiAgICBwYXJlbnQsXG4gICAgZG9jXG4gIH0pIDogUHJvbWlzZS5yZXNvbHZlKFtdKTtcbn1cbmZ1bmN0aW9uIGdldER1cGxpY2F0ZUl0ZW0oY29udGV4dCkge1xuICBjb25zdCB7XG4gICAgbm9kZSxcbiAgICBkb2NcbiAgfSA9IGNvbnRleHQ7XG4gIHJldHVybiBkb2MgPyBbe1xuICAgIHR5cGU6IFwiYWN0aW9uXCIsXG4gICAgbGFiZWw6IFwiRHVwbGljYXRlXCIsXG4gICAgaWNvbjogQ29weUljb24sXG4gICAgYWN0aW9uOiBnZXREdXBsaWNhdGVBY3Rpb24obm9kZSwgZG9jKSxcbiAgICB0ZWxlbWV0cnlFdmVudDogXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBEdXBsaWNhdGVkXCJcbiAgfV0gOiBbXTtcbn1cbmZ1bmN0aW9uIGdldFJlbW92ZUl0ZW1zKGNvbnRleHQpIHtcbiAgY29uc3Qge1xuICAgIG5vZGUsXG4gICAgZG9jXG4gIH0gPSBjb250ZXh0O1xuICByZXR1cm4gZG9jID8gW3tcbiAgICB0eXBlOiBcImFjdGlvblwiLFxuICAgIGxhYmVsOiBcIlJlbW92ZVwiLFxuICAgIGljb246IFJlbW92ZUljb24sXG4gICAgYWN0aW9uOiBnZXRBcnJheVJlbW92ZUFjdGlvbihub2RlLCBkb2MpLFxuICAgIHRlbGVtZXRyeUV2ZW50OiBcIlZpc3VhbCBFZGl0aW5nIENvbnRleHQgTWVudSBJdGVtIFJlbW92ZWRcIlxuICB9XSA6IFtdO1xufVxuYXN5bmMgZnVuY3Rpb24gZ2V0TW92ZUl0ZW1zKGNvbnRleHQsIHdpdGhEaXZpZGVyID0gITApIHtcbiAgY29uc3Qge1xuICAgIG5vZGUsXG4gICAgZG9jXG4gIH0gPSBjb250ZXh0O1xuICBpZiAoIWRvYykgcmV0dXJuIFtdO1xuICBjb25zdCBpdGVtcyA9IFtdLCBncm91cEl0ZW1zID0gW10sIFttb3ZlVXBQYXRjaGVzLCBtb3ZlRG93blBhdGNoZXMsIG1vdmVGaXJzdFBhdGNoZXMsIG1vdmVMYXN0UGF0Y2hlc10gPSBhd2FpdCBQcm9taXNlLmFsbChbZ2V0QXJyYXlNb3ZlUGF0Y2hlcyhub2RlLCBkb2MsIFwicHJldmlvdXNcIiksIGdldEFycmF5TW92ZVBhdGNoZXMobm9kZSwgZG9jLCBcIm5leHRcIiksIGdldEFycmF5TW92ZVBhdGNoZXMobm9kZSwgZG9jLCBcImZpcnN0XCIpLCBnZXRBcnJheU1vdmVQYXRjaGVzKG5vZGUsIGRvYywgXCJsYXN0XCIpXSk7XG4gIHJldHVybiBtb3ZlRmlyc3RQYXRjaGVzLmxlbmd0aCAmJiBncm91cEl0ZW1zLnB1c2goe1xuICAgIHR5cGU6IFwiYWN0aW9uXCIsXG4gICAgbGFiZWw6IFwiVG8gdG9wXCIsXG4gICAgaWNvbjogUHVibGlzaEljb24sXG4gICAgYWN0aW9uOiAoKSA9PiBkb2MucGF0Y2gobW92ZUZpcnN0UGF0Y2hlcyksXG4gICAgdGVsZW1ldHJ5RXZlbnQ6IFwiVmlzdWFsIEVkaXRpbmcgQ29udGV4dCBNZW51IEl0ZW0gTW92ZWRcIlxuICB9KSwgbW92ZVVwUGF0Y2hlcy5sZW5ndGggJiYgZ3JvdXBJdGVtcy5wdXNoKHtcbiAgICB0eXBlOiBcImFjdGlvblwiLFxuICAgIGxhYmVsOiBcIlVwXCIsXG4gICAgaWNvbjogQXJyb3dVcEljb24sXG4gICAgYWN0aW9uOiAoKSA9PiBkb2MucGF0Y2gobW92ZVVwUGF0Y2hlcyksXG4gICAgdGVsZW1ldHJ5RXZlbnQ6IFwiVmlzdWFsIEVkaXRpbmcgQ29udGV4dCBNZW51IEl0ZW0gTW92ZWRcIlxuICB9KSwgbW92ZURvd25QYXRjaGVzLmxlbmd0aCAmJiBncm91cEl0ZW1zLnB1c2goe1xuICAgIHR5cGU6IFwiYWN0aW9uXCIsXG4gICAgbGFiZWw6IFwiRG93blwiLFxuICAgIGljb246IEFycm93RG93bkljb24sXG4gICAgYWN0aW9uOiAoKSA9PiBkb2MucGF0Y2gobW92ZURvd25QYXRjaGVzKSxcbiAgICB0ZWxlbWV0cnlFdmVudDogXCJWaXN1YWwgRWRpdGluZyBDb250ZXh0IE1lbnUgSXRlbSBNb3ZlZFwiXG4gIH0pLCBtb3ZlTGFzdFBhdGNoZXMubGVuZ3RoICYmIGdyb3VwSXRlbXMucHVzaCh7XG4gICAgdHlwZTogXCJhY3Rpb25cIixcbiAgICBsYWJlbDogXCJUbyBib3R0b21cIixcbiAgICBpY29uOiBVbnB1Ymxpc2hJY29uLFxuICAgIGFjdGlvbjogKCkgPT4gZG9jLnBhdGNoKG1vdmVMYXN0UGF0Y2hlcyksXG4gICAgdGVsZW1ldHJ5RXZlbnQ6IFwiVmlzdWFsIEVkaXRpbmcgQ29udGV4dCBNZW51IEl0ZW0gTW92ZWRcIlxuICB9KSwgZ3JvdXBJdGVtcy5sZW5ndGggJiYgKGl0ZW1zLnB1c2goe1xuICAgIHR5cGU6IFwiZ3JvdXBcIixcbiAgICBsYWJlbDogXCJNb3ZlXCIsXG4gICAgaWNvbjogU29ydEljb24sXG4gICAgaXRlbXM6IGdyb3VwSXRlbXNcbiAgfSksIHdpdGhEaXZpZGVyICYmIGl0ZW1zLnB1c2goe1xuICAgIHR5cGU6IFwiZGl2aWRlclwiXG4gIH0pKSwgaXRlbXM7XG59XG5hc3luYyBmdW5jdGlvbiBnZXRDb250ZXh0TWVudUFycmF5SXRlbXMoY29udGV4dCkge1xuICBjb25zdCB7XG4gICAgbm9kZSxcbiAgICBmaWVsZCxcbiAgICBkb2NcbiAgfSA9IGNvbnRleHQsIGl0ZW1zID0gW107XG4gIHJldHVybiBpdGVtcy5wdXNoKC4uLmdldER1cGxpY2F0ZUl0ZW0oY29udGV4dCkpLCBpdGVtcy5wdXNoKC4uLmdldFJlbW92ZUl0ZW1zKGNvbnRleHQpKSwgaXRlbXMucHVzaCguLi5hd2FpdCBnZXRNb3ZlSXRlbXMoY29udGV4dCkpLCBpdGVtcy5wdXNoKHtcbiAgICB0eXBlOiBcImFjdGlvblwiLFxuICAgIGxhYmVsOiBcIkluc2VydCBiZWZvcmVcIixcbiAgICBpY29uOiBJbnNlcnRBYm92ZUljb24sXG4gICAgYWN0aW9uOiBnZXRBcnJheUluc2VydEFjdGlvbihub2RlLCBkb2MsIGZpZWxkLm5hbWUsIFwiYmVmb3JlXCIpLFxuICAgIHRlbGVtZXRyeUV2ZW50OiBcIlZpc3VhbCBFZGl0aW5nIENvbnRleHQgTWVudSBJdGVtIEluc2VydGVkXCJcbiAgfSksIGl0ZW1zLnB1c2goe1xuICAgIHR5cGU6IFwiYWN0aW9uXCIsXG4gICAgbGFiZWw6IFwiSW5zZXJ0IGFmdGVyXCIsXG4gICAgaWNvbjogSW5zZXJ0QmVsb3dJY29uLFxuICAgIGFjdGlvbjogZ2V0QXJyYXlJbnNlcnRBY3Rpb24obm9kZSwgZG9jLCBmaWVsZC5uYW1lLCBcImFmdGVyXCIpLFxuICAgIHRlbGVtZXRyeUV2ZW50OiBcIlZpc3VhbCBFZGl0aW5nIENvbnRleHQgTWVudSBJdGVtIEluc2VydGVkXCJcbiAgfSksIGl0ZW1zO1xufVxuY29uc3QgSW5zZXJ0TWVudVdyYXBwZXIgPSAocHJvcHMpID0+IHtcbiAgY29uc3QgJCA9IGMoMTIpLCB7XG4gICAgbGFiZWwsXG4gICAgcGFyZW50LFxuICAgIHdpZHRoLFxuICAgIG9uU2VsZWN0LFxuICAgIGJvdW5kYXJ5RWxlbWVudFxuICB9ID0gcHJvcHM7XG4gIGxldCB0MDtcbiAgJFswXSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDAgPSBbXCJsZWZ0LXN0YXJ0XCIsIFwicmlnaHRcIiwgXCJsZWZ0XCIsIFwicmlnaHQtZW5kXCIsIFwibGVmdC1lbmRcIiwgXCJib3R0b21cIiwgXCJ0b3BcIl0sICRbMF0gPSB0MCkgOiB0MCA9ICRbMF07XG4gIGxldCB0MTtcbiAgJFsxXSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDEgPSBbNCwgNCwgNCwgNF0sICRbMV0gPSB0MSkgOiB0MSA9ICRbMV07XG4gIGxldCB0MjtcbiAgJFsyXSAhPT0gYm91bmRhcnlFbGVtZW50IHx8ICRbM10gIT09IHdpZHRoID8gKHQyID0ge1xuICAgIGFycm93OiAhMSxcbiAgICBjb25zdHJhaW5TaXplOiAhMCxcbiAgICBmbG9hdGluZ0JvdW5kYXJ5OiBib3VuZGFyeUVsZW1lbnQsXG4gICAgcGFkZGluZzogMCxcbiAgICBwbGFjZW1lbnQ6IFwicmlnaHQtc3RhcnRcIixcbiAgICBmYWxsYmFja1BsYWNlbWVudHM6IHQwLFxuICAgIHByZXZlbnRPdmVyZmxvdzogITAsXG4gICAgd2lkdGgsXG4gICAgX191bnN0YWJsZV9tYXJnaW5zOiB0MVxuICB9LCAkWzJdID0gYm91bmRhcnlFbGVtZW50LCAkWzNdID0gd2lkdGgsICRbNF0gPSB0MikgOiB0MiA9ICRbNF07XG4gIGxldCB0MztcbiAgJFs1XSAhPT0gb25TZWxlY3QgfHwgJFs2XSAhPT0gcGFyZW50ID8gKHQzID0gLyogQF9fUFVSRV9fICovIGpzeChJbnNlcnRNZW51LCB7IG5vZGU6IHBhcmVudCwgb25TZWxlY3QgfSksICRbNV0gPSBvblNlbGVjdCwgJFs2XSA9IHBhcmVudCwgJFs3XSA9IHQzKSA6IHQzID0gJFs3XTtcbiAgbGV0IHQ0O1xuICByZXR1cm4gJFs4XSAhPT0gbGFiZWwgfHwgJFs5XSAhPT0gdDIgfHwgJFsxMF0gIT09IHQzID8gKHQ0ID0gLyogQF9fUFVSRV9fICovIGpzeChNZW51R3JvdXAsIHsgZm9udFNpemU6IDEsIGljb246IEluc2VydEJlbG93SWNvbiwgcGFkZGluZzogMiwgcG9wb3ZlcjogdDIsIHNwYWNlOiAyLCB0ZXh0OiBsYWJlbCwgY2hpbGRyZW46IHQzIH0pLCAkWzhdID0gbGFiZWwsICRbOV0gPSB0MiwgJFsxMF0gPSB0MywgJFsxMV0gPSB0NCkgOiB0NCA9ICRbMTFdLCB0NDtcbn07XG5hc3luYyBmdW5jdGlvbiBnZXRDb250ZXh0TWVudVVuaW9uSXRlbXMoY29udGV4dCkge1xuICBjb25zdCB7XG4gICAgZG9jLFxuICAgIG5vZGUsXG4gICAgcGFyZW50XG4gIH0gPSBjb250ZXh0LCBpdGVtcyA9IFtdO1xuICBpZiAoaXRlbXMucHVzaCguLi5nZXREdXBsaWNhdGVJdGVtKGNvbnRleHQpKSwgaXRlbXMucHVzaCguLi5nZXRSZW1vdmVJdGVtcyhjb250ZXh0KSksIGl0ZW1zLnB1c2goLi4uYXdhaXQgZ2V0TW92ZUl0ZW1zKGNvbnRleHQpKSwgcGFyZW50Lm9wdGlvbnM/Lmluc2VydE1lbnUpIHtcbiAgICBjb25zdCB3aWR0aCA9IChwYXJlbnQub3B0aW9ucy5pbnNlcnRNZW51IHx8IHt9KS52aWV3cz8uc29tZSgodmlldykgPT4gdmlldy5uYW1lID09PSBcImdyaWRcIikgPyAwIDogdm9pZCAwO1xuICAgIGl0ZW1zLnB1c2goe1xuICAgICAgdHlwZTogXCJjdXN0b21cIixcbiAgICAgIGNvbXBvbmVudDogKHtcbiAgICAgICAgYm91bmRhcnlFbGVtZW50LFxuICAgICAgICBzZW5kVGVsZW1ldHJ5XG4gICAgICB9KSA9PiAvKiBAX19QVVJFX18gKi8ganN4KEluc2VydE1lbnVXcmFwcGVyLCB7IGxhYmVsOiBcIkluc2VydCBiZWZvcmVcIiwgb25TZWxlY3Q6IChzY2hlbWFUeXBlKSA9PiB7XG4gICAgICAgIGdldEFycmF5SW5zZXJ0QWN0aW9uKG5vZGUsIGRvYywgc2NoZW1hVHlwZS5uYW1lLCBcImJlZm9yZVwiKSgpLCBzZW5kVGVsZW1ldHJ5KFwiVmlzdWFsIEVkaXRpbmcgQ29udGV4dCBNZW51IEl0ZW0gSW5zZXJ0ZWRcIiwgbnVsbCk7XG4gICAgICB9LCBwYXJlbnQsIHdpZHRoLCBib3VuZGFyeUVsZW1lbnQgfSlcbiAgICB9KSwgaXRlbXMucHVzaCh7XG4gICAgICB0eXBlOiBcImN1c3RvbVwiLFxuICAgICAgY29tcG9uZW50OiAoe1xuICAgICAgICBib3VuZGFyeUVsZW1lbnQsXG4gICAgICAgIHNlbmRUZWxlbWV0cnlcbiAgICAgIH0pID0+IC8qIEBfX1BVUkVfXyAqLyBqc3goSW5zZXJ0TWVudVdyYXBwZXIsIHsgbGFiZWw6IFwiSW5zZXJ0IGFmdGVyXCIsIG9uU2VsZWN0OiAoc2NoZW1hVHlwZSkgPT4ge1xuICAgICAgICBnZXRBcnJheUluc2VydEFjdGlvbihub2RlLCBkb2MsIHNjaGVtYVR5cGUubmFtZSwgXCJhZnRlclwiKSgpLCBzZW5kVGVsZW1ldHJ5KFwiVmlzdWFsIEVkaXRpbmcgQ29udGV4dCBNZW51IEl0ZW0gSW5zZXJ0ZWRcIiwgbnVsbCk7XG4gICAgICB9LCBwYXJlbnQsIHdpZHRoLCBib3VuZGFyeUVsZW1lbnQgfSlcbiAgICB9KTtcbiAgfSBlbHNlXG4gICAgaXRlbXMucHVzaCh7XG4gICAgICB0eXBlOiBcImdyb3VwXCIsXG4gICAgICBsYWJlbDogXCJJbnNlcnQgYmVmb3JlXCIsXG4gICAgICBpY29uOiBJbnNlcnRBYm92ZUljb24sXG4gICAgICBpdGVtczogcGFyZW50Lm9mLmZpbHRlcigoaXRlbSkgPT4gaXRlbS50eXBlID09PSBcInVuaW9uT3B0aW9uXCIpLm1hcCgodCkgPT4gKHtcbiAgICAgICAgdHlwZTogXCJhY3Rpb25cIixcbiAgICAgICAgaWNvbjogZ2V0Tm9kZUljb24odCksXG4gICAgICAgIGxhYmVsOiB0Lm5hbWUgPT09IFwiYmxvY2tcIiA/IFwiUGFyYWdyYXBoXCIgOiB0LnRpdGxlIHx8IHQubmFtZSxcbiAgICAgICAgYWN0aW9uOiBnZXRBcnJheUluc2VydEFjdGlvbihub2RlLCBkb2MsIHQubmFtZSwgXCJiZWZvcmVcIiksXG4gICAgICAgIHRlbGVtZXRyeUV2ZW50OiBcIlZpc3VhbCBFZGl0aW5nIENvbnRleHQgTWVudSBJdGVtIEluc2VydGVkXCJcbiAgICAgIH0pKVxuICAgIH0pLCBpdGVtcy5wdXNoKHtcbiAgICAgIHR5cGU6IFwiZ3JvdXBcIixcbiAgICAgIGxhYmVsOiBcIkluc2VydCBhZnRlclwiLFxuICAgICAgaWNvbjogSW5zZXJ0QmVsb3dJY29uLFxuICAgICAgaXRlbXM6IHBhcmVudC5vZi5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0udHlwZSA9PT0gXCJ1bmlvbk9wdGlvblwiKS5tYXAoKHQpID0+ICh7XG4gICAgICAgIHR5cGU6IFwiYWN0aW9uXCIsXG4gICAgICAgIGxhYmVsOiB0Lm5hbWUgPT09IFwiYmxvY2tcIiA/IFwiUGFyYWdyYXBoXCIgOiB0LnRpdGxlIHx8IHQubmFtZSxcbiAgICAgICAgaWNvbjogZ2V0Tm9kZUljb24odCksXG4gICAgICAgIGFjdGlvbjogZ2V0QXJyYXlJbnNlcnRBY3Rpb24obm9kZSwgZG9jLCB0Lm5hbWUsIFwiYWZ0ZXJcIiksXG4gICAgICAgIHRlbGVtZXRyeUV2ZW50OiBcIlZpc3VhbCBFZGl0aW5nIENvbnRleHQgTWVudSBJdGVtIEluc2VydGVkXCJcbiAgICAgIH0pKVxuICAgIH0pO1xuICByZXR1cm4gaXRlbXM7XG59XG5jb25zdCBQT1BPVkVSX01BUkdJTlMgPSBbLTQsIDQsIC00LCA0XTtcbmZ1bmN0aW9uIENvbnRleHRNZW51SXRlbShwcm9wcykge1xuICBjb25zdCAkID0gYygyNyksIHtcbiAgICBub2RlLFxuICAgIG9uRGlzbWlzcyxcbiAgICBib3VuZGFyeUVsZW1lbnRcbiAgfSA9IHByb3BzLCBzZW5kVGVsZW1ldHJ5ID0gdXNlVGVsZW1ldHJ5KCk7XG4gIGxldCB0MDtcbiAgJFswXSAhPT0gbm9kZSB8fCAkWzFdICE9PSBvbkRpc21pc3MgfHwgJFsyXSAhPT0gc2VuZFRlbGVtZXRyeSA/ICh0MCA9ICgpID0+IHtcbiAgICBub2RlLnR5cGUgPT09IFwiYWN0aW9uXCIgJiYgKG5vZGUuYWN0aW9uPy4oKSwgb25EaXNtaXNzPy4oKSwgbm9kZS50ZWxlbWV0cnlFdmVudCAmJiBzZW5kVGVsZW1ldHJ5KG5vZGUudGVsZW1ldHJ5RXZlbnQsIG51bGwpKTtcbiAgfSwgJFswXSA9IG5vZGUsICRbMV0gPSBvbkRpc21pc3MsICRbMl0gPSBzZW5kVGVsZW1ldHJ5LCAkWzNdID0gdDApIDogdDAgPSAkWzNdO1xuICBjb25zdCBvbkNsaWNrID0gdDA7XG4gIGlmIChub2RlLnR5cGUgPT09IFwiZGl2aWRlclwiKSB7XG4gICAgbGV0IHQxO1xuICAgIHJldHVybiAkWzRdID09PSBTeW1ib2wuZm9yKFwicmVhY3QubWVtb19jYWNoZV9zZW50aW5lbFwiKSA/ICh0MSA9IC8qIEBfX1BVUkVfXyAqLyBqc3goTWVudURpdmlkZXIsIHt9KSwgJFs0XSA9IHQxKSA6IHQxID0gJFs0XSwgdDE7XG4gIH1cbiAgaWYgKG5vZGUudHlwZSA9PT0gXCJhY3Rpb25cIikge1xuICAgIGNvbnN0IHQxID0gIW5vZGUuYWN0aW9uO1xuICAgIGxldCB0MjtcbiAgICByZXR1cm4gJFs1XSAhPT0gbm9kZS5ob3RrZXlzIHx8ICRbNl0gIT09IG5vZGUuaWNvbiB8fCAkWzddICE9PSBub2RlLmxhYmVsIHx8ICRbOF0gIT09IG9uQ2xpY2sgfHwgJFs5XSAhPT0gdDEgPyAodDIgPSAvKiBAX19QVVJFX18gKi8ganN4KE1lbnVJdGVtLCB7IGZvbnRTaXplOiAxLCBob3RrZXlzOiBub2RlLmhvdGtleXMsIGljb246IG5vZGUuaWNvbiwgcGFkZGluZzogMiwgc3BhY2U6IDIsIHRleHQ6IG5vZGUubGFiZWwsIGRpc2FibGVkOiB0MSwgb25DbGljayB9KSwgJFs1XSA9IG5vZGUuaG90a2V5cywgJFs2XSA9IG5vZGUuaWNvbiwgJFs3XSA9IG5vZGUubGFiZWwsICRbOF0gPSBvbkNsaWNrLCAkWzldID0gdDEsICRbMTBdID0gdDIpIDogdDIgPSAkWzEwXSwgdDI7XG4gIH1cbiAgaWYgKG5vZGUudHlwZSA9PT0gXCJncm91cFwiKSB7XG4gICAgY29uc3QgdDEgPSBub2RlLmljb247XG4gICAgbGV0IHQyO1xuICAgICRbMTFdID09PSBTeW1ib2wuZm9yKFwicmVhY3QubWVtb19jYWNoZV9zZW50aW5lbFwiKSA/ICh0MiA9IHtcbiAgICAgIGFycm93OiAhMSxcbiAgICAgIGNvbnN0cmFpblNpemU6ICEwLFxuICAgICAgcGxhY2VtZW50OiBcInJpZ2h0LXN0YXJ0XCIsXG4gICAgICBmYWxsYmFja1BsYWNlbWVudHM6IFtcImxlZnQtc3RhcnRcIiwgXCJyaWdodFwiLCBcImxlZnRcIiwgXCJyaWdodC1lbmRcIiwgXCJsZWZ0LWVuZFwiLCBcImJvdHRvbVwiLCBcInRvcFwiXSxcbiAgICAgIHByZXZlbnRPdmVyZmxvdzogITAsXG4gICAgICBfX3Vuc3RhYmxlX21hcmdpbnM6IFBPUE9WRVJfTUFSR0lOU1xuICAgIH0sICRbMTFdID0gdDIpIDogdDIgPSAkWzExXTtcbiAgICBjb25zdCB0MyA9IG5vZGUubGFiZWw7XG4gICAgbGV0IHQ0O1xuICAgIGlmICgkWzEyXSAhPT0gYm91bmRhcnlFbGVtZW50IHx8ICRbMTNdICE9PSBub2RlLml0ZW1zIHx8ICRbMTRdICE9PSBvbkRpc21pc3MpIHtcbiAgICAgIGxldCB0NTI7XG4gICAgICAkWzE2XSAhPT0gYm91bmRhcnlFbGVtZW50IHx8ICRbMTddICE9PSBvbkRpc21pc3MgPyAodDUyID0gKGl0ZW0sIGl0ZW1JbmRleCkgPT4gLyogQF9fUFVSRV9fICovIGpzeChDb250ZXh0TWVudUl0ZW0sIHsgbm9kZTogaXRlbSwgb25EaXNtaXNzLCBib3VuZGFyeUVsZW1lbnQgfSwgaXRlbUluZGV4KSwgJFsxNl0gPSBib3VuZGFyeUVsZW1lbnQsICRbMTddID0gb25EaXNtaXNzLCAkWzE4XSA9IHQ1MikgOiB0NTIgPSAkWzE4XSwgdDQgPSBub2RlLml0ZW1zLm1hcCh0NTIpLCAkWzEyXSA9IGJvdW5kYXJ5RWxlbWVudCwgJFsxM10gPSBub2RlLml0ZW1zLCAkWzE0XSA9IG9uRGlzbWlzcywgJFsxNV0gPSB0NDtcbiAgICB9IGVsc2VcbiAgICAgIHQ0ID0gJFsxNV07XG4gICAgbGV0IHQ1O1xuICAgIHJldHVybiAkWzE5XSAhPT0gbm9kZS5pY29uIHx8ICRbMjBdICE9PSBub2RlLmxhYmVsIHx8ICRbMjFdICE9PSB0NCA/ICh0NSA9IC8qIEBfX1BVUkVfXyAqLyBqc3goTWVudUdyb3VwLCB7IGZvbnRTaXplOiAxLCBpY29uOiB0MSwgcGFkZGluZzogMiwgcG9wb3ZlcjogdDIsIHNwYWNlOiAyLCB0ZXh0OiB0MywgY2hpbGRyZW46IHQ0IH0pLCAkWzE5XSA9IG5vZGUuaWNvbiwgJFsyMF0gPSBub2RlLmxhYmVsLCAkWzIxXSA9IHQ0LCAkWzIyXSA9IHQ1KSA6IHQ1ID0gJFsyMl0sIHQ1O1xuICB9XG4gIGlmIChub2RlLnR5cGUgPT09IFwiY3VzdG9tXCIpIHtcbiAgICBjb25zdCB7XG4gICAgICBjb21wb25lbnQ6IENvbXBvbmVudFxuICAgIH0gPSBub2RlO1xuICAgIGxldCB0MTtcbiAgICByZXR1cm4gJFsyM10gIT09IENvbXBvbmVudCB8fCAkWzI0XSAhPT0gYm91bmRhcnlFbGVtZW50IHx8ICRbMjVdICE9PSBzZW5kVGVsZW1ldHJ5ID8gKHQxID0gLyogQF9fUFVSRV9fICovIGpzeChDb21wb25lbnQsIHsgYm91bmRhcnlFbGVtZW50LCBzZW5kVGVsZW1ldHJ5IH0pLCAkWzIzXSA9IENvbXBvbmVudCwgJFsyNF0gPSBib3VuZGFyeUVsZW1lbnQsICRbMjVdID0gc2VuZFRlbGVtZXRyeSwgJFsyNl0gPSB0MSkgOiB0MSA9ICRbMjZdLCB0MTtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cbmNvbnN0IENvbnRleHRNZW51ID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDQzKSwge1xuICAgIG5vZGUsXG4gICAgb25EaXNtaXNzLFxuICAgIHBvc2l0aW9uOiB0MFxuICB9ID0gcHJvcHMsIHtcbiAgICB4LFxuICAgIHlcbiAgfSA9IHQwLCBbYm91bmRhcnlFbGVtZW50LCBzZXRCb3VuZGFyeUVsZW1lbnRdID0gdXNlU3RhdGUobnVsbCksIHtcbiAgICBnZXRGaWVsZFxuICB9ID0gdXNlU2NoZW1hKCksIHtcbiAgICBnZXREb2N1bWVudFxuICB9ID0gdXNlRG9jdW1lbnRzKCk7XG4gIGxldCB0MTtcbiAgJFswXSAhPT0gZ2V0RmllbGQgfHwgJFsxXSAhPT0gbm9kZSA/ICh0MSA9IGdldEZpZWxkKG5vZGUpLCAkWzBdID0gZ2V0RmllbGQsICRbMV0gPSBub2RlLCAkWzJdID0gdDEpIDogdDEgPSAkWzJdO1xuICBjb25zdCB7XG4gICAgZmllbGQsXG4gICAgcGFyZW50XG4gIH0gPSB0MTtcbiAgbGV0IHQyO1xuICB0MiA9IGZpZWxkPy50aXRsZSB8fCBmaWVsZD8ubmFtZSB8fCBcIlVua25vd24gdHlwZVwiO1xuICBjb25zdCB0aXRsZSA9IHQyLCBbaXRlbXMsIHNldEl0ZW1zXSA9IHVzZVN0YXRlKHZvaWQgMCk7XG4gIGxldCB0MywgdDQ7XG4gICRbM10gIT09IGZpZWxkIHx8ICRbNF0gIT09IGdldERvY3VtZW50IHx8ICRbNV0gIT09IG5vZGUgfHwgJFs2XSAhPT0gcGFyZW50ID8gKHQzID0gKCkgPT4ge1xuICAgIChhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkb2MgPSBnZXREb2N1bWVudChub2RlLmlkKTtcbiAgICAgIGlmICghZG9jKVxuICAgICAgICByZXR1cm47XG4gICAgICBjb25zdCBpdGVtc18wID0gYXdhaXQgZ2V0Q29udGV4dE1lbnVJdGVtcyh7XG4gICAgICAgIG5vZGUsXG4gICAgICAgIGZpZWxkLFxuICAgICAgICBwYXJlbnQsXG4gICAgICAgIGRvY1xuICAgICAgfSk7XG4gICAgICBzZXRJdGVtcyhpdGVtc18wKTtcbiAgICB9KSgpO1xuICB9LCB0NCA9IFtmaWVsZCwgbm9kZSwgcGFyZW50LCBnZXREb2N1bWVudF0sICRbM10gPSBmaWVsZCwgJFs0XSA9IGdldERvY3VtZW50LCAkWzVdID0gbm9kZSwgJFs2XSA9IHBhcmVudCwgJFs3XSA9IHQzLCAkWzhdID0gdDQpIDogKHQzID0gJFs3XSwgdDQgPSAkWzhdKSwgdXNlRWZmZWN0KHQzLCB0NCk7XG4gIGxldCB0NSwgdDY7XG4gICRbOV0gIT09IHggfHwgJFsxMF0gIT09IHkgPyAodDYgPSB7XG4gICAgZ2V0Qm91bmRpbmdDbGllbnRSZWN0OiAoKSA9PiAoe1xuICAgICAgYm90dG9tOiB5LFxuICAgICAgbGVmdDogeCxcbiAgICAgIHJpZ2h0OiB4LFxuICAgICAgdG9wOiB5LFxuICAgICAgd2lkdGg6IDAsXG4gICAgICBoZWlnaHQ6IDBcbiAgICB9KVxuICB9LCAkWzldID0geCwgJFsxMF0gPSB5LCAkWzExXSA9IHQ2KSA6IHQ2ID0gJFsxMV0sIHQ1ID0gdDY7XG4gIGNvbnN0IGNvbnRleHRNZW51UmVmZXJlbmNlRWxlbWVudCA9IHQ1O1xuICBsZXQgdDcsIHQ4O1xuICAkWzEyXSAhPT0gZmllbGQgPyAodDggPSBnZXROb2RlSWNvbihmaWVsZCksICRbMTJdID0gZmllbGQsICRbMTNdID0gdDgpIDogdDggPSAkWzEzXSwgdDcgPSB0ODtcbiAgY29uc3QgaWNvbiA9IHQ3O1xuICBsZXQgdDk7XG4gICRbMTRdID09PSBTeW1ib2wuZm9yKFwicmVhY3QubWVtb19jYWNoZV9zZW50aW5lbFwiKSA/ICh0OSA9IHtcbiAgICBtaW5XaWR0aDogMTIwLFxuICAgIG1heFdpZHRoOiAxNjBcbiAgfSwgJFsxNF0gPSB0OSkgOiB0OSA9ICRbMTRdO1xuICBsZXQgdDEwO1xuICAkWzE1XSAhPT0gaWNvbiB8fCAkWzE2XSAhPT0gaXRlbXMgPyAodDEwID0gLyogQF9fUFVSRV9fICovIGpzeChCb3gsIHsgZmxleDogXCJub25lXCIsIGNoaWxkcmVuOiBpdGVtcyA/IC8qIEBfX1BVUkVfXyAqLyBqc3goVGV4dCwgeyBzaXplOiAxLCBjaGlsZHJlbjogaWNvbiB9KSA6IC8qIEBfX1BVUkVfXyAqLyBqc3goU3Bpbm5lciwgeyBzaXplOiAxIH0pIH0pLCAkWzE1XSA9IGljb24sICRbMTZdID0gaXRlbXMsICRbMTddID0gdDEwKSA6IHQxMCA9ICRbMTddO1xuICBjb25zdCB0MTEgPSBpdGVtcyA/IHRpdGxlIDogXCJMb2FkaW5nLi4uXCI7XG4gIGxldCB0MTI7XG4gICRbMThdICE9PSB0MTEgPyAodDEyID0gLyogQF9fUFVSRV9fICovIGpzeChTdGFjaywgeyBmbGV4OiAxLCBzcGFjZTogMiwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goVGV4dCwgeyBzaXplOiAxLCB3ZWlnaHQ6IFwic2VtaWJvbGRcIiwgY2hpbGRyZW46IHQxMSB9KSB9KSwgJFsxOF0gPSB0MTEsICRbMTldID0gdDEyKSA6IHQxMiA9ICRbMTldO1xuICBsZXQgdDEzO1xuICAkWzIwXSAhPT0gdDEwIHx8ICRbMjFdICE9PSB0MTIgPyAodDEzID0gLyogQF9fUFVSRV9fICovIGpzeHMoRmxleCwgeyBnYXA6IDIsIHBhZGRpbmc6IDIsIGNoaWxkcmVuOiBbXG4gICAgdDEwLFxuICAgIHQxMlxuICBdIH0pLCAkWzIwXSA9IHQxMCwgJFsyMV0gPSB0MTIsICRbMjJdID0gdDEzKSA6IHQxMyA9ICRbMjJdO1xuICBsZXQgdDE0O1xuICAkWzIzXSAhPT0gYm91bmRhcnlFbGVtZW50IHx8ICRbMjRdICE9PSBpdGVtcyB8fCAkWzI1XSAhPT0gb25EaXNtaXNzID8gKHQxNCA9IGl0ZW1zICYmIC8qIEBfX1BVUkVfXyAqLyBqc3hzKEZyYWdtZW50LCB7IGNoaWxkcmVuOiBbXG4gICAgLyogQF9fUFVSRV9fICovIGpzeChNZW51RGl2aWRlciwge30pLFxuICAgIGl0ZW1zLm1hcCgoaXRlbSwgaSkgPT4gLyogQF9fUFVSRV9fICovIGpzeChDb250ZXh0TWVudUl0ZW0sIHsgbm9kZTogaXRlbSwgb25EaXNtaXNzLCBib3VuZGFyeUVsZW1lbnQgfSwgaSkpXG4gIF0gfSksICRbMjNdID0gYm91bmRhcnlFbGVtZW50LCAkWzI0XSA9IGl0ZW1zLCAkWzI1XSA9IG9uRGlzbWlzcywgJFsyNl0gPSB0MTQpIDogdDE0ID0gJFsyNl07XG4gIGxldCB0MTU7XG4gICRbMjddICE9PSB0MTMgfHwgJFsyOF0gIT09IHQxNCA/ICh0MTUgPSAvKiBAX19QVVJFX18gKi8ganN4cyhNZW51LCB7IHN0eWxlOiB0OSwgY2hpbGRyZW46IFtcbiAgICB0MTMsXG4gICAgdDE0XG4gIF0gfSksICRbMjddID0gdDEzLCAkWzI4XSA9IHQxNCwgJFsyOV0gPSB0MTUpIDogdDE1ID0gJFsyOV07XG4gIGNvbnN0IHQxNiA9IGAke3h9LSR7eX1gO1xuICBsZXQgdDE3O1xuICAkWzMwXSAhPT0geCB8fCAkWzMxXSAhPT0geSA/ICh0MTcgPSB7XG4gICAgcG9zaXRpb246IFwiYWJzb2x1dGVcIixcbiAgICBsZWZ0OiB4LFxuICAgIHRvcDogeVxuICB9LCAkWzMwXSA9IHgsICRbMzFdID0geSwgJFszMl0gPSB0MTcpIDogdDE3ID0gJFszMl07XG4gIGxldCB0MTg7XG4gICRbMzNdICE9PSB0MTYgfHwgJFszNF0gIT09IHQxNyA/ICh0MTggPSAvKiBAX19QVVJFX18gKi8ganN4KFwiZGl2XCIsIHsgc3R5bGU6IHQxNyB9LCB0MTYpLCAkWzMzXSA9IHQxNiwgJFszNF0gPSB0MTcsICRbMzVdID0gdDE4KSA6IHQxOCA9ICRbMzVdO1xuICBsZXQgdDE5O1xuICAkWzM2XSAhPT0gY29udGV4dE1lbnVSZWZlcmVuY2VFbGVtZW50IHx8ICRbMzddICE9PSB0MTUgfHwgJFszOF0gIT09IHQxOCA/ICh0MTkgPSAvKiBAX19QVVJFX18gKi8ganN4KFBvcG92ZXIsIHsgX191bnN0YWJsZV9tYXJnaW5zOiBQT1BPVkVSX01BUkdJTlMsIGFycm93OiAhMSwgb3BlbjogITAsIHBsYWNlbWVudDogXCJyaWdodC1zdGFydFwiLCByZWZlcmVuY2VFbGVtZW50OiBjb250ZXh0TWVudVJlZmVyZW5jZUVsZW1lbnQsIGNvbnRlbnQ6IHQxNSwgY2hpbGRyZW46IHQxOCB9KSwgJFszNl0gPSBjb250ZXh0TWVudVJlZmVyZW5jZUVsZW1lbnQsICRbMzddID0gdDE1LCAkWzM4XSA9IHQxOCwgJFszOV0gPSB0MTkpIDogdDE5ID0gJFszOV07XG4gIGxldCB0MjA7XG4gIHJldHVybiAkWzQwXSAhPT0gb25EaXNtaXNzIHx8ICRbNDFdICE9PSB0MTkgPyAodDIwID0gLyogQF9fUFVSRV9fICovIGpzeChQb3BvdmVyUG9ydGFsLCB7IHNldEJvdW5kYXJ5RWxlbWVudCwgb25EaXNtaXNzLCBjaGlsZHJlbjogdDE5IH0pLCAkWzQwXSA9IG9uRGlzbWlzcywgJFs0MV0gPSB0MTksICRbNDJdID0gdDIwKSA6IHQyMCA9ICRbNDJdLCB0MjA7XG59O1xuZnVuY3Rpb24gZ2V0TGlua0hyZWYoaHJlZiwgcmVmZXJlcikge1xuICB0cnkge1xuICAgIGNvbnN0IHBhcnNlZCA9IG5ldyBVUkwoaHJlZiwgdHlwZW9mIGxvY2F0aW9uID4gXCJ1XCIgPyB2b2lkIDAgOiBsb2NhdGlvbi5vcmlnaW4pO1xuICAgIGlmIChwYXJzZWQuaGFzaCkge1xuICAgICAgY29uc3QgaGFzaCA9IG5ldyBVUkwoZ2V0TGlua0hyZWYocGFyc2VkLmhhc2guc2xpY2UoMSksIHJlZmVyZXIpKTtcbiAgICAgIHJldHVybiBgJHtwYXJzZWQub3JpZ2lufSR7cGFyc2VkLnBhdGhuYW1lfSR7cGFyc2VkLnNlYXJjaH0jJHtoYXNoLnBhdGhuYW1lfSR7aGFzaC5zZWFyY2h9YDtcbiAgICB9XG4gICAgcmV0dXJuIHBhcnNlZC5zZWFyY2hQYXJhbXMuc2V0KFwicHJldmlld1wiLCByZWZlcmVyKSwgcGFyc2VkLnRvU3RyaW5nKCk7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBocmVmO1xuICB9XG59XG5jb25zdCBQcmV2aWV3U25hcHNob3RzQ29udGV4dCA9IGNyZWF0ZUNvbnRleHQobnVsbCk7XG5mdW5jdGlvbiB1c2VQcmV2aWV3U25hcHNob3RzKCkge1xuICBjb25zdCBjb250ZXh0ID0gdXNlQ29udGV4dChQcmV2aWV3U25hcHNob3RzQ29udGV4dCk7XG4gIGlmICghY29udGV4dClcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJQcmV2aWV3IFNuYXBzaG90cyBjb250ZXh0IGlzIG1pc3NpbmdcIik7XG4gIHJldHVybiBjb250ZXh0O1xufVxuY29uc3QgaXNSZWFjdEVsZW1lbnRPdmVybGF5Q29tcG9uZW50ID0gKGNvbXBvbmVudCkgPT4gaXNWYWxpZEVsZW1lbnQoY29tcG9uZW50KSwgUm9vdCQzID0gc3R5bGVkKENhcmQpYFxuICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1vdmVybGF5LWJnKTtcbiAgYm9yZGVyLXJhZGl1czogM3B4O1xuICBwb2ludGVyLWV2ZW50czogbm9uZTtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICB3aWxsLWNoYW5nZTogdHJhbnNmb3JtO1xuICBib3gtc2hhZG93OiB2YXIoLS1vdmVybGF5LWJveC1zaGFkb3cpO1xuICB0cmFuc2l0aW9uOiBub25lO1xuXG4gIC0tb3ZlcmxheS1iZzogdHJhbnNwYXJlbnQ7XG4gIC0tb3ZlcmxheS1ib3gtc2hhZG93OiBpbnNldCAwIDAgMCAxcHggdHJhbnNwYXJlbnQ7XG5cbiAgW2RhdGEtb3ZlcmxheXNdICYge1xuICAgIC0tb3ZlcmxheS1iZzogY29sb3ItbWl4KGluIHNyZ2IsIHRyYW5zcGFyZW50IDk1JSwgdmFyKC0tY2FyZC1mb2N1cy1yaW5nLWNvbG9yKSk7XG4gICAgLS1vdmVybGF5LWJveC1zaGFkb3c6IGluc2V0IDAgMCAwIDJweFxuICAgICAgY29sb3ItbWl4KGluIHNyZ2IsIHRyYW5zcGFyZW50IDUwJSwgdmFyKC0tY2FyZC1mb2N1cy1yaW5nLWNvbG9yKSk7XG4gIH1cblxuICBbZGF0YS1mYWRpbmctb3V0XSAmIHtcbiAgICB0cmFuc2l0aW9uOlxuICAgICAgYm94LXNoYWRvdyAxNTUwbXMsXG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yIDE1NTBtcztcblxuICAgIC0tb3ZlcmxheS1iZzogcmdiYSgwLCAwLCAyNTUsIDApO1xuICAgIC0tb3ZlcmxheS1ib3gtc2hhZG93OiBpbnNldCAwIDAgMCAxcHggdHJhbnNwYXJlbnQ7XG4gIH1cblxuICAmW2RhdGEtZm9jdXNlZF0ge1xuICAgIC0tb3ZlcmxheS1ib3gtc2hhZG93OiBpbnNldCAwIDAgMCAxcHggdmFyKC0tY2FyZC1mb2N1cy1yaW5nLWNvbG9yKTtcbiAgfVxuXG4gICZbZGF0YS1ob3ZlcmVkXTpub3QoW2RhdGEtZm9jdXNlZF0pIHtcbiAgICB0cmFuc2l0aW9uOiBub25lO1xuICAgIC0tb3ZlcmxheS1ib3gtc2hhZG93OiBpbnNldCAwIDAgMCAycHggdmFyKC0tY2FyZC1mb2N1cy1yaW5nLWNvbG9yKTtcbiAgfVxuXG4gIC8qIFtkYXRhLXVubW91bnRlZF0gJiB7XG4gICAgLS1vdmVybGF5LWJveC1zaGFkb3c6IGluc2V0IDAgMCAwIDFweCB2YXIoLS1jYXJkLWZvY3VzLXJpbmctY29sb3IpO1xuICB9ICovXG5cbiAgOmxpbmsge1xuICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZTtcbiAgfVxuYCwgQWN0aW9ucyA9IHN0eWxlZChGbGV4KWBcbiAgYm90dG9tOiAxMDAlO1xuICBjdXJzb3I6IHBvaW50ZXI7XG4gIHBvaW50ZXItZXZlbnRzOiBub25lO1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHJpZ2h0OiAwO1xuXG4gIFtkYXRhLWhvdmVyZWRdICYge1xuICAgIHBvaW50ZXItZXZlbnRzOiBhbGw7XG4gIH1cblxuICBbZGF0YS1mbGlwcGVkXSAmIHtcbiAgICBib3R0b206IGF1dG87XG4gICAgdG9wOiAxMDAlO1xuICB9XG5gLCBUYWIgPSBzdHlsZWQoRmxleClgXG4gIGJvdHRvbTogMTAwJTtcbiAgY3Vyc29yOiBwb2ludGVyO1xuICBwb2ludGVyLWV2ZW50czogbm9uZTtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBsZWZ0OiAwO1xuXG4gIFtkYXRhLWhvdmVyZWRdICYge1xuICAgIHBvaW50ZXItZXZlbnRzOiBhbGw7XG4gIH1cblxuICBbZGF0YS1mbGlwcGVkXSAmIHtcbiAgICBib3R0b206IGF1dG87XG4gICAgdG9wOiAxMDAlO1xuICB9XG5gLCBBY3Rpb25PcGVuID0gc3R5bGVkKENhcmQpYFxuICBjdXJzb3I6IHBvaW50ZXI7XG4gIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWNhcmQtZm9jdXMtcmluZy1jb2xvcik7XG4gIHJpZ2h0OiAwO1xuICBib3JkZXItcmFkaXVzOiAzcHg7XG5cbiAgJiBbZGF0YS11aT0nVGV4dCddIHtcbiAgICBjb2xvcjogI2ZmZjtcbiAgICB3aGl0ZS1zcGFjZTogbm93cmFwO1xuICB9XG5gLCBMYWJlbHMgPSBzdHlsZWQoRmxleClgXG4gIGRpc3BsYXk6IGZsZXg7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWNhcmQtZm9jdXMtcmluZy1jb2xvcik7XG4gIHJpZ2h0OiAwO1xuICBib3JkZXItcmFkaXVzOiAzcHg7XG4gICYgW2RhdGEtdWk9J1RleHQnXSxcbiAgJiBbZGF0YS1zYW5pdHktaWNvbl0ge1xuICAgIGNvbG9yOiAjZmZmO1xuICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7XG4gIH1cbmA7XG5mdW5jdGlvbiBjcmVhdGVJbnRlbnRMaW5rKG5vZGUpIHtcbiAgY29uc3Qge1xuICAgIGlkLFxuICAgIHR5cGUsXG4gICAgcGF0aCxcbiAgICBiYXNlVXJsLFxuICAgIHRvb2wsXG4gICAgd29ya3NwYWNlXG4gIH0gPSBub2RlO1xuICByZXR1cm4gY3JlYXRlRWRpdFVybCh7XG4gICAgYmFzZVVybCxcbiAgICB3b3Jrc3BhY2UsXG4gICAgdG9vbCxcbiAgICB0eXBlLFxuICAgIGlkLFxuICAgIHBhdGg6IHBhdGhUb1VybFN0cmluZyhzdHVkaW9QYXRoLmZyb21TdHJpbmcocGF0aCkpXG4gIH0pO1xufVxuY29uc3QgRWxlbWVudE92ZXJsYXlJbm5lciA9IChwcm9wcykgPT4ge1xuICBjb25zdCAkID0gYygzNSksIHtcbiAgICBlbGVtZW50LFxuICAgIGZvY3VzZWQsXG4gICAgY29tcG9uZW50UmVzb2x2ZXIsXG4gICAgbm9kZSxcbiAgICBzaG93QWN0aW9ucyxcbiAgICBkcmFnZ2FibGVcbiAgfSA9IHByb3BzLCB7XG4gICAgZ2V0RmllbGQsXG4gICAgZ2V0VHlwZVxuICB9ID0gdXNlU2NoZW1hKCk7XG4gIGxldCB0MDtcbiAgJFswXSAhPT0gZ2V0VHlwZSB8fCAkWzFdICE9PSBub2RlID8gKHQwID0gZ2V0VHlwZShub2RlKSwgJFswXSA9IGdldFR5cGUsICRbMV0gPSBub2RlLCAkWzJdID0gdDApIDogdDAgPSAkWzJdO1xuICBjb25zdCBzY2hlbWFUeXBlID0gdDA7XG4gIGxldCB0MTtcbiAgJFszXSAhPT0gZ2V0RmllbGQgfHwgJFs0XSAhPT0gbm9kZSA/ICh0MSA9IGdldEZpZWxkKG5vZGUpLCAkWzNdID0gZ2V0RmllbGQsICRbNF0gPSBub2RlLCAkWzVdID0gdDEpIDogdDEgPSAkWzVdO1xuICBjb25zdCB7XG4gICAgZmllbGQsXG4gICAgcGFyZW50XG4gIH0gPSB0MTtcbiAgbGV0IHQyO1xuICAkWzZdICE9PSBub2RlID8gKHQyID0gXCJwYXRoXCIgaW4gbm9kZSA/IGNyZWF0ZUludGVudExpbmsobm9kZSkgOiBub2RlLmhyZWYsICRbNl0gPSBub2RlLCAkWzddID0gdDIpIDogdDIgPSAkWzddO1xuICBjb25zdCBocmVmID0gdDIsIHByZXZpZXdTbmFwc2hvdHMgPSB1c2VQcmV2aWV3U25hcHNob3RzKCk7XG4gIGxldCB0MztcbiAgYmIwOiB7XG4gICAgaWYgKCEoXCJwYXRoXCIgaW4gbm9kZSkpIHtcbiAgICAgIHQzID0gdm9pZCAwO1xuICAgICAgYnJlYWsgYmIwO1xuICAgIH1cbiAgICBsZXQgdDQyO1xuICAgICRbOF0gIT09IG5vZGUgfHwgJFs5XSAhPT0gcHJldmlld1NuYXBzaG90cyA/ICh0NDIgPSBwcmV2aWV3U25hcHNob3RzLmZpbmQoKHNuYXBzaG90KSA9PiBzbmFwc2hvdC5faWQgPT09IG5vZGUuaWQpPy50aXRsZSwgJFs4XSA9IG5vZGUsICRbOV0gPSBwcmV2aWV3U25hcHNob3RzLCAkWzEwXSA9IHQ0MikgOiB0NDIgPSAkWzEwXSwgdDMgPSB0NDI7XG4gIH1cbiAgY29uc3QgdGl0bGUgPSB0MztcbiAgbGV0IHQ0O1xuICBiYjE6IHtcbiAgICBpZiAoIShcInBhdGhcIiBpbiBub2RlKSkge1xuICAgICAgdDQgPSB2b2lkIDA7XG4gICAgICBicmVhayBiYjE7XG4gICAgfVxuICAgIGlmICghZmllbGQgfHwgIXNjaGVtYVR5cGUpIHtcbiAgICAgIHQ0ID0gdm9pZCAwO1xuICAgICAgYnJlYWsgYmIxO1xuICAgIH1cbiAgICBjb25zdCB0eXBlID0gZmllbGQudmFsdWUudHlwZSwgdDUyID0gISFmb2N1c2VkO1xuICAgIGxldCB0NjI7XG4gICAgJFsxMV0gIT09IGVsZW1lbnQgfHwgJFsxMl0gIT09IGZpZWxkIHx8ICRbMTNdICE9PSBub2RlIHx8ICRbMTRdICE9PSBwYXJlbnQgfHwgJFsxNV0gIT09IHNjaGVtYVR5cGUgfHwgJFsxNl0gIT09IHQ1MiB8fCAkWzE3XSAhPT0gdHlwZSA/ICh0NjIgPSB7XG4gICAgICBkb2N1bWVudDogc2NoZW1hVHlwZSxcbiAgICAgIGVsZW1lbnQsXG4gICAgICBmaWVsZCxcbiAgICAgIGZvY3VzZWQ6IHQ1MixcbiAgICAgIG5vZGUsXG4gICAgICBwYXJlbnQsXG4gICAgICB0eXBlXG4gICAgfSwgJFsxMV0gPSBlbGVtZW50LCAkWzEyXSA9IGZpZWxkLCAkWzEzXSA9IG5vZGUsICRbMTRdID0gcGFyZW50LCAkWzE1XSA9IHNjaGVtYVR5cGUsICRbMTZdID0gdDUyLCAkWzE3XSA9IHR5cGUsICRbMThdID0gdDYyKSA6IHQ2MiA9ICRbMThdLCB0NCA9IHQ2MjtcbiAgfVxuICBjb25zdCBjb21wb25lbnRDb250ZXh0ID0gdDQsIGN1c3RvbUNvbXBvbmVudHMgPSB1c2VDdXN0b21Db21wb25lbnRzKGNvbXBvbmVudENvbnRleHQsIGNvbXBvbmVudFJlc29sdmVyKTtcbiAgbGV0IHQ1O1xuICAkWzE5XSAhPT0gc2NoZW1hVHlwZSA/ICh0NSA9IHNjaGVtYVR5cGU/Lmljb24gPyAvKiBAX19QVVJFX18gKi8ganN4KFwiZGl2XCIsIHsgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw6IHtcbiAgICBfX2h0bWw6IHNjaGVtYVR5cGUuaWNvblxuICB9IH0pIDogLyogQF9fUFVSRV9fICovIGpzeChEb2N1bWVudEljb24sIHt9KSwgJFsxOV0gPSBzY2hlbWFUeXBlLCAkWzIwXSA9IHQ1KSA6IHQ1ID0gJFsyMF07XG4gIGNvbnN0IGljb24gPSB0NTtcbiAgbGV0IHQ2O1xuICAkWzIxXSAhPT0gaHJlZiB8fCAkWzIyXSAhPT0gc2hvd0FjdGlvbnMgPyAodDYgPSBzaG93QWN0aW9ucyA/IC8qIEBfX1BVUkVfXyAqLyBqc3goQWN0aW9ucywgeyBnYXA6IDEsIHBhZGRpbmdZOiAxLCBcImRhdGEtc2FuaXR5LW92ZXJsYXktZWxlbWVudFwiOiAhMCwgY2hpbGRyZW46IC8qIEBfX1BVUkVfXyAqLyBqc3goTGluaywgeyBocmVmIH0pIH0pIDogbnVsbCwgJFsyMV0gPSBocmVmLCAkWzIyXSA9IHNob3dBY3Rpb25zLCAkWzIzXSA9IHQ2KSA6IHQ2ID0gJFsyM107XG4gIGxldCB0NztcbiAgJFsyNF0gIT09IGRyYWdnYWJsZSB8fCAkWzI1XSAhPT0gaWNvbiB8fCAkWzI2XSAhPT0gdGl0bGUgPyAodDcgPSB0aXRsZSAmJiAvKiBAX19QVVJFX18gKi8ganN4KFRhYiwgeyBnYXA6IDEsIHBhZGRpbmdZOiAxLCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeHMoTGFiZWxzLCB7IGdhcDogMiwgcGFkZGluZzogMiwgY2hpbGRyZW46IFtcbiAgICBkcmFnZ2FibGUgJiYgLyogQF9fUFVSRV9fICovIGpzeChCb3gsIHsgbWFyZ2luUmlnaHQ6IDEsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KFRleHQsIHsgY2xhc3NOYW1lOiBcImRyYWctaGFuZGxlXCIsIHNpemU6IDAsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KERyYWdIYW5kbGVJY29uLCB7fSkgfSkgfSksXG4gICAgLyogQF9fUFVSRV9fICovIGpzeChUZXh0LCB7IHNpemU6IDAsIGNoaWxkcmVuOiBpY29uIH0pLFxuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goVGV4dCwgeyBzaXplOiAxLCB3ZWlnaHQ6IFwibWVkaXVtXCIsIGNoaWxkcmVuOiB0aXRsZSB9KVxuICBdIH0pIH0pLCAkWzI0XSA9IGRyYWdnYWJsZSwgJFsyNV0gPSBpY29uLCAkWzI2XSA9IHRpdGxlLCAkWzI3XSA9IHQ3KSA6IHQ3ID0gJFsyN107XG4gIGxldCB0ODtcbiAgJFsyOF0gIT09IGNvbXBvbmVudENvbnRleHQgfHwgJFsyOV0gIT09IGN1c3RvbUNvbXBvbmVudHMgPyAodDggPSBBcnJheS5pc0FycmF5KGN1c3RvbUNvbXBvbmVudHMpID8gY3VzdG9tQ29tcG9uZW50cy5tYXAoKHQ5MiwgaSkgPT4ge1xuICAgIGNvbnN0IHtcbiAgICAgIGNvbXBvbmVudDogQ29tcG9uZW50LFxuICAgICAgcHJvcHM6IHByb3BzXzBcbiAgICB9ID0gdDkyO1xuICAgIHJldHVybiAvKiBAX19QVVJFX18gKi8ganN4KENvbXBvbmVudCwgeyBQb2ludGVyRXZlbnRzLCAuLi5jb21wb25lbnRDb250ZXh0LCAuLi5wcm9wc18wIH0sIGkpO1xuICB9KSA6IGN1c3RvbUNvbXBvbmVudHMsICRbMjhdID0gY29tcG9uZW50Q29udGV4dCwgJFsyOV0gPSBjdXN0b21Db21wb25lbnRzLCAkWzMwXSA9IHQ4KSA6IHQ4ID0gJFszMF07XG4gIGxldCB0OTtcbiAgcmV0dXJuICRbMzFdICE9PSB0NiB8fCAkWzMyXSAhPT0gdDcgfHwgJFszM10gIT09IHQ4ID8gKHQ5ID0gLyogQF9fUFVSRV9fICovIGpzeHMoRnJhZ21lbnQsIHsgY2hpbGRyZW46IFtcbiAgICB0NixcbiAgICB0NyxcbiAgICB0OFxuICBdIH0pLCAkWzMxXSA9IHQ2LCAkWzMyXSA9IHQ3LCAkWzMzXSA9IHQ4LCAkWzM0XSA9IHQ5KSA6IHQ5ID0gJFszNF0sIHQ5O1xufSwgRWxlbWVudE92ZXJsYXkgPSBtZW1vKGZ1bmN0aW9uKHByb3BzKSB7XG4gIGNvbnN0ICQgPSBjKDI0KSwge1xuICAgIGRyYWdnYWJsZSxcbiAgICBmb2N1c2VkLFxuICAgIGhvdmVyZWQsXG4gICAgcmVjdCxcbiAgICB3YXNNYXliZUNvbGxhcHNlZCxcbiAgICBlbmFibGVTY3JvbGxJbnRvVmlld1xuICB9ID0gcHJvcHMsIHJlZiA9IHVzZVJlZihudWxsKSwgc2Nyb2xsZWRJbnRvVmlld1JlZiA9IHVzZVJlZighMSk7XG4gIGxldCB0MDtcbiAgY29uc3QgdDEgPSBgJHtyZWN0Lnd9cHhgLCB0MiA9IGAke3JlY3QuaH1weGAsIHQzID0gYHRyYW5zbGF0ZSgke3JlY3QueH1weCwgJHtyZWN0Lnl9cHgpYDtcbiAgbGV0IHQ0O1xuICAkWzBdICE9PSB0MSB8fCAkWzFdICE9PSB0MiB8fCAkWzJdICE9PSB0MyA/ICh0NCA9IHtcbiAgICB3aWR0aDogdDEsXG4gICAgaGVpZ2h0OiB0MixcbiAgICB0cmFuc2Zvcm06IHQzXG4gIH0sICRbMF0gPSB0MSwgJFsxXSA9IHQyLCAkWzJdID0gdDMsICRbM10gPSB0NCkgOiB0NCA9ICRbM10sIHQwID0gdDQ7XG4gIGNvbnN0IHN0eWxlID0gdDA7XG4gIGxldCB0NSwgdDY7XG4gICRbNF0gIT09IGVuYWJsZVNjcm9sbEludG9WaWV3IHx8ICRbNV0gIT09IGZvY3VzZWQgfHwgJFs2XSAhPT0gd2FzTWF5YmVDb2xsYXBzZWQgPyAodDUgPSAoKSA9PiB7XG4gICAgaWYgKCFzY3JvbGxlZEludG9WaWV3UmVmLmN1cnJlbnQgJiYgIXdhc01heWJlQ29sbGFwc2VkICYmIGZvY3VzZWQgPT09ICEwICYmIHJlZi5jdXJyZW50ICYmIGVuYWJsZVNjcm9sbEludG9WaWV3KSB7XG4gICAgICBjb25zdCB0YXJnZXQgPSByZWYuY3VycmVudDtcbiAgICAgIHNjcm9sbEludG9WaWV3KHJlZi5jdXJyZW50LCB7XG4gICAgICAgIGJlaGF2aW9yOiAoYWN0aW9ucykgPT4ge1xuICAgICAgICAgIGFjdGlvbnMubGVuZ3RoICE9PSAwICYmIHRhcmdldC5zY3JvbGxJbnRvVmlldyh7XG4gICAgICAgICAgICBiZWhhdmlvcjogXCJzbW9vdGhcIixcbiAgICAgICAgICAgIGJsb2NrOiBcImNlbnRlclwiLFxuICAgICAgICAgICAgaW5saW5lOiBcIm5lYXJlc3RcIlxuICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBzY3JvbGxNb2RlOiBcImlmLW5lZWRlZFwiLFxuICAgICAgICBibG9jazogXCJjZW50ZXJcIixcbiAgICAgICAgaW5saW5lOiBcIm5lYXJlc3RcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIHNjcm9sbGVkSW50b1ZpZXdSZWYuY3VycmVudCA9IGZvY3VzZWQgPT09ICEwO1xuICB9LCB0NiA9IFtmb2N1c2VkLCB3YXNNYXliZUNvbGxhcHNlZCwgZW5hYmxlU2Nyb2xsSW50b1ZpZXddLCAkWzRdID0gZW5hYmxlU2Nyb2xsSW50b1ZpZXcsICRbNV0gPSBmb2N1c2VkLCAkWzZdID0gd2FzTWF5YmVDb2xsYXBzZWQsICRbN10gPSB0NSwgJFs4XSA9IHQ2KSA6ICh0NSA9ICRbN10sIHQ2ID0gJFs4XSksIHVzZUVmZmVjdCh0NSwgdDYpO1xuICBjb25zdCBbaXNOZWFyVG9wLCBzZXRJc05lYXJUb3BdID0gdXNlU3RhdGUoITEpO1xuICBsZXQgdDc7XG4gICRbOV0gIT09IGhvdmVyZWQgPyAodDcgPSAoKSA9PiB7XG4gICAgaWYgKCFyZWYuY3VycmVudCB8fCAhaG92ZXJlZClcbiAgICAgIHJldHVybjtcbiAgICBjb25zdCBpbyA9IG5ldyBJbnRlcnNlY3Rpb25PYnNlcnZlcigodDgyKSA9PiB7XG4gICAgICBjb25zdCBbaW50ZXJzZWN0aW9uXSA9IHQ4MjtcbiAgICAgIHNldElzTmVhclRvcChpbnRlcnNlY3Rpb24uYm91bmRpbmdDbGllbnRSZWN0LnRvcCA8IDApO1xuICAgIH0sIHtcbiAgICAgIHRocmVzaG9sZDogMVxuICAgIH0pO1xuICAgIHJldHVybiBpby5vYnNlcnZlKHJlZi5jdXJyZW50KSwgKCkgPT4gaW8uZGlzY29ubmVjdCgpO1xuICB9LCAkWzldID0gaG92ZXJlZCwgJFsxMF0gPSB0NykgOiB0NyA9ICRbMTBdO1xuICBsZXQgdDg7XG4gICRbMTFdICE9PSBob3ZlcmVkIHx8ICRbMTJdICE9PSBpc05lYXJUb3AgPyAodDggPSBbaG92ZXJlZCwgaXNOZWFyVG9wXSwgJFsxMV0gPSBob3ZlcmVkLCAkWzEyXSA9IGlzTmVhclRvcCwgJFsxM10gPSB0OCkgOiB0OCA9ICRbMTNdLCB1c2VFZmZlY3QodDcsIHQ4KTtcbiAgY29uc3QgdDkgPSBmb2N1c2VkID8gXCJcIiA6IHZvaWQgMCwgdDEwID0gaG92ZXJlZCA/IFwiXCIgOiB2b2lkIDAsIHQxMSA9IGlzTmVhclRvcCA/IFwiXCIgOiB2b2lkIDAsIHQxMiA9IGRyYWdnYWJsZSA/IFwiXCIgOiB2b2lkIDA7XG4gIGxldCB0MTM7XG4gICRbMTRdICE9PSBob3ZlcmVkIHx8ICRbMTVdICE9PSBwcm9wcyA/ICh0MTMgPSBob3ZlcmVkICYmIC8qIEBfX1BVUkVfXyAqLyBqc3goRWxlbWVudE92ZXJsYXlJbm5lciwgeyAuLi5wcm9wcyB9KSwgJFsxNF0gPSBob3ZlcmVkLCAkWzE1XSA9IHByb3BzLCAkWzE2XSA9IHQxMykgOiB0MTMgPSAkWzE2XTtcbiAgbGV0IHQxNDtcbiAgcmV0dXJuICRbMTddICE9PSBzdHlsZSB8fCAkWzE4XSAhPT0gdDEwIHx8ICRbMTldICE9PSB0MTEgfHwgJFsyMF0gIT09IHQxMiB8fCAkWzIxXSAhPT0gdDEzIHx8ICRbMjJdICE9PSB0OSA/ICh0MTQgPSAvKiBAX19QVVJFX18gKi8ganN4KFJvb3QkMywgeyBcImRhdGEtZm9jdXNlZFwiOiB0OSwgXCJkYXRhLWhvdmVyZWRcIjogdDEwLCBcImRhdGEtZmxpcHBlZFwiOiB0MTEsIFwiZGF0YS1kcmFnZ2FibGVcIjogdDEyLCByZWYsIHN0eWxlLCBjaGlsZHJlbjogdDEzIH0pLCAkWzE3XSA9IHN0eWxlLCAkWzE4XSA9IHQxMCwgJFsxOV0gPSB0MTEsICRbMjBdID0gdDEyLCAkWzIxXSA9IHQxMywgJFsyMl0gPSB0OSwgJFsyM10gPSB0MTQpIDogdDE0ID0gJFsyM10sIHQxNDtcbn0pO1xuZnVuY3Rpb24gdXNlQ3VzdG9tQ29tcG9uZW50cyhjb21wb25lbnRDb250ZXh0LCBjb21wb25lbnRSZXNvbHZlcikge1xuICBjb25zdCAkID0gYyg0KTtcbiAgbGV0IHQwO1xuICBiYjA6IHtcbiAgICBpZiAoIWNvbXBvbmVudENvbnRleHQpIHtcbiAgICAgIHQwID0gdm9pZCAwO1xuICAgICAgYnJlYWsgYmIwO1xuICAgIH1cbiAgICBsZXQgdDE7XG4gICAgaWYgKCRbMF0gIT09IGNvbXBvbmVudENvbnRleHQgfHwgJFsxXSAhPT0gY29tcG9uZW50UmVzb2x2ZXIpIHtcbiAgICAgIGNvbnN0IHJlc29sdmVkID0gY29tcG9uZW50UmVzb2x2ZXI/Lihjb21wb25lbnRDb250ZXh0KTtcbiAgICAgIGlmICghcmVzb2x2ZWQpIHtcbiAgICAgICAgdDAgPSB2b2lkIDA7XG4gICAgICAgIGJyZWFrIGJiMDtcbiAgICAgIH1cbiAgICAgIGlmIChpc1JlYWN0RWxlbWVudE92ZXJsYXlDb21wb25lbnQocmVzb2x2ZWQpKSB7XG4gICAgICAgIHQwID0gcmVzb2x2ZWQ7XG4gICAgICAgIGJyZWFrIGJiMDtcbiAgICAgIH1cbiAgICAgIHQxID0gKEFycmF5LmlzQXJyYXkocmVzb2x2ZWQpID8gcmVzb2x2ZWQgOiBbcmVzb2x2ZWRdKS5tYXAoX3RlbXAkOCksICRbMF0gPSBjb21wb25lbnRDb250ZXh0LCAkWzFdID0gY29tcG9uZW50UmVzb2x2ZXIsICRbMl0gPSB0MSwgJFszXSA9IHQwO1xuICAgIH0gZWxzZVxuICAgICAgdDEgPSAkWzJdLCB0MCA9ICRbM107XG4gICAgdDAgPSB0MTtcbiAgfVxuICByZXR1cm4gdDA7XG59XG5mdW5jdGlvbiBfdGVtcCQ4KGNvbXBvbmVudCkge1xuICByZXR1cm4gdHlwZW9mIGNvbXBvbmVudCA9PSBcIm9iamVjdFwiICYmIFwiY29tcG9uZW50XCIgaW4gY29tcG9uZW50ID8gY29tcG9uZW50IDoge1xuICAgIGNvbXBvbmVudCxcbiAgICBwcm9wczoge31cbiAgfTtcbn1cbmNvbnN0IExpbmsgPSBtZW1vKGZ1bmN0aW9uKHByb3BzKSB7XG4gIGNvbnN0ICQgPSBjKDYpLCByZWZlcmVyID0gdXNlU3luY0V4dGVybmFsU3RvcmUoX3RlbXAyJDUsIF90ZW1wMyQyKTtcbiAgbGV0IHQwLCB0MTtcbiAgJFswXSAhPT0gcHJvcHMuaHJlZiB8fCAkWzFdICE9PSByZWZlcmVyID8gKHQxID0gZ2V0TGlua0hyZWYocHJvcHMuaHJlZiwgcmVmZXJlciksICRbMF0gPSBwcm9wcy5ocmVmLCAkWzFdID0gcmVmZXJlciwgJFsyXSA9IHQxKSA6IHQxID0gJFsyXSwgdDAgPSB0MTtcbiAgY29uc3QgaHJlZiA9IHQwO1xuICBsZXQgdDI7XG4gICRbM10gPT09IFN5bWJvbC5mb3IoXCJyZWFjdC5tZW1vX2NhY2hlX3NlbnRpbmVsXCIpID8gKHQyID0gLyogQF9fUFVSRV9fICovIGpzeChBY3Rpb25PcGVuLCB7IHBhZGRpbmc6IDIsIGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KFRleHQsIHsgc2l6ZTogMSwgd2VpZ2h0OiBcIm1lZGl1bVwiLCBjaGlsZHJlbjogXCJPcGVuIGluIFN0dWRpb1wiIH0pIH0pLCAkWzNdID0gdDIpIDogdDIgPSAkWzNdO1xuICBsZXQgdDM7XG4gIHJldHVybiAkWzRdICE9PSBocmVmID8gKHQzID0gLyogQF9fUFVSRV9fICovIGpzeChCb3gsIHsgYXM6IFwiYVwiLCBocmVmLCB0YXJnZXQ6IFwiX2JsYW5rXCIsIHJlbDogXCJub29wZW5lciBub3JlZmVycmVyXCIsIGNoaWxkcmVuOiB0MiB9KSwgJFs0XSA9IGhyZWYsICRbNV0gPSB0MykgOiB0MyA9ICRbNV0sIHQzO1xufSk7XG5mdW5jdGlvbiBfdGVtcDIkNShvblN0b3JlQ2hhbmdlKSB7XG4gIGNvbnN0IGhhbmRsZVBvcFN0YXRlID0gKCkgPT4gb25TdG9yZUNoYW5nZSgpO1xuICByZXR1cm4gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJwb3BzdGF0ZVwiLCBoYW5kbGVQb3BTdGF0ZSksICgpID0+IHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwicG9wc3RhdGVcIiwgaGFuZGxlUG9wU3RhdGUpO1xufVxuZnVuY3Rpb24gX3RlbXAzJDIoKSB7XG4gIHJldHVybiB3aW5kb3cubG9jYXRpb24uaHJlZjtcbn1cbmNvbnN0IE92ZXJsYXlEcmFnR3JvdXBSZWN0ID0gKHQwKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDUpLCB7XG4gICAgZHJhZ0dyb3VwUmVjdFxuICB9ID0gdDAsIHQxID0gYCR7ZHJhZ0dyb3VwUmVjdC55fXB4YCwgdDIgPSBgJHtkcmFnR3JvdXBSZWN0Lnh9cHhgLCB0MyA9IGAke2RyYWdHcm91cFJlY3QudyAtIDF9cHhgLCB0NCA9IGAke2RyYWdHcm91cFJlY3QuaCAtIDF9cHhgO1xuICBsZXQgdDU7XG4gIHJldHVybiAkWzBdICE9PSB0MSB8fCAkWzFdICE9PSB0MiB8fCAkWzJdICE9PSB0MyB8fCAkWzNdICE9PSB0NCA/ICh0NSA9IC8qIEBfX1BVUkVfXyAqLyBqc3goXCJkaXZcIiwgeyBzdHlsZToge1xuICAgIHBvc2l0aW9uOiBcImFic29sdXRlXCIsXG4gICAgdG9wOiB0MSxcbiAgICBsZWZ0OiB0MixcbiAgICB3aWR0aDogdDMsXG4gICAgaGVpZ2h0OiB0NCxcbiAgICBib3JkZXI6IFwiMXB4IGRhc2hlZCAjZjA3MDliXCIsXG4gICAgcG9pbnRlckV2ZW50czogXCJub25lXCJcbiAgfSB9KSwgJFswXSA9IHQxLCAkWzFdID0gdDIsICRbMl0gPSB0MywgJFszXSA9IHQ0LCAkWzRdID0gdDUpIDogdDUgPSAkWzRdLCB0NTtcbn0sIG1hcmtlclRoaWNrbmVzcyA9IDY7XG5mdW5jdGlvbiBsZXJwKHYwLCB2MSwgdCkge1xuICByZXR1cm4gdjAgKiAoMSAtIHQpICsgdjEgKiB0O1xufVxuY29uc3QgT3ZlcmxheURyYWdJbnNlcnRNYXJrZXIgPSAodDApID0+IHtcbiAgY29uc3QgJCA9IGMoNCksIHtcbiAgICBkcmFnSW5zZXJ0UG9zaXRpb25cbiAgfSA9IHQwO1xuICBpZiAoZHJhZ0luc2VydFBvc2l0aW9uID09PSBudWxsKVxuICAgIHJldHVybjtcbiAgY29uc3QgZmxvdyA9IGRyYWdJbnNlcnRQb3NpdGlvbj8ubGVmdCB8fCBkcmFnSW5zZXJ0UG9zaXRpb24/LnJpZ2h0ID8gXCJob3Jpem9udGFsXCIgOiBcInZlcnRpY2FsXCI7XG4gIGxldCB4ID0gMCwgeSA9IDAsIHdpZHRoID0gMCwgaGVpZ2h0ID0gMDtcbiAgaWYgKGZsb3cgPT09IFwiaG9yaXpvbnRhbFwiKSB7XG4gICAgY29uc3Qge1xuICAgICAgbGVmdCxcbiAgICAgIHJpZ2h0XG4gICAgfSA9IGRyYWdJbnNlcnRQb3NpdGlvbjtcbiAgICBpZiAod2lkdGggPSBtYXJrZXJUaGlja25lc3MsIHJpZ2h0ICYmIGxlZnQpIHtcbiAgICAgIGNvbnN0IHN0YXJ0WCA9IGxlZnQucmVjdC54ICsgbGVmdC5yZWN0LncsIGVuZFggPSByaWdodC5yZWN0LngsIG9mZnNldCA9IE1hdGgubWluKHJpZ2h0LnJlY3QuaCwgbGVmdC5yZWN0LmgpICogMC4wMTI1O1xuICAgICAgeCA9IGxlcnAoc3RhcnRYLCBlbmRYLCAwLjUpIC0gbWFya2VyVGhpY2tuZXNzIC8gMiwgeSA9IGxlZnQucmVjdC55ICsgb2Zmc2V0LCBoZWlnaHQgPSBNYXRoLm1pbihyaWdodC5yZWN0LmgsIGxlZnQucmVjdC5oKSAtIG9mZnNldCAqIDI7XG4gICAgfSBlbHNlIGlmIChyaWdodCAmJiAhbGVmdCkge1xuICAgICAgY29uc3Qgb2Zmc2V0XzAgPSByaWdodC5yZWN0LmggKiAwLjAxMjU7XG4gICAgICB4ID0gcmlnaHQucmVjdC54IC0gbWFya2VyVGhpY2tuZXNzIC8gMiwgeSA9IHJpZ2h0LnJlY3QueSArIG9mZnNldF8wLCBoZWlnaHQgPSByaWdodC5yZWN0LmggLSBvZmZzZXRfMCAqIDI7XG4gICAgfSBlbHNlIGlmIChsZWZ0ICYmICFyaWdodCkge1xuICAgICAgY29uc3Qgb2Zmc2V0XzEgPSBsZWZ0LnJlY3QuaCAqIDAuMDEyNTtcbiAgICAgIHggPSBsZWZ0LnJlY3QueCArIGxlZnQucmVjdC53IC0gbWFya2VyVGhpY2tuZXNzIC8gMiwgeSA9IGxlZnQucmVjdC55ICsgb2Zmc2V0XzEsIGhlaWdodCA9IGxlZnQucmVjdC5oIC0gb2Zmc2V0XzEgKiAyO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBjb25zdCB7XG4gICAgICBib3R0b20sXG4gICAgICB0b3BcbiAgICB9ID0gZHJhZ0luc2VydFBvc2l0aW9uO1xuICAgIGlmIChib3R0b20gJiYgdG9wKSB7XG4gICAgICBjb25zdCBzdGFydFhfMCA9IE1hdGgubWluKHRvcC5yZWN0LngsIGJvdHRvbS5yZWN0LngpLCBzdGFydFkgPSB0b3AucmVjdC55ICsgdG9wLnJlY3QuaCwgZW5kWSA9IGJvdHRvbS5yZWN0LnksIG9mZnNldF8yID0gTWF0aC5taW4oYm90dG9tLnJlY3QudywgdG9wLnJlY3QudykgKiAwLjAxMjU7XG4gICAgICBoZWlnaHQgPSBtYXJrZXJUaGlja25lc3MsIHggPSBzdGFydFhfMCArIG9mZnNldF8yLCB5ID0gbGVycChzdGFydFksIGVuZFksIDAuNSkgLSBtYXJrZXJUaGlja25lc3MgLyAyLCB3aWR0aCA9IE1hdGgubWF4KGJvdHRvbS5yZWN0LncsIHRvcC5yZWN0LncpIC0gb2Zmc2V0XzIgKiAyO1xuICAgIH0gZWxzZSBpZiAoYm90dG9tICYmICF0b3ApIHtcbiAgICAgIGNvbnN0IG9mZnNldF8zID0gYm90dG9tLnJlY3QudyAqIDAuMDEyNTtcbiAgICAgIHggPSBib3R0b20ucmVjdC54ICsgb2Zmc2V0XzMsIHkgPSBib3R0b20ucmVjdC55IC0gbWFya2VyVGhpY2tuZXNzIC8gMiwgd2lkdGggPSBib3R0b20ucmVjdC53IC0gb2Zmc2V0XzMgKiAyLCBoZWlnaHQgPSBtYXJrZXJUaGlja25lc3M7XG4gICAgfSBlbHNlIGlmICh0b3AgJiYgIWJvdHRvbSkge1xuICAgICAgY29uc3Qgb2Zmc2V0XzQgPSB0b3AucmVjdC53ICogMC4wMTI1O1xuICAgICAgeCA9IHRvcC5yZWN0LnggKyBvZmZzZXRfNCwgeSA9IHRvcC5yZWN0LnkgKyB0b3AucmVjdC5oIC0gbWFya2VyVGhpY2tuZXNzIC8gMiwgd2lkdGggPSB0b3AucmVjdC53IC0gb2Zmc2V0XzQgKiAyLCBoZWlnaHQgPSBtYXJrZXJUaGlja25lc3M7XG4gICAgfVxuICB9XG4gIGNvbnN0IHQxID0gYCR7d2lkdGh9cHhgLCB0MiA9IGAke2hlaWdodH1weGAsIHQzID0gYHRyYW5zbGF0ZSgke3h9cHgsICR7eX1weClgO1xuICBsZXQgdDQ7XG4gIHJldHVybiAkWzBdICE9PSB0MSB8fCAkWzFdICE9PSB0MiB8fCAkWzJdICE9PSB0MyA/ICh0NCA9IC8qIEBfX1BVUkVfXyAqLyBqc3goXCJkaXZcIiwgeyBzdHlsZToge1xuICAgIHBvc2l0aW9uOiBcImFic29sdXRlXCIsXG4gICAgd2lkdGg6IHQxLFxuICAgIGhlaWdodDogdDIsXG4gICAgdHJhbnNmb3JtOiB0MyxcbiAgICBiYWNrZ3JvdW5kOiBcIiM1NTZiZmNcIixcbiAgICBib3JkZXI6IFwiMnB4IHNvbGlkIHdoaXRlXCIsXG4gICAgYm9yZGVyUmFkaXVzOiBcIjk5OXB4XCIsXG4gICAgekluZGV4OiBcIjk5OTk5OVwiXG4gIH0gfSksICRbMF0gPSB0MSwgJFsxXSA9IHQyLCAkWzJdID0gdDMsICRbM10gPSB0NCkgOiB0NCA9ICRbM10sIHQ0O1xufSwgUm9vdCQyID0gc3R5bGVkLmRpdmBcbiAgLS1kcmFnLXByZXZpZXctb3BhY2l0eTogMC45ODtcbiAgLS1kcmFnLXByZXZpZXctc2tlbGV0b24tc3Ryb2tlOiAjZmZmZmZmO1xuXG4gIEBtZWRpYSAocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspIHtcbiAgICAtLWRyYWctcHJldmlldy1za2VsZXRvbi1zdHJva2U6ICMzODNkNTE7XG4gIH1cblxuICBwb3NpdGlvbjogZml4ZWQ7XG4gIGRpc3BsYXk6IGdyaWQ7XG4gIHRyYW5zZm9ybTogJHsoe1xuICAkc2NhbGVGYWN0b3IsXG4gICR3aWR0aCxcbiAgJGhlaWdodFxufSkgPT4gYHRyYW5zbGF0ZShjYWxjKHZhcigtLWRyYWctcHJldmlldy14KSAtICR7JHdpZHRoIC8gMn1weCksIGNhbGModmFyKC0tZHJhZy1wcmV2aWV3LXkpIC0gJHskaGVpZ2h0IC8gMn1weCkpIHNjYWxlKCR7JHNjYWxlRmFjdG9yfSlgfTtcbiAgd2lkdGg6ICR7KHtcbiAgJHdpZHRoXG59KSA9PiBgJHskd2lkdGh9cHhgfTtcbiAgaGVpZ2h0OiAkeyh7XG4gICRoZWlnaHRcbn0pID0+IGAkeyRoZWlnaHR9cHhgfTtcbiAgei1pbmRleDogOTk5OTk5OTtcbiAgb3BhY2l0eTogdmFyKC0tZHJhZy1wcmV2aWV3LW9wYWNpdHkpO1xuICBjdXJzb3I6IG1vdmU7XG5cbiAgLmRyYWctcHJldmlldy1jb250ZW50LXdyYXBwZXIge1xuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICB3aWR0aDogMTAwJTtcbiAgICBoZWlnaHQ6IDEwMCU7XG4gICAgY29udGFpbmVyLXR5cGU6IGlubGluZS1zaXplO1xuICB9XG5cbiAgW2RhdGEtdWk9J2NhcmQnXSB7XG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIGhlaWdodDogMTAwJTtcbiAgfVxuXG4gIC5kcmFnLXByZXZpZXctc2tlbGV0b24ge1xuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICBpbnNldDogMDtcblxuICAgIHJlY3Qge1xuICAgICAgc3Ryb2tlOiB2YXIoLS1kcmFnLXByZXZpZXctc2tlbGV0b24tc3Ryb2tlKTtcbiAgICB9XG4gIH1cblxuICAuZHJhZy1wcmV2aWV3LWhhbmRsZSB7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIHRvcDogNGNxbWluO1xuICAgIGxlZnQ6IDRjcW1pbjtcbiAgICB3aWR0aDogNmNxbWluO1xuICAgIGZpbGw6IHZhcigtLWRyYWctcHJldmlldy1oYW5kbGUtZmlsbCk7XG4gIH1cbmA7XG5mdW5jdGlvbiBjbGFtcChudW1iZXIsIG1pbiwgbWF4KSB7XG4gIHJldHVybiBudW1iZXIgPCBtaW4gPyBtaW4gOiBudW1iZXIgPiBtYXggPyBtYXggOiBudW1iZXI7XG59XG5mdW5jdGlvbiBtYXAobnVtYmVyLCBpbk1pbiwgaW5NYXgsIG91dE1pbiwgb3V0TWF4KSB7XG4gIGNvbnN0IG1hcHBlZCA9IChudW1iZXIgLSBpbk1pbikgKiAob3V0TWF4IC0gb3V0TWluKSAvIChpbk1heCAtIGluTWluKSArIG91dE1pbjtcbiAgcmV0dXJuIGNsYW1wKG1hcHBlZCwgb3V0TWluLCBvdXRNYXgpO1xufVxuY29uc3QgT3ZlcmxheURyYWdQcmV2aWV3ID0gKHQwKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDUwKSwge1xuICAgIHNrZWxldG9uXG4gIH0gPSB0MCwgbWF4U2tlbGV0b25XaWR0aCA9IE1hdGgubWluKHNrZWxldG9uLm1heFdpZHRoLCB3aW5kb3cuaW5uZXJXaWR0aCAvIDIpLCBzY2FsZUZhY3RvciA9IHNrZWxldG9uLncgPiBtYXhTa2VsZXRvbldpZHRoID8gbWF4U2tlbGV0b25XaWR0aCAvIHNrZWxldG9uLncgOiAxLCBvZmZzZXRYID0gc2tlbGV0b24ub2Zmc2V0WCAqIHNjYWxlRmFjdG9yLCBvZmZzZXRZID0gc2tlbGV0b24ub2Zmc2V0WSAqIHNjYWxlRmFjdG9yLCBwcmVmZXJzRGFyayA9IHVzZVByZWZlcnNEYXJrKCksIHRoZW1lID0gdXNlVGhlbWVfdjIoKSwgcmFkaXVzID0gdGhlbWUucmFkaXVzW35+bWFwKHNrZWxldG9uLncsIDAsIDE5MjAsIDEsIHRoZW1lLnJhZGl1cy5sZW5ndGggLSAyKV07XG4gIGxldCBUMCwgVDEsIHQxLCB0MTAsIHQxMSwgdDEyLCB0MTMsIHQxNCwgdDIsIHQzLCB0NCwgdDUsIHQ2LCB0NywgdDgsIHQ5O1xuICBpZiAoJFswXSAhPT0gb2Zmc2V0WCB8fCAkWzFdICE9PSBvZmZzZXRZIHx8ICRbMl0gIT09IHByZWZlcnNEYXJrIHx8ICRbM10gIT09IHJhZGl1cyB8fCAkWzRdICE9PSBzY2FsZUZhY3RvciB8fCAkWzVdICE9PSBza2VsZXRvbi5jaGlsZFJlY3RzIHx8ICRbNl0gIT09IHNrZWxldG9uLmggfHwgJFs3XSAhPT0gc2tlbGV0b24udykge1xuICAgIGNvbnN0IGltYWdlUmVjdHMgPSBza2VsZXRvbi5jaGlsZFJlY3RzLmZpbHRlcihfdGVtcCQ3KSwgdGV4dFJlY3RzID0gc2tlbGV0b24uY2hpbGRSZWN0cy5maWx0ZXIoX3RlbXAyJDQpO1xuICAgIFQxID0gUm9vdCQyLCB0MTAgPSBza2VsZXRvbi53LCB0MTEgPSBza2VsZXRvbi5oLCB0MTIgPSBvZmZzZXRYLCB0MTMgPSBvZmZzZXRZLCB0MTQgPSBzY2FsZUZhY3RvciwgVDAgPSBDYXJkLCB0NSA9IHJhZGl1cywgdDYgPSA0LCB0NyA9IFwiaGlkZGVuXCIsIHQ4ID0gXCJ0cmFuc3BhcmVudFwiLCB0OSA9IHByZWZlcnNEYXJrID8gXCJkYXJrXCIgOiBcImxpZ2h0XCIsIHQ0ID0gXCJkcmFnLXByZXZpZXctY29udGVudC13cmFwcGVyXCIsIHQyID0gXCJkcmFnLXByZXZpZXctc2tlbGV0b25cIiwgdDMgPSBgMCAwICR7c2tlbGV0b24ud30gJHtza2VsZXRvbi5ofWAsIHQxID0gWy4uLmltYWdlUmVjdHMsIC4uLnRleHRSZWN0c10sICRbMF0gPSBvZmZzZXRYLCAkWzFdID0gb2Zmc2V0WSwgJFsyXSA9IHByZWZlcnNEYXJrLCAkWzNdID0gcmFkaXVzLCAkWzRdID0gc2NhbGVGYWN0b3IsICRbNV0gPSBza2VsZXRvbi5jaGlsZFJlY3RzLCAkWzZdID0gc2tlbGV0b24uaCwgJFs3XSA9IHNrZWxldG9uLncsICRbOF0gPSBUMCwgJFs5XSA9IFQxLCAkWzEwXSA9IHQxLCAkWzExXSA9IHQxMCwgJFsxMl0gPSB0MTEsICRbMTNdID0gdDEyLCAkWzE0XSA9IHQxMywgJFsxNV0gPSB0MTQsICRbMTZdID0gdDIsICRbMTddID0gdDMsICRbMThdID0gdDQsICRbMTldID0gdDUsICRbMjBdID0gdDYsICRbMjFdID0gdDcsICRbMjJdID0gdDgsICRbMjNdID0gdDk7XG4gIH0gZWxzZVxuICAgIFQwID0gJFs4XSwgVDEgPSAkWzldLCB0MSA9ICRbMTBdLCB0MTAgPSAkWzExXSwgdDExID0gJFsxMl0sIHQxMiA9ICRbMTNdLCB0MTMgPSAkWzE0XSwgdDE0ID0gJFsxNV0sIHQyID0gJFsxNl0sIHQzID0gJFsxN10sIHQ0ID0gJFsxOF0sIHQ1ID0gJFsxOV0sIHQ2ID0gJFsyMF0sIHQ3ID0gJFsyMV0sIHQ4ID0gJFsyMl0sIHQ5ID0gJFsyM107XG4gIGxldCB0MTU7XG4gICRbMjRdICE9PSB0MSB8fCAkWzI1XSAhPT0gdGhlbWUuY29sb3IgPyAodDE1ID0gdDEubWFwKChyXzEsIGkpID0+IC8qIEBfX1BVUkVfXyAqLyBqc3goXCJyZWN0XCIsIHsgeDogcl8xLngsIHk6IHJfMS55LCB3aWR0aDogcl8xLncsIGhlaWdodDogcl8xLmgsIGZpbGw6IHRoZW1lLmNvbG9yLnNrZWxldG9uLmZyb20gfSwgaSkpLCAkWzI0XSA9IHQxLCAkWzI1XSA9IHRoZW1lLmNvbG9yLCAkWzI2XSA9IHQxNSkgOiB0MTUgPSAkWzI2XTtcbiAgbGV0IHQxNjtcbiAgJFsyN10gIT09IHQxNSB8fCAkWzI4XSAhPT0gdDIgfHwgJFsyOV0gIT09IHQzID8gKHQxNiA9IC8qIEBfX1BVUkVfXyAqLyBqc3goXCJzdmdcIiwgeyBjbGFzc05hbWU6IHQyLCB2aWV3Qm94OiB0MywgY2hpbGRyZW46IHQxNSB9KSwgJFsyN10gPSB0MTUsICRbMjhdID0gdDIsICRbMjldID0gdDMsICRbMzBdID0gdDE2KSA6IHQxNiA9ICRbMzBdO1xuICBsZXQgdDE3O1xuICAkWzMxXSAhPT0gdDE2IHx8ICRbMzJdICE9PSB0NCA/ICh0MTcgPSAvKiBAX19QVVJFX18gKi8ganN4KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0NCwgY2hpbGRyZW46IHQxNiB9KSwgJFszMV0gPSB0MTYsICRbMzJdID0gdDQsICRbMzNdID0gdDE3KSA6IHQxNyA9ICRbMzNdO1xuICBsZXQgdDE4O1xuICAkWzM0XSAhPT0gVDAgfHwgJFszNV0gIT09IHQxNyB8fCAkWzM2XSAhPT0gdDUgfHwgJFszN10gIT09IHQ2IHx8ICRbMzhdICE9PSB0NyB8fCAkWzM5XSAhPT0gdDggfHwgJFs0MF0gIT09IHQ5ID8gKHQxOCA9IC8qIEBfX1BVUkVfXyAqLyBqc3goVDAsIHsgcmFkaXVzOiB0NSwgc2hhZG93OiB0Niwgb3ZlcmZsb3c6IHQ3LCB0b25lOiB0OCwgc2NoZW1lOiB0OSwgY2hpbGRyZW46IHQxNyB9KSwgJFszNF0gPSBUMCwgJFszNV0gPSB0MTcsICRbMzZdID0gdDUsICRbMzddID0gdDYsICRbMzhdID0gdDcsICRbMzldID0gdDgsICRbNDBdID0gdDksICRbNDFdID0gdDE4KSA6IHQxOCA9ICRbNDFdO1xuICBsZXQgdDE5O1xuICByZXR1cm4gJFs0Ml0gIT09IFQxIHx8ICRbNDNdICE9PSB0MTAgfHwgJFs0NF0gIT09IHQxMSB8fCAkWzQ1XSAhPT0gdDEyIHx8ICRbNDZdICE9PSB0MTMgfHwgJFs0N10gIT09IHQxNCB8fCAkWzQ4XSAhPT0gdDE4ID8gKHQxOSA9IC8qIEBfX1BVUkVfXyAqLyBqc3goVDEsIHsgJHdpZHRoOiB0MTAsICRoZWlnaHQ6IHQxMSwgJG9mZnNldFg6IHQxMiwgJG9mZnNldFk6IHQxMywgJHNjYWxlRmFjdG9yOiB0MTQsIGNoaWxkcmVuOiB0MTggfSksICRbNDJdID0gVDEsICRbNDNdID0gdDEwLCAkWzQ0XSA9IHQxMSwgJFs0NV0gPSB0MTIsICRbNDZdID0gdDEzLCAkWzQ3XSA9IHQxNCwgJFs0OF0gPSB0MTgsICRbNDldID0gdDE5KSA6IHQxOSA9ICRbNDldLCB0MTk7XG59O1xuZnVuY3Rpb24gX3RlbXAkNyhyKSB7XG4gIHJldHVybiByLnRhZ05hbWUgPT09IFwiSU1HXCI7XG59XG5mdW5jdGlvbiBfdGVtcDIkNChyXzApIHtcbiAgcmV0dXJuIHJfMC50YWdOYW1lICE9PSBcIklNR1wiO1xufVxuY29uc3QgUm9vdCQxID0gc3R5bGVkKENhcmQpYFxuICBwb3NpdGlvbjogZml4ZWQ7XG4gIGJvdHRvbTogMnJlbTtcbiAgbGVmdDogMnJlbTtcbmAsIE92ZXJsYXlNaW5pbWFwUHJvbXB0ID0gKCkgPT4ge1xuICBjb25zdCAkID0gYygyKTtcbiAgbGV0IHQwO1xuICAkWzBdID09PSBTeW1ib2wuZm9yKFwicmVhY3QubWVtb19jYWNoZV9zZW50aW5lbFwiKSA/ICh0MCA9IHtcbiAgICB6SW5kZXg6IFwiOTk5OTk5XCJcbiAgfSwgJFswXSA9IHQwKSA6IHQwID0gJFswXTtcbiAgbGV0IHQxO1xuICByZXR1cm4gJFsxXSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDEgPSAvKiBAX19QVVJFX18gKi8ganN4KFJvb3QkMSwgeyBwYWRkaW5nOiAyLCBzaGFkb3c6IDIsIHJhZGl1czogMiwgc3R5bGU6IHQwLCBjaGlsZHJlbjogLyogQF9fUFVSRV9fICovIGpzeHMoRmxleCwgeyBhbGlnbjogXCJjZW50ZXJcIiwgZ2FwOiAyLCBjaGlsZHJlbjogW1xuICAgIC8qIEBfX1BVUkVfXyAqLyBqc3goSG90a2V5cywgeyBrZXlzOiBbXCJTaGlmdFwiXSB9KSxcbiAgICAvKiBAX19QVVJFX18gKi8ganN4KFRleHQsIHsgc2l6ZTogMSwgY2hpbGRyZW46IFwiWm9vbSBPdXRcIiB9KSxcbiAgICAvKiBAX19QVVJFX18gKi8ganN4KEV4cGFuZEljb24sIHt9KVxuICBdIH0pIH0pLCAkWzFdID0gdDEpIDogdDEgPSAkWzFdLCB0MTtcbn0sIGVsZW1lbnRzUmVkdWNlciA9IChlbGVtZW50cywgbWVzc2FnZSkgPT4ge1xuICBjb25zdCB7XG4gICAgdHlwZVxuICB9ID0gbWVzc2FnZTtcbiAgc3dpdGNoICh0eXBlKSB7XG4gICAgY2FzZSBcImVsZW1lbnQvcmVnaXN0ZXJcIjpcbiAgICAgIHJldHVybiBlbGVtZW50cy5maW5kKChlKSA9PiBlLmlkID09PSBtZXNzYWdlLmlkKSA/IGVsZW1lbnRzIDogWy4uLmVsZW1lbnRzLCB7XG4gICAgICAgIGlkOiBtZXNzYWdlLmlkLFxuICAgICAgICBhY3RpdmF0ZWQ6ICExLFxuICAgICAgICBlbGVtZW50OiBtZXNzYWdlLmVsZW1lbnQsXG4gICAgICAgIGZvY3VzZWQ6ICExLFxuICAgICAgICBob3ZlcmVkOiAhMSxcbiAgICAgICAgcmVjdDogbWVzc2FnZS5yZWN0LFxuICAgICAgICBzYW5pdHk6IG1lc3NhZ2Uuc2FuaXR5LFxuICAgICAgICBkcmFnRGlzYWJsZWQ6IG1lc3NhZ2UuZHJhZ0Rpc2FibGVkXG4gICAgICB9XTtcbiAgICBjYXNlIFwiZWxlbWVudC9hY3RpdmF0ZVwiOlxuICAgICAgcmV0dXJuIGVsZW1lbnRzLm1hcCgoZSkgPT4gZS5pZCA9PT0gbWVzc2FnZS5pZCA/IHtcbiAgICAgICAgLi4uZSxcbiAgICAgICAgYWN0aXZhdGVkOiAhMFxuICAgICAgfSA6IGUpO1xuICAgIGNhc2UgXCJlbGVtZW50L3VwZGF0ZVwiOlxuICAgICAgcmV0dXJuIGVsZW1lbnRzLm1hcCgoZSkgPT4gZS5pZCA9PT0gbWVzc2FnZS5pZCA/IHtcbiAgICAgICAgLi4uZSxcbiAgICAgICAgc2FuaXR5OiBtZXNzYWdlLnNhbml0eSxcbiAgICAgICAgcmVjdDogbWVzc2FnZS5yZWN0XG4gICAgICB9IDogZSk7XG4gICAgY2FzZSBcImVsZW1lbnQvdW5yZWdpc3RlclwiOlxuICAgICAgcmV0dXJuIGVsZW1lbnRzLmZpbHRlcigoZSkgPT4gZS5pZCAhPT0gbWVzc2FnZS5pZCk7XG4gICAgY2FzZSBcImVsZW1lbnQvZGVhY3RpdmF0ZVwiOlxuICAgICAgcmV0dXJuIGVsZW1lbnRzLm1hcCgoZSkgPT4gZS5pZCA9PT0gbWVzc2FnZS5pZCA/IHtcbiAgICAgICAgLi4uZSxcbiAgICAgICAgYWN0aXZhdGVkOiAhMSxcbiAgICAgICAgaG92ZXJlZDogITFcbiAgICAgIH0gOiBlKTtcbiAgICBjYXNlIFwiZWxlbWVudC9tb3VzZWVudGVyXCI6XG4gICAgICByZXR1cm4gZWxlbWVudHMubWFwKChlKSA9PiBlLmlkID09PSBtZXNzYWdlLmlkID8ge1xuICAgICAgICAuLi5lLFxuICAgICAgICByZWN0OiBtZXNzYWdlLnJlY3QsXG4gICAgICAgIGhvdmVyZWQ6ICEwXG4gICAgICB9IDoge1xuICAgICAgICAuLi5lLFxuICAgICAgICBob3ZlcmVkOiAhMVxuICAgICAgfSk7XG4gICAgY2FzZSBcImVsZW1lbnQvbW91c2VsZWF2ZVwiOlxuICAgICAgcmV0dXJuIGVsZW1lbnRzLm1hcCgoZWxlbWVudCkgPT4gZWxlbWVudC5pZCA9PT0gbWVzc2FnZS5pZCA/IHtcbiAgICAgICAgLi4uZWxlbWVudCxcbiAgICAgICAgaG92ZXJlZDogITFcbiAgICAgIH0gOiBlbGVtZW50KTtcbiAgICBjYXNlIFwiZWxlbWVudC91cGRhdGVSZWN0XCI6XG4gICAgICByZXR1cm4gZWxlbWVudHMubWFwKChlbGVtZW50KSA9PiBlbGVtZW50LmlkID09PSBtZXNzYWdlLmlkID8ge1xuICAgICAgICAuLi5lbGVtZW50LFxuICAgICAgICByZWN0OiBtZXNzYWdlLnJlY3RcbiAgICAgIH0gOiBlbGVtZW50KTtcbiAgICBjYXNlIFwiZWxlbWVudC9jbGlja1wiOlxuICAgICAgcmV0dXJuIGVsZW1lbnRzLm1hcCgoZSkgPT4gKHtcbiAgICAgICAgLi4uZSxcbiAgICAgICAgZm9jdXNlZDogZS5pZCA9PT0gbWVzc2FnZS5pZCAmJiBcImNsaWNrZWRcIlxuICAgICAgfSkpO1xuICAgIGNhc2UgXCJvdmVybGF5L2JsdXJcIjpcbiAgICAgIHJldHVybiBlbGVtZW50cy5tYXAoKGUpID0+ICh7XG4gICAgICAgIC4uLmUsXG4gICAgICAgIGZvY3VzZWQ6ICExXG4gICAgICB9KSk7XG4gICAgY2FzZSBcInByZXNlbnRhdGlvbi9ibHVyXCI6XG4gICAgICByZXR1cm4gZWxlbWVudHMubWFwKChlKSA9PiAoe1xuICAgICAgICAuLi5lLFxuICAgICAgICBmb2N1c2VkOiAhMVxuICAgICAgfSkpO1xuICAgIGNhc2UgXCJwcmVzZW50YXRpb24vZm9jdXNcIjoge1xuICAgICAgY29uc3QgY2xpY2tlZEVsZW1lbnQgPSBlbGVtZW50cy5maW5kKChlKSA9PiBlLmZvY3VzZWQgPT09IFwiY2xpY2tlZFwiKTtcbiAgICAgIHJldHVybiBlbGVtZW50cy5tYXAoKGUpID0+IHtcbiAgICAgICAgY29uc3QgZm9jdXNlZCA9IFwicGF0aFwiIGluIGUuc2FuaXR5ICYmIGUuc2FuaXR5LmlkID09PSBtZXNzYWdlLmRhdGEuaWQgJiYgZS5zYW5pdHkucGF0aCA9PT0gbWVzc2FnZS5kYXRhLnBhdGg7XG4gICAgICAgIHJldHVybiBjbGlja2VkRWxlbWVudCAmJiBlID09PSBjbGlja2VkRWxlbWVudCAmJiBmb2N1c2VkID8gZSA6IHtcbiAgICAgICAgICAuLi5lLFxuICAgICAgICAgIC8vIE1hcmsgYXMgYSBkdXBlIGlmIGFub3RoZXIgbWF0Y2hpbmcgaXRlbSBoYXMgYmVlbiBjbGlja2VkIHRvIHByZXZlbnRcbiAgICAgICAgICAvLyBzY3JvbGxpbmcsIG90aGVyd2lzZSBqdXN0IHNldCBmb2N1cyBhcyBhIGJvb2xlYW5cbiAgICAgICAgICBmb2N1c2VkOiBmb2N1c2VkICYmIGNsaWNrZWRFbGVtZW50ID8gXCJkdXBsaWNhdGVcIiA6IGZvY3VzZWRcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIGVsZW1lbnRzO1xuICB9XG59O1xuZnVuY3Rpb24gb3ZlcmxheVN0YXRlUmVkdWNlcihzdGF0ZSwgbWVzc2FnZSkge1xuICBjb25zdCB7XG4gICAgdHlwZVxuICB9ID0gbWVzc2FnZTtcbiAgbGV0IHtcbiAgICBjb250ZXh0TWVudSxcbiAgICBmb2N1c1BhdGgsXG4gICAgcGVyc3BlY3RpdmUsXG4gICAgaXNEcmFnZ2luZyxcbiAgICBkcmFnSW5zZXJ0UG9zaXRpb24sXG4gICAgZHJhZ1Nob3dNaW5pbWFwLFxuICAgIGRyYWdTaG93TWluaW1hcFByb21wdCxcbiAgICBkcmFnU2tlbGV0b24sXG4gICAgZHJhZ01pbmltYXBUcmFuc2l0aW9uLFxuICAgIGRyYWdHcm91cFJlY3RcbiAgfSA9IHN0YXRlLCB3YXNNYXliZUNvbGxhcHNlZCA9ICExO1xuICBpZiAodHlwZSA9PT0gXCJwcmVzZW50YXRpb24vZm9jdXNcIikge1xuICAgIGNvbnN0IHByZXZGb2N1c1BhdGggPSBzdGF0ZS5mb2N1c1BhdGg7XG4gICAgZm9jdXNQYXRoID0gbWVzc2FnZS5kYXRhLnBhdGgsIHByZXZGb2N1c1BhdGggIT09IGZvY3VzUGF0aCAmJiAod2FzTWF5YmVDb2xsYXBzZWQgPSBwcmV2Rm9jdXNQYXRoLnNsaWNlKGZvY3VzUGF0aC5sZW5ndGgpLnN0YXJ0c1dpdGgoXCJbXCIpKTtcbiAgfVxuICByZXR1cm4gdHlwZSA9PT0gXCJwcmVzZW50YXRpb24vcGVyc3BlY3RpdmVcIiAmJiAocGVyc3BlY3RpdmUgPSBtZXNzYWdlLmRhdGEucGVyc3BlY3RpdmUpLCB0eXBlID09PSBcImVsZW1lbnQvY29udGV4dG1lbnVcIiAmJiAoXCJzYW5pdHlcIiBpbiBtZXNzYWdlID8gY29udGV4dE1lbnUgPSB7XG4gICAgbm9kZTogbWVzc2FnZS5zYW5pdHksXG4gICAgcG9zaXRpb246IG1lc3NhZ2UucG9zaXRpb25cbiAgfSA6IGNvbnRleHRNZW51ID0gbnVsbCksICh0eXBlID09PSBcImVsZW1lbnQvY2xpY2tcIiB8fCB0eXBlID09PSBcImVsZW1lbnQvbW91c2VsZWF2ZVwiIHx8IHR5cGUgPT09IFwib3ZlcmxheS9ibHVyXCIgfHwgdHlwZSA9PT0gXCJwcmVzZW50YXRpb24vYmx1clwiIHx8IHR5cGUgPT09IFwicHJlc2VudGF0aW9uL2ZvY3VzXCIpICYmIChjb250ZXh0TWVudSA9IG51bGwpLCB0eXBlID09PSBcIm92ZXJsYXkvZHJhZ1VwZGF0ZUluc2VydFBvc2l0aW9uXCIgJiYgKGRyYWdJbnNlcnRQb3NpdGlvbiA9IG1lc3NhZ2UuaW5zZXJ0UG9zaXRpb24pLCB0eXBlID09PSBcIm92ZXJsYXkvZHJhZ1N0YXJ0XCIgJiYgKGlzRHJhZ2dpbmcgPSAhMCksIG1lc3NhZ2UudHlwZSA9PT0gXCJvdmVybGF5L2RyYWdVcGRhdGVTa2VsZXRvblwiICYmIChkcmFnU2tlbGV0b24gPSBtZXNzYWdlLnNrZWxldG9uKSwgdHlwZSA9PT0gXCJvdmVybGF5L2RyYWdFbmRcIiAmJiAoaXNEcmFnZ2luZyA9ICExKSwgbWVzc2FnZS50eXBlID09PSBcIm92ZXJsYXkvZHJhZ1RvZ2dsZU1pbmltYXBQcm9tcHRcIiAmJiAoZHJhZ1Nob3dNaW5pbWFwUHJvbXB0ID0gbWVzc2FnZS5kaXNwbGF5KSwgdHlwZSA9PT0gXCJvdmVybGF5L2RyYWdTdGFydE1pbmltYXBUcmFuc2l0aW9uXCIgJiYgKGRyYWdNaW5pbWFwVHJhbnNpdGlvbiA9ICEwKSwgdHlwZSA9PT0gXCJvdmVybGF5L2RyYWdFbmRNaW5pbWFwVHJhbnNpdGlvblwiICYmIChkcmFnTWluaW1hcFRyYW5zaXRpb24gPSAhMSksIHR5cGUgPT09IFwib3ZlcmxheS9kcmFnVXBkYXRlR3JvdXBSZWN0XCIgJiYgKGRyYWdHcm91cFJlY3QgPSBtZXNzYWdlLmdyb3VwUmVjdCksIHR5cGUgPT09IFwib3ZlcmxheS9kcmFnVG9nZ2xlTWluaW1hcFwiICYmIChkcmFnU2hvd01pbmltYXAgPSBtZXNzYWdlLmRpc3BsYXkpLCB7XG4gICAgLi4uc3RhdGUsXG4gICAgY29udGV4dE1lbnUsXG4gICAgZWxlbWVudHM6IGVsZW1lbnRzUmVkdWNlcihzdGF0ZS5lbGVtZW50cywgbWVzc2FnZSksXG4gICAgZHJhZ0luc2VydFBvc2l0aW9uLFxuICAgIGRyYWdTa2VsZXRvbixcbiAgICBkcmFnR3JvdXBSZWN0LFxuICAgIGlzRHJhZ2dpbmcsXG4gICAgZm9jdXNQYXRoLFxuICAgIHBlcnNwZWN0aXZlLFxuICAgIHdhc01heWJlQ29sbGFwc2VkLFxuICAgIGRyYWdTaG93TWluaW1hcCxcbiAgICBkcmFnU2hvd01pbmltYXBQcm9tcHQsXG4gICAgZHJhZ01pbmltYXBUcmFuc2l0aW9uXG4gIH07XG59XG5jb25zdCBQcmV2aWV3U25hcHNob3RzUHJvdmlkZXIgPSBmdW5jdGlvbihwcm9wcykge1xuICBjb25zdCAkID0gYygxMyksIHtcbiAgICBjb21saW5rLFxuICAgIGNoaWxkcmVuXG4gIH0gPSBwcm9wcztcbiAgbGV0IHQwO1xuICAkWzBdID09PSBTeW1ib2wuZm9yKFwicmVhY3QubWVtb19jYWNoZV9zZW50aW5lbFwiKSA/ICh0MCA9IFtdLCAkWzBdID0gdDApIDogdDAgPSAkWzBdO1xuICBjb25zdCBbcHJldmlld1NuYXBzaG90cywgc2V0UHJldmlld1NuYXBzaG90c10gPSB1c2VTdGF0ZSh0MCk7XG4gIGxldCB0MTtcbiAgJFsxXSAhPT0gY29tbGluayA/ICh0MSA9IGFzeW5jIChzaWduYWwpID0+IHtcbiAgICBpZiAoY29tbGluaylcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY29tbGluay5mZXRjaChcInZpc3VhbC1lZGl0aW5nL3ByZXZpZXctc25hcHNob3RzXCIsIHZvaWQgMCwge1xuICAgICAgICAgIHNpZ25hbCxcbiAgICAgICAgICBzdXBwcmVzc1dhcm5pbmdzOiAhMFxuICAgICAgICB9KTtcbiAgICAgICAgc2V0UHJldmlld1NuYXBzaG90cyhyZXNwb25zZS5zbmFwc2hvdHMpO1xuICAgICAgfSBjYXRjaCB7XG4gICAgICB9XG4gIH0sICRbMV0gPSBjb21saW5rLCAkWzJdID0gdDEpIDogdDEgPSAkWzJdO1xuICBjb25zdCBmZXRjaFByZXZpZXdTbmFwc2hvdHMgPSB0MTtcbiAgbGV0IHQyLCB0MztcbiAgJFszXSAhPT0gY29tbGluayB8fCAkWzRdICE9PSBmZXRjaFByZXZpZXdTbmFwc2hvdHMgPyAodDIgPSAoKSA9PiB7XG4gICAgaWYgKCFjb21saW5rKVxuICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IHByZXZpZXdTYXBzaG90c0ZldGNoID0gbmV3IEFib3J0Q29udHJvbGxlcigpLCB1bnN1YiA9IGNvbWxpbmsub25TdGF0dXMoKCkgPT4ge1xuICAgICAgZmV0Y2hQcmV2aWV3U25hcHNob3RzKHByZXZpZXdTYXBzaG90c0ZldGNoLnNpZ25hbCk7XG4gICAgfSwgXCJjb25uZWN0ZWRcIik7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHByZXZpZXdTYXBzaG90c0ZldGNoLmFib3J0KCksIHVuc3ViKCk7XG4gICAgfTtcbiAgfSwgdDMgPSBbY29tbGluaywgZmV0Y2hQcmV2aWV3U25hcHNob3RzXSwgJFszXSA9IGNvbWxpbmssICRbNF0gPSBmZXRjaFByZXZpZXdTbmFwc2hvdHMsICRbNV0gPSB0MiwgJFs2XSA9IHQzKSA6ICh0MiA9ICRbNV0sIHQzID0gJFs2XSksIHVzZUVmZmVjdCh0MiwgdDMpO1xuICBsZXQgdDQsIHQ1O1xuICAkWzddICE9PSBjb21saW5rID8gKHQ0ID0gKCkgPT4gY29tbGluaz8ub24oXCJwcmVzZW50YXRpb24vcHJldmlldy1zbmFwc2hvdHNcIiwgKGRhdGEpID0+IHtcbiAgICBzZXRQcmV2aWV3U25hcHNob3RzKGRhdGEuc25hcHNob3RzKTtcbiAgfSksIHQ1ID0gW2NvbWxpbmtdLCAkWzddID0gY29tbGluaywgJFs4XSA9IHQ0LCAkWzldID0gdDUpIDogKHQ0ID0gJFs4XSwgdDUgPSAkWzldKSwgdXNlRWZmZWN0KHQ0LCB0NSk7XG4gIGxldCB0NjtcbiAgdDYgPSBwcmV2aWV3U25hcHNob3RzO1xuICBjb25zdCBjb250ZXh0ID0gdDY7XG4gIGxldCB0NztcbiAgcmV0dXJuICRbMTBdICE9PSBjaGlsZHJlbiB8fCAkWzExXSAhPT0gY29udGV4dCA/ICh0NyA9IC8qIEBfX1BVUkVfXyAqLyBqc3goUHJldmlld1NuYXBzaG90c0NvbnRleHQuUHJvdmlkZXIsIHsgdmFsdWU6IGNvbnRleHQsIGNoaWxkcmVuIH0pLCAkWzEwXSA9IGNoaWxkcmVuLCAkWzExXSA9IGNvbnRleHQsICRbMTJdID0gdDcpIDogdDcgPSAkWzEyXSwgdDc7XG59O1xuZnVuY3Rpb24gaXNTYW5pdHlOb2RlKG5vZGUpIHtcbiAgcmV0dXJuIFwicGF0aFwiIGluIG5vZGU7XG59XG5mdW5jdGlvbiBpc0RvY3VtZW50U2NoZW1hVHlwZSh0eXBlKSB7XG4gIHJldHVybiB0eXBlLnR5cGUgPT09IFwiZG9jdW1lbnRcIjtcbn1cbmZ1bmN0aW9uIGlzVHlwZVNjaGVtYVR5cGUodHlwZSkge1xuICByZXR1cm4gdHlwZS50eXBlID09PSBcInR5cGVcIjtcbn1cbmZ1bmN0aW9uIHBvcFVua2V5ZWRQYXRoU2VnbWVudHMocGF0aCkge1xuICByZXR1cm4gcGF0aC5zcGxpdChcIi5cIikudG9SZXZlcnNlZCgpLnJlZHVjZSgoYWNjLCBwYXJ0KSA9PiBhY2MubGVuZ3RoID8gW3BhcnQsIC4uLmFjY10gOiBwYXJ0LmluY2x1ZGVzKFwiW19rZXk9PVwiKSA/IFtwYXJ0XSA6IFtdLCBbXSkuam9pbihcIi5cIik7XG59XG5mdW5jdGlvbiBnZXRQYXRoc1dpdGhVbnJlc29sdmVkVHlwZXMoZWxlbWVudHMpIHtcbiAgcmV0dXJuIGVsZW1lbnRzLnJlZHVjZSgoYWNjLCBlbGVtZW50KSA9PiB7XG4gICAgY29uc3Qge1xuICAgICAgc2FuaXR5XG4gICAgfSA9IGVsZW1lbnQ7XG4gICAgaWYgKCEoXCJpZFwiIGluIHNhbml0eSkgfHwgIXNhbml0eS5wYXRoLmluY2x1ZGVzKFwiW19rZXk9PVwiKSkgcmV0dXJuIGFjYztcbiAgICBjb25zdCBwYXRoID0gcG9wVW5rZXllZFBhdGhTZWdtZW50cyhzYW5pdHkucGF0aCk7XG4gICAgcmV0dXJuIGFjYy5maW5kKChpdGVtKSA9PiBpdGVtLmlkID09PSBzYW5pdHkuaWQgJiYgaXRlbS5wYXRoID09PSBwYXRoKSB8fCBhY2MucHVzaCh7XG4gICAgICBpZDogc2FuaXR5LmlkLFxuICAgICAgcGF0aFxuICAgIH0pLCBhY2M7XG4gIH0sIFtdKTtcbn1cbmNvbnN0IFNjaGVtYVByb3ZpZGVyID0gZnVuY3Rpb24ocHJvcHMpIHtcbiAgY29uc3QgJCA9IGMoMjIpLCB7XG4gICAgY29tbGluayxcbiAgICBjaGlsZHJlbixcbiAgICBlbGVtZW50c1xuICB9ID0gcHJvcHM7XG4gIGxldCB0MDtcbiAgJFswXSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDAgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpLCAkWzBdID0gdDApIDogdDAgPSAkWzBdO1xuICBjb25zdCBbcmVzb2x2ZWRUeXBlcywgc2V0UmVzb2x2ZWRUeXBlc10gPSB1c2VTdGF0ZSh0MCksIFtzY2hlbWEsIHNldFNjaGVtYV0gPSB1c2VTdGF0ZShudWxsKTtcbiAgbGV0IHQxLCB0MjtcbiAgJFsxXSAhPT0gY29tbGluayA/ICh0MSA9ICgpID0+IHtcbiAgICBpZiAoIWNvbWxpbmspXG4gICAgICByZXR1cm47XG4gICAgY29uc3QgZmV0Y2hTY2hlbWEgPSBhc3luYyBmdW5jdGlvbihzaWduYWwpIHtcbiAgICAgIGlmIChjb21saW5rKVxuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY29tbGluay5mZXRjaChcInZpc3VhbC1lZGl0aW5nL3NjaGVtYVwiLCB2b2lkIDAsIHtcbiAgICAgICAgICAgIHNpZ25hbCxcbiAgICAgICAgICAgIHN1cHByZXNzV2FybmluZ3M6ICEwXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgc2V0U2NoZW1hKHJlc3BvbnNlLnNjaGVtYSk7XG4gICAgICAgIH0gY2F0Y2gge1xuICAgICAgICB9XG4gICAgfSwgc2NoZW1hRmV0Y2ggPSBuZXcgQWJvcnRDb250cm9sbGVyKCksIHVuc3ViID0gY29tbGluay5vblN0YXR1cygoKSA9PiB7XG4gICAgICBmZXRjaFNjaGVtYShzY2hlbWFGZXRjaC5zaWduYWwpO1xuICAgIH0sIFwiY29ubmVjdGVkXCIpO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBzY2hlbWFGZXRjaC5hYm9ydCgpLCB1bnN1YigpO1xuICAgIH07XG4gIH0sIHQyID0gW2NvbWxpbmtdLCAkWzFdID0gY29tbGluaywgJFsyXSA9IHQxLCAkWzNdID0gdDIpIDogKHQxID0gJFsyXSwgdDIgPSAkWzNdKSwgdXNlRWZmZWN0KHQxLCB0Mik7XG4gIGxldCB0MztcbiAgJFs0XSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDMgPSBbXSwgJFs0XSA9IHQzKSA6IHQzID0gJFs0XTtcbiAgY29uc3QgcmVwb3J0ZWRQYXRoc1JlZiA9IHVzZVJlZih0MyksIHQ0ID0gdXNlRGVmZXJyZWRWYWx1ZShlbGVtZW50cyk7XG4gIGxldCB0NTtcbiAgJFs1XSAhPT0gdDQgPyAodDUgPSBnZXRQYXRoc1dpdGhVbnJlc29sdmVkVHlwZXModDQpLCAkWzVdID0gdDQsICRbNl0gPSB0NSkgOiB0NSA9ICRbNl07XG4gIGNvbnN0IHBhdGhzID0gdDUsIGNvbnRyb2xsZXJSZWYgPSB1c2VSZWYobnVsbCk7XG4gIGxldCB0NiwgdDc7XG4gICRbN10gIT09IGNvbWxpbmsgfHwgJFs4XSAhPT0gcGF0aHMgPyAodDYgPSAoKSA9PiB7XG4gICAgaWYgKCFwYXRocy5sZW5ndGggfHwgIWNvbWxpbmspXG4gICAgICByZXR1cm47XG4gICAgY29uc3QgcmVwb3J0UGF0aHMgPSBhc3luYyAocGF0aHNfMCwgc2lnbmFsXzApID0+IHtcbiAgICAgIGNvbnN0IGluaXRpYWxSZXBvcnRlZFBhdGhzID0gcmVwb3J0ZWRQYXRoc1JlZi5jdXJyZW50O1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmVwb3J0ZWRQYXRoc1JlZi5jdXJyZW50ID0gcGF0aHNfMDtcbiAgICAgICAgY29uc3QgcmVzcG9uc2VfMCA9IGF3YWl0IGNvbWxpbmsuZmV0Y2goXCJ2aXN1YWwtZWRpdGluZy9zY2hlbWEtdW5pb24tdHlwZXNcIiwge1xuICAgICAgICAgIHBhdGhzOiBwYXRoc18wXG4gICAgICAgIH0sIHtcbiAgICAgICAgICBzaWduYWw6IHNpZ25hbF8wLFxuICAgICAgICAgIHN1cHByZXNzV2FybmluZ3M6ICEwXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoc2lnbmFsXzAuYWJvcnRlZClcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIHNldFJlc29sdmVkVHlwZXMocmVzcG9uc2VfMC50eXBlcyksIGNvbnRyb2xsZXJSZWYuY3VycmVudCA9IG51bGw7XG4gICAgICB9IGNhdGNoIHtcbiAgICAgIH1cbiAgICAgIHNpZ25hbF8wLmFib3J0ZWQgJiYgKHJlcG9ydGVkUGF0aHNSZWYuY3VycmVudCA9IGluaXRpYWxSZXBvcnRlZFBhdGhzKTtcbiAgICB9O1xuICAgIHBhdGhzLnNvbWUoKHApID0+ICFyZXBvcnRlZFBhdGhzUmVmLmN1cnJlbnQuZmluZCgodDgyKSA9PiB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIGlkLFxuICAgICAgICBwYXRoXG4gICAgICB9ID0gdDgyO1xuICAgICAgcmV0dXJuIGlkID09PSBwLmlkICYmIHBhdGggPT09IHAucGF0aDtcbiAgICB9KSkgJiYgKGNvbnRyb2xsZXJSZWYuY3VycmVudD8uYWJvcnQoKSwgY29udHJvbGxlclJlZi5jdXJyZW50ID0gbmV3IEFib3J0Q29udHJvbGxlcigpLCByZXBvcnRQYXRocyhwYXRocywgY29udHJvbGxlclJlZi5jdXJyZW50LnNpZ25hbCkpO1xuICB9LCB0NyA9IFtjb21saW5rLCBwYXRoc10sICRbN10gPSBjb21saW5rLCAkWzhdID0gcGF0aHMsICRbOV0gPSB0NiwgJFsxMF0gPSB0NykgOiAodDYgPSAkWzldLCB0NyA9ICRbMTBdKSwgdXNlRWZmZWN0KHQ2LCB0Nyk7XG4gIGxldCB0ODtcbiAgJFsxMV0gIT09IHNjaGVtYSA/ICh0OCA9IChub2RlLCBfdHlwZSkgPT4ge1xuICAgIGNvbnN0IHR5cGUgPSBfdHlwZSB8fCBcImRvY3VtZW50XCI7XG4gICAgaWYgKCFzY2hlbWEgfHwgdHlwZW9mIG5vZGUgIT0gXCJzdHJpbmdcIiAmJiAoIWlzU2FuaXR5Tm9kZShub2RlKSB8fCAhQXJyYXkuaXNBcnJheShzY2hlbWEpKSlcbiAgICAgIHJldHVybjtcbiAgICBjb25zdCBuYW1lID0gdHlwZW9mIG5vZGUgPT0gXCJzdHJpbmdcIiA/IG5vZGUgOiBub2RlLnR5cGUsIGZpbHRlciA9IHR5cGUgPT09IFwiZG9jdW1lbnRcIiA/IGlzRG9jdW1lbnRTY2hlbWFUeXBlIDogaXNUeXBlU2NoZW1hVHlwZTtcbiAgICByZXR1cm4gc2NoZW1hLmZpbHRlcihmaWx0ZXIpLmZpbmQoKHNjaGVtYVR5cGUpID0+IHNjaGVtYVR5cGUubmFtZSA9PT0gbmFtZSk7XG4gIH0sICRbMTFdID0gc2NoZW1hLCAkWzEyXSA9IHQ4KSA6IHQ4ID0gJFsxMl07XG4gIGNvbnN0IGdldFR5cGUgPSB0ODtcbiAgbGV0IHQ5O1xuICAkWzEzXSAhPT0gZ2V0VHlwZSB8fCAkWzE0XSAhPT0gcmVzb2x2ZWRUeXBlcyA/ICh0OSA9IChub2RlXzApID0+IHtcbiAgICBpZiAoIWlzU2FuaXR5Tm9kZShub2RlXzApKVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZmllbGQ6IHZvaWQgMCxcbiAgICAgICAgcGFyZW50OiB2b2lkIDBcbiAgICAgIH07XG4gICAgY29uc3Qgc2NoZW1hVHlwZV8wID0gZ2V0VHlwZShub2RlXzApO1xuICAgIGlmICghc2NoZW1hVHlwZV8wKVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZmllbGQ6IHZvaWQgMCxcbiAgICAgICAgcGFyZW50OiB2b2lkIDBcbiAgICAgIH07XG4gICAgZnVuY3Rpb24gZmllbGRGcm9tUGF0aChzY2hlbWFUeXBlXzEsIHBhdGhfMCwgcGFyZW50LCB0MTAyKSB7XG4gICAgICBjb25zdCBwcmV2UGF0aCA9IHQxMDIgPT09IHZvaWQgMCA/IFtdIDogdDEwMjtcbiAgICAgIGlmICghc2NoZW1hVHlwZV8xKVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGZpZWxkOiB2b2lkIDAsXG4gICAgICAgICAgcGFyZW50OiB2b2lkIDBcbiAgICAgICAgfTtcbiAgICAgIGNvbnN0IFtuZXh0LCAuLi5yZXN0XSA9IHBhdGhfMDtcbiAgICAgIGlmIChcImZpZWxkc1wiIGluIHNjaGVtYVR5cGVfMSkge1xuICAgICAgICBjb25zdCBvYmplY3RGaWVsZCA9IHNjaGVtYVR5cGVfMS5maWVsZHNbbmV4dF07XG4gICAgICAgIGlmICghb2JqZWN0RmllbGQgJiYgXCJyZXN0XCIgaW4gc2NoZW1hVHlwZV8xKVxuICAgICAgICAgIHJldHVybiBmaWVsZEZyb21QYXRoKHNjaGVtYVR5cGVfMS5yZXN0LCBwYXRoXzAsIHNjaGVtYVR5cGVfMSwgcHJldlBhdGgpO1xuICAgICAgICBpZiAoIXJlc3QubGVuZ3RoKVxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBmaWVsZDogb2JqZWN0RmllbGQsXG4gICAgICAgICAgICBwYXJlbnRcbiAgICAgICAgICB9O1xuICAgICAgICBpZiAoIW9iamVjdEZpZWxkKVxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgW0BzYW5pdHkvdmlzdWFsLWVkaXRpbmddIE5vIGZpZWxkIGNvdWxkIGJlIHJlc29sdmVkIGF0IHBhdGg6IFwiJHtbLi4ucHJldlBhdGgsIC4uLnBhdGhfMF0uam9pbihcIi5cIil9XCJgKTtcbiAgICAgICAgcmV0dXJuIGZpZWxkRnJvbVBhdGgob2JqZWN0RmllbGQudmFsdWUsIHJlc3QsIHNjaGVtYVR5cGVfMSwgWy4uLnByZXZQYXRoLCBuZXh0XSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoc2NoZW1hVHlwZV8xLnR5cGUgPT09IFwiYXJyYXlcIilcbiAgICAgICAgICByZXR1cm4gZmllbGRGcm9tUGF0aChzY2hlbWFUeXBlXzEub2YsIHBhdGhfMCwgc2NoZW1hVHlwZV8xLCBwcmV2UGF0aCk7XG4gICAgICAgIGlmIChzY2hlbWFUeXBlXzEudHlwZSA9PT0gXCJhcnJheUl0ZW1cIilcbiAgICAgICAgICByZXR1cm4gcmVzdC5sZW5ndGggPyBmaWVsZEZyb21QYXRoKHNjaGVtYVR5cGVfMS52YWx1ZSwgcmVzdCwgc2NoZW1hVHlwZV8xLCBbLi4ucHJldlBhdGgsIG5leHRdKSA6IHtcbiAgICAgICAgICAgIGZpZWxkOiBzY2hlbWFUeXBlXzEsXG4gICAgICAgICAgICBwYXJlbnRcbiAgICAgICAgICB9O1xuICAgICAgICBpZiAoc2NoZW1hVHlwZV8xLnR5cGUgPT09IFwidW5pb25cIikge1xuICAgICAgICAgIGNvbnN0IG5hbWVfMCA9IG5leHQuc3RhcnRzV2l0aChcIltfa2V5PT1cIikgPyByZXNvbHZlZFR5cGVzPy5nZXQobm9kZV8wLmlkKT8uZ2V0KFtwcmV2UGF0aC5qb2luKFwiLlwiKSwgbmV4dF0uZmlsdGVyKEJvb2xlYW4pLmpvaW4oXCJcIikpIDogbmV4dDtcbiAgICAgICAgICByZXR1cm4gZmllbGRGcm9tUGF0aChzY2hlbWFUeXBlXzEub2YuZmluZCgoaXRlbSkgPT4gaXRlbS50eXBlID09PSBcInVuaW9uT3B0aW9uXCIgPyBpdGVtLm5hbWUgPT09IG5hbWVfMCA6IGl0ZW0pLCByZXN0LCBzY2hlbWFUeXBlXzEsIFsuLi5wcmV2UGF0aCwgbmV4dF0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChzY2hlbWFUeXBlXzEudHlwZSA9PT0gXCJ1bmlvbk9wdGlvblwiKVxuICAgICAgICAgICAgcmV0dXJuIG5leHQgPyBmaWVsZEZyb21QYXRoKHNjaGVtYVR5cGVfMS52YWx1ZSwgcGF0aF8wLCBzY2hlbWFUeXBlXzEsIHByZXZQYXRoKSA6IHtcbiAgICAgICAgICAgICAgZmllbGQ6IHNjaGVtYVR5cGVfMSxcbiAgICAgICAgICAgICAgcGFyZW50XG4gICAgICAgICAgICB9O1xuICAgICAgICAgIGlmIChzY2hlbWFUeXBlXzEudHlwZSA9PT0gXCJpbmxpbmVcIikge1xuICAgICAgICAgICAgY29uc3QgdHlwZV8wID0gZ2V0VHlwZShzY2hlbWFUeXBlXzEubmFtZSwgXCJ0eXBlXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGZpZWxkRnJvbVBhdGgodHlwZV8wLnZhbHVlLCBwYXRoXzAsIHNjaGVtYVR5cGVfMSwgcHJldlBhdGgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBbQHNhbml0eS92aXN1YWwtZWRpdGluZ10gTm8gZmllbGQgY291bGQgYmUgcmVzb2x2ZWQgYXQgcGF0aDogXCIke1suLi5wcmV2UGF0aCwgLi4ucGF0aF8wXS5qb2luKFwiLlwiKX1cImApO1xuICAgIH1cbiAgICBjb25zdCBub2RlUGF0aCA9IG5vZGVfMC5wYXRoLnNwbGl0KFwiLlwiKS5mbGF0TWFwKF90ZW1wJDYpO1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gZmllbGRGcm9tUGF0aChzY2hlbWFUeXBlXzAsIG5vZGVQYXRoLCB2b2lkIDApO1xuICAgIH0gY2F0Y2ggKHQxMTIpIHtcbiAgICAgIGNvbnN0IGUgPSB0MTEyO1xuICAgICAgcmV0dXJuIGUgaW5zdGFuY2VvZiBFcnJvciAmJiBjb25zb2xlLndhcm4oZS5tZXNzYWdlKSwge1xuICAgICAgICBmaWVsZDogdm9pZCAwLFxuICAgICAgICBwYXJlbnQ6IHZvaWQgMFxuICAgICAgfTtcbiAgICB9XG4gIH0sICRbMTNdID0gZ2V0VHlwZSwgJFsxNF0gPSByZXNvbHZlZFR5cGVzLCAkWzE1XSA9IHQ5KSA6IHQ5ID0gJFsxNV07XG4gIGNvbnN0IGdldEZpZWxkID0gdDk7XG4gIGxldCB0MTAsIHQxMTtcbiAgJFsxNl0gIT09IGdldEZpZWxkIHx8ICRbMTddICE9PSBnZXRUeXBlID8gKHQxMSA9IHtcbiAgICBnZXRGaWVsZCxcbiAgICBnZXRUeXBlXG4gIH0sICRbMTZdID0gZ2V0RmllbGQsICRbMTddID0gZ2V0VHlwZSwgJFsxOF0gPSB0MTEpIDogdDExID0gJFsxOF0sIHQxMCA9IHQxMTtcbiAgY29uc3QgY29udGV4dCA9IHQxMDtcbiAgbGV0IHQxMjtcbiAgcmV0dXJuICRbMTldICE9PSBjaGlsZHJlbiB8fCAkWzIwXSAhPT0gY29udGV4dCA/ICh0MTIgPSAvKiBAX19QVVJFX18gKi8ganN4KFNjaGVtYUNvbnRleHQuUHJvdmlkZXIsIHsgdmFsdWU6IGNvbnRleHQsIGNoaWxkcmVuIH0pLCAkWzE5XSA9IGNoaWxkcmVuLCAkWzIwXSA9IGNvbnRleHQsICRbMjFdID0gdDEyKSA6IHQxMiA9ICRbMjFdLCB0MTI7XG59O1xuZnVuY3Rpb24gX3RlbXAkNihwYXJ0KSB7XG4gIHJldHVybiBwYXJ0LmluY2x1ZGVzKFwiW1wiKSA/IHBhcnQuc3BsaXQoLyhcXFsuK1xcXSkvLCAyKSA6IFtwYXJ0XTtcbn1cbmNvbnN0IGNyZWF0ZVN0b3JlID0gKGluaXRpYWxTdGF0ZSkgPT4ge1xuICBsZXQgc3RhdGUgPSBpbml0aWFsU3RhdGU7XG4gIGNvbnN0IGdldFN0YXRlID0gKCkgPT4gc3RhdGUsIGxpc3RlbmVycyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7XG4gIHJldHVybiB7XG4gICAgZ2V0U3RhdGUsXG4gICAgc2V0U3RhdGU6IChmbikgPT4ge1xuICAgICAgc3RhdGUgPSBmbihzdGF0ZSksIGxpc3RlbmVycy5mb3JFYWNoKChsKSA9PiBsKCkpO1xuICAgIH0sXG4gICAgc3Vic2NyaWJlOiAobGlzdGVuZXIpID0+IChsaXN0ZW5lcnMuYWRkKGxpc3RlbmVyKSwgKCkgPT4gbGlzdGVuZXJzLmRlbGV0ZShsaXN0ZW5lcikpXG4gIH07XG59LCBzdG9yZSA9IGNyZWF0ZVN0b3JlKHt9KSwgU2hhcmVkU3RhdGVQcm92aWRlciA9IChwcm9wcykgPT4ge1xuICBjb25zdCAkID0gYygxMSksIHtcbiAgICBjb21saW5rLFxuICAgIGNoaWxkcmVuXG4gIH0gPSBwcm9wcztcbiAgbGV0IHQwLCB0MTtcbiAgJFswXSAhPT0gY29tbGluayA/ICh0MCA9ICgpID0+IGNvbWxpbms/Lm9uKFwicHJlc2VudGF0aW9uL3NoYXJlZC1zdGF0ZVwiLCBfdGVtcCQ1KSwgdDEgPSBbY29tbGlua10sICRbMF0gPSBjb21saW5rLCAkWzFdID0gdDAsICRbMl0gPSB0MSkgOiAodDAgPSAkWzFdLCB0MSA9ICRbMl0pLCB1c2VFZmZlY3QodDAsIHQxKTtcbiAgbGV0IHQyLCB0MztcbiAgJFszXSAhPT0gY29tbGluayA/ICh0MiA9ICgpID0+IHtcbiAgICAoYXN5bmMgZnVuY3Rpb24oKSB7XG4gICAgICBjb25zdCB2YWx1ZSA9IGF3YWl0IGNvbWxpbms/LmZldGNoKFwidmlzdWFsLWVkaXRpbmcvc2hhcmVkLXN0YXRlXCIsIHZvaWQgMCwge1xuICAgICAgICBzdXBwcmVzc1dhcm5pbmdzOiAhMFxuICAgICAgfSk7XG4gICAgICB2YWx1ZSAmJiBzdG9yZS5zZXRTdGF0ZSgoKSA9PiB2YWx1ZS5zdGF0ZSk7XG4gICAgfSkoKS5jYXRjaChfdGVtcDIkMyk7XG4gIH0sIHQzID0gW2NvbWxpbmtdLCAkWzNdID0gY29tbGluaywgJFs0XSA9IHQyLCAkWzVdID0gdDMpIDogKHQyID0gJFs0XSwgdDMgPSAkWzVdKSwgdXNlRWZmZWN0KHQyLCB0Myk7XG4gIGxldCB0NCwgdDU7XG4gICRbNl0gIT09IGNvbWxpbmsgPyAodDUgPSB7XG4gICAgY29tbGluayxcbiAgICBzdG9yZVxuICB9LCAkWzZdID0gY29tbGluaywgJFs3XSA9IHQ1KSA6IHQ1ID0gJFs3XSwgdDQgPSB0NTtcbiAgY29uc3QgdmFsdWVfMCA9IHQ0O1xuICBsZXQgdDY7XG4gIHJldHVybiAkWzhdICE9PSBjaGlsZHJlbiB8fCAkWzldICE9PSB2YWx1ZV8wID8gKHQ2ID0gLyogQF9fUFVSRV9fICovIGpzeChTaGFyZWRTdGF0ZUNvbnRleHQuUHJvdmlkZXIsIHsgdmFsdWU6IHZhbHVlXzAsIGNoaWxkcmVuIH0pLCAkWzhdID0gY2hpbGRyZW4sICRbOV0gPSB2YWx1ZV8wLCAkWzEwXSA9IHQ2KSA6IHQ2ID0gJFsxMF0sIHQ2O1xufTtcbmZ1bmN0aW9uIF90ZW1wJDUoZGF0YSkge1xuICBcInZhbHVlXCIgaW4gZGF0YSA/IHN0b3JlLnNldFN0YXRlKChwcmV2KSA9PiAoe1xuICAgIC4uLnByZXYsXG4gICAgW2RhdGEua2V5XTogZGF0YS52YWx1ZVxuICB9KSkgOiBzdG9yZS5zZXRTdGF0ZSgocHJldl8wKSA9PiBPYmplY3QuZnJvbUVudHJpZXMoT2JqZWN0LmVudHJpZXMocHJldl8wKS5maWx0ZXIoKHQwKSA9PiB7XG4gICAgY29uc3QgW2tleV0gPSB0MDtcbiAgICByZXR1cm4ga2V5ICE9PSBkYXRhLmtleTtcbiAgfSkpKTtcbn1cbmZ1bmN0aW9uIF90ZW1wMiQzKHJlYXNvbikge1xuICBjb25zb2xlLmRlYnVnKHJlYXNvbiksIGNvbnNvbGUud2FybihcIltAc2FuaXR5L3Zpc3VhbC1lZGl0aW5nXTogRmFpbGVkIHRvIGZldGNoIHNoYXJlZCBzdGF0ZS4gQ2hlY2sgeW91ciB2ZXJzaW9uIG9mIGBzYW5pdHlgIGlzIHVwLXRvLWRhdGVcIik7XG59XG5jb25zdCBUZWxlbWV0cnlQcm92aWRlciA9ICh0MCkgPT4ge1xuICBjb25zdCAkID0gYyg1KSwge1xuICAgIGNoaWxkcmVuLFxuICAgIGNvbWxpbmtcbiAgfSA9IHQwO1xuICBsZXQgdDE7XG4gICRbMF0gIT09IGNvbWxpbmsgPyAodDEgPSAobmFtZSwgZGF0YSkgPT4ge1xuICAgIGlmICghY29tbGluaylcbiAgICAgIHJldHVybjtcbiAgICBjb25zdCBldmVudCA9IGV2ZW50c1tuYW1lXTtcbiAgICBpZiAoZXZlbnQpXG4gICAgICBjb21saW5rLnBvc3QoXCJ2aXN1YWwtZWRpdGluZy90ZWxlbWV0cnktbG9nXCIsIHtcbiAgICAgICAgZXZlbnQsXG4gICAgICAgIGRhdGFcbiAgICAgIH0pO1xuICAgIGVsc2VcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVGVsZW1ldHJ5IGV2ZW50OiAke25hbWV9IGRvZXMgbm90IGV4aXN0YCk7XG4gIH0sICRbMF0gPSBjb21saW5rLCAkWzFdID0gdDEpIDogdDEgPSAkWzFdO1xuICBjb25zdCBsb2cgPSB0MTtcbiAgbGV0IHQyO1xuICByZXR1cm4gJFsyXSAhPT0gY2hpbGRyZW4gfHwgJFszXSAhPT0gbG9nID8gKHQyID0gLyogQF9fUFVSRV9fICovIGpzeChUZWxlbWV0cnlDb250ZXh0LlByb3ZpZGVyLCB7IHZhbHVlOiBsb2csIGNoaWxkcmVuIH0pLCAkWzJdID0gY2hpbGRyZW4sICRbM10gPSBsb2csICRbNF0gPSB0MikgOiB0MiA9ICRbNF0sIHQyO1xufTtcbmZ1bmN0aW9uIHVzZUNvbnRyb2xsZXIoZWxlbWVudCwgaGFuZGxlciwgaW5GcmFtZSwgaW5Qb3BVcCkge1xuICBjb25zdCAkID0gYyg3KSwgb3ZlcmxheUNvbnRyb2xsZXIgPSB1c2VSZWYodm9pZCAwKSwgb3B0aW1pc3RpY0FjdG9yUmVhZHkgPSB1c2VPcHRpbWlzdGljQWN0b3JSZWFkeSgpO1xuICBsZXQgdDAsIHQxO1xuICByZXR1cm4gJFswXSAhPT0gZWxlbWVudCB8fCAkWzFdICE9PSBoYW5kbGVyIHx8ICRbMl0gIT09IGluRnJhbWUgfHwgJFszXSAhPT0gaW5Qb3BVcCB8fCAkWzRdICE9PSBvcHRpbWlzdGljQWN0b3JSZWFkeSA/ICh0MCA9ICgpID0+IHtcbiAgICBpZiAoZWxlbWVudClcbiAgICAgIHJldHVybiBvdmVybGF5Q29udHJvbGxlci5jdXJyZW50ID0gY3JlYXRlT3ZlcmxheUNvbnRyb2xsZXIoe1xuICAgICAgICBoYW5kbGVyLFxuICAgICAgICBvdmVybGF5RWxlbWVudDogZWxlbWVudCxcbiAgICAgICAgaW5GcmFtZSxcbiAgICAgICAgaW5Qb3BVcCxcbiAgICAgICAgb3B0aW1pc3RpY0FjdG9yUmVhZHlcbiAgICAgIH0pLCAoKSA9PiB7XG4gICAgICAgIG92ZXJsYXlDb250cm9sbGVyLmN1cnJlbnQ/LmRlc3Ryb3koKSwgb3ZlcmxheUNvbnRyb2xsZXIuY3VycmVudCA9IHZvaWQgMDtcbiAgICAgIH07XG4gIH0sIHQxID0gW2VsZW1lbnQsIGhhbmRsZXIsIGluRnJhbWUsIGluUG9wVXAsIG9wdGltaXN0aWNBY3RvclJlYWR5XSwgJFswXSA9IGVsZW1lbnQsICRbMV0gPSBoYW5kbGVyLCAkWzJdID0gaW5GcmFtZSwgJFszXSA9IGluUG9wVXAsICRbNF0gPSBvcHRpbWlzdGljQWN0b3JSZWFkeSwgJFs1XSA9IHQwLCAkWzZdID0gdDEpIDogKHQwID0gJFs1XSwgdDEgPSAkWzZdKSwgdXNlRWZmZWN0KHQwLCB0MSksIG92ZXJsYXlDb250cm9sbGVyO1xufVxuZnVuY3Rpb24gdXNlUGVyc3BlY3RpdmVTeW5jKGNvbWxpbmssIGRpc3BhdGNoKSB7XG4gIGNvbnN0ICQgPSBjKDQpO1xuICBsZXQgdDAsIHQxO1xuICAkWzBdICE9PSBjb21saW5rIHx8ICRbMV0gIT09IGRpc3BhdGNoID8gKHQwID0gKCkgPT4ge1xuICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG4gICAgY29tbGluaz8uZmV0Y2goXCJ2aXN1YWwtZWRpdGluZy9mZXRjaC1wZXJzcGVjdGl2ZVwiLCB2b2lkIDAsIHtcbiAgICAgIHNpZ25hbDogY29udHJvbGxlci5zaWduYWwsXG4gICAgICBzdXBwcmVzc1dhcm5pbmdzOiAhMFxuICAgIH0pLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIGRpc3BhdGNoKHtcbiAgICAgICAgdHlwZTogXCJwcmVzZW50YXRpb24vcGVyc3BlY3RpdmVcIixcbiAgICAgICAgZGF0YVxuICAgICAgfSk7XG4gICAgfSkuY2F0Y2goX3RlbXAkNCk7XG4gICAgY29uc3QgdW5zdWIgPSBjb21saW5rPy5vbihcInByZXNlbnRhdGlvbi9wZXJzcGVjdGl2ZVwiLCAoZGF0YV8wKSA9PiB7XG4gICAgICBkaXNwYXRjaCh7XG4gICAgICAgIHR5cGU6IFwicHJlc2VudGF0aW9uL3BlcnNwZWN0aXZlXCIsXG4gICAgICAgIGRhdGE6IGRhdGFfMFxuICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHVuc3ViPy4oKSwgY29udHJvbGxlci5hYm9ydCgpO1xuICAgIH07XG4gIH0sIHQxID0gW2NvbWxpbmssIGRpc3BhdGNoXSwgJFswXSA9IGNvbWxpbmssICRbMV0gPSBkaXNwYXRjaCwgJFsyXSA9IHQwLCAkWzNdID0gdDEpIDogKHQwID0gJFsyXSwgdDEgPSAkWzNdKSwgdXNlRWZmZWN0KHQwLCB0MSk7XG59XG5mdW5jdGlvbiBfdGVtcCQ0KCkge1xufVxuZnVuY3Rpb24gaXNFcXVhbFNldHMoYSwgYikge1xuICBpZiAoYSA9PT0gYikgcmV0dXJuICEwO1xuICBpZiAoYS5zaXplICE9PSBiLnNpemUpIHJldHVybiAhMTtcbiAgZm9yIChjb25zdCB2YWx1ZSBvZiBhKSBpZiAoIWIuaGFzKHZhbHVlKSkgcmV0dXJuICExO1xuICByZXR1cm4gITA7XG59XG5mdW5jdGlvbiB1c2VSZXBvcnREb2N1bWVudHMoY29tbGluaywgZWxlbWVudHMsIHBlcnNwZWN0aXZlKSB7XG4gIGNvbnN0ICQgPSBjKDcpLCBsYXN0UmVwb3J0ZWQgPSB1c2VSZWYodm9pZCAwKTtcbiAgbGV0IHQwO1xuICAkWzBdICE9PSBjb21saW5rID8gKHQwID0gKGRvY3VtZW50cywgcGVyc3BlY3RpdmVfMCkgPT4ge1xuICAgIGNvbWxpbms/LnBvc3QoXCJ2aXN1YWwtZWRpdGluZy9kb2N1bWVudHNcIiwge1xuICAgICAgZG9jdW1lbnRzLFxuICAgICAgcGVyc3BlY3RpdmU6IHBlcnNwZWN0aXZlXzBcbiAgICB9KTtcbiAgfSwgJFswXSA9IGNvbWxpbmssICRbMV0gPSB0MCkgOiB0MCA9ICRbMV07XG4gIGNvbnN0IHJlcG9ydERvY3VtZW50cyA9IHQwO1xuICBsZXQgdDEsIHQyO1xuICAkWzJdICE9PSBlbGVtZW50cyB8fCAkWzNdICE9PSBwZXJzcGVjdGl2ZSB8fCAkWzRdICE9PSByZXBvcnREb2N1bWVudHMgPyAodDEgPSAoKSA9PiB7XG4gICAgY29uc3Qgbm9kZXMgPSBlbGVtZW50cy5tYXAoX3RlbXAkMykuZmlsdGVyKF90ZW1wMiQyKSwgbm9kZUlkcyA9IG5ldyBTZXQobm9kZXMubWFwKF90ZW1wMyQxKSk7XG4gICAgaWYgKCFsYXN0UmVwb3J0ZWQuY3VycmVudCB8fCAhaXNFcXVhbFNldHMobm9kZUlkcywgbGFzdFJlcG9ydGVkLmN1cnJlbnQubm9kZUlkcykgfHwgcGVyc3BlY3RpdmUgIT09IGxhc3RSZXBvcnRlZC5jdXJyZW50LnBlcnNwZWN0aXZlKSB7XG4gICAgICBjb25zdCBkb2N1bWVudHNPblBhZ2UgPSBBcnJheS5mcm9tKG5vZGVJZHMpLm1hcCgoX2lkKSA9PiB7XG4gICAgICAgIGNvbnN0IG5vZGVfMCA9IG5vZGVzLmZpbmQoKG5vZGUpID0+IG5vZGUuaWQgPT09IF9pZCksIHtcbiAgICAgICAgICB0eXBlLFxuICAgICAgICAgIHByb2plY3RJZDogX3Byb2plY3RJZCxcbiAgICAgICAgICBkYXRhc2V0OiBfZGF0YXNldFxuICAgICAgICB9ID0gbm9kZV8wO1xuICAgICAgICByZXR1cm4gX3Byb2plY3RJZCAmJiBfZGF0YXNldCA/IHtcbiAgICAgICAgICBfaWQsXG4gICAgICAgICAgX3R5cGU6IHR5cGUsXG4gICAgICAgICAgX3Byb2plY3RJZCxcbiAgICAgICAgICBfZGF0YXNldFxuICAgICAgICB9IDoge1xuICAgICAgICAgIF9pZCxcbiAgICAgICAgICBfdHlwZTogdHlwZVxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgICBsYXN0UmVwb3J0ZWQuY3VycmVudCA9IHtcbiAgICAgICAgbm9kZUlkcyxcbiAgICAgICAgcGVyc3BlY3RpdmVcbiAgICAgIH0sIHJlcG9ydERvY3VtZW50cyhkb2N1bWVudHNPblBhZ2UsIHBlcnNwZWN0aXZlKTtcbiAgICB9XG4gIH0sIHQyID0gW2VsZW1lbnRzLCBwZXJzcGVjdGl2ZSwgcmVwb3J0RG9jdW1lbnRzXSwgJFsyXSA9IGVsZW1lbnRzLCAkWzNdID0gcGVyc3BlY3RpdmUsICRbNF0gPSByZXBvcnREb2N1bWVudHMsICRbNV0gPSB0MSwgJFs2XSA9IHQyKSA6ICh0MSA9ICRbNV0sIHQyID0gJFs2XSksIHVzZUVmZmVjdCh0MSwgdDIpO1xufVxuZnVuY3Rpb24gX3RlbXAzJDEoZV8wKSB7XG4gIHJldHVybiBlXzAuaWQ7XG59XG5mdW5jdGlvbiBfdGVtcDIkMihzKSB7XG4gIHJldHVybiAhIXM7XG59XG5mdW5jdGlvbiBfdGVtcCQzKGUpIHtcbiAgY29uc3Qge1xuICAgIHNhbml0eVxuICB9ID0gZTtcbiAgcmV0dXJuIFwiaWRcIiBpbiBzYW5pdHkgPyBzYW5pdHkgOiBudWxsO1xufVxuY29uc3QgUm9vdCA9IHN0eWxlZC5kaXZgXG4gIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50O1xuICBkaXJlY3Rpb246IGx0cjtcbiAgaW5zZXQ6IDA7XG4gIHBvaW50ZXItZXZlbnRzOiBub25lO1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHdpZHRoOiAxMDAlO1xuICBoZWlnaHQ6IDEwMCU7XG4gIHotaW5kZXg6ICR7KHtcbiAgJHpJbmRleFxufSkgPT4gJHpJbmRleCA/PyBcIjk5OTk5OTlcIn07XG5gO1xuZnVuY3Rpb24gcmFmMihmbikge1xuICBsZXQgcjAsIHIxO1xuICByZXR1cm4gcjAgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgIHIxID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZuKTtcbiAgfSksICgpID0+IHtcbiAgICByMCAhPT0gdm9pZCAwICYmIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHIwKSwgcjEgIT09IHZvaWQgMCAmJiBjYW5jZWxBbmltYXRpb25GcmFtZShyMSk7XG4gIH07XG59XG5jb25zdCBEb2N1bWVudFJlcG9ydGVyID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDgpLCB7XG4gICAgZG9jdW1lbnRJZHNcbiAgfSA9IHByb3BzO1xuICBsZXQgdDA7XG4gICRbMF0gPT09IFN5bWJvbC5mb3IoXCJyZWFjdC5tZW1vX2NhY2hlX3NlbnRpbmVsXCIpID8gKHQwID0gW10sICRbMF0gPSB0MCkgOiB0MCA9ICRbMF07XG4gIGNvbnN0IFt1bmlxdWVJZHMsIHNldFVuaXF1ZUlkc10gPSB1c2VTdGF0ZSh0MCk7XG4gIGxldCB0MSwgdDI7XG4gICRbMV0gIT09IGRvY3VtZW50SWRzID8gKHQxID0gKCkgPT4ge1xuICAgIHNldFVuaXF1ZUlkcygocHJldikgPT4ge1xuICAgICAgY29uc3QgbmV4dCA9IEFycmF5LmZyb20obmV3IFNldChkb2N1bWVudElkcykpO1xuICAgICAgcmV0dXJuIHByZXYubGVuZ3RoID09PSBuZXh0Lmxlbmd0aCAmJiBwcmV2LnJlZHVjZShfdGVtcCQyLCBuZXh0KT8ubGVuZ3RoID09PSAwID8gcHJldiA6IG5leHQ7XG4gICAgfSk7XG4gIH0sIHQyID0gW2RvY3VtZW50SWRzXSwgJFsxXSA9IGRvY3VtZW50SWRzLCAkWzJdID0gdDEsICRbM10gPSB0MikgOiAodDEgPSAkWzJdLCB0MiA9ICRbM10pLCB1c2VFZmZlY3QodDEsIHQyKTtcbiAgY29uc3QgYWN0b3IgPSB1c2VPcHRpbWlzdGljQWN0b3IoKTtcbiAgbGV0IHQzLCB0NDtcbiAgcmV0dXJuICRbNF0gIT09IGFjdG9yIHx8ICRbNV0gIT09IHVuaXF1ZUlkcyA/ICh0MyA9ICgpID0+IHtcbiAgICBmb3IgKGNvbnN0IGlkXzAgb2YgdW5pcXVlSWRzKVxuICAgICAgYWN0b3Iuc2VuZCh7XG4gICAgICAgIHR5cGU6IFwib2JzZXJ2ZVwiLFxuICAgICAgICBkb2N1bWVudElkOiBnZXREcmFmdElkKGlkXzApXG4gICAgICB9KSwgYWN0b3Iuc2VuZCh7XG4gICAgICAgIHR5cGU6IFwib2JzZXJ2ZVwiLFxuICAgICAgICBkb2N1bWVudElkOiBnZXRQdWJsaXNoZWRJZChpZF8wKVxuICAgICAgfSk7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGZvciAoY29uc3QgaWRfMSBvZiB1bmlxdWVJZHMpXG4gICAgICAgIGFjdG9yLnNlbmQoe1xuICAgICAgICAgIHR5cGU6IFwidW5vYnNlcnZlXCIsXG4gICAgICAgICAgZG9jdW1lbnRJZDogZ2V0RHJhZnRJZChpZF8xKVxuICAgICAgICB9KSwgYWN0b3Iuc2VuZCh7XG4gICAgICAgICAgdHlwZTogXCJ1bm9ic2VydmVcIixcbiAgICAgICAgICBkb2N1bWVudElkOiBnZXRQdWJsaXNoZWRJZChpZF8xKVxuICAgICAgICB9KTtcbiAgICB9O1xuICB9LCB0NCA9IFthY3RvciwgdW5pcXVlSWRzXSwgJFs0XSA9IGFjdG9yLCAkWzVdID0gdW5pcXVlSWRzLCAkWzZdID0gdDMsICRbN10gPSB0NCkgOiAodDMgPSAkWzZdLCB0NCA9ICRbN10pLCB1c2VFZmZlY3QodDMsIHQ0KSwgbnVsbDtcbn0sIE92ZXJsYXlzQ29udHJvbGxlciA9IChwcm9wcykgPT4ge1xuICBjb25zdCAkID0gYygxMiksIHtcbiAgICBjb21saW5rLFxuICAgIGRpc3BhdGNoLFxuICAgIGluRnJhbWUsXG4gICAgaW5Qb3BVcCxcbiAgICBvbkRyYWcsXG4gICAgb3ZlcmxheUVuYWJsZWQsXG4gICAgcm9vdEVsZW1lbnRcbiAgfSA9IHByb3BzLCB7XG4gICAgZGlzcGF0Y2hEcmFnRW5kRXZlbnRcbiAgfSA9IHVzZURyYWdFbmRFdmVudHMoKSwgc2VuZFRlbGVtZXRyeSA9IHVzZVRlbGVtZXRyeSgpO1xuICBsZXQgdDA7XG4gICRbMF0gIT09IGNvbWxpbmsgfHwgJFsxXSAhPT0gZGlzcGF0Y2ggfHwgJFsyXSAhPT0gZGlzcGF0Y2hEcmFnRW5kRXZlbnQgfHwgJFszXSAhPT0gb25EcmFnIHx8ICRbNF0gIT09IHNlbmRUZWxlbWV0cnkgPyAodDAgPSAobWVzc2FnZSkgPT4ge1xuICAgIGlmIChtZXNzYWdlLnR5cGUgPT09IFwiZWxlbWVudC9jbGlja1wiKSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIHNhbml0eVxuICAgICAgfSA9IG1lc3NhZ2U7XG4gICAgICBjb21saW5rPy5wb3N0KFwidmlzdWFsLWVkaXRpbmcvZm9jdXNcIiwgc2FuaXR5KSwgc2VuZFRlbGVtZXRyeShcIlZpc3VhbCBFZGl0aW5nIE92ZXJsYXkgQ2xpY2tlZFwiLCBudWxsKTtcbiAgICB9IGVsc2UgaWYgKG1lc3NhZ2UudHlwZSA9PT0gXCJvdmVybGF5L2FjdGl2YXRlXCIpXG4gICAgICBjb21saW5rPy5wb3N0KFwidmlzdWFsLWVkaXRpbmcvdG9nZ2xlXCIsIHtcbiAgICAgICAgZW5hYmxlZDogITBcbiAgICAgIH0pO1xuICAgIGVsc2UgaWYgKG1lc3NhZ2UudHlwZSA9PT0gXCJvdmVybGF5L2RlYWN0aXZhdGVcIilcbiAgICAgIGNvbWxpbms/LnBvc3QoXCJ2aXN1YWwtZWRpdGluZy90b2dnbGVcIiwge1xuICAgICAgICBlbmFibGVkOiAhMVxuICAgICAgfSk7XG4gICAgZWxzZSBpZiAobWVzc2FnZS50eXBlID09PSBcIm92ZXJsYXkvZHJhZ0VuZFwiKSB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIGluc2VydFBvc2l0aW9uLFxuICAgICAgICB0YXJnZXQsXG4gICAgICAgIGRyYWdHcm91cCxcbiAgICAgICAgZmxvdyxcbiAgICAgICAgcHJldmVudEluc2VydERlZmF1bHRcbiAgICAgIH0gPSBtZXNzYWdlO1xuICAgICAgZGlzcGF0Y2hEcmFnRW5kRXZlbnQoe1xuICAgICAgICBpbnNlcnRQb3NpdGlvbixcbiAgICAgICAgdGFyZ2V0LFxuICAgICAgICBkcmFnR3JvdXAsXG4gICAgICAgIGZsb3csXG4gICAgICAgIHByZXZlbnRJbnNlcnREZWZhdWx0XG4gICAgICB9KSwgaW5zZXJ0UG9zaXRpb24gJiYgc2VuZFRlbGVtZXRyeShcIlZpc3VhbCBFZGl0aW5nIERyYWcgU2VxdWVuY2UgQ29tcGxldGVkXCIsIG51bGwpO1xuICAgIH0gZWxzZSBpZiAobWVzc2FnZS50eXBlID09PSBcIm92ZXJsYXkvZHJhZ1VwZGF0ZUN1cnNvclBvc2l0aW9uXCIpIHtcbiAgICAgIG9uRHJhZyhtZXNzYWdlLngsIG1lc3NhZ2UueSk7XG4gICAgICByZXR1cm47XG4gICAgfSBlbHNlIGlmIChtZXNzYWdlLnR5cGUgPT09IFwib3ZlcmxheS9kcmFnVG9nZ2xlTWluaW1hcFwiICYmIG1lc3NhZ2UuZGlzcGxheSA9PT0gITApXG4gICAgICBzZW5kVGVsZW1ldHJ5KFwiVmlzdWFsIEVkaXRpbmcgRHJhZyBNaW5pbWFwIEVuYWJsZWRcIiwgbnVsbCk7XG4gICAgZWxzZSBpZiAobWVzc2FnZS50eXBlID09PSBcIm92ZXJsYXkvc2V0Q3Vyc29yXCIpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgZWxlbWVudCxcbiAgICAgICAgY3Vyc29yXG4gICAgICB9ID0gbWVzc2FnZTtcbiAgICAgIGN1cnNvciA/IGVsZW1lbnQuc3R5bGUuY3Vyc29yID0gY3Vyc29yIDogZWxlbWVudC5zdHlsZS5yZW1vdmVQcm9wZXJ0eShcImN1cnNvclwiKTtcbiAgICB9XG4gICAgZGlzcGF0Y2gobWVzc2FnZSk7XG4gIH0sICRbMF0gPSBjb21saW5rLCAkWzFdID0gZGlzcGF0Y2gsICRbMl0gPSBkaXNwYXRjaERyYWdFbmRFdmVudCwgJFszXSA9IG9uRHJhZywgJFs0XSA9IHNlbmRUZWxlbWV0cnksICRbNV0gPSB0MCkgOiB0MCA9ICRbNV07XG4gIGNvbnN0IGNvbnRyb2xsZXIgPSB1c2VDb250cm9sbGVyKHJvb3RFbGVtZW50LCB0MCwgaW5GcmFtZSwgaW5Qb3BVcCk7XG4gIGxldCB0MTtcbiAgJFs2XSAhPT0gY29udHJvbGxlci5jdXJyZW50IHx8ICRbN10gIT09IG92ZXJsYXlFbmFibGVkID8gKHQxID0gKCkgPT4ge1xuICAgIG92ZXJsYXlFbmFibGVkID8gY29udHJvbGxlci5jdXJyZW50Py5hY3RpdmF0ZSgpIDogY29udHJvbGxlci5jdXJyZW50Py5kZWFjdGl2YXRlKCk7XG4gIH0sICRbNl0gPSBjb250cm9sbGVyLmN1cnJlbnQsICRbN10gPSBvdmVybGF5RW5hYmxlZCwgJFs4XSA9IHQxKSA6IHQxID0gJFs4XTtcbiAgbGV0IHQyO1xuICByZXR1cm4gJFs5XSAhPT0gY29udHJvbGxlciB8fCAkWzEwXSAhPT0gb3ZlcmxheUVuYWJsZWQgPyAodDIgPSBbY29udHJvbGxlciwgb3ZlcmxheUVuYWJsZWRdLCAkWzldID0gY29udHJvbGxlciwgJFsxMF0gPSBvdmVybGF5RW5hYmxlZCwgJFsxMV0gPSB0MikgOiB0MiA9ICRbMTFdLCB1c2VFZmZlY3QodDEsIHQyKSwgbnVsbDtcbn0sIE92ZXJsYXlzID0gKHByb3BzKSA9PiB7XG4gIGNvbnN0ICQgPSBjKDc0KSwge1xuICAgIGNvbWxpbmssXG4gICAgY29tbGlua1N0YXR1cyxcbiAgICBjb21wb25lbnRSZXNvbHZlcjogX2NvbXBvbmVudFJlc29sdmVyLFxuICAgIGluRnJhbWUsXG4gICAgaW5Qb3BVcCxcbiAgICB6SW5kZXhcbiAgfSA9IHByb3BzLCBwcmVmZXJzRGFyayA9IHVzZVByZWZlcnNEYXJrKCk7XG4gIGxldCB0MDtcbiAgJFswXSA9PT0gU3ltYm9sLmZvcihcInJlYWN0Lm1lbW9fY2FjaGVfc2VudGluZWxcIikgPyAodDAgPSB7XG4gICAgY29udGV4dE1lbnU6IG51bGwsXG4gICAgZHJhZ0luc2VydFBvc2l0aW9uOiBudWxsLFxuICAgIGRyYWdTaG93TWluaW1hcDogITEsXG4gICAgZHJhZ1Nob3dNaW5pbWFwUHJvbXB0OiAhMSxcbiAgICBkcmFnU2tlbGV0b246IG51bGwsXG4gICAgZWxlbWVudHM6IFtdLFxuICAgIGZvY3VzUGF0aDogXCJcIixcbiAgICBpc0RyYWdnaW5nOiAhMSxcbiAgICBwZXJzcGVjdGl2ZTogXCJwdWJsaXNoZWRcIixcbiAgICB3YXNNYXliZUNvbGxhcHNlZDogITEsXG4gICAgZHJhZ01pbmltYXBUcmFuc2l0aW9uOiAhMSxcbiAgICBkcmFnR3JvdXBSZWN0OiBudWxsXG4gIH0sICRbMF0gPSB0MCkgOiB0MCA9ICRbMF07XG4gIGNvbnN0IFt0MSwgZGlzcGF0Y2hdID0gdXNlUmVkdWNlcihvdmVybGF5U3RhdGVSZWR1Y2VyLCB0MCksIHtcbiAgICBjb250ZXh0TWVudSxcbiAgICBkcmFnSW5zZXJ0UG9zaXRpb24sXG4gICAgZHJhZ1Nob3dNaW5pbWFwLFxuICAgIGRyYWdTaG93TWluaW1hcFByb21wdCxcbiAgICBkcmFnU2tlbGV0b24sXG4gICAgZWxlbWVudHMsXG4gICAgaXNEcmFnZ2luZyxcbiAgICBwZXJzcGVjdGl2ZSxcbiAgICB3YXNNYXliZUNvbGxhcHNlZCxcbiAgICBkcmFnTWluaW1hcFRyYW5zaXRpb24sXG4gICAgZHJhZ0dyb3VwUmVjdFxuICB9ID0gdDEsIFtyb290RWxlbWVudCwgc2V0Um9vdEVsZW1lbnRdID0gdXNlU3RhdGUobnVsbCksIFtvdmVybGF5RW5hYmxlZCwgc2V0T3ZlcmxheUVuYWJsZWRdID0gdXNlU3RhdGUoITApO1xuICBsZXQgdDIsIHQzO1xuICAkWzFdICE9PSBjb21saW5rID8gKHQyID0gKCkgPT4ge1xuICAgIGNvbnN0IHVuc3VicyA9IFtjb21saW5rPy5vbihcInByZXNlbnRhdGlvbi9mb2N1c1wiLCAoZGF0YSkgPT4ge1xuICAgICAgZGlzcGF0Y2goe1xuICAgICAgICB0eXBlOiBcInByZXNlbnRhdGlvbi9mb2N1c1wiLFxuICAgICAgICBkYXRhXG4gICAgICB9KTtcbiAgICB9KSwgY29tbGluaz8ub24oXCJwcmVzZW50YXRpb24vYmx1clwiLCAoZGF0YV8wKSA9PiB7XG4gICAgICBkaXNwYXRjaCh7XG4gICAgICAgIHR5cGU6IFwicHJlc2VudGF0aW9uL2JsdXJcIixcbiAgICAgICAgZGF0YTogZGF0YV8wXG4gICAgICB9KTtcbiAgICB9KSwgY29tbGluaz8ub24oXCJwcmVzZW50YXRpb24vdG9nZ2xlLW92ZXJsYXlcIiwgKCkgPT4ge1xuICAgICAgc2V0T3ZlcmxheUVuYWJsZWQoX3RlbXAyJDEpO1xuICAgIH0pXS5maWx0ZXIoQm9vbGVhbik7XG4gICAgcmV0dXJuICgpID0+IHVuc3Vicy5mb3JFYWNoKF90ZW1wMyk7XG4gIH0sIHQzID0gW2NvbWxpbmtdLCAkWzFdID0gY29tbGluaywgJFsyXSA9IHQyLCAkWzNdID0gdDMpIDogKHQyID0gJFsyXSwgdDMgPSAkWzNdKSwgdXNlRWZmZWN0KHQyLCB0MyksIHVzZVBlcnNwZWN0aXZlU3luYyhjb21saW5rLCBkaXNwYXRjaCksIHVzZVJlcG9ydERvY3VtZW50cyhjb21saW5rLCBlbGVtZW50cywgcGVyc3BlY3RpdmUpO1xuICBsZXQgdDQ7XG4gICRbNF0gIT09IHJvb3RFbGVtZW50ID8gKHQ0ID0gKHgsIHkpID0+IHtcbiAgICByb290RWxlbWVudCAmJiAocm9vdEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoXCItLWRyYWctcHJldmlldy14XCIsIGAke3h9cHhgKSwgcm9vdEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoXCItLWRyYWctcHJldmlldy15XCIsIGAke3kgLSB3aW5kb3cuc2Nyb2xsWX1weGApKTtcbiAgfSwgJFs0XSA9IHJvb3RFbGVtZW50LCAkWzVdID0gdDQpIDogdDQgPSAkWzVdO1xuICBjb25zdCB1cGRhdGVEcmFnUHJldmlld0N1c3RvbVByb3BzID0gdDQ7XG4gIGxldCB0NSwgdDY7XG4gICRbNl0gPT09IFN5bWJvbC5mb3IoXCJyZWFjdC5tZW1vX2NhY2hlX3NlbnRpbmVsXCIpID8gKHQ1ID0gKCkgPT4ge1xuICAgIGNvbnN0IGhhbmRsZUNsaWNrID0gX3RlbXA0LCBoYW5kbGVLZXlVcCA9IChlKSA9PiB7XG4gICAgICBpc0FsdEtleShlKSAmJiBzZXRPdmVybGF5RW5hYmxlZChfdGVtcDUpO1xuICAgIH0sIGhhbmRsZUtleWRvd24gPSAoZV8wKSA9PiB7XG4gICAgICBpc0FsdEtleShlXzApICYmIHNldE92ZXJsYXlFbmFibGVkKF90ZW1wNiksIGlzSG90a2V5KFtcIm1vZFwiLCBcIlxcXFxcIl0sIGVfMCkgJiYgc2V0T3ZlcmxheUVuYWJsZWQoX3RlbXA3KTtcbiAgICB9O1xuICAgIHJldHVybiB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZUNsaWNrKSwgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUtleWRvd24pLCB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGhhbmRsZUtleVVwKSwgKCkgPT4ge1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVDbGljayksIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVLZXlkb3duKSwgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBoYW5kbGVLZXlVcCk7XG4gICAgfTtcbiAgfSwgdDYgPSBbc2V0T3ZlcmxheUVuYWJsZWRdLCAkWzZdID0gdDUsICRbN10gPSB0NikgOiAodDUgPSAkWzZdLCB0NiA9ICRbN10pLCB1c2VFZmZlY3QodDUsIHQ2KTtcbiAgY29uc3QgW292ZXJsYXlzRmxhc2gsIHNldE92ZXJsYXlzRmxhc2hdID0gdXNlU3RhdGUoITEpLCBbZmFkaW5nT3V0LCBzZXRGYWRpbmdPdXRdID0gdXNlU3RhdGUoITEpLCBmYWRlT3V0VGltZW91dFJlZiA9IHVzZVJlZih2b2lkIDApO1xuICBsZXQgdDcsIHQ4O1xuICAkWzhdICE9PSBvdmVybGF5RW5hYmxlZCA/ICh0NyA9ICgpID0+IHtcbiAgICBpZiAob3ZlcmxheUVuYWJsZWQpXG4gICAgICByZXR1cm4gcmFmMigoKSA9PiB7XG4gICAgICAgIHNldE92ZXJsYXlzRmxhc2goITApLCByYWYyKCgpID0+IHtcbiAgICAgICAgICBzZXRGYWRpbmdPdXQoITApLCBmYWRlT3V0VGltZW91dFJlZi5jdXJyZW50ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBzZXRGYWRpbmdPdXQoITEpLCBzZXRPdmVybGF5c0ZsYXNoKCExKTtcbiAgICAgICAgICB9LCAxNTAwKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICBmYWRlT3V0VGltZW91dFJlZi5jdXJyZW50ICYmIChjbGVhclRpbWVvdXQoZmFkZU91dFRpbWVvdXRSZWYuY3VycmVudCksIHNldE92ZXJsYXlzRmxhc2goITEpLCBzZXRGYWRpbmdPdXQoITEpKTtcbiAgfSwgdDggPSBbb3ZlcmxheUVuYWJsZWRdLCAkWzhdID0gb3ZlcmxheUVuYWJsZWQsICRbOV0gPSB0NywgJFsxMF0gPSB0OCkgOiAodDcgPSAkWzldLCB0OCA9ICRbMTBdKSwgdXNlRWZmZWN0KHQ3LCB0OCk7XG4gIGxldCB0OSwgdDEwO1xuICAkWzExXSAhPT0gZWxlbWVudHMgPyAodDEwID0gZWxlbWVudHMuZmxhdE1hcChfdGVtcDgpLCAkWzExXSA9IGVsZW1lbnRzLCAkWzEyXSA9IHQxMCkgOiB0MTAgPSAkWzEyXSwgdDkgPSB0MTA7XG4gIGNvbnN0IGRvY3VtZW50SWRzID0gdDk7XG4gIGxldCB0MTE7XG4gICRbMTNdID09PSBTeW1ib2wuZm9yKFwicmVhY3QubWVtb19jYWNoZV9zZW50aW5lbFwiKSA/ICh0MTEgPSAoKSA9PiB7XG4gICAgZGlzcGF0Y2goe1xuICAgICAgdHlwZTogXCJvdmVybGF5L2JsdXJcIlxuICAgIH0pO1xuICB9LCAkWzEzXSA9IHQxMSkgOiB0MTEgPSAkWzEzXTtcbiAgY29uc3QgY2xvc2VDb250ZXh0TWVudSA9IHQxMSwgb3B0aW1pc3RpY0FjdG9yUmVhZHkgPSB1c2VPcHRpbWlzdGljQWN0b3JSZWFkeSgpO1xuICBsZXQgdDEyO1xuICB0MTIgPSBvcHRpbWlzdGljQWN0b3JSZWFkeSA/IF9jb21wb25lbnRSZXNvbHZlciA6IHZvaWQgMDtcbiAgY29uc3QgY29tcG9uZW50UmVzb2x2ZXIgPSB0MTI7XG4gIGxldCB0MTM7XG4gIGJiMDoge1xuICAgIGlmICgoaW5GcmFtZSB8fCBpblBvcFVwKSAmJiBjb21saW5rU3RhdHVzICE9PSBcImNvbm5lY3RlZFwiIHx8IGlzRHJhZ2dpbmcpIHtcbiAgICAgIGxldCB0MTQzO1xuICAgICAgJFsxNF0gPT09IFN5bWJvbC5mb3IoXCJyZWFjdC5tZW1vX2NhY2hlX3NlbnRpbmVsXCIpID8gKHQxNDMgPSBbXSwgJFsxNF0gPSB0MTQzKSA6IHQxNDMgPSAkWzE0XSwgdDEzID0gdDE0MztcbiAgICAgIGJyZWFrIGJiMDtcbiAgICB9XG4gICAgbGV0IHQxNDI7XG4gICAgJFsxNV0gIT09IGNvbXBvbmVudFJlc29sdmVyIHx8ICRbMTZdICE9PSBkcmFnTWluaW1hcFRyYW5zaXRpb24gfHwgJFsxN10gIT09IGRyYWdTaG93TWluaW1hcCB8fCAkWzE4XSAhPT0gZWxlbWVudHMgfHwgJFsxOV0gIT09IGluRnJhbWUgfHwgJFsyMF0gIT09IGlzRHJhZ2dpbmcgfHwgJFsyMV0gIT09IG9wdGltaXN0aWNBY3RvclJlYWR5IHx8ICRbMjJdICE9PSB3YXNNYXliZUNvbGxhcHNlZCA/ICh0MTQyID0gZWxlbWVudHMuZmlsdGVyKF90ZW1wOSkubWFwKCh0MTUyKSA9PiB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIGlkLFxuICAgICAgICBlbGVtZW50OiBlbGVtZW50XzAsXG4gICAgICAgIGZvY3VzZWQsXG4gICAgICAgIGhvdmVyZWQsXG4gICAgICAgIHJlY3QsXG4gICAgICAgIHNhbml0eSxcbiAgICAgICAgZHJhZ0Rpc2FibGVkXG4gICAgICB9ID0gdDE1MiwgZHJhZ2dhYmxlID0gIWRyYWdEaXNhYmxlZCAmJiAhIWVsZW1lbnRfMC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXNhbml0eVwiKSAmJiBvcHRpbWlzdGljQWN0b3JSZWFkeSAmJiBlbGVtZW50cy5zb21lKChlXzIpID0+IFwiaWRcIiBpbiBlXzIuc2FuaXR5ICYmIFwiaWRcIiBpbiBzYW5pdHkgPyBzYW5pdHlOb2Rlc0V4aXN0SW5TYW1lQXJyYXkoZV8yLnNhbml0eSwgc2FuaXR5KSAmJiBlXzIuc2FuaXR5LnBhdGggIT09IHNhbml0eS5wYXRoIDogITEpO1xuICAgICAgcmV0dXJuIC8qIEBfX1BVUkVfXyAqLyBqc3goRWxlbWVudE92ZXJsYXksIHsgY29tcG9uZW50UmVzb2x2ZXIsIGVsZW1lbnQ6IGVsZW1lbnRfMCwgZW5hYmxlU2Nyb2xsSW50b1ZpZXc6ICFpc0RyYWdnaW5nICYmICFkcmFnTWluaW1hcFRyYW5zaXRpb24gJiYgIWRyYWdTaG93TWluaW1hcCwgZm9jdXNlZCwgaG92ZXJlZCwgbm9kZTogc2FuaXR5LCByZWN0LCBzaG93QWN0aW9uczogIWluRnJhbWUsIGRyYWdnYWJsZSwgaXNEcmFnZ2luZzogaXNEcmFnZ2luZyB8fCBkcmFnTWluaW1hcFRyYW5zaXRpb24sIHdhc01heWJlQ29sbGFwc2VkOiBmb2N1c2VkICYmIHdhc01heWJlQ29sbGFwc2VkIH0sIGlkKTtcbiAgICB9KSwgJFsxNV0gPSBjb21wb25lbnRSZXNvbHZlciwgJFsxNl0gPSBkcmFnTWluaW1hcFRyYW5zaXRpb24sICRbMTddID0gZHJhZ1Nob3dNaW5pbWFwLCAkWzE4XSA9IGVsZW1lbnRzLCAkWzE5XSA9IGluRnJhbWUsICRbMjBdID0gaXNEcmFnZ2luZywgJFsyMV0gPSBvcHRpbWlzdGljQWN0b3JSZWFkeSwgJFsyMl0gPSB3YXNNYXliZUNvbGxhcHNlZCwgJFsyM10gPSB0MTQyKSA6IHQxNDIgPSAkWzIzXSwgdDEzID0gdDE0MjtcbiAgfVxuICBjb25zdCBlbGVtZW50c1RvUmVuZGVyID0gdDEzLCB0MTQgPSBwcmVmZXJzRGFyayA/IFwiZGFya1wiIDogXCJsaWdodFwiLCB0MTUgPSBmYWRpbmdPdXQgPyBcIlwiIDogdm9pZCAwLCB0MTYgPSBvdmVybGF5c0ZsYXNoID8gXCJcIiA6IHZvaWQgMDtcbiAgbGV0IHQxNztcbiAgJFsyNF0gIT09IGRvY3VtZW50SWRzIHx8ICRbMjVdICE9PSBwZXJzcGVjdGl2ZSA/ICh0MTcgPSAvKiBAX19QVVJFX18gKi8ganN4KERvY3VtZW50UmVwb3J0ZXIsIHsgZG9jdW1lbnRJZHMsIHBlcnNwZWN0aXZlIH0pLCAkWzI0XSA9IGRvY3VtZW50SWRzLCAkWzI1XSA9IHBlcnNwZWN0aXZlLCAkWzI2XSA9IHQxNykgOiB0MTcgPSAkWzI2XTtcbiAgbGV0IHQxODtcbiAgJFsyN10gIT09IGNvbWxpbmsgfHwgJFsyOF0gIT09IGluRnJhbWUgfHwgJFsyOV0gIT09IGluUG9wVXAgfHwgJFszMF0gIT09IG92ZXJsYXlFbmFibGVkIHx8ICRbMzFdICE9PSByb290RWxlbWVudCB8fCAkWzMyXSAhPT0gdXBkYXRlRHJhZ1ByZXZpZXdDdXN0b21Qcm9wcyA/ICh0MTggPSAvKiBAX19QVVJFX18gKi8ganN4KE92ZXJsYXlzQ29udHJvbGxlciwgeyBjb21saW5rLCBkaXNwYXRjaCwgaW5GcmFtZSwgaW5Qb3BVcCwgb25EcmFnOiB1cGRhdGVEcmFnUHJldmlld0N1c3RvbVByb3BzLCBvdmVybGF5RW5hYmxlZCwgcm9vdEVsZW1lbnQgfSksICRbMjddID0gY29tbGluaywgJFsyOF0gPSBpbkZyYW1lLCAkWzI5XSA9IGluUG9wVXAsICRbMzBdID0gb3ZlcmxheUVuYWJsZWQsICRbMzFdID0gcm9vdEVsZW1lbnQsICRbMzJdID0gdXBkYXRlRHJhZ1ByZXZpZXdDdXN0b21Qcm9wcywgJFszM10gPSB0MTgpIDogdDE4ID0gJFszM107XG4gIGxldCB0MTk7XG4gICRbMzRdICE9PSBjb250ZXh0TWVudSA/ICh0MTkgPSBjb250ZXh0TWVudSAmJiAvKiBAX19QVVJFX18gKi8ganN4KENvbnRleHRNZW51LCB7IC4uLmNvbnRleHRNZW51LCBvbkRpc21pc3M6IGNsb3NlQ29udGV4dE1lbnUgfSksICRbMzRdID0gY29udGV4dE1lbnUsICRbMzVdID0gdDE5KSA6IHQxOSA9ICRbMzVdO1xuICBsZXQgdDIwO1xuICAkWzM2XSAhPT0gZHJhZ0dyb3VwUmVjdCB8fCAkWzM3XSAhPT0gZHJhZ0luc2VydFBvc2l0aW9uIHx8ICRbMzhdICE9PSBkcmFnTWluaW1hcFRyYW5zaXRpb24gfHwgJFszOV0gIT09IGRyYWdTaG93TWluaW1hcFByb21wdCB8fCAkWzQwXSAhPT0gaXNEcmFnZ2luZyA/ICh0MjAgPSBpc0RyYWdnaW5nICYmICFkcmFnTWluaW1hcFRyYW5zaXRpb24gJiYgLyogQF9fUFVSRV9fICovIGpzeHMoRnJhZ21lbnQsIHsgY2hpbGRyZW46IFtcbiAgICBkcmFnSW5zZXJ0UG9zaXRpb24gJiYgLyogQF9fUFVSRV9fICovIGpzeChPdmVybGF5RHJhZ0luc2VydE1hcmtlciwgeyBkcmFnSW5zZXJ0UG9zaXRpb24gfSksXG4gICAgZHJhZ1Nob3dNaW5pbWFwUHJvbXB0ICYmIC8qIEBfX1BVUkVfXyAqLyBqc3goT3ZlcmxheU1pbmltYXBQcm9tcHQsIHt9KSxcbiAgICBkcmFnR3JvdXBSZWN0ICYmIC8qIEBfX1BVUkVfXyAqLyBqc3goT3ZlcmxheURyYWdHcm91cFJlY3QsIHsgZHJhZ0dyb3VwUmVjdCB9KVxuICBdIH0pLCAkWzM2XSA9IGRyYWdHcm91cFJlY3QsICRbMzddID0gZHJhZ0luc2VydFBvc2l0aW9uLCAkWzM4XSA9IGRyYWdNaW5pbWFwVHJhbnNpdGlvbiwgJFszOV0gPSBkcmFnU2hvd01pbmltYXBQcm9tcHQsICRbNDBdID0gaXNEcmFnZ2luZywgJFs0MV0gPSB0MjApIDogdDIwID0gJFs0MV07XG4gIGxldCB0MjE7XG4gICRbNDJdICE9PSBkcmFnU2tlbGV0b24gfHwgJFs0M10gIT09IGlzRHJhZ2dpbmcgPyAodDIxID0gaXNEcmFnZ2luZyAmJiBkcmFnU2tlbGV0b24gJiYgLyogQF9fUFVSRV9fICovIGpzeChPdmVybGF5RHJhZ1ByZXZpZXcsIHsgc2tlbGV0b246IGRyYWdTa2VsZXRvbiB9KSwgJFs0Ml0gPSBkcmFnU2tlbGV0b24sICRbNDNdID0gaXNEcmFnZ2luZywgJFs0NF0gPSB0MjEpIDogdDIxID0gJFs0NF07XG4gIGxldCB0MjI7XG4gICRbNDVdICE9PSBlbGVtZW50c1RvUmVuZGVyIHx8ICRbNDZdICE9PSB0MTUgfHwgJFs0N10gIT09IHQxNiB8fCAkWzQ4XSAhPT0gdDE3IHx8ICRbNDldICE9PSB0MTggfHwgJFs1MF0gIT09IHQxOSB8fCAkWzUxXSAhPT0gdDIwIHx8ICRbNTJdICE9PSB0MjEgfHwgJFs1M10gIT09IHpJbmRleCA/ICh0MjIgPSAvKiBAX19QVVJFX18gKi8ganN4cyhSb290LCB7IFwiZGF0YS1mYWRpbmctb3V0XCI6IHQxNSwgXCJkYXRhLW92ZXJsYXlzXCI6IHQxNiwgcmVmOiBzZXRSb290RWxlbWVudCwgJHpJbmRleDogekluZGV4LCBjaGlsZHJlbjogW1xuICAgIHQxNyxcbiAgICB0MTgsXG4gICAgdDE5LFxuICAgIGVsZW1lbnRzVG9SZW5kZXIsXG4gICAgdDIwLFxuICAgIHQyMVxuICBdIH0pLCAkWzQ1XSA9IGVsZW1lbnRzVG9SZW5kZXIsICRbNDZdID0gdDE1LCAkWzQ3XSA9IHQxNiwgJFs0OF0gPSB0MTcsICRbNDldID0gdDE4LCAkWzUwXSA9IHQxOSwgJFs1MV0gPSB0MjAsICRbNTJdID0gdDIxLCAkWzUzXSA9IHpJbmRleCwgJFs1NF0gPSB0MjIpIDogdDIyID0gJFs1NF07XG4gIGxldCB0MjM7XG4gICRbNTVdICE9PSBjb21saW5rIHx8ICRbNTZdICE9PSB0MjIgPyAodDIzID0gLyogQF9fUFVSRV9fICovIGpzeChTaGFyZWRTdGF0ZVByb3ZpZGVyLCB7IGNvbWxpbmssIGNoaWxkcmVuOiB0MjIgfSksICRbNTVdID0gY29tbGluaywgJFs1Nl0gPSB0MjIsICRbNTddID0gdDIzKSA6IHQyMyA9ICRbNTddO1xuICBsZXQgdDI0O1xuICAkWzU4XSAhPT0gY29tbGluayB8fCAkWzU5XSAhPT0gdDIzID8gKHQyNCA9IC8qIEBfX1BVUkVfXyAqLyBqc3goUHJldmlld1NuYXBzaG90c1Byb3ZpZGVyLCB7IGNvbWxpbmssIGNoaWxkcmVuOiB0MjMgfSksICRbNThdID0gY29tbGluaywgJFs1OV0gPSB0MjMsICRbNjBdID0gdDI0KSA6IHQyNCA9ICRbNjBdO1xuICBsZXQgdDI1O1xuICAkWzYxXSAhPT0gY29tbGluayB8fCAkWzYyXSAhPT0gZWxlbWVudHMgfHwgJFs2M10gIT09IHQyNCA/ICh0MjUgPSAvKiBAX19QVVJFX18gKi8ganN4KFNjaGVtYVByb3ZpZGVyLCB7IGNvbWxpbmssIGVsZW1lbnRzLCBjaGlsZHJlbjogdDI0IH0pLCAkWzYxXSA9IGNvbWxpbmssICRbNjJdID0gZWxlbWVudHMsICRbNjNdID0gdDI0LCAkWzY0XSA9IHQyNSkgOiB0MjUgPSAkWzY0XTtcbiAgbGV0IHQyNjtcbiAgJFs2NV0gIT09IHJvb3RFbGVtZW50IHx8ICRbNjZdICE9PSB0MjUgPyAodDI2ID0gLyogQF9fUFVSRV9fICovIGpzeChMYXllclByb3ZpZGVyLCB7IGNoaWxkcmVuOiAvKiBAX19QVVJFX18gKi8ganN4KFBvcnRhbFByb3ZpZGVyLCB7IGVsZW1lbnQ6IHJvb3RFbGVtZW50LCBjaGlsZHJlbjogdDI1IH0pIH0pLCAkWzY1XSA9IHJvb3RFbGVtZW50LCAkWzY2XSA9IHQyNSwgJFs2N10gPSB0MjYpIDogdDI2ID0gJFs2N107XG4gIGxldCB0Mjc7XG4gICRbNjhdICE9PSB0MTQgfHwgJFs2OV0gIT09IHQyNiA/ICh0MjcgPSAvKiBAX19QVVJFX18gKi8ganN4KFRoZW1lUHJvdmlkZXIsIHsgc2NoZW1lOiB0MTQsIHRoZW1lOiBzdHVkaW9UaGVtZSwgdG9uZTogXCJ0cmFuc3BhcmVudFwiLCBjaGlsZHJlbjogdDI2IH0pLCAkWzY4XSA9IHQxNCwgJFs2OV0gPSB0MjYsICRbNzBdID0gdDI3KSA6IHQyNyA9ICRbNzBdO1xuICBsZXQgdDI4O1xuICByZXR1cm4gJFs3MV0gIT09IGNvbWxpbmsgfHwgJFs3Ml0gIT09IHQyNyA/ICh0MjggPSAvKiBAX19QVVJFX18gKi8ganN4KFRlbGVtZXRyeVByb3ZpZGVyLCB7IGNvbWxpbmssIGNoaWxkcmVuOiB0MjcgfSksICRbNzFdID0gY29tbGluaywgJFs3Ml0gPSB0MjcsICRbNzNdID0gdDI4KSA6IHQyOCA9ICRbNzNdLCB0Mjg7XG59LCBJU19NQUMgPSB0eXBlb2Ygd2luZG93IDwgXCJ1XCIgJiYgL01hY3xpUG9kfGlQaG9uZXxpUGFkLy50ZXN0KHdpbmRvdy5uYXZpZ2F0b3IucGxhdGZvcm0pLCBNT0RJRklFUlMgPSB7XG4gIGFsdDogXCJhbHRLZXlcIixcbiAgY3RybDogXCJjdHJsS2V5XCIsXG4gIG1vZDogSVNfTUFDID8gXCJtZXRhS2V5XCIgOiBcImN0cmxLZXlcIixcbiAgc2hpZnQ6IFwic2hpZnRLZXlcIlxufTtcbmZ1bmN0aW9uIGlzSG90a2V5KGtleXMsIGV2ZW50KSB7XG4gIHJldHVybiBrZXlzLmV2ZXJ5KChrZXkpID0+IE1PRElGSUVSU1trZXldID8gZXZlbnRbTU9ESUZJRVJTW2tleV1dIDogZXZlbnQua2V5ID09PSBrZXkudG9VcHBlckNhc2UoKSk7XG59XG5mdW5jdGlvbiBpc0FsdEtleShldmVudCkge1xuICByZXR1cm4gZXZlbnQua2V5ID09PSBcIkFsdFwiO1xufVxuZnVuY3Rpb24gX3RlbXAkMihhY2MsIHByZXZJZCkge1xuICByZXR1cm4gYWNjLmZpbHRlcigoaWQpID0+IGlkICE9PSBwcmV2SWQpO1xufVxuZnVuY3Rpb24gX3RlbXAyJDEoZW5hYmxlZCkge1xuICByZXR1cm4gIWVuYWJsZWQ7XG59XG5mdW5jdGlvbiBfdGVtcDModW5zdWIpIHtcbiAgcmV0dXJuIHVuc3ViKCk7XG59XG5mdW5jdGlvbiBfdGVtcDQoZXZlbnQpIHtcbiAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuICBpZiAoKGlzSFRNTEFuY2hvckVsZW1lbnQodGFyZ2V0KSB8fCBpc0hUTUxFbGVtZW50KHRhcmdldCkgJiYgdGFyZ2V0LmNsb3Nlc3QoXCJhXCIpKSAmJiBldmVudC5hbHRLZXkpIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpLCBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICBjb25zdCBuZXdFdmVudCA9IG5ldyBNb3VzZUV2ZW50KGV2ZW50LnR5cGUsIHtcbiAgICAgIC4uLmV2ZW50LFxuICAgICAgYWx0S2V5OiAhMSxcbiAgICAgIGJ1YmJsZXM6ICEwLFxuICAgICAgY2FuY2VsYWJsZTogITBcbiAgICB9KTtcbiAgICBldmVudC50YXJnZXQ/LmRpc3BhdGNoRXZlbnQobmV3RXZlbnQpO1xuICB9XG59XG5mdW5jdGlvbiBfdGVtcDUoZW5hYmxlZF8wKSB7XG4gIHJldHVybiAhZW5hYmxlZF8wO1xufVxuZnVuY3Rpb24gX3RlbXA2KGVuYWJsZWRfMSkge1xuICByZXR1cm4gIWVuYWJsZWRfMTtcbn1cbmZ1bmN0aW9uIF90ZW1wNyhlbmFibGVkXzIpIHtcbiAgcmV0dXJuICFlbmFibGVkXzI7XG59XG5mdW5jdGlvbiBfdGVtcDgoZWxlbWVudCkge1xuICByZXR1cm4gXCJpZFwiIGluIGVsZW1lbnQuc2FuaXR5ID8gW2VsZW1lbnQuc2FuaXR5LmlkXSA6IFtdO1xufVxuZnVuY3Rpb24gX3RlbXA5KGVfMSkge1xuICByZXR1cm4gZV8xLmFjdGl2YXRlZCB8fCBlXzEuZm9jdXNlZDtcbn1cbmNvbnN0IFJlZnJlc2ggPSAocHJvcHMpID0+IHtcbiAgY29uc3QgJCA9IGMoNCksIHtcbiAgICBjb21saW5rLFxuICAgIHJlZnJlc2hcbiAgfSA9IHByb3BzLCBtYW51YWxSZWZyZXNoUmVmID0gdXNlUmVmKDApLCBtdXRhdGlvblJlZnJlc2hSZWYgPSB1c2VSZWYoMCk7XG4gIGxldCB0MCwgdDE7XG4gIHJldHVybiAkWzBdICE9PSBjb21saW5rIHx8ICRbMV0gIT09IHJlZnJlc2ggPyAodDAgPSAoKSA9PiBjb21saW5rLm9uKFwicHJlc2VudGF0aW9uL3JlZnJlc2hcIiwgKGRhdGEpID0+IHtcbiAgICBpZiAoZGF0YS5zb3VyY2UgPT09IFwibWFudWFsXCIpIHtcbiAgICAgIGNsZWFyVGltZW91dChtYW51YWxSZWZyZXNoUmVmLmN1cnJlbnQpO1xuICAgICAgY29uc3QgcHJvbWlzZSA9IHJlZnJlc2goZGF0YSk7XG4gICAgICBpZiAocHJvbWlzZSA9PT0gITEpXG4gICAgICAgIHJldHVybjtcbiAgICAgIGNvbWxpbmsucG9zdChcInZpc3VhbC1lZGl0aW5nL3JlZnJlc2hpbmdcIiwgZGF0YSk7XG4gICAgICBsZXQgdGltZWRPdXQ7XG4gICAgICB0aW1lZE91dCA9ICExLCBtYW51YWxSZWZyZXNoUmVmLmN1cnJlbnQgPSB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGNvbWxpbmsucG9zdChcInZpc3VhbC1lZGl0aW5nL3JlZnJlc2hlZFwiLCBkYXRhKSwgdGltZWRPdXQgPSAhMDtcbiAgICAgIH0sIDNlMyksIHByb21pc2U/LmZpbmFsbHk/LigoKSA9PiB7XG4gICAgICAgIHRpbWVkT3V0IHx8IChjbGVhclRpbWVvdXQobWFudWFsUmVmcmVzaFJlZi5jdXJyZW50KSwgY29tbGluay5wb3N0KFwidmlzdWFsLWVkaXRpbmcvcmVmcmVzaGVkXCIsIGRhdGEpKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAoZGF0YS5zb3VyY2UgPT09IFwibXV0YXRpb25cIikge1xuICAgICAgY2xlYXJUaW1lb3V0KG11dGF0aW9uUmVmcmVzaFJlZi5jdXJyZW50KTtcbiAgICAgIGNvbnN0IHByb21pc2VfMCA9IHJlZnJlc2goZGF0YSk7XG4gICAgICBpZiAocHJvbWlzZV8wID09PSAhMSlcbiAgICAgICAgcmV0dXJuO1xuICAgICAgY29tbGluay5wb3N0KFwidmlzdWFsLWVkaXRpbmcvcmVmcmVzaGluZ1wiLCBkYXRhKSwgbXV0YXRpb25SZWZyZXNoUmVmLmN1cnJlbnQgPSB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGNvbnN0IHByb21pc2VfMSA9IHJlZnJlc2goZGF0YSk7XG4gICAgICAgIHByb21pc2VfMSAhPT0gITEgJiYgKGNvbWxpbmsucG9zdChcInZpc3VhbC1lZGl0aW5nL3JlZnJlc2hpbmdcIiwgZGF0YSksIHByb21pc2VfMT8uZmluYWxseT8uKCgpID0+IHtcbiAgICAgICAgICBjb21saW5rLnBvc3QoXCJ2aXN1YWwtZWRpdGluZy9yZWZyZXNoZWRcIiwgZGF0YSk7XG4gICAgICAgIH0pIHx8IGNvbWxpbmsucG9zdChcInZpc3VhbC1lZGl0aW5nL3JlZnJlc2hlZFwiLCBkYXRhKSk7XG4gICAgICB9LCAxZTMpLCBwcm9taXNlXzA/LmZpbmFsbHk/LigoKSA9PiB7XG4gICAgICAgIGNvbWxpbmsucG9zdChcInZpc3VhbC1lZGl0aW5nL3JlZnJlc2hlZFwiLCBkYXRhKTtcbiAgICAgIH0pIHx8IGNvbWxpbmsucG9zdChcInZpc3VhbC1lZGl0aW5nL3JlZnJlc2hlZFwiLCBkYXRhKTtcbiAgICB9XG4gIH0pLCB0MSA9IFtjb21saW5rLCByZWZyZXNoXSwgJFswXSA9IGNvbWxpbmssICRbMV0gPSByZWZyZXNoLCAkWzJdID0gdDAsICRbM10gPSB0MSkgOiAodDAgPSAkWzJdLCB0MSA9ICRbM10pLCB1c2VFZmZlY3QodDAsIHQxKSwgbnVsbDtcbn07XG5mdW5jdGlvbiB1c2VDb21saW5rKHQwKSB7XG4gIGNvbnN0ICQgPSBjKDkpLCBhY3RpdmUgPSB0MCA9PT0gdm9pZCAwID8gITAgOiB0MCwgW25vZGUsIHNldE5vZGVdID0gdXNlU3RhdGUoKSwgW3N0YXR1cywgc2V0U3RhdHVzXSA9IHVzZVN0YXRlKFwiaWRsZVwiKTtcbiAgbGV0IHQxLCB0MjtcbiAgJFswXSAhPT0gYWN0aXZlID8gKHQxID0gKCkgPT4ge1xuICAgIGlmICghYWN0aXZlKVxuICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IGluc3RhbmNlID0gY3JlYXRlTm9kZSh7XG4gICAgICBuYW1lOiBcInZpc3VhbC1lZGl0aW5nXCIsXG4gICAgICBjb25uZWN0VG86IFwicHJlc2VudGF0aW9uXCJcbiAgICB9LCBjcmVhdGVOb2RlTWFjaGluZSgpLnByb3ZpZGUoe1xuICAgICAgYWN0b3JzOiBjcmVhdGVDb21wYXRpYmlsaXR5QWN0b3JzKClcbiAgICB9KSksIHVuc3ViID0gaW5zdGFuY2Uub25TdGF0dXMoKCkgPT4gc2V0U3RhdHVzKFwiY29ubmVjdGVkXCIpLCBcImNvbm5lY3RlZFwiKTtcbiAgICBzZXROb2RlKGluc3RhbmNlKTtcbiAgICBjb25zdCBzdG9wID0gaW5zdGFuY2Uuc3RhcnQoKTtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgdW5zdWIoKSwgc3RvcCgpLCBzZXROb2RlKHZvaWQgMCk7XG4gICAgfTtcbiAgfSwgdDIgPSBbYWN0aXZlXSwgJFswXSA9IGFjdGl2ZSwgJFsxXSA9IHQxLCAkWzJdID0gdDIpIDogKHQxID0gJFsxXSwgdDIgPSAkWzJdKSwgdXNlRWZmZWN0KHQxLCB0Mik7XG4gIGxldCB0MywgdDQ7XG4gICRbM10gIT09IHN0YXR1cyA/ICh0MyA9ICgpID0+IHtcbiAgICBpZiAoc3RhdHVzID09PSBcImNvbm5lY3RlZFwiKVxuICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG4gICAgcmV0dXJuIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBfdGVtcCQxLCB7XG4gICAgICBzaWduYWw6IGNvbnRyb2xsZXIuc2lnbmFsXG4gICAgfSksICgpID0+IHtcbiAgICAgIGNvbnRyb2xsZXIuYWJvcnQoKTtcbiAgICB9O1xuICB9LCB0NCA9IFtzdGF0dXNdLCAkWzNdID0gc3RhdHVzLCAkWzRdID0gdDMsICRbNV0gPSB0NCkgOiAodDMgPSAkWzRdLCB0NCA9ICRbNV0pLCB1c2VFZmZlY3QodDMsIHQ0KTtcbiAgbGV0IHQ1O1xuICByZXR1cm4gJFs2XSAhPT0gbm9kZSB8fCAkWzddICE9PSBzdGF0dXMgPyAodDUgPSBbbm9kZSwgc3RhdHVzXSwgJFs2XSA9IG5vZGUsICRbN10gPSBzdGF0dXMsICRbOF0gPSB0NSkgOiB0NSA9ICRbOF0sIHQ1O1xufVxuZnVuY3Rpb24gX3RlbXAkMSh0MCkge1xuICBjb25zdCB7XG4gICAgZGF0YSxcbiAgICBvcmlnaW5cbiAgfSA9IHQwO1xuICBkYXRhICYmIHR5cGVvZiBkYXRhID09IFwib2JqZWN0XCIgJiYgXCJkb21haW5cIiBpbiBkYXRhICYmIGRhdGEuZG9tYWluID09PSBcInNhbml0eS9jaGFubmVsc1wiICYmIFwiZnJvbVwiIGluIGRhdGEgJiYgZGF0YS5mcm9tID09PSBcInByZXNlbnRhdGlvblwiICYmIFwidHlwZVwiIGluIGRhdGEgJiYgZGF0YS50eXBlID09PSBcInByZXNlbnRhdGlvbi9zdGF0dXNcIiAmJiB3aW5kb3cucGFyZW50LnBvc3RNZXNzYWdlKHtcbiAgICBkb21haW46IFwic2FuaXR5L2NoYW5uZWxzXCIsXG4gICAgdHlwZTogXCJ2aXN1YWwtZWRpdGluZy9zdGF0dXNcIixcbiAgICBkYXRhOiB7XG4gICAgICBvcmlnaW46IGxvY2F0aW9uLm9yaWdpblxuICAgIH1cbiAgfSwgb3JpZ2luKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZVNoYXJlZExpc3RlbmVyKGNvbWxpbmspIHtcbiAgY29uc3QgaW5jb21pbmdDb25uZWN0aW9uJCA9IG5ldyBSZXBsYXlTdWJqZWN0KDEpLCBpbmNvbWluZ011dGF0aW9ucyQgPSBuZXcgU3ViamVjdCgpO1xuICByZXR1cm4gY29tbGluay5mZXRjaChcInZpc3VhbC1lZGl0aW5nL3NuYXBzaG90LXdlbGNvbWVcIiwgdm9pZCAwLCB7XG4gICAgc3VwcHJlc3NXYXJuaW5nczogITBcbiAgfSkudGhlbigoZGF0YSkgPT4ge1xuICAgIGluY29taW5nQ29ubmVjdGlvbiQubmV4dChkYXRhLmV2ZW50KTtcbiAgfSkuY2F0Y2goKCkgPT4ge1xuICB9KSwgY29tbGluay5vbihcInByZXNlbnRhdGlvbi9zbmFwc2hvdC1ldmVudFwiLCAoZGF0YSkgPT4ge1xuICAgIGRhdGEuZXZlbnQudHlwZSA9PT0gXCJyZWNvbm5lY3RcIiAmJiBpbmNvbWluZ0Nvbm5lY3Rpb24kLm5leHQoZGF0YS5ldmVudCksIGRhdGEuZXZlbnQudHlwZSA9PT0gXCJtdXRhdGlvblwiICYmIGluY29taW5nTXV0YXRpb25zJC5uZXh0KGRhdGEuZXZlbnQpO1xuICB9KSwgbWVyZ2UoaW5jb21pbmdDb25uZWN0aW9uJCwgaW5jb21pbmdNdXRhdGlvbnMkKTtcbn1cbmZ1bmN0aW9uIHVzZURhdGFzZXRNdXRhdG9yKGNvbWxpbmspIHtcbiAgY29uc3QgJCA9IGMoMyk7XG4gIGxldCB0MCwgdDE7XG4gICRbMF0gIT09IGNvbWxpbmsgPyAodDAgPSAoKSA9PiB7XG4gICAgaWYgKCFjb21saW5rKVxuICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IGxpc3RlbmVyID0gY3JlYXRlU2hhcmVkTGlzdGVuZXIoY29tbGluayksIGRhdGFzZXRNdXRhdG9yID0gY3JlYXRlRGF0YXNldE11dGF0b3IoY29tbGluayksIG11dGF0b3IgPSBjcmVhdGVBY3RvcihkYXRhc2V0TXV0YXRvciwge1xuICAgICAgaW5wdXQ6IHtcbiAgICAgICAgY2xpZW50OiB7XG4gICAgICAgICAgd2l0aENvbmZpZzogX3RlbXBcbiAgICAgICAgfSxcbiAgICAgICAgc2hhcmVkTGlzdGVuZXI6IGxpc3RlbmVyXG4gICAgICB9XG4gICAgfSk7XG4gICAgbXV0YXRvci5zdGFydCgpO1xuICAgIGNvbnN0IGZlYXR1cmVzRmV0Y2ggPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG4gICAgcmV0dXJuIGNvbWxpbmsuZmV0Y2goXCJ2aXN1YWwtZWRpdGluZy9mZWF0dXJlc1wiLCB2b2lkIDAsIHtcbiAgICAgIHNpZ25hbDogZmVhdHVyZXNGZXRjaC5zaWduYWwsXG4gICAgICBzdXBwcmVzc1dhcm5pbmdzOiAhMFxuICAgIH0pLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIGRhdGEuZmVhdHVyZXMub3B0aW1pc3RpYyAmJiBzZXRBY3RvcihtdXRhdG9yKTtcbiAgICB9KS5jYXRjaChfdGVtcDIpLCAoKSA9PiB7XG4gICAgICBtdXRhdG9yLnN0b3AoKSwgZmVhdHVyZXNGZXRjaC5hYm9ydCgpO1xuICAgIH07XG4gIH0sIHQxID0gW2NvbWxpbmtdLCAkWzBdID0gY29tbGluaywgJFsxXSA9IHQwLCAkWzJdID0gdDEpIDogKHQwID0gJFsxXSwgdDEgPSAkWzJdKSwgdXNlRWZmZWN0KHQwLCB0MSk7XG59XG5mdW5jdGlvbiBfdGVtcDIoKSB7XG4gIGNvbnNvbGUud2FybihcIltAc2FuaXR5L3Zpc3VhbC1lZGl0aW5nXSBQYWNrYWdlIHZlcnNpb24gbWlzbWF0Y2ggZGV0ZWN0ZWQ6IFBsZWFzZSB1cGRhdGUgeW91ciBTYW5pdHkgc3R1ZGlvIHRvIHByZXZlbnQgcG90ZW50aWFsIGNvbXBhdGliaWxpdHkgaXNzdWVzLlwiKTtcbn1cbmZ1bmN0aW9uIF90ZW1wKCkge1xufVxuY29uc3QgVmlzdWFsRWRpdGluZyA9IChwcm9wcykgPT4ge1xuICBjb25zdCAkID0gYygyMiksIHtcbiAgICBjb21wb25lbnRzLFxuICAgIGhpc3RvcnksXG4gICAgcG9ydGFsOiB0MCxcbiAgICByZWZyZXNoLFxuICAgIHpJbmRleFxuICB9ID0gcHJvcHMsIHBvcnRhbCA9IHQwID09PSB2b2lkIDAgPyAhMCA6IHQwLCBbaW5GcmFtZSwgc2V0SW5GcmFtZV0gPSB1c2VTdGF0ZShudWxsKSwgW2luUG9wVXAsIHNldEluUG9wVXBdID0gdXNlU3RhdGUobnVsbCk7XG4gIGxldCB0MSwgdDI7XG4gICRbMF0gPT09IFN5bWJvbC5mb3IoXCJyZWFjdC5tZW1vX2NhY2hlX3NlbnRpbmVsXCIpID8gKHQxID0gKCkgPT4ge1xuICAgIHNldEluRnJhbWUoaXNNYXliZVByZXZpZXdJZnJhbWUoKSksIHNldEluUG9wVXAoaXNNYXliZVByZXZpZXdXaW5kb3coKSk7XG4gIH0sIHQyID0gW10sICRbMF0gPSB0MSwgJFsxXSA9IHQyKSA6ICh0MSA9ICRbMF0sIHQyID0gJFsxXSksIHVzZUVmZmVjdCh0MSwgdDIpO1xuICBjb25zdCBbcG9ydGFsRWxlbWVudCwgc2V0UG9ydGFsRWxlbWVudF0gPSB1c2VTdGF0ZShudWxsKTtcbiAgbGV0IHQzLCB0NDtcbiAgJFsyXSAhPT0gcG9ydGFsID8gKHQzID0gKCkgPT4ge1xuICAgIGlmIChwb3J0YWwgPT09ICExKVxuICAgICAgcmV0dXJuO1xuICAgIGNvbnN0IG5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2FuaXR5LXZpc3VhbC1lZGl0aW5nXCIpO1xuICAgIHJldHVybiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYXBwZW5kQ2hpbGQobm9kZSksIHNldFBvcnRhbEVsZW1lbnQobm9kZSksICgpID0+IHtcbiAgICAgIHNldFBvcnRhbEVsZW1lbnQobnVsbCksIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jb250YWlucyhub2RlKSAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQucmVtb3ZlQ2hpbGQobm9kZSk7XG4gICAgfTtcbiAgfSwgdDQgPSBbcG9ydGFsXSwgJFsyXSA9IHBvcnRhbCwgJFszXSA9IHQzLCAkWzRdID0gdDQpIDogKHQzID0gJFszXSwgdDQgPSAkWzRdKSwgdXNlRWZmZWN0KHQzLCB0NCk7XG4gIGNvbnN0IFtjb21saW5rLCBjb21saW5rU3RhdHVzXSA9IHVzZUNvbWxpbmsoaW5GcmFtZSA9PT0gITAgfHwgaW5Qb3BVcCA9PT0gITApO1xuICB1c2VEYXRhc2V0TXV0YXRvcihjb21saW5rU3RhdHVzID09PSBcImNvbm5lY3RlZFwiID8gY29tbGluayA6IHZvaWQgMCk7XG4gIGxldCB0NTtcbiAgJFs1XSAhPT0gY29tbGluayB8fCAkWzZdICE9PSBjb21saW5rU3RhdHVzIHx8ICRbN10gIT09IGNvbXBvbmVudHMgfHwgJFs4XSAhPT0gaW5GcmFtZSB8fCAkWzldICE9PSBpblBvcFVwIHx8ICRbMTBdICE9PSB6SW5kZXggPyAodDUgPSBpbkZyYW1lICE9PSBudWxsICYmIGluUG9wVXAgIT09IG51bGwgJiYgLyogQF9fUFVSRV9fICovIGpzeChPdmVybGF5cywgeyBjb21saW5rLCBjb21saW5rU3RhdHVzLCBjb21wb25lbnRSZXNvbHZlcjogY29tcG9uZW50cywgaW5GcmFtZSwgaW5Qb3BVcCwgekluZGV4IH0pLCAkWzVdID0gY29tbGluaywgJFs2XSA9IGNvbWxpbmtTdGF0dXMsICRbN10gPSBjb21wb25lbnRzLCAkWzhdID0gaW5GcmFtZSwgJFs5XSA9IGluUG9wVXAsICRbMTBdID0gekluZGV4LCAkWzExXSA9IHQ1KSA6IHQ1ID0gJFsxMV07XG4gIGxldCB0NjtcbiAgJFsxMl0gIT09IGNvbWxpbmsgfHwgJFsxM10gIT09IGhpc3RvcnkgfHwgJFsxNF0gIT09IHJlZnJlc2ggPyAodDYgPSBjb21saW5rICYmIC8qIEBfX1BVUkVfXyAqLyBqc3hzKEZyYWdtZW50LCB7IGNoaWxkcmVuOiBbXG4gICAgLyogQF9fUFVSRV9fICovIGpzeChIaXN0b3J5LCB7IGNvbWxpbmssIGhpc3RvcnkgfSksXG4gICAgLyogQF9fUFVSRV9fICovIGpzeChNZXRhLCB7IGNvbWxpbmsgfSksXG4gICAgcmVmcmVzaCAmJiAvKiBAX19QVVJFX18gKi8ganN4KFJlZnJlc2gsIHsgY29tbGluaywgcmVmcmVzaCB9KVxuICBdIH0pLCAkWzEyXSA9IGNvbWxpbmssICRbMTNdID0gaGlzdG9yeSwgJFsxNF0gPSByZWZyZXNoLCAkWzE1XSA9IHQ2KSA6IHQ2ID0gJFsxNV07XG4gIGxldCB0NztcbiAgJFsxNl0gIT09IHQ1IHx8ICRbMTddICE9PSB0NiA/ICh0NyA9IC8qIEBfX1BVUkVfXyAqLyBqc3hzKEZyYWdtZW50LCB7IGNoaWxkcmVuOiBbXG4gICAgdDUsXG4gICAgdDZcbiAgXSB9KSwgJFsxNl0gPSB0NSwgJFsxN10gPSB0NiwgJFsxOF0gPSB0NykgOiB0NyA9ICRbMThdO1xuICBjb25zdCBjaGlsZHJlbiA9IHQ3O1xuICBpZiAocG9ydGFsID09PSAhMSB8fCAhcG9ydGFsRWxlbWVudClcbiAgICByZXR1cm4gY2hpbGRyZW47XG4gIGxldCB0ODtcbiAgcmV0dXJuICRbMTldICE9PSBjaGlsZHJlbiB8fCAkWzIwXSAhPT0gcG9ydGFsRWxlbWVudCA/ICh0OCA9IGNyZWF0ZVBvcnRhbChjaGlsZHJlbiwgcG9ydGFsRWxlbWVudCksICRbMTldID0gY2hpbGRyZW4sICRbMjBdID0gcG9ydGFsRWxlbWVudCwgJFsyMV0gPSB0OCkgOiB0OCA9ICRbMjFdLCB0ODtcbn07XG5WaXN1YWxFZGl0aW5nLmRpc3BsYXlOYW1lID0gXCJWaXN1YWxFZGl0aW5nXCI7XG5leHBvcnQge1xuICBWaXN1YWxFZGl0aW5nLFxuICBjcmVhdGVEYXRhQXR0cmlidXRlLFxuICBjcmVhdGVEYXRhc2V0TXV0YXRvcixcbiAgY3JlYXRlRG9jdW1lbnRNdXRhdG9yLFxuICBlbXB0eUFjdG9yLFxuICB1c2VEb2N1bWVudHMsXG4gIHVzZU9wdGltaXN0aWMsXG4gIHVzZU9wdGltaXN0aWNBY3RvclxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcFxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/next-sanity/node_modules/@sanity/visual-editing/dist/react/index.js\n");

/***/ })

};
;